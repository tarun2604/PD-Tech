function ED(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function kD(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var eE={exports:{}},_h={},tE={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ff=Symbol.for("react.element"),TD=Symbol.for("react.portal"),CD=Symbol.for("react.fragment"),ND=Symbol.for("react.strict_mode"),AD=Symbol.for("react.profiler"),OD=Symbol.for("react.provider"),DD=Symbol.for("react.context"),jD=Symbol.for("react.forward_ref"),PD=Symbol.for("react.suspense"),FD=Symbol.for("react.memo"),RD=Symbol.for("react.lazy"),t_=Symbol.iterator;function MD(e){return e===null||typeof e!="object"?null:(e=t_&&e[t_]||e["@@iterator"],typeof e=="function"?e:null)}var rE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nE=Object.assign,aE={};function Fl(e,t,r){this.props=e,this.context=t,this.refs=aE,this.updater=r||rE}Fl.prototype.isReactComponent={};Fl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function sE(){}sE.prototype=Fl.prototype;function Jg(e,t,r){this.props=e,this.context=t,this.refs=aE,this.updater=r||rE}var Qg=Jg.prototype=new sE;Qg.constructor=Jg;nE(Qg,Fl.prototype);Qg.isPureReactComponent=!0;var r_=Array.isArray,iE=Object.prototype.hasOwnProperty,Zg={current:null},oE={key:!0,ref:!0,__self:!0,__source:!0};function lE(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)iE.call(t,n)&&!oE.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:ff,type:e,key:s,ref:i,props:a,_owner:Zg.current}}function ID(e,t){return{$$typeof:ff,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ex(e){return typeof e=="object"&&e!==null&&e.$$typeof===ff}function LD(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var n_=/\/+/g;function Bp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?LD(""+e.key):t.toString(36)}function Ld(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case ff:case TD:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Bp(i,0):n,r_(a)?(r="",e!=null&&(r=e.replace(n_,"$&/")+"/"),Ld(a,t,r,"",function(c){return c})):a!=null&&(ex(a)&&(a=ID(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(n_,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",r_(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Bp(s,o);i+=Ld(s,t,r,l,a)}else if(l=MD(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Bp(s,o++),i+=Ld(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Kf(e,t,r){if(e==null)return e;var n=[],a=0;return Ld(e,n,"","",function(s){return t.call(r,s,a++)}),n}function $D(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rr={current:null},$d={transition:null},UD={ReactCurrentDispatcher:Rr,ReactCurrentBatchConfig:$d,ReactCurrentOwner:Zg};function cE(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:Kf,forEach:function(e,t,r){Kf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Kf(e,function(){t++}),t},toArray:function(e){return Kf(e,function(t){return t})||[]},only:function(e){if(!ex(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Me.Component=Fl;Me.Fragment=CD;Me.Profiler=AD;Me.PureComponent=Jg;Me.StrictMode=ND;Me.Suspense=PD;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UD;Me.act=cE;Me.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=nE({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Zg.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)iE.call(t,l)&&!oE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ff,type:e.type,key:a,ref:s,props:n,_owner:i}};Me.createContext=function(e){return e={$$typeof:DD,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:OD,_context:e},e.Consumer=e};Me.createElement=lE;Me.createFactory=function(e){var t=lE.bind(null,e);return t.type=e,t};Me.createRef=function(){return{current:null}};Me.forwardRef=function(e){return{$$typeof:jD,render:e}};Me.isValidElement=ex;Me.lazy=function(e){return{$$typeof:RD,_payload:{_status:-1,_result:e},_init:$D}};Me.memo=function(e,t){return{$$typeof:FD,type:e,compare:t===void 0?null:t}};Me.startTransition=function(e){var t=$d.transition;$d.transition={};try{e()}finally{$d.transition=t}};Me.unstable_act=cE;Me.useCallback=function(e,t){return Rr.current.useCallback(e,t)};Me.useContext=function(e){return Rr.current.useContext(e)};Me.useDebugValue=function(){};Me.useDeferredValue=function(e){return Rr.current.useDeferredValue(e)};Me.useEffect=function(e,t){return Rr.current.useEffect(e,t)};Me.useId=function(){return Rr.current.useId()};Me.useImperativeHandle=function(e,t,r){return Rr.current.useImperativeHandle(e,t,r)};Me.useInsertionEffect=function(e,t){return Rr.current.useInsertionEffect(e,t)};Me.useLayoutEffect=function(e,t){return Rr.current.useLayoutEffect(e,t)};Me.useMemo=function(e,t){return Rr.current.useMemo(e,t)};Me.useReducer=function(e,t,r){return Rr.current.useReducer(e,t,r)};Me.useRef=function(e){return Rr.current.useRef(e)};Me.useState=function(e){return Rr.current.useState(e)};Me.useSyncExternalStore=function(e,t,r){return Rr.current.useSyncExternalStore(e,t,r)};Me.useTransition=function(){return Rr.current.useTransition()};Me.version="18.3.1";tE.exports=Me;var D=tE.exports;const Q=Sr(D),BD=ED({__proto__:null,default:Q},[D]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WD=D,VD=Symbol.for("react.element"),HD=Symbol.for("react.fragment"),zD=Object.prototype.hasOwnProperty,YD=WD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GD={key:!0,ref:!0,__self:!0,__source:!0};function uE(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)zD.call(t,n)&&!GD.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:VD,type:e,key:s,ref:i,props:a,_owner:YD.current}}_h.Fragment=HD;_h.jsx=uE;_h.jsxs=uE;eE.exports=_h;var u=eE.exports,fE={exports:{}},un={},dE={exports:{}},hE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,Y){var ce=Z.length;Z.push(Y);e:for(;0<ce;){var z=ce-1>>>1,k=Z[z];if(0<a(k,Y))Z[z]=Y,Z[ce]=k,ce=z;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var Y=Z[0],ce=Z.pop();if(ce!==Y){Z[0]=ce;e:for(var z=0,k=Z.length,I=k>>>1;z<I;){var N=2*(z+1)-1,P=Z[N],K=N+1,ne=Z[K];if(0>a(P,ce))K<k&&0>a(ne,P)?(Z[z]=ne,Z[K]=ce,z=K):(Z[z]=P,Z[N]=ce,z=N);else if(K<k&&0>a(ne,ce))Z[z]=ne,Z[K]=ce,z=K;else break e}}return Y}function a(Z,Y){var ce=Z.sortIndex-Y.sortIndex;return ce!==0?ce:Z.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,h=3,m=!1,v=!1,p=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(Z){for(var Y=r(c);Y!==null;){if(Y.callback===null)n(c);else if(Y.startTime<=Z)n(c),Y.sortIndex=Y.expirationTime,t(l,Y);else break;Y=r(c)}}function w(Z){if(p=!1,x(Z),!v)if(r(l)!==null)v=!0,H(E);else{var Y=r(c);Y!==null&&q(w,Y.startTime-Z)}}function E(Z,Y){v=!1,p&&(p=!1,g(T),T=-1),m=!0;var ce=h;try{for(x(Y),d=r(l);d!==null&&(!(d.expirationTime>Y)||Z&&!M());){var z=d.callback;if(typeof z=="function"){d.callback=null,h=d.priorityLevel;var k=z(d.expirationTime<=Y);Y=e.unstable_now(),typeof k=="function"?d.callback=k:d===r(l)&&n(l),x(Y)}else n(l);d=r(l)}if(d!==null)var I=!0;else{var N=r(c);N!==null&&q(w,N.startTime-Y),I=!1}return I}finally{d=null,h=ce,m=!1}}var S=!1,b=null,T=-1,C=5,F=-1;function M(){return!(e.unstable_now()-F<C)}function j(){if(b!==null){var Z=e.unstable_now();F=Z;var Y=!0;try{Y=b(!0,Z)}finally{Y?A():(S=!1,b=null)}}else S=!1}var A;if(typeof y=="function")A=function(){y(j)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,X=G.port2;G.port1.onmessage=j,A=function(){X.postMessage(null)}}else A=function(){_(j,0)};function H(Z){b=Z,S||(S=!0,A())}function q(Z,Y){T=_(function(){Z(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,H(E))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(Z){switch(h){case 1:case 2:case 3:var Y=3;break;default:Y=h}var ce=h;h=Y;try{return Z()}finally{h=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,Y){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ce=h;h=Z;try{return Y()}finally{h=ce}},e.unstable_scheduleCallback=function(Z,Y,ce){var z=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?z+ce:z):ce=z,Z){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=ce+k,Z={id:f++,callback:Y,priorityLevel:Z,startTime:ce,expirationTime:k,sortIndex:-1},ce>z?(Z.sortIndex=ce,t(c,Z),r(l)===null&&Z===r(c)&&(p?(g(T),T=-1):p=!0,q(w,ce-z))):(Z.sortIndex=k,t(l,Z),v||m||(v=!0,H(E))),Z},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(Z){var Y=h;return function(){var ce=h;h=Y;try{return Z.apply(this,arguments)}finally{h=ce}}}})(hE);dE.exports=hE;var KD=dE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qD=D,on=KD;function de(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pE=new Set,mu={};function fo(e,t){ml(e,t),ml(e+"Capture",t)}function ml(e,t){for(mu[e]=t,e=0;e<t.length;e++)pE.add(t[e])}var os=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ev=Object.prototype.hasOwnProperty,XD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,a_={},s_={};function JD(e){return ev.call(s_,e)?!0:ev.call(a_,e)?!1:XD.test(e)?s_[e]=!0:(a_[e]=!0,!1)}function QD(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ZD(e,t,r,n){if(t===null||typeof t>"u"||QD(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Mr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var or={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){or[e]=new Mr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];or[t]=new Mr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){or[e]=new Mr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){or[e]=new Mr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){or[e]=new Mr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){or[e]=new Mr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){or[e]=new Mr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){or[e]=new Mr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){or[e]=new Mr(e,5,!1,e.toLowerCase(),null,!1,!1)});var tx=/[\-:]([a-z])/g;function rx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(tx,rx);or[t]=new Mr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(tx,rx);or[t]=new Mr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(tx,rx);or[t]=new Mr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){or[e]=new Mr(e,1,!1,e.toLowerCase(),null,!1,!1)});or.xlinkHref=new Mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){or[e]=new Mr(e,1,!1,e.toLowerCase(),null,!0,!0)});function nx(e,t,r,n){var a=or.hasOwnProperty(t)?or[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ZD(t,r,a,n)&&(r=null),n||a===null?JD(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var gs=qD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qf=Symbol.for("react.element"),Lo=Symbol.for("react.portal"),$o=Symbol.for("react.fragment"),ax=Symbol.for("react.strict_mode"),tv=Symbol.for("react.profiler"),mE=Symbol.for("react.provider"),vE=Symbol.for("react.context"),sx=Symbol.for("react.forward_ref"),rv=Symbol.for("react.suspense"),nv=Symbol.for("react.suspense_list"),ix=Symbol.for("react.memo"),Os=Symbol.for("react.lazy"),gE=Symbol.for("react.offscreen"),i_=Symbol.iterator;function hc(e){return e===null||typeof e!="object"?null:(e=i_&&e[i_]||e["@@iterator"],typeof e=="function"?e:null)}var St=Object.assign,Wp;function Dc(e){if(Wp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Wp=t&&t[1]||""}return`
`+Wp+e}var Vp=!1;function Hp(e,t){if(!e||Vp)return"";Vp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Vp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Dc(e):""}function ej(e){switch(e.tag){case 5:return Dc(e.type);case 16:return Dc("Lazy");case 13:return Dc("Suspense");case 19:return Dc("SuspenseList");case 0:case 2:case 15:return e=Hp(e.type,!1),e;case 11:return e=Hp(e.type.render,!1),e;case 1:return e=Hp(e.type,!0),e;default:return""}}function av(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $o:return"Fragment";case Lo:return"Portal";case tv:return"Profiler";case ax:return"StrictMode";case rv:return"Suspense";case nv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vE:return(e.displayName||"Context")+".Consumer";case mE:return(e._context.displayName||"Context")+".Provider";case sx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ix:return t=e.displayName||null,t!==null?t:av(e.type)||"Memo";case Os:t=e._payload,e=e._init;try{return av(e(t))}catch{}}return null}function tj(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return av(t);case 8:return t===ax?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ni(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function xE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function rj(e){var t=xE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Xf(e){e._valueTracker||(e._valueTracker=rj(e))}function yE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=xE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function o0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sv(e,t){var r=t.checked;return St({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function o_(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ni(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _E(e,t){t=t.checked,t!=null&&nx(e,"checked",t,!1)}function iv(e,t){_E(e,t);var r=ni(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ov(e,t.type,r):t.hasOwnProperty("defaultValue")&&ov(e,t.type,ni(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function l_(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ov(e,t,r){(t!=="number"||o0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var jc=Array.isArray;function tl(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ni(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function lv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(de(91));return St({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function c_(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(de(92));if(jc(r)){if(1<r.length)throw Error(de(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ni(r)}}function wE(e,t){var r=ni(t.value),n=ni(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function u_(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function bE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?bE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Jf,SE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Jf=Jf||document.createElement("div"),Jf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Jf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function vu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Bc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nj=["Webkit","ms","Moz","O"];Object.keys(Bc).forEach(function(e){nj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Bc[t]=Bc[e]})});function EE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Bc.hasOwnProperty(e)&&Bc[e]?(""+t).trim():t+"px"}function kE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=EE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var aj=St({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uv(e,t){if(t){if(aj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(de(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(de(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(de(61))}if(t.style!=null&&typeof t.style!="object")throw Error(de(62))}}function fv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dv=null;function ox(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hv=null,rl=null,nl=null;function f_(e){if(e=pf(e)){if(typeof hv!="function")throw Error(de(280));var t=e.stateNode;t&&(t=kh(t),hv(e.stateNode,e.type,t))}}function TE(e){rl?nl?nl.push(e):nl=[e]:rl=e}function CE(){if(rl){var e=rl,t=nl;if(nl=rl=null,f_(e),t)for(e=0;e<t.length;e++)f_(t[e])}}function NE(e,t){return e(t)}function AE(){}var zp=!1;function OE(e,t,r){if(zp)return e(t,r);zp=!0;try{return NE(e,t,r)}finally{zp=!1,(rl!==null||nl!==null)&&(AE(),CE())}}function gu(e,t){var r=e.stateNode;if(r===null)return null;var n=kh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(de(231,t,typeof r));return r}var pv=!1;if(os)try{var pc={};Object.defineProperty(pc,"passive",{get:function(){pv=!0}}),window.addEventListener("test",pc,pc),window.removeEventListener("test",pc,pc)}catch{pv=!1}function sj(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Wc=!1,l0=null,c0=!1,mv=null,ij={onError:function(e){Wc=!0,l0=e}};function oj(e,t,r,n,a,s,i,o,l){Wc=!1,l0=null,sj.apply(ij,arguments)}function lj(e,t,r,n,a,s,i,o,l){if(oj.apply(this,arguments),Wc){if(Wc){var c=l0;Wc=!1,l0=null}else throw Error(de(198));c0||(c0=!0,mv=c)}}function ho(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function DE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function d_(e){if(ho(e)!==e)throw Error(de(188))}function cj(e){var t=e.alternate;if(!t){if(t=ho(e),t===null)throw Error(de(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return d_(a),e;if(s===n)return d_(a),t;s=s.sibling}throw Error(de(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(de(189))}}if(r.alternate!==n)throw Error(de(190))}if(r.tag!==3)throw Error(de(188));return r.stateNode.current===r?e:t}function jE(e){return e=cj(e),e!==null?PE(e):null}function PE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=PE(e);if(t!==null)return t;e=e.sibling}return null}var FE=on.unstable_scheduleCallback,h_=on.unstable_cancelCallback,uj=on.unstable_shouldYield,fj=on.unstable_requestPaint,jt=on.unstable_now,dj=on.unstable_getCurrentPriorityLevel,lx=on.unstable_ImmediatePriority,RE=on.unstable_UserBlockingPriority,u0=on.unstable_NormalPriority,hj=on.unstable_LowPriority,ME=on.unstable_IdlePriority,wh=null,Sa=null;function pj(e){if(Sa&&typeof Sa.onCommitFiberRoot=="function")try{Sa.onCommitFiberRoot(wh,e,void 0,(e.current.flags&128)===128)}catch{}}var Zn=Math.clz32?Math.clz32:gj,mj=Math.log,vj=Math.LN2;function gj(e){return e>>>=0,e===0?32:31-(mj(e)/vj|0)|0}var Qf=64,Zf=4194304;function Pc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function f0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Pc(o):(s&=i,s!==0&&(n=Pc(s)))}else i=r&~a,i!==0?n=Pc(i):s!==0&&(n=Pc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Zn(t),a=1<<r,n|=e[r],t&=~a;return n}function xj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yj(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Zn(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=xj(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function vv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function IE(){var e=Qf;return Qf<<=1,!(Qf&4194240)&&(Qf=64),e}function Yp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function df(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Zn(t),e[t]=r}function _j(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Zn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function cx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Zn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Je=0;function LE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $E,ux,UE,BE,WE,gv=!1,ed=[],Ys=null,Gs=null,Ks=null,xu=new Map,yu=new Map,Ps=[],wj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function p_(e,t){switch(e){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Gs=null;break;case"mouseover":case"mouseout":Ks=null;break;case"pointerover":case"pointerout":xu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yu.delete(t.pointerId)}}function mc(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=pf(t),t!==null&&ux(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function bj(e,t,r,n,a){switch(t){case"focusin":return Ys=mc(Ys,e,t,r,n,a),!0;case"dragenter":return Gs=mc(Gs,e,t,r,n,a),!0;case"mouseover":return Ks=mc(Ks,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return xu.set(s,mc(xu.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,yu.set(s,mc(yu.get(s)||null,e,t,r,n,a)),!0}return!1}function VE(e){var t=ji(e.target);if(t!==null){var r=ho(t);if(r!==null){if(t=r.tag,t===13){if(t=DE(r),t!==null){e.blockedOn=t,WE(e.priority,function(){UE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ud(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=xv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);dv=n,r.target.dispatchEvent(n),dv=null}else return t=pf(r),t!==null&&ux(t),e.blockedOn=r,!1;t.shift()}return!0}function m_(e,t,r){Ud(e)&&r.delete(t)}function Sj(){gv=!1,Ys!==null&&Ud(Ys)&&(Ys=null),Gs!==null&&Ud(Gs)&&(Gs=null),Ks!==null&&Ud(Ks)&&(Ks=null),xu.forEach(m_),yu.forEach(m_)}function vc(e,t){e.blockedOn===t&&(e.blockedOn=null,gv||(gv=!0,on.unstable_scheduleCallback(on.unstable_NormalPriority,Sj)))}function _u(e){function t(a){return vc(a,e)}if(0<ed.length){vc(ed[0],e);for(var r=1;r<ed.length;r++){var n=ed[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ys!==null&&vc(Ys,e),Gs!==null&&vc(Gs,e),Ks!==null&&vc(Ks,e),xu.forEach(t),yu.forEach(t),r=0;r<Ps.length;r++)n=Ps[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ps.length&&(r=Ps[0],r.blockedOn===null);)VE(r),r.blockedOn===null&&Ps.shift()}var al=gs.ReactCurrentBatchConfig,d0=!0;function Ej(e,t,r,n){var a=Je,s=al.transition;al.transition=null;try{Je=1,fx(e,t,r,n)}finally{Je=a,al.transition=s}}function kj(e,t,r,n){var a=Je,s=al.transition;al.transition=null;try{Je=4,fx(e,t,r,n)}finally{Je=a,al.transition=s}}function fx(e,t,r,n){if(d0){var a=xv(e,t,r,n);if(a===null)rm(e,t,n,h0,r),p_(e,n);else if(bj(a,e,t,r,n))n.stopPropagation();else if(p_(e,n),t&4&&-1<wj.indexOf(e)){for(;a!==null;){var s=pf(a);if(s!==null&&$E(s),s=xv(e,t,r,n),s===null&&rm(e,t,n,h0,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else rm(e,t,n,null,r)}}var h0=null;function xv(e,t,r,n){if(h0=null,e=ox(n),e=ji(e),e!==null)if(t=ho(e),t===null)e=null;else if(r=t.tag,r===13){if(e=DE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return h0=e,null}function HE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dj()){case lx:return 1;case RE:return 4;case u0:case hj:return 16;case ME:return 536870912;default:return 16}default:return 16}}var Ls=null,dx=null,Bd=null;function zE(){if(Bd)return Bd;var e,t=dx,r=t.length,n,a="value"in Ls?Ls.value:Ls.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Bd=a.slice(e,1<n?1-n:void 0)}function Wd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function td(){return!0}function v_(){return!1}function fn(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?td:v_,this.isPropagationStopped=v_,this}return St(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=td)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=td)},persist:function(){},isPersistent:td}),t}var Rl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hx=fn(Rl),hf=St({},Rl,{view:0,detail:0}),Tj=fn(hf),Gp,Kp,gc,bh=St({},hf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:px,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gc&&(gc&&e.type==="mousemove"?(Gp=e.screenX-gc.screenX,Kp=e.screenY-gc.screenY):Kp=Gp=0,gc=e),Gp)},movementY:function(e){return"movementY"in e?e.movementY:Kp}}),g_=fn(bh),Cj=St({},bh,{dataTransfer:0}),Nj=fn(Cj),Aj=St({},hf,{relatedTarget:0}),qp=fn(Aj),Oj=St({},Rl,{animationName:0,elapsedTime:0,pseudoElement:0}),Dj=fn(Oj),jj=St({},Rl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Pj=fn(jj),Fj=St({},Rl,{data:0}),x_=fn(Fj),Rj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ij={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ij[e])?!!t[e]:!1}function px(){return Lj}var $j=St({},hf,{key:function(e){if(e.key){var t=Rj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Wd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:px,charCode:function(e){return e.type==="keypress"?Wd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Wd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Uj=fn($j),Bj=St({},bh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y_=fn(Bj),Wj=St({},hf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:px}),Vj=fn(Wj),Hj=St({},Rl,{propertyName:0,elapsedTime:0,pseudoElement:0}),zj=fn(Hj),Yj=St({},bh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Gj=fn(Yj),Kj=[9,13,27,32],mx=os&&"CompositionEvent"in window,Vc=null;os&&"documentMode"in document&&(Vc=document.documentMode);var qj=os&&"TextEvent"in window&&!Vc,YE=os&&(!mx||Vc&&8<Vc&&11>=Vc),__=" ",w_=!1;function GE(e,t){switch(e){case"keyup":return Kj.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Uo=!1;function Xj(e,t){switch(e){case"compositionend":return KE(t);case"keypress":return t.which!==32?null:(w_=!0,__);case"textInput":return e=t.data,e===__&&w_?null:e;default:return null}}function Jj(e,t){if(Uo)return e==="compositionend"||!mx&&GE(e,t)?(e=zE(),Bd=dx=Ls=null,Uo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return YE&&t.locale!=="ko"?null:t.data;default:return null}}var Qj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function b_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Qj[e.type]:t==="textarea"}function qE(e,t,r,n){TE(n),t=p0(t,"onChange"),0<t.length&&(r=new hx("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Hc=null,wu=null;function Zj(e){ik(e,0)}function Sh(e){var t=Vo(e);if(yE(t))return e}function e3(e,t){if(e==="change")return t}var XE=!1;if(os){var Xp;if(os){var Jp="oninput"in document;if(!Jp){var S_=document.createElement("div");S_.setAttribute("oninput","return;"),Jp=typeof S_.oninput=="function"}Xp=Jp}else Xp=!1;XE=Xp&&(!document.documentMode||9<document.documentMode)}function E_(){Hc&&(Hc.detachEvent("onpropertychange",JE),wu=Hc=null)}function JE(e){if(e.propertyName==="value"&&Sh(wu)){var t=[];qE(t,wu,e,ox(e)),OE(Zj,t)}}function t3(e,t,r){e==="focusin"?(E_(),Hc=t,wu=r,Hc.attachEvent("onpropertychange",JE)):e==="focusout"&&E_()}function r3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Sh(wu)}function n3(e,t){if(e==="click")return Sh(t)}function a3(e,t){if(e==="input"||e==="change")return Sh(t)}function s3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var aa=typeof Object.is=="function"?Object.is:s3;function bu(e,t){if(aa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!ev.call(t,a)||!aa(e[a],t[a]))return!1}return!0}function k_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function T_(e,t){var r=k_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=k_(r)}}function QE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?QE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ZE(){for(var e=window,t=o0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=o0(e.document)}return t}function vx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function i3(e){var t=ZE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&QE(r.ownerDocument.documentElement,r)){if(n!==null&&vx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=T_(r,s);var i=T_(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var o3=os&&"documentMode"in document&&11>=document.documentMode,Bo=null,yv=null,zc=null,_v=!1;function C_(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;_v||Bo==null||Bo!==o0(n)||(n=Bo,"selectionStart"in n&&vx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),zc&&bu(zc,n)||(zc=n,n=p0(yv,"onSelect"),0<n.length&&(t=new hx("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Bo)))}function rd(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Wo={animationend:rd("Animation","AnimationEnd"),animationiteration:rd("Animation","AnimationIteration"),animationstart:rd("Animation","AnimationStart"),transitionend:rd("Transition","TransitionEnd")},Qp={},ek={};os&&(ek=document.createElement("div").style,"AnimationEvent"in window||(delete Wo.animationend.animation,delete Wo.animationiteration.animation,delete Wo.animationstart.animation),"TransitionEvent"in window||delete Wo.transitionend.transition);function Eh(e){if(Qp[e])return Qp[e];if(!Wo[e])return e;var t=Wo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ek)return Qp[e]=t[r];return e}var tk=Eh("animationend"),rk=Eh("animationiteration"),nk=Eh("animationstart"),ak=Eh("transitionend"),sk=new Map,N_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fi(e,t){sk.set(e,t),fo(t,[e])}for(var Zp=0;Zp<N_.length;Zp++){var em=N_[Zp],l3=em.toLowerCase(),c3=em[0].toUpperCase()+em.slice(1);fi(l3,"on"+c3)}fi(tk,"onAnimationEnd");fi(rk,"onAnimationIteration");fi(nk,"onAnimationStart");fi("dblclick","onDoubleClick");fi("focusin","onFocus");fi("focusout","onBlur");fi(ak,"onTransitionEnd");ml("onMouseEnter",["mouseout","mouseover"]);ml("onMouseLeave",["mouseout","mouseover"]);ml("onPointerEnter",["pointerout","pointerover"]);ml("onPointerLeave",["pointerout","pointerover"]);fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fc));function A_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,lj(n,t,void 0,e),e.currentTarget=null}function ik(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;A_(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;A_(a,o,c),s=l}}}if(c0)throw e=mv,c0=!1,mv=null,e}function ot(e,t){var r=t[kv];r===void 0&&(r=t[kv]=new Set);var n=e+"__bubble";r.has(n)||(ok(t,e,2,!1),r.add(n))}function tm(e,t,r){var n=0;t&&(n|=4),ok(r,e,n,t)}var nd="_reactListening"+Math.random().toString(36).slice(2);function Su(e){if(!e[nd]){e[nd]=!0,pE.forEach(function(r){r!=="selectionchange"&&(u3.has(r)||tm(r,!1,e),tm(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[nd]||(t[nd]=!0,tm("selectionchange",!1,t))}}function ok(e,t,r,n){switch(HE(t)){case 1:var a=Ej;break;case 4:a=kj;break;default:a=fx}r=a.bind(null,t,r,e),a=void 0,!pv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function rm(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ji(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}OE(function(){var c=s,f=ox(r),d=[];e:{var h=sk.get(e);if(h!==void 0){var m=hx,v=e;switch(e){case"keypress":if(Wd(r)===0)break e;case"keydown":case"keyup":m=Uj;break;case"focusin":v="focus",m=qp;break;case"focusout":v="blur",m=qp;break;case"beforeblur":case"afterblur":m=qp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=g_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Nj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Vj;break;case tk:case rk:case nk:m=Dj;break;case ak:m=zj;break;case"scroll":m=Tj;break;case"wheel":m=Gj;break;case"copy":case"cut":case"paste":m=Pj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=y_}var p=(t&4)!==0,_=!p&&e==="scroll",g=p?h!==null?h+"Capture":null:h;p=[];for(var y=c,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,g!==null&&(w=gu(y,g),w!=null&&p.push(Eu(y,w,x)))),_)break;y=y.return}0<p.length&&(h=new m(h,v,null,r,f),d.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==dv&&(v=r.relatedTarget||r.fromElement)&&(ji(v)||v[ls]))break e;if((m||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=c,v=v?ji(v):null,v!==null&&(_=ho(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=c),m!==v)){if(p=g_,w="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=y_,w="onPointerLeave",g="onPointerEnter",y="pointer"),_=m==null?h:Vo(m),x=v==null?h:Vo(v),h=new p(w,y+"leave",m,r,f),h.target=_,h.relatedTarget=x,w=null,ji(f)===c&&(p=new p(g,y+"enter",v,r,f),p.target=x,p.relatedTarget=_,w=p),_=w,m&&v)t:{for(p=m,g=v,y=0,x=p;x;x=Co(x))y++;for(x=0,w=g;w;w=Co(w))x++;for(;0<y-x;)p=Co(p),y--;for(;0<x-y;)g=Co(g),x--;for(;y--;){if(p===g||g!==null&&p===g.alternate)break t;p=Co(p),g=Co(g)}p=null}else p=null;m!==null&&O_(d,h,m,p,!1),v!==null&&_!==null&&O_(d,_,v,p,!0)}}e:{if(h=c?Vo(c):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var E=e3;else if(b_(h))if(XE)E=a3;else{E=r3;var S=t3}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=n3);if(E&&(E=E(e,c))){qE(d,E,r,f);break e}S&&S(e,h,c),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&ov(h,"number",h.value)}switch(S=c?Vo(c):window,e){case"focusin":(b_(S)||S.contentEditable==="true")&&(Bo=S,yv=c,zc=null);break;case"focusout":zc=yv=Bo=null;break;case"mousedown":_v=!0;break;case"contextmenu":case"mouseup":case"dragend":_v=!1,C_(d,r,f);break;case"selectionchange":if(o3)break;case"keydown":case"keyup":C_(d,r,f)}var b;if(mx)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Uo?GE(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(YE&&r.locale!=="ko"&&(Uo||T!=="onCompositionStart"?T==="onCompositionEnd"&&Uo&&(b=zE()):(Ls=f,dx="value"in Ls?Ls.value:Ls.textContent,Uo=!0)),S=p0(c,T),0<S.length&&(T=new x_(T,e,null,r,f),d.push({event:T,listeners:S}),b?T.data=b:(b=KE(r),b!==null&&(T.data=b)))),(b=qj?Xj(e,r):Jj(e,r))&&(c=p0(c,"onBeforeInput"),0<c.length&&(f=new x_("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=b))}ik(d,t)})}function Eu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function p0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=gu(e,r),s!=null&&n.unshift(Eu(e,s,a)),s=gu(e,t),s!=null&&n.push(Eu(e,s,a))),e=e.return}return n}function Co(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function O_(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=gu(r,s),l!=null&&i.unshift(Eu(r,l,o))):a||(l=gu(r,s),l!=null&&i.push(Eu(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var f3=/\r\n?/g,d3=/\u0000|\uFFFD/g;function D_(e){return(typeof e=="string"?e:""+e).replace(f3,`
`).replace(d3,"")}function ad(e,t,r){if(t=D_(t),D_(e)!==t&&r)throw Error(de(425))}function m0(){}var wv=null,bv=null;function Sv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ev=typeof setTimeout=="function"?setTimeout:void 0,h3=typeof clearTimeout=="function"?clearTimeout:void 0,j_=typeof Promise=="function"?Promise:void 0,p3=typeof queueMicrotask=="function"?queueMicrotask:typeof j_<"u"?function(e){return j_.resolve(null).then(e).catch(m3)}:Ev;function m3(e){setTimeout(function(){throw e})}function nm(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),_u(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);_u(t)}function qs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function P_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ml=Math.random().toString(36).slice(2),xa="__reactFiber$"+Ml,ku="__reactProps$"+Ml,ls="__reactContainer$"+Ml,kv="__reactEvents$"+Ml,v3="__reactListeners$"+Ml,g3="__reactHandles$"+Ml;function ji(e){var t=e[xa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ls]||r[xa]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=P_(e);e!==null;){if(r=e[xa])return r;e=P_(e)}return t}e=r,r=e.parentNode}return null}function pf(e){return e=e[xa]||e[ls],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(de(33))}function kh(e){return e[ku]||null}var Tv=[],Ho=-1;function di(e){return{current:e}}function ut(e){0>Ho||(e.current=Tv[Ho],Tv[Ho]=null,Ho--)}function at(e,t){Ho++,Tv[Ho]=e.current,e.current=t}var ai={},wr=di(ai),Hr=di(!1),zi=ai;function vl(e,t){var r=e.type.contextTypes;if(!r)return ai;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function zr(e){return e=e.childContextTypes,e!=null}function v0(){ut(Hr),ut(wr)}function F_(e,t,r){if(wr.current!==ai)throw Error(de(168));at(wr,t),at(Hr,r)}function lk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(de(108,tj(e)||"Unknown",a));return St({},r,n)}function g0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ai,zi=wr.current,at(wr,e),at(Hr,Hr.current),!0}function R_(e,t,r){var n=e.stateNode;if(!n)throw Error(de(169));r?(e=lk(e,t,zi),n.__reactInternalMemoizedMergedChildContext=e,ut(Hr),ut(wr),at(wr,e)):ut(Hr),at(Hr,r)}var Ya=null,Th=!1,am=!1;function ck(e){Ya===null?Ya=[e]:Ya.push(e)}function x3(e){Th=!0,ck(e)}function hi(){if(!am&&Ya!==null){am=!0;var e=0,t=Je;try{var r=Ya;for(Je=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ya=null,Th=!1}catch(a){throw Ya!==null&&(Ya=Ya.slice(e+1)),FE(lx,hi),a}finally{Je=t,am=!1}}return null}var zo=[],Yo=0,x0=null,y0=0,yn=[],_n=0,Yi=null,qa=1,Xa="";function ki(e,t){zo[Yo++]=y0,zo[Yo++]=x0,x0=e,y0=t}function uk(e,t,r){yn[_n++]=qa,yn[_n++]=Xa,yn[_n++]=Yi,Yi=e;var n=qa;e=Xa;var a=32-Zn(n)-1;n&=~(1<<a),r+=1;var s=32-Zn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,qa=1<<32-Zn(t)+a|r<<a|n,Xa=s+e}else qa=1<<s|r<<a|n,Xa=e}function gx(e){e.return!==null&&(ki(e,1),uk(e,1,0))}function xx(e){for(;e===x0;)x0=zo[--Yo],zo[Yo]=null,y0=zo[--Yo],zo[Yo]=null;for(;e===Yi;)Yi=yn[--_n],yn[_n]=null,Xa=yn[--_n],yn[_n]=null,qa=yn[--_n],yn[_n]=null}var sn=null,an=null,vt=!1,Kn=null;function fk(e,t){var r=kn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function M_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,an=qs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,an=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Yi!==null?{id:qa,overflow:Xa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=kn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,sn=e,an=null,!0):!1;default:return!1}}function Cv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Nv(e){if(vt){var t=an;if(t){var r=t;if(!M_(e,t)){if(Cv(e))throw Error(de(418));t=qs(r.nextSibling);var n=sn;t&&M_(e,t)?fk(n,r):(e.flags=e.flags&-4097|2,vt=!1,sn=e)}}else{if(Cv(e))throw Error(de(418));e.flags=e.flags&-4097|2,vt=!1,sn=e}}}function I_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function sd(e){if(e!==sn)return!1;if(!vt)return I_(e),vt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Sv(e.type,e.memoizedProps)),t&&(t=an)){if(Cv(e))throw dk(),Error(de(418));for(;t;)fk(e,t),t=qs(t.nextSibling)}if(I_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(de(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){an=qs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}an=null}}else an=sn?qs(e.stateNode.nextSibling):null;return!0}function dk(){for(var e=an;e;)e=qs(e.nextSibling)}function gl(){an=sn=null,vt=!1}function yx(e){Kn===null?Kn=[e]:Kn.push(e)}var y3=gs.ReactCurrentBatchConfig;function xc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(de(309));var n=r.stateNode}if(!n)throw Error(de(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(de(284));if(!r._owner)throw Error(de(290,e))}return e}function id(e,t){throw e=Object.prototype.toString.call(t),Error(de(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function L_(e){var t=e._init;return t(e._payload)}function hk(e){function t(g,y){if(e){var x=g.deletions;x===null?(g.deletions=[y],g.flags|=16):x.push(y)}}function r(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function a(g,y){return g=Zs(g,y),g.index=0,g.sibling=null,g}function s(g,y,x){return g.index=x,e?(x=g.alternate,x!==null?(x=x.index,x<y?(g.flags|=2,y):x):(g.flags|=2,y)):(g.flags|=1048576,y)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,y,x,w){return y===null||y.tag!==6?(y=fm(x,g.mode,w),y.return=g,y):(y=a(y,x),y.return=g,y)}function l(g,y,x,w){var E=x.type;return E===$o?f(g,y,x.props.children,w,x.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Os&&L_(E)===y.type)?(w=a(y,x.props),w.ref=xc(g,y,x),w.return=g,w):(w=qd(x.type,x.key,x.props,null,g.mode,w),w.ref=xc(g,y,x),w.return=g,w)}function c(g,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=dm(x,g.mode,w),y.return=g,y):(y=a(y,x.children||[]),y.return=g,y)}function f(g,y,x,w,E){return y===null||y.tag!==7?(y=Li(x,g.mode,w,E),y.return=g,y):(y=a(y,x),y.return=g,y)}function d(g,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=fm(""+y,g.mode,x),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case qf:return x=qd(y.type,y.key,y.props,null,g.mode,x),x.ref=xc(g,null,y),x.return=g,x;case Lo:return y=dm(y,g.mode,x),y.return=g,y;case Os:var w=y._init;return d(g,w(y._payload),x)}if(jc(y)||hc(y))return y=Li(y,g.mode,x,null),y.return=g,y;id(g,y)}return null}function h(g,y,x,w){var E=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return E!==null?null:o(g,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case qf:return x.key===E?l(g,y,x,w):null;case Lo:return x.key===E?c(g,y,x,w):null;case Os:return E=x._init,h(g,y,E(x._payload),w)}if(jc(x)||hc(x))return E!==null?null:f(g,y,x,w,null);id(g,x)}return null}function m(g,y,x,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(x)||null,o(y,g,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qf:return g=g.get(w.key===null?x:w.key)||null,l(y,g,w,E);case Lo:return g=g.get(w.key===null?x:w.key)||null,c(y,g,w,E);case Os:var S=w._init;return m(g,y,x,S(w._payload),E)}if(jc(w)||hc(w))return g=g.get(x)||null,f(y,g,w,E,null);id(y,w)}return null}function v(g,y,x,w){for(var E=null,S=null,b=y,T=y=0,C=null;b!==null&&T<x.length;T++){b.index>T?(C=b,b=null):C=b.sibling;var F=h(g,b,x[T],w);if(F===null){b===null&&(b=C);break}e&&b&&F.alternate===null&&t(g,b),y=s(F,y,T),S===null?E=F:S.sibling=F,S=F,b=C}if(T===x.length)return r(g,b),vt&&ki(g,T),E;if(b===null){for(;T<x.length;T++)b=d(g,x[T],w),b!==null&&(y=s(b,y,T),S===null?E=b:S.sibling=b,S=b);return vt&&ki(g,T),E}for(b=n(g,b);T<x.length;T++)C=m(b,g,T,x[T],w),C!==null&&(e&&C.alternate!==null&&b.delete(C.key===null?T:C.key),y=s(C,y,T),S===null?E=C:S.sibling=C,S=C);return e&&b.forEach(function(M){return t(g,M)}),vt&&ki(g,T),E}function p(g,y,x,w){var E=hc(x);if(typeof E!="function")throw Error(de(150));if(x=E.call(x),x==null)throw Error(de(151));for(var S=E=null,b=y,T=y=0,C=null,F=x.next();b!==null&&!F.done;T++,F=x.next()){b.index>T?(C=b,b=null):C=b.sibling;var M=h(g,b,F.value,w);if(M===null){b===null&&(b=C);break}e&&b&&M.alternate===null&&t(g,b),y=s(M,y,T),S===null?E=M:S.sibling=M,S=M,b=C}if(F.done)return r(g,b),vt&&ki(g,T),E;if(b===null){for(;!F.done;T++,F=x.next())F=d(g,F.value,w),F!==null&&(y=s(F,y,T),S===null?E=F:S.sibling=F,S=F);return vt&&ki(g,T),E}for(b=n(g,b);!F.done;T++,F=x.next())F=m(b,g,T,F.value,w),F!==null&&(e&&F.alternate!==null&&b.delete(F.key===null?T:F.key),y=s(F,y,T),S===null?E=F:S.sibling=F,S=F);return e&&b.forEach(function(j){return t(g,j)}),vt&&ki(g,T),E}function _(g,y,x,w){if(typeof x=="object"&&x!==null&&x.type===$o&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case qf:e:{for(var E=x.key,S=y;S!==null;){if(S.key===E){if(E=x.type,E===$o){if(S.tag===7){r(g,S.sibling),y=a(S,x.props.children),y.return=g,g=y;break e}}else if(S.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Os&&L_(E)===S.type){r(g,S.sibling),y=a(S,x.props),y.ref=xc(g,S,x),y.return=g,g=y;break e}r(g,S);break}else t(g,S);S=S.sibling}x.type===$o?(y=Li(x.props.children,g.mode,w,x.key),y.return=g,g=y):(w=qd(x.type,x.key,x.props,null,g.mode,w),w.ref=xc(g,y,x),w.return=g,g=w)}return i(g);case Lo:e:{for(S=x.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(g,y.sibling),y=a(y,x.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else t(g,y);y=y.sibling}y=dm(x,g.mode,w),y.return=g,g=y}return i(g);case Os:return S=x._init,_(g,y,S(x._payload),w)}if(jc(x))return v(g,y,x,w);if(hc(x))return p(g,y,x,w);id(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(g,y.sibling),y=a(y,x),y.return=g,g=y):(r(g,y),y=fm(x,g.mode,w),y.return=g,g=y),i(g)):r(g,y)}return _}var xl=hk(!0),pk=hk(!1),_0=di(null),w0=null,Go=null,_x=null;function wx(){_x=Go=w0=null}function bx(e){var t=_0.current;ut(_0),e._currentValue=t}function Av(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function sl(e,t){w0=e,_x=Go=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vr=!0),e.firstContext=null)}function An(e){var t=e._currentValue;if(_x!==e)if(e={context:e,memoizedValue:t,next:null},Go===null){if(w0===null)throw Error(de(308));Go=e,w0.dependencies={lanes:0,firstContext:e}}else Go=Go.next=e;return t}var Pi=null;function Sx(e){Pi===null?Pi=[e]:Pi.push(e)}function mk(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Sx(t)):(r.next=a.next,a.next=r),t.interleaved=r,cs(e,n)}function cs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ds=!1;function Ex(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function es(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Xs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,He&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,cs(e,r)}return a=n.interleaved,a===null?(t.next=t,Sx(n)):(t.next=a.next,a.next=t),n.interleaved=t,cs(e,r)}function Vd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,cx(e,r)}}function $_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function b0(e,t,r,n){var a=e.updateQueue;Ds=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=c=l=null,o=s;do{var h=o.lane,m=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,p=o;switch(h=t,m=r,p.tag){case 1:if(v=p.payload,typeof v=="function"){d=v.call(m,d,h);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=p.payload,h=typeof v=="function"?v.call(m,d,h):v,h==null)break e;d=St({},d,h);break e;case 2:Ds=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=m,l=d):f=f.next=m,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Ki|=i,e.lanes=i,e.memoizedState=d}}function U_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(de(191,a));a.call(n)}}}var mf={},Ea=di(mf),Tu=di(mf),Cu=di(mf);function Fi(e){if(e===mf)throw Error(de(174));return e}function kx(e,t){switch(at(Cu,t),at(Tu,e),at(Ea,mf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cv(t,e)}ut(Ea),at(Ea,t)}function yl(){ut(Ea),ut(Tu),ut(Cu)}function gk(e){Fi(Cu.current);var t=Fi(Ea.current),r=cv(t,e.type);t!==r&&(at(Tu,e),at(Ea,r))}function Tx(e){Tu.current===e&&(ut(Ea),ut(Tu))}var _t=di(0);function S0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var sm=[];function Cx(){for(var e=0;e<sm.length;e++)sm[e]._workInProgressVersionPrimary=null;sm.length=0}var Hd=gs.ReactCurrentDispatcher,im=gs.ReactCurrentBatchConfig,Gi=0,bt=null,Bt=null,Jt=null,E0=!1,Yc=!1,Nu=0,_3=0;function fr(){throw Error(de(321))}function Nx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!aa(e[r],t[r]))return!1;return!0}function Ax(e,t,r,n,a,s){if(Gi=s,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Hd.current=e===null||e.memoizedState===null?E3:k3,e=r(n,a),Yc){s=0;do{if(Yc=!1,Nu=0,25<=s)throw Error(de(301));s+=1,Jt=Bt=null,t.updateQueue=null,Hd.current=T3,e=r(n,a)}while(Yc)}if(Hd.current=k0,t=Bt!==null&&Bt.next!==null,Gi=0,Jt=Bt=bt=null,E0=!1,t)throw Error(de(300));return e}function Ox(){var e=Nu!==0;return Nu=0,e}function ga(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e,Jt}function On(){if(Bt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Bt.next;var t=Jt===null?bt.memoizedState:Jt.next;if(t!==null)Jt=t,Bt=e;else{if(e===null)throw Error(de(310));Bt=e,e={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e}return Jt}function Au(e,t){return typeof t=="function"?t(e):t}function om(e){var t=On(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=Bt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var f=c.lane;if((Gi&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,bt.lanes|=f,Ki|=f}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,aa(n,t.memoizedState)||(Vr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,bt.lanes|=s,Ki|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function lm(e){var t=On(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);aa(s,t.memoizedState)||(Vr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function xk(){}function yk(e,t){var r=bt,n=On(),a=t(),s=!aa(n.memoizedState,a);if(s&&(n.memoizedState=a,Vr=!0),n=n.queue,Dx(bk.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Jt!==null&&Jt.memoizedState.tag&1){if(r.flags|=2048,Ou(9,wk.bind(null,r,n,a,t),void 0,null),Qt===null)throw Error(de(349));Gi&30||_k(r,t,a)}return a}function _k(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function wk(e,t,r,n){t.value=r,t.getSnapshot=n,Sk(t)&&Ek(e)}function bk(e,t,r){return r(function(){Sk(t)&&Ek(e)})}function Sk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!aa(e,r)}catch{return!0}}function Ek(e){var t=cs(e,1);t!==null&&ea(t,e,1,-1)}function B_(e){var t=ga();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Au,lastRenderedState:e},t.queue=e,e=e.dispatch=S3.bind(null,bt,e),[t.memoizedState,e]}function Ou(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function kk(){return On().memoizedState}function zd(e,t,r,n){var a=ga();bt.flags|=e,a.memoizedState=Ou(1|t,r,void 0,n===void 0?null:n)}function Ch(e,t,r,n){var a=On();n=n===void 0?null:n;var s=void 0;if(Bt!==null){var i=Bt.memoizedState;if(s=i.destroy,n!==null&&Nx(n,i.deps)){a.memoizedState=Ou(t,r,s,n);return}}bt.flags|=e,a.memoizedState=Ou(1|t,r,s,n)}function W_(e,t){return zd(8390656,8,e,t)}function Dx(e,t){return Ch(2048,8,e,t)}function Tk(e,t){return Ch(4,2,e,t)}function Ck(e,t){return Ch(4,4,e,t)}function Nk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ak(e,t,r){return r=r!=null?r.concat([e]):null,Ch(4,4,Nk.bind(null,t,e),r)}function jx(){}function Ok(e,t){var r=On();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Dk(e,t){var r=On();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function jk(e,t,r){return Gi&21?(aa(r,t)||(r=IE(),bt.lanes|=r,Ki|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vr=!0),e.memoizedState=r)}function w3(e,t){var r=Je;Je=r!==0&&4>r?r:4,e(!0);var n=im.transition;im.transition={};try{e(!1),t()}finally{Je=r,im.transition=n}}function Pk(){return On().memoizedState}function b3(e,t,r){var n=Qs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Fk(e))Rk(t,r);else if(r=mk(e,t,r,n),r!==null){var a=jr();ea(r,e,n,a),Mk(r,t,n)}}function S3(e,t,r){var n=Qs(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Fk(e))Rk(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,aa(o,i)){var l=t.interleaved;l===null?(a.next=a,Sx(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=mk(e,t,a,n),r!==null&&(a=jr(),ea(r,e,n,a),Mk(r,t,n))}}function Fk(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function Rk(e,t){Yc=E0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Mk(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,cx(e,r)}}var k0={readContext:An,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useInsertionEffect:fr,useLayoutEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useMutableSource:fr,useSyncExternalStore:fr,useId:fr,unstable_isNewReconciler:!1},E3={readContext:An,useCallback:function(e,t){return ga().memoizedState=[e,t===void 0?null:t],e},useContext:An,useEffect:W_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,zd(4194308,4,Nk.bind(null,t,e),r)},useLayoutEffect:function(e,t){return zd(4194308,4,e,t)},useInsertionEffect:function(e,t){return zd(4,2,e,t)},useMemo:function(e,t){var r=ga();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ga();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=b3.bind(null,bt,e),[n.memoizedState,e]},useRef:function(e){var t=ga();return e={current:e},t.memoizedState=e},useState:B_,useDebugValue:jx,useDeferredValue:function(e){return ga().memoizedState=e},useTransition:function(){var e=B_(!1),t=e[0];return e=w3.bind(null,e[1]),ga().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=bt,a=ga();if(vt){if(r===void 0)throw Error(de(407));r=r()}else{if(r=t(),Qt===null)throw Error(de(349));Gi&30||_k(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,W_(bk.bind(null,n,s,e),[e]),n.flags|=2048,Ou(9,wk.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ga(),t=Qt.identifierPrefix;if(vt){var r=Xa,n=qa;r=(n&~(1<<32-Zn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Nu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=_3++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},k3={readContext:An,useCallback:Ok,useContext:An,useEffect:Dx,useImperativeHandle:Ak,useInsertionEffect:Tk,useLayoutEffect:Ck,useMemo:Dk,useReducer:om,useRef:kk,useState:function(){return om(Au)},useDebugValue:jx,useDeferredValue:function(e){var t=On();return jk(t,Bt.memoizedState,e)},useTransition:function(){var e=om(Au)[0],t=On().memoizedState;return[e,t]},useMutableSource:xk,useSyncExternalStore:yk,useId:Pk,unstable_isNewReconciler:!1},T3={readContext:An,useCallback:Ok,useContext:An,useEffect:Dx,useImperativeHandle:Ak,useInsertionEffect:Tk,useLayoutEffect:Ck,useMemo:Dk,useReducer:lm,useRef:kk,useState:function(){return lm(Au)},useDebugValue:jx,useDeferredValue:function(e){var t=On();return Bt===null?t.memoizedState=e:jk(t,Bt.memoizedState,e)},useTransition:function(){var e=lm(Au)[0],t=On().memoizedState;return[e,t]},useMutableSource:xk,useSyncExternalStore:yk,useId:Pk,unstable_isNewReconciler:!1};function zn(e,t){if(e&&e.defaultProps){t=St({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ov(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:St({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Nh={isMounted:function(e){return(e=e._reactInternals)?ho(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=jr(),a=Qs(e),s=es(n,a);s.payload=t,r!=null&&(s.callback=r),t=Xs(e,s,a),t!==null&&(ea(t,e,a,n),Vd(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=jr(),a=Qs(e),s=es(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Xs(e,s,a),t!==null&&(ea(t,e,a,n),Vd(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=jr(),n=Qs(e),a=es(r,n);a.tag=2,t!=null&&(a.callback=t),t=Xs(e,a,n),t!==null&&(ea(t,e,n,r),Vd(t,e,n))}};function V_(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!bu(r,n)||!bu(a,s):!0}function Ik(e,t,r){var n=!1,a=ai,s=t.contextType;return typeof s=="object"&&s!==null?s=An(s):(a=zr(t)?zi:wr.current,n=t.contextTypes,s=(n=n!=null)?vl(e,a):ai),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Nh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function H_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Nh.enqueueReplaceState(t,t.state,null)}function Dv(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Ex(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=An(s):(s=zr(t)?zi:wr.current,a.context=vl(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Ov(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Nh.enqueueReplaceState(a,a.state,null),b0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function _l(e,t){try{var r="",n=t;do r+=ej(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function cm(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function jv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var C3=typeof WeakMap=="function"?WeakMap:Map;function Lk(e,t,r){r=es(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){C0||(C0=!0,Wv=n),jv(e,t)},r}function $k(e,t,r){r=es(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){jv(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){jv(e,t),typeof n!="function"&&(Js===null?Js=new Set([this]):Js.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function z_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new C3;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=B3.bind(null,e,t,r),t.then(e,e))}function Y_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function G_(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=es(-1,1),t.tag=2,Xs(r,t,1))),r.lanes|=1),e)}var N3=gs.ReactCurrentOwner,Vr=!1;function Nr(e,t,r,n){t.child=e===null?pk(t,null,r,n):xl(t,e.child,r,n)}function K_(e,t,r,n,a){r=r.render;var s=t.ref;return sl(t,a),n=Ax(e,t,r,n,s,a),r=Ox(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,us(e,t,a)):(vt&&r&&gx(t),t.flags|=1,Nr(e,t,n,a),t.child)}function q_(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Ux(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Uk(e,t,s,n,a)):(e=qd(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:bu,r(i,n)&&e.ref===t.ref)return us(e,t,a)}return t.flags|=1,e=Zs(s,n),e.ref=t.ref,e.return=t,t.child=e}function Uk(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(bu(s,n)&&e.ref===t.ref)if(Vr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Vr=!0);else return t.lanes=e.lanes,us(e,t,a)}return Pv(e,t,r,n,a)}function Bk(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(qo,Zr),Zr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,at(qo,Zr),Zr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,at(qo,Zr),Zr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,at(qo,Zr),Zr|=n;return Nr(e,t,a,r),t.child}function Wk(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Pv(e,t,r,n,a){var s=zr(r)?zi:wr.current;return s=vl(t,s),sl(t,a),r=Ax(e,t,r,n,s,a),n=Ox(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,us(e,t,a)):(vt&&n&&gx(t),t.flags|=1,Nr(e,t,r,a),t.child)}function X_(e,t,r,n,a){if(zr(r)){var s=!0;g0(t)}else s=!1;if(sl(t,a),t.stateNode===null)Yd(e,t),Ik(t,r,n),Dv(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=An(c):(c=zr(r)?zi:wr.current,c=vl(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&H_(t,i,n,c),Ds=!1;var h=t.memoizedState;i.state=h,b0(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Hr.current||Ds?(typeof f=="function"&&(Ov(t,r,f,n),l=t.memoizedState),(o=Ds||V_(t,r,o,n,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,vk(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:zn(t.type,o),i.props=c,d=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=An(l):(l=zr(r)?zi:wr.current,l=vl(t,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&H_(t,i,n,l),Ds=!1,h=t.memoizedState,i.state=h,b0(t,n,i,a);var v=t.memoizedState;o!==d||h!==v||Hr.current||Ds?(typeof m=="function"&&(Ov(t,r,m,n),v=t.memoizedState),(c=Ds||V_(t,r,c,n,h,v,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Fv(e,t,r,n,s,a)}function Fv(e,t,r,n,a,s){Wk(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&R_(t,r,!1),us(e,t,s);n=t.stateNode,N3.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=xl(t,e.child,null,s),t.child=xl(t,null,o,s)):Nr(e,t,o,s),t.memoizedState=n.state,a&&R_(t,r,!0),t.child}function Vk(e){var t=e.stateNode;t.pendingContext?F_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&F_(e,t.context,!1),kx(e,t.containerInfo)}function J_(e,t,r,n,a){return gl(),yx(a),t.flags|=256,Nr(e,t,r,n),t.child}var Rv={dehydrated:null,treeContext:null,retryLane:0};function Mv(e){return{baseLanes:e,cachePool:null,transitions:null}}function Hk(e,t,r){var n=t.pendingProps,a=_t.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),at(_t,a&1),e===null)return Nv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Dh(i,n,0,null),e=Li(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Mv(r),t.memoizedState=Rv,e):Px(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return A3(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Zs(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Zs(o,s):(s=Li(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?Mv(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Rv,n}return s=e.child,e=s.sibling,n=Zs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Px(e,t){return t=Dh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function od(e,t,r,n){return n!==null&&yx(n),xl(t,e.child,null,r),e=Px(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function A3(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=cm(Error(de(422))),od(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Dh({mode:"visible",children:n.children},a,0,null),s=Li(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&xl(t,e.child,null,i),t.child.memoizedState=Mv(i),t.memoizedState=Rv,s);if(!(t.mode&1))return od(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(de(419)),n=cm(s,n,void 0),od(e,t,i,n)}if(o=(i&e.childLanes)!==0,Vr||o){if(n=Qt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,cs(e,a),ea(n,e,a,-1))}return $x(),n=cm(Error(de(421))),od(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=W3.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,an=qs(a.nextSibling),sn=t,vt=!0,Kn=null,e!==null&&(yn[_n++]=qa,yn[_n++]=Xa,yn[_n++]=Yi,qa=e.id,Xa=e.overflow,Yi=t),t=Px(t,n.children),t.flags|=4096,t)}function Q_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Av(e.return,t,r)}function um(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function zk(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Nr(e,t,n.children,r),n=_t.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Q_(e,r,t);else if(e.tag===19)Q_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(at(_t,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&S0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),um(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&S0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}um(t,!0,r,null,s);break;case"together":um(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function us(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ki|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(de(153));if(t.child!==null){for(e=t.child,r=Zs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Zs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function O3(e,t,r){switch(t.tag){case 3:Vk(t),gl();break;case 5:gk(t);break;case 1:zr(t.type)&&g0(t);break;case 4:kx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;at(_0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(at(_t,_t.current&1),t.flags|=128,null):r&t.child.childLanes?Hk(e,t,r):(at(_t,_t.current&1),e=us(e,t,r),e!==null?e.sibling:null);at(_t,_t.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return zk(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),at(_t,_t.current),n)break;return null;case 22:case 23:return t.lanes=0,Bk(e,t,r)}return us(e,t,r)}var Yk,Iv,Gk,Kk;Yk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Iv=function(){};Gk=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Fi(Ea.current);var s=null;switch(r){case"input":a=sv(e,a),n=sv(e,n),s=[];break;case"select":a=St({},a,{value:void 0}),n=St({},n,{value:void 0}),s=[];break;case"textarea":a=lv(e,a),n=lv(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=m0)}uv(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(mu.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(mu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ot("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Kk=function(e,t,r,n){r!==n&&(t.flags|=4)};function yc(e,t){if(!vt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function D3(e,t,r){var n=t.pendingProps;switch(xx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(t),null;case 1:return zr(t.type)&&v0(),dr(t),null;case 3:return n=t.stateNode,yl(),ut(Hr),ut(wr),Cx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(sd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Kn!==null&&(zv(Kn),Kn=null))),Iv(e,t),dr(t),null;case 5:Tx(t);var a=Fi(Cu.current);if(r=t.type,e!==null&&t.stateNode!=null)Gk(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(de(166));return dr(t),null}if(e=Fi(Ea.current),sd(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[xa]=t,n[ku]=s,e=(t.mode&1)!==0,r){case"dialog":ot("cancel",n),ot("close",n);break;case"iframe":case"object":case"embed":ot("load",n);break;case"video":case"audio":for(a=0;a<Fc.length;a++)ot(Fc[a],n);break;case"source":ot("error",n);break;case"img":case"image":case"link":ot("error",n),ot("load",n);break;case"details":ot("toggle",n);break;case"input":o_(n,s),ot("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ot("invalid",n);break;case"textarea":c_(n,s),ot("invalid",n)}uv(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&ad(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&ad(n.textContent,o,e),a=["children",""+o]):mu.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ot("scroll",n)}switch(r){case"input":Xf(n),l_(n,s,!0);break;case"textarea":Xf(n),u_(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=m0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=bE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[xa]=t,e[ku]=n,Yk(e,t,!1,!1),t.stateNode=e;e:{switch(i=fv(r,n),r){case"dialog":ot("cancel",e),ot("close",e),a=n;break;case"iframe":case"object":case"embed":ot("load",e),a=n;break;case"video":case"audio":for(a=0;a<Fc.length;a++)ot(Fc[a],e);a=n;break;case"source":ot("error",e),a=n;break;case"img":case"image":case"link":ot("error",e),ot("load",e),a=n;break;case"details":ot("toggle",e),a=n;break;case"input":o_(e,n),a=sv(e,n),ot("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=St({},n,{value:void 0}),ot("invalid",e);break;case"textarea":c_(e,n),a=lv(e,n),ot("invalid",e);break;default:a=n}uv(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?kE(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&SE(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&vu(e,l):typeof l=="number"&&vu(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ot("scroll",e):l!=null&&nx(e,s,l,i))}switch(r){case"input":Xf(e),l_(e,n,!1);break;case"textarea":Xf(e),u_(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ni(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?tl(e,!!n.multiple,s,!1):n.defaultValue!=null&&tl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=m0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dr(t),null;case 6:if(e&&t.stateNode!=null)Kk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(de(166));if(r=Fi(Cu.current),Fi(Ea.current),sd(t)){if(n=t.stateNode,r=t.memoizedProps,n[xa]=t,(s=n.nodeValue!==r)&&(e=sn,e!==null))switch(e.tag){case 3:ad(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ad(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[xa]=t,t.stateNode=n}return dr(t),null;case 13:if(ut(_t),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(vt&&an!==null&&t.mode&1&&!(t.flags&128))dk(),gl(),t.flags|=98560,s=!1;else if(s=sd(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(de(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(de(317));s[xa]=t}else gl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dr(t),s=!1}else Kn!==null&&(zv(Kn),Kn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?Wt===0&&(Wt=3):$x())),t.updateQueue!==null&&(t.flags|=4),dr(t),null);case 4:return yl(),Iv(e,t),e===null&&Su(t.stateNode.containerInfo),dr(t),null;case 10:return bx(t.type._context),dr(t),null;case 17:return zr(t.type)&&v0(),dr(t),null;case 19:if(ut(_t),s=t.memoizedState,s===null)return dr(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)yc(s,!1);else{if(Wt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=S0(e),i!==null){for(t.flags|=128,yc(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return at(_t,_t.current&1|2),t.child}e=e.sibling}s.tail!==null&&jt()>wl&&(t.flags|=128,n=!0,yc(s,!1),t.lanes=4194304)}else{if(!n)if(e=S0(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),yc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!vt)return dr(t),null}else 2*jt()-s.renderingStartTime>wl&&r!==1073741824&&(t.flags|=128,n=!0,yc(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=jt(),t.sibling=null,r=_t.current,at(_t,n?r&1|2:r&1),t):(dr(t),null);case 22:case 23:return Lx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Zr&1073741824&&(dr(t),t.subtreeFlags&6&&(t.flags|=8192)):dr(t),null;case 24:return null;case 25:return null}throw Error(de(156,t.tag))}function j3(e,t){switch(xx(t),t.tag){case 1:return zr(t.type)&&v0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return yl(),ut(Hr),ut(wr),Cx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Tx(t),null;case 13:if(ut(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(de(340));gl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(_t),null;case 4:return yl(),null;case 10:return bx(t.type._context),null;case 22:case 23:return Lx(),null;case 24:return null;default:return null}}var ld=!1,vr=!1,P3=typeof WeakSet=="function"?WeakSet:Set,be=null;function Ko(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Et(e,t,n)}else r.current=null}function Lv(e,t,r){try{r()}catch(n){Et(e,t,n)}}var Z_=!1;function F3(e,t){if(wv=d0,e=ZE(),vx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,d=e,h=null;t:for(;;){for(var m;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(m=d.firstChild)!==null;)h=d,d=m;for(;;){if(d===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++f===n&&(l=i),(m=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(bv={focusedElem:e,selectionRange:r},d0=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var p=v.memoizedProps,_=v.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?p:zn(t.type,p),_);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(w){Et(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return v=Z_,Z_=!1,v}function Gc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Lv(t,r,s)}a=a.next}while(a!==n)}}function Ah(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function $v(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function qk(e){var t=e.alternate;t!==null&&(e.alternate=null,qk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[xa],delete t[ku],delete t[kv],delete t[v3],delete t[g3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Xk(e){return e.tag===5||e.tag===3||e.tag===4}function ew(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Xk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Uv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=m0));else if(n!==4&&(e=e.child,e!==null))for(Uv(e,t,r),e=e.sibling;e!==null;)Uv(e,t,r),e=e.sibling}function Bv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Bv(e,t,r),e=e.sibling;e!==null;)Bv(e,t,r),e=e.sibling}var tr=null,Yn=!1;function ks(e,t,r){for(r=r.child;r!==null;)Jk(e,t,r),r=r.sibling}function Jk(e,t,r){if(Sa&&typeof Sa.onCommitFiberUnmount=="function")try{Sa.onCommitFiberUnmount(wh,r)}catch{}switch(r.tag){case 5:vr||Ko(r,t);case 6:var n=tr,a=Yn;tr=null,ks(e,t,r),tr=n,Yn=a,tr!==null&&(Yn?(e=tr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):tr.removeChild(r.stateNode));break;case 18:tr!==null&&(Yn?(e=tr,r=r.stateNode,e.nodeType===8?nm(e.parentNode,r):e.nodeType===1&&nm(e,r),_u(e)):nm(tr,r.stateNode));break;case 4:n=tr,a=Yn,tr=r.stateNode.containerInfo,Yn=!0,ks(e,t,r),tr=n,Yn=a;break;case 0:case 11:case 14:case 15:if(!vr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Lv(r,t,i),a=a.next}while(a!==n)}ks(e,t,r);break;case 1:if(!vr&&(Ko(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Et(r,t,o)}ks(e,t,r);break;case 21:ks(e,t,r);break;case 22:r.mode&1?(vr=(n=vr)||r.memoizedState!==null,ks(e,t,r),vr=n):ks(e,t,r);break;default:ks(e,t,r)}}function tw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new P3),t.forEach(function(n){var a=V3.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Wn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:tr=o.stateNode,Yn=!1;break e;case 3:tr=o.stateNode.containerInfo,Yn=!0;break e;case 4:tr=o.stateNode.containerInfo,Yn=!0;break e}o=o.return}if(tr===null)throw Error(de(160));Jk(s,i,a),tr=null,Yn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Et(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Qk(t,e),t=t.sibling}function Qk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Wn(t,e),ha(e),n&4){try{Gc(3,e,e.return),Ah(3,e)}catch(p){Et(e,e.return,p)}try{Gc(5,e,e.return)}catch(p){Et(e,e.return,p)}}break;case 1:Wn(t,e),ha(e),n&512&&r!==null&&Ko(r,r.return);break;case 5:if(Wn(t,e),ha(e),n&512&&r!==null&&Ko(r,r.return),e.flags&32){var a=e.stateNode;try{vu(a,"")}catch(p){Et(e,e.return,p)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&_E(a,s),fv(o,i);var c=fv(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?kE(a,d):f==="dangerouslySetInnerHTML"?SE(a,d):f==="children"?vu(a,d):nx(a,f,d,c)}switch(o){case"input":iv(a,s);break;case"textarea":wE(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?tl(a,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?tl(a,!!s.multiple,s.defaultValue,!0):tl(a,!!s.multiple,s.multiple?[]:"",!1))}a[ku]=s}catch(p){Et(e,e.return,p)}}break;case 6:if(Wn(t,e),ha(e),n&4){if(e.stateNode===null)throw Error(de(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(p){Et(e,e.return,p)}}break;case 3:if(Wn(t,e),ha(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{_u(t.containerInfo)}catch(p){Et(e,e.return,p)}break;case 4:Wn(t,e),ha(e);break;case 13:Wn(t,e),ha(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Mx=jt())),n&4&&tw(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(vr=(c=vr)||f,Wn(t,e),vr=c):Wn(t,e),ha(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(be=e,f=e.child;f!==null;){for(d=be=f;be!==null;){switch(h=be,m=h.child,h.tag){case 0:case 11:case 14:case 15:Gc(4,h,h.return);break;case 1:Ko(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(p){Et(n,r,p)}}break;case 5:Ko(h,h.return);break;case 22:if(h.memoizedState!==null){nw(d);continue}}m!==null?(m.return=h,be=m):nw(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=EE("display",i))}catch(p){Et(e,e.return,p)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(p){Et(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Wn(t,e),ha(e),n&4&&tw(e);break;case 21:break;default:Wn(t,e),ha(e)}}function ha(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Xk(r)){var n=r;break e}r=r.return}throw Error(de(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(vu(a,""),n.flags&=-33);var s=ew(e);Bv(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=ew(e);Uv(e,o,i);break;default:throw Error(de(161))}}catch(l){Et(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function R3(e,t,r){be=e,Zk(e)}function Zk(e,t,r){for(var n=(e.mode&1)!==0;be!==null;){var a=be,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||ld;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||vr;o=ld;var c=vr;if(ld=i,(vr=l)&&!c)for(be=a;be!==null;)i=be,l=i.child,i.tag===22&&i.memoizedState!==null?aw(a):l!==null?(l.return=i,be=l):aw(a);for(;s!==null;)be=s,Zk(s),s=s.sibling;be=a,ld=o,vr=c}rw(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,be=s):rw(e)}}function rw(e){for(;be!==null;){var t=be;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vr||Ah(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!vr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:zn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&U_(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}U_(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&_u(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}vr||t.flags&512&&$v(t)}catch(h){Et(t,t.return,h)}}if(t===e){be=null;break}if(r=t.sibling,r!==null){r.return=t.return,be=r;break}be=t.return}}function nw(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var r=t.sibling;if(r!==null){r.return=t.return,be=r;break}be=t.return}}function aw(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ah(4,t)}catch(l){Et(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Et(t,a,l)}}var s=t.return;try{$v(t)}catch(l){Et(t,s,l)}break;case 5:var i=t.return;try{$v(t)}catch(l){Et(t,i,l)}}}catch(l){Et(t,t.return,l)}if(t===e){be=null;break}var o=t.sibling;if(o!==null){o.return=t.return,be=o;break}be=t.return}}var M3=Math.ceil,T0=gs.ReactCurrentDispatcher,Fx=gs.ReactCurrentOwner,Nn=gs.ReactCurrentBatchConfig,He=0,Qt=null,Lt=null,ar=0,Zr=0,qo=di(0),Wt=0,Du=null,Ki=0,Oh=0,Rx=0,Kc=null,Br=null,Mx=0,wl=1/0,Wa=null,C0=!1,Wv=null,Js=null,cd=!1,$s=null,N0=0,qc=0,Vv=null,Gd=-1,Kd=0;function jr(){return He&6?jt():Gd!==-1?Gd:Gd=jt()}function Qs(e){return e.mode&1?He&2&&ar!==0?ar&-ar:y3.transition!==null?(Kd===0&&(Kd=IE()),Kd):(e=Je,e!==0||(e=window.event,e=e===void 0?16:HE(e.type)),e):1}function ea(e,t,r,n){if(50<qc)throw qc=0,Vv=null,Error(de(185));df(e,r,n),(!(He&2)||e!==Qt)&&(e===Qt&&(!(He&2)&&(Oh|=r),Wt===4&&Fs(e,ar)),Yr(e,n),r===1&&He===0&&!(t.mode&1)&&(wl=jt()+500,Th&&hi()))}function Yr(e,t){var r=e.callbackNode;yj(e,t);var n=f0(e,e===Qt?ar:0);if(n===0)r!==null&&h_(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&h_(r),t===1)e.tag===0?x3(sw.bind(null,e)):ck(sw.bind(null,e)),p3(function(){!(He&6)&&hi()}),r=null;else{switch(LE(n)){case 1:r=lx;break;case 4:r=RE;break;case 16:r=u0;break;case 536870912:r=ME;break;default:r=u0}r=oT(r,eT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function eT(e,t){if(Gd=-1,Kd=0,He&6)throw Error(de(327));var r=e.callbackNode;if(il()&&e.callbackNode!==r)return null;var n=f0(e,e===Qt?ar:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=A0(e,n);else{t=n;var a=He;He|=2;var s=rT();(Qt!==e||ar!==t)&&(Wa=null,wl=jt()+500,Ii(e,t));do try{$3();break}catch(o){tT(e,o)}while(!0);wx(),T0.current=s,He=a,Lt!==null?t=0:(Qt=null,ar=0,t=Wt)}if(t!==0){if(t===2&&(a=vv(e),a!==0&&(n=a,t=Hv(e,a))),t===1)throw r=Du,Ii(e,0),Fs(e,n),Yr(e,jt()),r;if(t===6)Fs(e,n);else{if(a=e.current.alternate,!(n&30)&&!I3(a)&&(t=A0(e,n),t===2&&(s=vv(e),s!==0&&(n=s,t=Hv(e,s))),t===1))throw r=Du,Ii(e,0),Fs(e,n),Yr(e,jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(de(345));case 2:Ti(e,Br,Wa);break;case 3:if(Fs(e,n),(n&130023424)===n&&(t=Mx+500-jt(),10<t)){if(f0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){jr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Ev(Ti.bind(null,e,Br,Wa),t);break}Ti(e,Br,Wa);break;case 4:if(Fs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Zn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*M3(n/1960))-n,10<n){e.timeoutHandle=Ev(Ti.bind(null,e,Br,Wa),n);break}Ti(e,Br,Wa);break;case 5:Ti(e,Br,Wa);break;default:throw Error(de(329))}}}return Yr(e,jt()),e.callbackNode===r?eT.bind(null,e):null}function Hv(e,t){var r=Kc;return e.current.memoizedState.isDehydrated&&(Ii(e,t).flags|=256),e=A0(e,t),e!==2&&(t=Br,Br=r,t!==null&&zv(t)),e}function zv(e){Br===null?Br=e:Br.push.apply(Br,e)}function I3(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!aa(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fs(e,t){for(t&=~Rx,t&=~Oh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Zn(t),n=1<<r;e[r]=-1,t&=~n}}function sw(e){if(He&6)throw Error(de(327));il();var t=f0(e,0);if(!(t&1))return Yr(e,jt()),null;var r=A0(e,t);if(e.tag!==0&&r===2){var n=vv(e);n!==0&&(t=n,r=Hv(e,n))}if(r===1)throw r=Du,Ii(e,0),Fs(e,t),Yr(e,jt()),r;if(r===6)throw Error(de(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ti(e,Br,Wa),Yr(e,jt()),null}function Ix(e,t){var r=He;He|=1;try{return e(t)}finally{He=r,He===0&&(wl=jt()+500,Th&&hi())}}function qi(e){$s!==null&&$s.tag===0&&!(He&6)&&il();var t=He;He|=1;var r=Nn.transition,n=Je;try{if(Nn.transition=null,Je=1,e)return e()}finally{Je=n,Nn.transition=r,He=t,!(He&6)&&hi()}}function Lx(){Zr=qo.current,ut(qo)}function Ii(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,h3(r)),Lt!==null)for(r=Lt.return;r!==null;){var n=r;switch(xx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&v0();break;case 3:yl(),ut(Hr),ut(wr),Cx();break;case 5:Tx(n);break;case 4:yl();break;case 13:ut(_t);break;case 19:ut(_t);break;case 10:bx(n.type._context);break;case 22:case 23:Lx()}r=r.return}if(Qt=e,Lt=e=Zs(e.current,null),ar=Zr=t,Wt=0,Du=null,Rx=Oh=Ki=0,Br=Kc=null,Pi!==null){for(t=0;t<Pi.length;t++)if(r=Pi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Pi=null}return e}function tT(e,t){do{var r=Lt;try{if(wx(),Hd.current=k0,E0){for(var n=bt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}E0=!1}if(Gi=0,Jt=Bt=bt=null,Yc=!1,Nu=0,Fx.current=null,r===null||r.return===null){Wt=1,Du=t,Lt=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=ar,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Y_(i);if(m!==null){m.flags&=-257,G_(m,i,o,s,t),m.mode&1&&z_(s,c,t),t=m,l=c;var v=t.updateQueue;if(v===null){var p=new Set;p.add(l),t.updateQueue=p}else v.add(l);break e}else{if(!(t&1)){z_(s,c,t),$x();break e}l=Error(de(426))}}else if(vt&&o.mode&1){var _=Y_(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),G_(_,i,o,s,t),yx(_l(l,o));break e}}s=l=_l(l,o),Wt!==4&&(Wt=2),Kc===null?Kc=[s]:Kc.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=Lk(s,l,t);$_(s,g);break e;case 1:o=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Js===null||!Js.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=$k(s,o,t);$_(s,w);break e}}s=s.return}while(s!==null)}aT(r)}catch(E){t=E,Lt===r&&r!==null&&(Lt=r=r.return);continue}break}while(!0)}function rT(){var e=T0.current;return T0.current=k0,e===null?k0:e}function $x(){(Wt===0||Wt===3||Wt===2)&&(Wt=4),Qt===null||!(Ki&268435455)&&!(Oh&268435455)||Fs(Qt,ar)}function A0(e,t){var r=He;He|=2;var n=rT();(Qt!==e||ar!==t)&&(Wa=null,Ii(e,t));do try{L3();break}catch(a){tT(e,a)}while(!0);if(wx(),He=r,T0.current=n,Lt!==null)throw Error(de(261));return Qt=null,ar=0,Wt}function L3(){for(;Lt!==null;)nT(Lt)}function $3(){for(;Lt!==null&&!uj();)nT(Lt)}function nT(e){var t=iT(e.alternate,e,Zr);e.memoizedProps=e.pendingProps,t===null?aT(e):Lt=t,Fx.current=null}function aT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=j3(r,t),r!==null){r.flags&=32767,Lt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Wt=6,Lt=null;return}}else if(r=D3(r,t,Zr),r!==null){Lt=r;return}if(t=t.sibling,t!==null){Lt=t;return}Lt=t=e}while(t!==null);Wt===0&&(Wt=5)}function Ti(e,t,r){var n=Je,a=Nn.transition;try{Nn.transition=null,Je=1,U3(e,t,r,n)}finally{Nn.transition=a,Je=n}return null}function U3(e,t,r,n){do il();while($s!==null);if(He&6)throw Error(de(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(de(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(_j(e,s),e===Qt&&(Lt=Qt=null,ar=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||cd||(cd=!0,oT(u0,function(){return il(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Nn.transition,Nn.transition=null;var i=Je;Je=1;var o=He;He|=4,Fx.current=null,F3(e,r),Qk(r,e),i3(bv),d0=!!wv,bv=wv=null,e.current=r,R3(r),fj(),He=o,Je=i,Nn.transition=s}else e.current=r;if(cd&&(cd=!1,$s=e,N0=a),s=e.pendingLanes,s===0&&(Js=null),pj(r.stateNode),Yr(e,jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(C0)throw C0=!1,e=Wv,Wv=null,e;return N0&1&&e.tag!==0&&il(),s=e.pendingLanes,s&1?e===Vv?qc++:(qc=0,Vv=e):qc=0,hi(),null}function il(){if($s!==null){var e=LE(N0),t=Nn.transition,r=Je;try{if(Nn.transition=null,Je=16>e?16:e,$s===null)var n=!1;else{if(e=$s,$s=null,N0=0,He&6)throw Error(de(331));var a=He;for(He|=4,be=e.current;be!==null;){var s=be,i=s.child;if(be.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(be=c;be!==null;){var f=be;switch(f.tag){case 0:case 11:case 15:Gc(8,f,s)}var d=f.child;if(d!==null)d.return=f,be=d;else for(;be!==null;){f=be;var h=f.sibling,m=f.return;if(qk(f),f===c){be=null;break}if(h!==null){h.return=m,be=h;break}be=m}}}var v=s.alternate;if(v!==null){var p=v.child;if(p!==null){v.child=null;do{var _=p.sibling;p.sibling=null,p=_}while(p!==null)}}be=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,be=i;else e:for(;be!==null;){if(s=be,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Gc(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,be=g;break e}be=s.return}}var y=e.current;for(be=y;be!==null;){i=be;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,be=x;else e:for(i=y;be!==null;){if(o=be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ah(9,o)}}catch(E){Et(o,o.return,E)}if(o===i){be=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,be=w;break e}be=o.return}}if(He=a,hi(),Sa&&typeof Sa.onPostCommitFiberRoot=="function")try{Sa.onPostCommitFiberRoot(wh,e)}catch{}n=!0}return n}finally{Je=r,Nn.transition=t}}return!1}function iw(e,t,r){t=_l(r,t),t=Lk(e,t,1),e=Xs(e,t,1),t=jr(),e!==null&&(df(e,1,t),Yr(e,t))}function Et(e,t,r){if(e.tag===3)iw(e,e,r);else for(;t!==null;){if(t.tag===3){iw(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Js===null||!Js.has(n))){e=_l(r,e),e=$k(t,e,1),t=Xs(t,e,1),e=jr(),t!==null&&(df(t,1,e),Yr(t,e));break}}t=t.return}}function B3(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=jr(),e.pingedLanes|=e.suspendedLanes&r,Qt===e&&(ar&r)===r&&(Wt===4||Wt===3&&(ar&130023424)===ar&&500>jt()-Mx?Ii(e,0):Rx|=r),Yr(e,t)}function sT(e,t){t===0&&(e.mode&1?(t=Zf,Zf<<=1,!(Zf&130023424)&&(Zf=4194304)):t=1);var r=jr();e=cs(e,t),e!==null&&(df(e,t,r),Yr(e,r))}function W3(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),sT(e,r)}function V3(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(de(314))}n!==null&&n.delete(t),sT(e,r)}var iT;iT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Hr.current)Vr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vr=!1,O3(e,t,r);Vr=!!(e.flags&131072)}else Vr=!1,vt&&t.flags&1048576&&uk(t,y0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Yd(e,t),e=t.pendingProps;var a=vl(t,wr.current);sl(t,r),a=Ax(null,t,n,e,a,r);var s=Ox();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zr(n)?(s=!0,g0(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Ex(t),a.updater=Nh,t.stateNode=a,a._reactInternals=t,Dv(t,n,e,r),t=Fv(null,t,n,!0,s,r)):(t.tag=0,vt&&s&&gx(t),Nr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Yd(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=z3(n),e=zn(n,e),a){case 0:t=Pv(null,t,n,e,r);break e;case 1:t=X_(null,t,n,e,r);break e;case 11:t=K_(null,t,n,e,r);break e;case 14:t=q_(null,t,n,zn(n.type,e),r);break e}throw Error(de(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zn(n,a),Pv(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zn(n,a),X_(e,t,n,a,r);case 3:e:{if(Vk(t),e===null)throw Error(de(387));n=t.pendingProps,s=t.memoizedState,a=s.element,vk(e,t),b0(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=_l(Error(de(423)),t),t=J_(e,t,n,r,a);break e}else if(n!==a){a=_l(Error(de(424)),t),t=J_(e,t,n,r,a);break e}else for(an=qs(t.stateNode.containerInfo.firstChild),sn=t,vt=!0,Kn=null,r=pk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(gl(),n===a){t=us(e,t,r);break e}Nr(e,t,n,r)}t=t.child}return t;case 5:return gk(t),e===null&&Nv(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,Sv(n,a)?i=null:s!==null&&Sv(n,s)&&(t.flags|=32),Wk(e,t),Nr(e,t,i,r),t.child;case 6:return e===null&&Nv(t),null;case 13:return Hk(e,t,r);case 4:return kx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=xl(t,null,n,r):Nr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zn(n,a),K_(e,t,n,a,r);case 7:return Nr(e,t,t.pendingProps,r),t.child;case 8:return Nr(e,t,t.pendingProps.children,r),t.child;case 12:return Nr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,at(_0,n._currentValue),n._currentValue=i,s!==null)if(aa(s.value,i)){if(s.children===a.children&&!Hr.current){t=us(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=es(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Av(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(de(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Av(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Nr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,sl(t,r),a=An(a),n=n(a),t.flags|=1,Nr(e,t,n,r),t.child;case 14:return n=t.type,a=zn(n,t.pendingProps),a=zn(n.type,a),q_(e,t,n,a,r);case 15:return Uk(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:zn(n,a),Yd(e,t),t.tag=1,zr(n)?(e=!0,g0(t)):e=!1,sl(t,r),Ik(t,n,a),Dv(t,n,a,r),Fv(null,t,n,!0,e,r);case 19:return zk(e,t,r);case 22:return Bk(e,t,r)}throw Error(de(156,t.tag))};function oT(e,t){return FE(e,t)}function H3(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(e,t,r,n){return new H3(e,t,r,n)}function Ux(e){return e=e.prototype,!(!e||!e.isReactComponent)}function z3(e){if(typeof e=="function")return Ux(e)?1:0;if(e!=null){if(e=e.$$typeof,e===sx)return 11;if(e===ix)return 14}return 2}function Zs(e,t){var r=e.alternate;return r===null?(r=kn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function qd(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")Ux(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case $o:return Li(r.children,a,s,t);case ax:i=8,a|=8;break;case tv:return e=kn(12,r,t,a|2),e.elementType=tv,e.lanes=s,e;case rv:return e=kn(13,r,t,a),e.elementType=rv,e.lanes=s,e;case nv:return e=kn(19,r,t,a),e.elementType=nv,e.lanes=s,e;case gE:return Dh(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case mE:i=10;break e;case vE:i=9;break e;case sx:i=11;break e;case ix:i=14;break e;case Os:i=16,n=null;break e}throw Error(de(130,e==null?e:typeof e,""))}return t=kn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Li(e,t,r,n){return e=kn(7,e,n,t),e.lanes=r,e}function Dh(e,t,r,n){return e=kn(22,e,n,t),e.elementType=gE,e.lanes=r,e.stateNode={isHidden:!1},e}function fm(e,t,r){return e=kn(6,e,null,t),e.lanes=r,e}function dm(e,t,r){return t=kn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Y3(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yp(0),this.expirationTimes=Yp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yp(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bx(e,t,r,n,a,s,i,o,l){return e=new Y3(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=kn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ex(s),e}function G3(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Lo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function lT(e){if(!e)return ai;e=e._reactInternals;e:{if(ho(e)!==e||e.tag!==1)throw Error(de(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(de(171))}if(e.tag===1){var r=e.type;if(zr(r))return lk(e,r,t)}return t}function cT(e,t,r,n,a,s,i,o,l){return e=Bx(r,n,!0,e,a,s,i,o,l),e.context=lT(null),r=e.current,n=jr(),a=Qs(r),s=es(n,a),s.callback=t??null,Xs(r,s,a),e.current.lanes=a,df(e,a,n),Yr(e,n),e}function jh(e,t,r,n){var a=t.current,s=jr(),i=Qs(a);return r=lT(r),t.context===null?t.context=r:t.pendingContext=r,t=es(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Xs(a,t,i),e!==null&&(ea(e,a,i,s),Vd(e,a,i)),i}function O0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ow(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Wx(e,t){ow(e,t),(e=e.alternate)&&ow(e,t)}function K3(){return null}var uT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Vx(e){this._internalRoot=e}Ph.prototype.render=Vx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(de(409));jh(e,t,null,null)};Ph.prototype.unmount=Vx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qi(function(){jh(null,e,null,null)}),t[ls]=null}};function Ph(e){this._internalRoot=e}Ph.prototype.unstable_scheduleHydration=function(e){if(e){var t=BE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ps.length&&t!==0&&t<Ps[r].priority;r++);Ps.splice(r,0,e),r===0&&VE(e)}};function Hx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Fh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function lw(){}function q3(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=O0(i);s.call(c)}}var i=cT(t,n,e,0,null,!1,!1,"",lw);return e._reactRootContainer=i,e[ls]=i.current,Su(e.nodeType===8?e.parentNode:e),qi(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=O0(l);o.call(c)}}var l=Bx(e,0,!1,null,null,!1,!1,"",lw);return e._reactRootContainer=l,e[ls]=l.current,Su(e.nodeType===8?e.parentNode:e),qi(function(){jh(t,l,r,n)}),l}function Rh(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=O0(i);o.call(l)}}jh(t,i,e,a)}else i=q3(r,t,e,a,n);return O0(i)}$E=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Pc(t.pendingLanes);r!==0&&(cx(t,r|1),Yr(t,jt()),!(He&6)&&(wl=jt()+500,hi()))}break;case 13:qi(function(){var n=cs(e,1);if(n!==null){var a=jr();ea(n,e,1,a)}}),Wx(e,1)}};ux=function(e){if(e.tag===13){var t=cs(e,134217728);if(t!==null){var r=jr();ea(t,e,134217728,r)}Wx(e,134217728)}};UE=function(e){if(e.tag===13){var t=Qs(e),r=cs(e,t);if(r!==null){var n=jr();ea(r,e,t,n)}Wx(e,t)}};BE=function(){return Je};WE=function(e,t){var r=Je;try{return Je=e,t()}finally{Je=r}};hv=function(e,t,r){switch(t){case"input":if(iv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=kh(n);if(!a)throw Error(de(90));yE(n),iv(n,a)}}}break;case"textarea":wE(e,r);break;case"select":t=r.value,t!=null&&tl(e,!!r.multiple,t,!1)}};NE=Ix;AE=qi;var X3={usingClientEntryPoint:!1,Events:[pf,Vo,kh,TE,CE,Ix]},_c={findFiberByHostInstance:ji,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},J3={bundleType:_c.bundleType,version:_c.version,rendererPackageName:_c.rendererPackageName,rendererConfig:_c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=jE(e),e===null?null:e.stateNode},findFiberByHostInstance:_c.findFiberByHostInstance||K3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ud.isDisabled&&ud.supportsFiber)try{wh=ud.inject(J3),Sa=ud}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X3;un.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hx(t))throw Error(de(200));return G3(e,t,null,r)};un.createRoot=function(e,t){if(!Hx(e))throw Error(de(299));var r=!1,n="",a=uT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Bx(e,1,!1,null,null,r,!1,n,a),e[ls]=t.current,Su(e.nodeType===8?e.parentNode:e),new Vx(t)};un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(de(188)):(e=Object.keys(e).join(","),Error(de(268,e)));return e=jE(t),e=e===null?null:e.stateNode,e};un.flushSync=function(e){return qi(e)};un.hydrate=function(e,t,r){if(!Fh(t))throw Error(de(200));return Rh(null,e,t,!0,r)};un.hydrateRoot=function(e,t,r){if(!Hx(e))throw Error(de(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=uT;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=cT(t,null,e,1,r??null,a,!1,s,i),e[ls]=t.current,Su(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Ph(t)};un.render=function(e,t,r){if(!Fh(t))throw Error(de(200));return Rh(null,e,t,!1,r)};un.unmountComponentAtNode=function(e){if(!Fh(e))throw Error(de(40));return e._reactRootContainer?(qi(function(){Rh(null,null,e,!1,function(){e._reactRootContainer=null,e[ls]=null})}),!0):!1};un.unstable_batchedUpdates=Ix;un.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Fh(r))throw Error(de(200));if(e==null||e._reactInternals===void 0)throw Error(de(38));return Rh(e,t,r,!1,n)};un.version="18.3.1-next-f1338f8080-20240426";function fT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fT)}catch(e){console.error(e)}}fT(),fE.exports=un;var zx=fE.exports;const dT=Sr(zx);var hT,cw=zx;hT=cw.createRoot,cw.hydrateRoot;/**
 * @remix-run/router v1.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ju(){return ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ju.apply(this,arguments)}var Us;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Us||(Us={}));const uw="popstate";function Q3(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return Yv("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:D0(a)}return eP(t,r,null,e)}function Ft(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function pT(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Z3(){return Math.random().toString(36).substr(2,8)}function fw(e,t){return{usr:e.state,key:e.key,idx:t}}function Yv(e,t,r,n){return r===void 0&&(r=null),ju({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Il(t):t,{state:r,key:t&&t.key||n||Z3()})}function D0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Il(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function eP(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o=Us.Pop,l=null,c=f();c==null&&(c=0,i.replaceState(ju({},i.state,{idx:c}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=Us.Pop;let _=f(),g=_==null?null:_-c;c=_,l&&l({action:o,location:p.location,delta:g})}function h(_,g){o=Us.Push;let y=Yv(p.location,_,g);c=f()+1;let x=fw(y,c),w=p.createHref(y);try{i.pushState(x,"",w)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;a.location.assign(w)}s&&l&&l({action:o,location:p.location,delta:1})}function m(_,g){o=Us.Replace;let y=Yv(p.location,_,g);c=f();let x=fw(y,c),w=p.createHref(y);i.replaceState(x,"",w),s&&l&&l({action:o,location:p.location,delta:0})}function v(_){let g=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof _=="string"?_:D0(_);return y=y.replace(/ $/,"%20"),Ft(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let p={get action(){return o},get location(){return e(a,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(uw,d),l=_,()=>{a.removeEventListener(uw,d),l=null}},createHref(_){return t(a,_)},createURL:v,encodeLocation(_){let g=v(_);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:m,go(_){return i.go(_)}};return p}var dw;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(dw||(dw={}));function tP(e,t,r){return r===void 0&&(r="/"),rP(e,t,r,!1)}function rP(e,t,r,n){let a=typeof t=="string"?Il(t):t,s=Yx(a.pathname||"/",r);if(s==null)return null;let i=mT(e);nP(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=pP(s);o=dP(i[l],c,n)}return o}function mT(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(Ft(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ei([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(Ft(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),mT(s.children,t,f,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:uP(c,s.index),routesMeta:f})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of vT(s.path))a(s,i,l)}),t}function vT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=vT(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function nP(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:fP(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const aP=/^:[\w-]+$/,sP=3,iP=2,oP=1,lP=10,cP=-2,hw=e=>e==="*";function uP(e,t){let r=e.split("/"),n=r.length;return r.some(hw)&&(n+=cP),t&&(n+=iP),r.filter(a=>!hw(a)).reduce((a,s)=>a+(aP.test(s)?sP:s===""?oP:lP),n)}function fP(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function dP(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=pw({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),h=l.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=pw({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:ei([s,d.pathname]),pathnameBase:xP(ei([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=ei([s,d.pathnameBase]))}return i}function pw(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=hP(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,f,d)=>{let{paramName:h,isOptional:m}=f;if(h==="*"){let p=o[d]||"";i=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const v=o[d];return m&&!v?c[h]=void 0:c[h]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function hP(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),pT(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function pP(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return pT(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Yx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function mP(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Il(e):e;return{pathname:r?r.startsWith("/")?r:vP(r,t):t,search:yP(n),hash:_P(a)}}function vP(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function hm(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gP(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Gx(e,t){let r=gP(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Kx(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Il(e):(a=ju({},e),Ft(!a.pathname||!a.pathname.includes("?"),hm("?","pathname","search",a)),Ft(!a.pathname||!a.pathname.includes("#"),hm("#","pathname","hash",a)),Ft(!a.search||!a.search.includes("#"),hm("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}o=d>=0?t[d]:"/"}let l=mP(a,o),c=i&&i!=="/"&&i.endsWith("/"),f=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}const ei=e=>e.join("/").replace(/\/\/+/g,"/"),xP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),yP=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,_P=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function wP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const gT=["post","put","patch","delete"];new Set(gT);const bP=["get",...gT];new Set(bP);/**
 * React Router v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pu(){return Pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pu.apply(this,arguments)}const qx=D.createContext(null),SP=D.createContext(null),pi=D.createContext(null),Mh=D.createContext(null),Pa=D.createContext({outlet:null,matches:[],isDataRoute:!1}),xT=D.createContext(null);function EP(e,t){let{relative:r}=t===void 0?{}:t;Ll()||Ft(!1);let{basename:n,navigator:a}=D.useContext(pi),{hash:s,pathname:i,search:o}=_T(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:ei([n,i])),a.createHref({pathname:l,search:o,hash:s})}function Ll(){return D.useContext(Mh)!=null}function $l(){return Ll()||Ft(!1),D.useContext(Mh).location}function yT(e){D.useContext(pi).static||D.useLayoutEffect(e)}function Rn(){let{isDataRoute:e}=D.useContext(Pa);return e?$P():kP()}function kP(){Ll()||Ft(!1);let e=D.useContext(qx),{basename:t,future:r,navigator:n}=D.useContext(pi),{matches:a}=D.useContext(Pa),{pathname:s}=$l(),i=JSON.stringify(Gx(a,r.v7_relativeSplatPath)),o=D.useRef(!1);return yT(()=>{o.current=!0}),D.useCallback(function(c,f){if(f===void 0&&(f={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=Kx(c,JSON.parse(i),s,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ei([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,s,e])}const TP=D.createContext(null);function CP(e){let t=D.useContext(Pa).outlet;return t&&D.createElement(TP.Provider,{value:e},t)}function Ul(){let{matches:e}=D.useContext(Pa),t=e[e.length-1];return t?t.params:{}}function _T(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=D.useContext(pi),{matches:a}=D.useContext(Pa),{pathname:s}=$l(),i=JSON.stringify(Gx(a,n.v7_relativeSplatPath));return D.useMemo(()=>Kx(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function NP(e,t){return AP(e,t)}function AP(e,t,r,n){Ll()||Ft(!1);let{navigator:a,static:s}=D.useContext(pi),{matches:i}=D.useContext(Pa),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let f=$l(),d;if(t){var h;let g=typeof t=="string"?Il(t):t;c==="/"||(h=g.pathname)!=null&&h.startsWith(c)||Ft(!1),d=g}else d=f;let m=d.pathname||"/",v=m;if(c!=="/"){let g=c.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=!s&&r&&r.matches&&r.matches.length>0?r.matches:tP(e,{pathname:v}),_=FP(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:ei([c,a.encodeLocation?a.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:ei([c,a.encodeLocation?a.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,r,n);return t&&_?D.createElement(Mh.Provider,{value:{location:Pu({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Us.Pop}},_):_}function OP(){let e=LP(),t=wP(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},t),r?D.createElement("pre",{style:a},r):null,null)}const DP=D.createElement(OP,null);class jP extends D.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?D.createElement(Pa.Provider,{value:this.props.routeContext},D.createElement(xT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PP(e){let{routeContext:t,match:r,children:n}=e,a=D.useContext(qx);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),D.createElement(Pa.Provider,{value:t},n)}function FP(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||Ft(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:h,errors:m}=r,v=d.route.loader&&h[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||v){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((f,d,h)=>{let m,v=!1,p=null,_=null;r&&(m=o&&d.route.id?o[d.route.id]:void 0,p=d.route.errorElement||DP,l&&(c<0&&h===0?(v=!0,_=null):c===h&&(v=!0,_=d.route.hydrateFallbackElement||null)));let g=t.concat(i.slice(0,h+1)),y=()=>{let x;return m?x=p:v?x=_:d.route.Component?x=D.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=f,D.createElement(PP,{match:d,routeContext:{outlet:f,matches:g,isDataRoute:r!=null},children:x})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?D.createElement(jP,{location:r.location,revalidation:r.revalidation,component:p,error:m,children:y(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):y()},null)}var wT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(wT||{}),j0=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(j0||{});function RP(e){let t=D.useContext(qx);return t||Ft(!1),t}function MP(e){let t=D.useContext(SP);return t||Ft(!1),t}function IP(e){let t=D.useContext(Pa);return t||Ft(!1),t}function bT(e){let t=IP(),r=t.matches[t.matches.length-1];return r.route.id||Ft(!1),r.route.id}function LP(){var e;let t=D.useContext(xT),r=MP(j0.UseRouteError),n=bT(j0.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function $P(){let{router:e}=RP(wT.UseNavigateStable),t=bT(j0.UseNavigateStable),r=D.useRef(!1);return yT(()=>{r.current=!0}),D.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Pu({fromRouteId:t},s)))},[e,t])}function UP(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function P0(e){let{to:t,replace:r,state:n,relative:a}=e;Ll()||Ft(!1);let{future:s,static:i}=D.useContext(pi),{matches:o}=D.useContext(Pa),{pathname:l}=$l(),c=Rn(),f=Kx(t,Gx(o,s.v7_relativeSplatPath),l,a==="path"),d=JSON.stringify(f);return D.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:a}),[c,d,a,r,n]),null}function BP(e){return CP(e.context)}function ht(e){Ft(!1)}function WP(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Us.Pop,navigator:s,static:i=!1,future:o}=e;Ll()&&Ft(!1);let l=t.replace(/^\/*/,"/"),c=D.useMemo(()=>({basename:l,navigator:s,static:i,future:Pu({v7_relativeSplatPath:!1},o)}),[l,o,s,i]);typeof n=="string"&&(n=Il(n));let{pathname:f="/",search:d="",hash:h="",state:m=null,key:v="default"}=n,p=D.useMemo(()=>{let _=Yx(f,l);return _==null?null:{location:{pathname:_,search:d,hash:h,state:m,key:v},navigationType:a}},[l,f,d,h,m,v,a]);return p==null?null:D.createElement(pi.Provider,{value:c},D.createElement(Mh.Provider,{children:r,value:p}))}function VP(e){let{children:t,location:r}=e;return NP(Gv(t),r)}new Promise(()=>{});function Gv(e,t){t===void 0&&(t=[]);let r=[];return D.Children.forEach(e,(n,a)=>{if(!D.isValidElement(n))return;let s=[...t,a];if(n.type===D.Fragment){r.push.apply(r,Gv(n.props.children,s));return}n.type!==ht&&Ft(!1),!n.props.index||!n.props.children||Ft(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Gv(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kv(){return Kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kv.apply(this,arguments)}function HP(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function zP(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function YP(e,t){return e.button===0&&(!t||t==="_self")&&!zP(e)}const GP=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],KP="6";try{window.__reactRouterVersion=KP}catch{}const qP="startTransition",mw=BD[qP];function XP(e){let{basename:t,children:r,future:n,window:a}=e,s=D.useRef();s.current==null&&(s.current=Q3({window:a,v5Compat:!0}));let i=s.current,[o,l]=D.useState({action:i.action,location:i.location}),{v7_startTransition:c}=n||{},f=D.useCallback(d=>{c&&mw?mw(()=>l(d)):l(d)},[l,c]);return D.useLayoutEffect(()=>i.listen(f),[i,f]),D.useEffect(()=>UP(n),[n]),D.createElement(WP,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const JP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",QP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jr=D.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:f,viewTransition:d}=t,h=HP(t,GP),{basename:m}=D.useContext(pi),v,p=!1;if(typeof c=="string"&&QP.test(c)&&(v=c,JP))try{let x=new URL(window.location.href),w=c.startsWith("//")?new URL(x.protocol+c):new URL(c),E=Yx(w.pathname,m);w.origin===x.origin&&E!=null?c=E+w.search+w.hash:p=!0}catch{}let _=EP(c,{relative:a}),g=ZP(c,{replace:i,state:o,target:l,preventScrollReset:f,relative:a,viewTransition:d});function y(x){n&&n(x),x.defaultPrevented||g(x)}return D.createElement("a",Kv({},h,{href:v||_,onClick:p||s?n:y,ref:r,target:l}))});var vw;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(vw||(vw={}));var gw;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gw||(gw={}));function ZP(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:i,viewTransition:o}=t===void 0?{}:t,l=Rn(),c=$l(),f=_T(e,{relative:i});return D.useCallback(d=>{if(YP(d,r)){d.preventDefault();let h=n!==void 0?n:D0(c)===D0(f);l(e,{replace:h,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,f,n,a,r,e,s,i,o])}const eF={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnZXdyZWNhcXdocHludWt0dXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg2MTI2NzMsImV4cCI6MjA1NDE4ODY3M30.xsi-rH3yossZT99w9JcLVE_FUpMs7lN6jKQUOadIV-Y",VITE_SUPABASE_URL:"https://wgewrecaqwhpynuktuxp.supabase.co"},xw=e=>{let t;const r=new Set,n=(f,d)=>{const h=typeof f=="function"?f(t):f;if(!Object.is(h,t)){const m=t;t=d??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(v=>v(t,m))}},a=()=>t,l={setState:n,getState:a,getInitialState:()=>c,subscribe:f=>(r.add(f),()=>r.delete(f)),destroy:()=>{(eF?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,a,l);return l},tF=e=>e?xw(e):xw;var ST={exports:{}},ET={},kT={exports:{}},TT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bl=D;function rF(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nF=typeof Object.is=="function"?Object.is:rF,aF=bl.useState,sF=bl.useEffect,iF=bl.useLayoutEffect,oF=bl.useDebugValue;function lF(e,t){var r=t(),n=aF({inst:{value:r,getSnapshot:t}}),a=n[0].inst,s=n[1];return iF(function(){a.value=r,a.getSnapshot=t,pm(a)&&s({inst:a})},[e,r,t]),sF(function(){return pm(a)&&s({inst:a}),e(function(){pm(a)&&s({inst:a})})},[e]),oF(r),r}function pm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!nF(e,r)}catch{return!0}}function cF(e,t){return t()}var uF=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?cF:lF;TT.useSyncExternalStore=bl.useSyncExternalStore!==void 0?bl.useSyncExternalStore:uF;kT.exports=TT;var CT=kT.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ih=D,fF=CT;function dF(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hF=typeof Object.is=="function"?Object.is:dF,pF=fF.useSyncExternalStore,mF=Ih.useRef,vF=Ih.useEffect,gF=Ih.useMemo,xF=Ih.useDebugValue;ET.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var s=mF(null);if(s.current===null){var i={hasValue:!1,value:null};s.current=i}else i=s.current;s=gF(function(){function l(m){if(!c){if(c=!0,f=m,m=n(m),a!==void 0&&i.hasValue){var v=i.value;if(a(v,m))return d=v}return d=m}if(v=d,hF(f,m))return v;var p=n(m);return a!==void 0&&a(v,p)?(f=m,v):(f=m,d=p)}var c=!1,f,d,h=r===void 0?null:r;return[function(){return l(t())},h===null?void 0:function(){return l(h())}]},[t,r,n,a]);var o=pF(e,s[0],s[1]);return vF(function(){i.hasValue=!0,i.value=o},[o]),xF(o),o};ST.exports=ET;var yF=ST.exports;const _F=Sr(yF),NT={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnZXdyZWNhcXdocHludWt0dXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg2MTI2NzMsImV4cCI6MjA1NDE4ODY3M30.xsi-rH3yossZT99w9JcLVE_FUpMs7lN6jKQUOadIV-Y",VITE_SUPABASE_URL:"https://wgewrecaqwhpynuktuxp.supabase.co"},{useDebugValue:wF}=Q,{useSyncExternalStoreWithSelector:bF}=_F;let yw=!1;const SF=e=>e;function EF(e,t=SF,r){(NT?"production":void 0)!=="production"&&r&&!yw&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),yw=!0);const n=bF(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return wF(n),n}const _w=e=>{(NT?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?tF(e):e,r=(n,a)=>EF(t,n,a);return Object.assign(r,t),r},kF=e=>e?_w(e):_w,TF="modulepreload",CF=function(e){return"/"+e},ww={},Sl=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=CF(l),l in ww)return;ww[l]=!0;const c=l.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":TF,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,m)=>{d.addEventListener("load",h),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},NF=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Sl(async()=>{const{default:n}=await Promise.resolve().then(()=>Bl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Xx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class AF extends Xx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class OF extends Xx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class DF extends Xx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var qv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(qv||(qv={}));var jF=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class PF{constructor(t,{headers:r={},customFetch:n,region:a=qv.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=NF(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return jF(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=i):typeof i=="string"?(o["Content-Type"]="text/plain",c=i):typeof FormData<"u"&&i instanceof FormData?c=i:(o["Content-Type"]="application/json",c=JSON.stringify(i)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:c}).catch(v=>{throw new AF(v)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new OF(f);if(!f.ok)throw new DF(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return h==="application/json"?m=yield f.json():h==="application/octet-stream"?m=yield f.blob():h==="text/event-stream"?m=f:h==="multipart/form-data"?m=yield f.formData():m=yield f.text(),{data:m,error:null}}catch(a){return{data:null,error:a}}})}}var Wr={},Jx={},Lh={},vf={},$h={},Uh={},FF=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},El=FF();const RF=El.fetch,AT=El.fetch.bind(El),OT=El.Headers,MF=El.Request,IF=El.Response,Bl=Object.freeze(Object.defineProperty({__proto__:null,Headers:OT,Request:MF,Response:IF,default:AT,fetch:RF},Symbol.toStringTag,{value:"Module"})),LF=kD(Bl);var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});let $F=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Bh.default=$F;var DT=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Uh,"__esModule",{value:!0});const UF=DT(LF),BF=DT(Bh);let WF=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=UF.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l;let c=null,f=null,d=null,h=s.status,m=s.statusText;if(s.ok){if(this.method!=="HEAD"){const g=await s.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=g:f=JSON.parse(g))}const p=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),_=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");p&&_&&_.length>1&&(d=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(c={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,d=null,h=406,m="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const p=await s.text();try{c=JSON.parse(p),Array.isArray(c)&&s.status===404&&(f=[],c=null,h=200,m="OK")}catch{s.status===404&&p===""?(h=204,m="No Content"):c={message:p}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,m="OK"),c&&this.shouldThrowOnError)throw new BF.default(c)}return{error:c,data:f,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Uh.default=WF;var VF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($h,"__esModule",{value:!0});const HF=VF(Uh);let zF=class extends HF.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};$h.default=zF;var YF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vf,"__esModule",{value:!0});const GF=YF($h);let KF=class extends GF.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};vf.default=KF;var qF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lh,"__esModule",{value:!0});const wc=qF(vf);let XF=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new wc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new wc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,f)=>c.concat(Object.keys(f)),[]);if(l.length>0){const c=[...new Set(l)].map(f=>`"${f}"`);this.url.searchParams.set("columns",c.join(","))}}return new wc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new wc.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new wc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Lh.default=XF;var Wh={},Vh={};Object.defineProperty(Vh,"__esModule",{value:!0});Vh.version=void 0;Vh.version="0.0.0-automated";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.DEFAULT_HEADERS=void 0;const JF=Vh;Wh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${JF.version}`};var jT=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jx,"__esModule",{value:!0});const QF=jT(Lh),ZF=jT(vf),eR=Wh;let tR=class PT{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},eR.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new QF.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new PT(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(i=n?"HEAD":"GET",Object.entries(r).filter(([f,d])=>d!==void 0).map(([f,d])=>[f,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([f,d])=>{o.searchParams.append(f,d)})):(i="POST",l=r);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new ZF.default({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Jx.default=tR;var Wl=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.PostgrestError=Wr.PostgrestBuilder=Wr.PostgrestTransformBuilder=Wr.PostgrestFilterBuilder=Wr.PostgrestQueryBuilder=Wr.PostgrestClient=void 0;const FT=Wl(Jx);Wr.PostgrestClient=FT.default;const RT=Wl(Lh);Wr.PostgrestQueryBuilder=RT.default;const MT=Wl(vf);Wr.PostgrestFilterBuilder=MT.default;const IT=Wl($h);Wr.PostgrestTransformBuilder=IT.default;const LT=Wl(Uh);Wr.PostgrestBuilder=LT.default;const $T=Wl(Bh);Wr.PostgrestError=$T.default;var rR=Wr.default={PostgrestClient:FT.default,PostgrestQueryBuilder:RT.default,PostgrestFilterBuilder:MT.default,PostgrestTransformBuilder:IT.default,PostgrestBuilder:LT.default,PostgrestError:$T.default};const{PostgrestClient:nR,PostgrestQueryBuilder:The,PostgrestFilterBuilder:Che,PostgrestTransformBuilder:Nhe,PostgrestBuilder:Ahe,PostgrestError:Ohe}=rR,aR="2.11.2",sR={"X-Client-Info":`realtime-js/${aR}`},iR="1.0.0",UT=1e4,oR=1e3;var ol;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ol||(ol={}));var Qr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Qr||(Qr={}));var Gn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Gn||(Gn={}));var Xv;(function(e){e.websocket="websocket"})(Xv||(Xv={}));var Ai;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ai||(Ai={}));class lR{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class BT{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(rt||(rt={}));const bw=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=cR(i,e,t,a),s),{})},cR=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?WT(s,i):Jv(i)},WT=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return hR(t,r)}switch(e){case rt.bool:return uR(t);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return fR(t);case rt.json:case rt.jsonb:return dR(t);case rt.timestamp:return pR(t);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return Jv(t);default:return Jv(t)}},Jv=e=>e,uR=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},fR=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},dR=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},hR=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>WT(t,o))}return e},pR=e=>typeof e=="string"?e.replace(" ","T"):e,VT=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class mm{constructor(t,r,n={},a=UT){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Sw;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Sw||(Sw={}));class Xc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Xc.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=Xc.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Xc.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,f)=>{i[c]||(l[c]=f)}),this.map(i,(c,f)=>{const d=s[c];if(d){const h=f.map(_=>_.presence_ref),m=d.map(_=>_.presence_ref),v=f.filter(_=>m.indexOf(_.presence_ref)<0),p=d.filter(_=>h.indexOf(_.presence_ref)<0);v.length>0&&(o[c]=v),p.length>0&&(l[c]=p)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),f.length>0){const d=t[o].map(m=>m.presence_ref),h=f.filter(m=>d.indexOf(m.presence_ref)<0);t[o].unshift(...h)}n(o,f,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const f=l.map(d=>d.presence_ref);c=c.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ew;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ew||(Ew={}));var kw;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(kw||(kw={}));var Va;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Va||(Va={}));class Qx{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Qr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new mm(this,Gn.join,this.params,this.timeout),this.rejoinTimer=new BT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Qr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Qr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Qr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Qr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Gn.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new Xc(this),this.broadcastEndpointURL=VT(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(f=>t==null?void 0:t(Va.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(Va.CLOSED));const l={},c={broadcast:s,presence:i,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var d;if(this.socket.setAuth(),f===void 0){t==null||t(Va.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,m=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,v=[];for(let p=0;p<m;p++){const _=h[p],{filter:{event:g,schema:y,table:x,filter:w}}=_,E=f&&f[p];if(E&&E.event===g&&E.schema===y&&E.table===x&&E.filter===w)v.push(Object.assign(Object.assign({},_),{id:E.id}));else{this.unsubscribe(),t==null||t(Va.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Va.SUBSCRIBED);return}}).receive("error",f=>{t==null||t(Va.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Va.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Qr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Gn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const a=new mm(this,Gn.leave,{},t);a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new mm(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:f}=Gn;if(n&&[o,l,c,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var v,p,_;return((v=m.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(p=m.filter)===null||p===void 0?void 0:p.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(m=>{var v,p,_,g,y,x;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const w=m.id,E=(v=m.filter)===null||v===void 0?void 0:v.event;return w&&((p=r.ids)===null||p===void 0?void 0:p.includes(w))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const w=(y=(g=m==null?void 0:m.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((x=r==null?void 0:r.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:p,table:_,commit_timestamp:g,type:y,errors:x}=v;h=Object.assign(Object.assign({},{schema:p,table:_,commit_timestamp:g,eventType:y,new:{},old:{},errors:x}),this._getPayloadRecords(v))}m.callback(h,n)})}_isClosed(){return this.state===Qr.closed}_isJoined(){return this.state===Qr.joined}_isJoining(){return this.state===Qr.joining}_isLeaving(){return this.state===Qr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Qx.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Gn.close,{},t)}_onError(t){this._on(Gn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Qr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=bw(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=bw(t.columns,t.old_record)),r}}const mR=()=>{},vR=typeof WebSocket<"u",gR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xR{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=sR,this.params={},this.timeout=UT,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=mR,this.conn=null,this.sendBuffer=[],this.serializer=new lR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>Sl(async()=>{const{default:l}=await Promise.resolve().then(()=>Bl);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${t}/${Xv.websocket}`,this.httpEndpoint=VT(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,i)=>i(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new BT(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(vR){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new yR(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Sl(async()=>{const{default:t}=await import("./browser-CrPUtrK7.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:iR}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ol.connecting:return Ai.Connecting;case ol.open:return Ai.Open;case ol.closing:return Ai.Closing;default:return Ai.Closed}}isConnected(){return this.connectionState()===Ai.Open}channel(t,r={config:{}}){const n=new Qx(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(Gn.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(oR,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:s,ref:i}=r;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${a} ${i&&"("+i+")"||""}`,s),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Gn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([gR],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class yR{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ol.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Zx extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function qt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class _R extends Zx{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Qv extends Zx{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var wR=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const HT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Sl(async()=>{const{default:n}=await Promise.resolve().then(()=>Bl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},bR=()=>wR(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Sl(()=>Promise.resolve().then(()=>Bl),void 0)).Response:Response}),Zv=e=>{if(Array.isArray(e))return e.map(r=>Zv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Zv(n)}),t};var po=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const vm=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),SR=(e,t,r)=>po(void 0,void 0,void 0,function*(){const n=yield bR();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new _R(vm(a),e.status||500))}).catch(a=>{t(new Qv(vm(a),a))}):t(new Qv(vm(e),e))}),ER=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function gf(e,t,r,n,a,s){return po(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,ER(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>SR(l,o,n))})})}function F0(e,t,r,n){return po(this,void 0,void 0,function*(){return gf(e,"GET",t,r,n)})}function js(e,t,r,n,a){return po(this,void 0,void 0,function*(){return gf(e,"POST",t,n,a,r)})}function kR(e,t,r,n,a){return po(this,void 0,void 0,function*(){return gf(e,"PUT",t,n,a,r)})}function TR(e,t,r,n){return po(this,void 0,void 0,function*(){return gf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function zT(e,t,r,n,a){return po(this,void 0,void 0,function*(){return gf(e,"DELETE",t,n,a,r)})}var Lr=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const CR={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Tw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class NR{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=HT(a)}uploadOrUpdate(t,r,n,a){return Lr(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Tw),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),f=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(qt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Lr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Tw.upsert},a),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:f}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(qt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Lr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield js(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new Zx("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Lr(this,void 0,void 0,function*(){try{return{data:yield js(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Lr(this,void 0,void 0,function*(){try{return{data:{path:(yield js(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Lr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield js(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Lr(this,void 0,void 0,function*(){try{const a=yield js(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}download(t,r){return Lr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield F0(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(qt(o))return{data:null,error:o};throw o}})}info(t){return Lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield F0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Zv(n),error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}exists(t){return Lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield TR(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(qt(n)&&n instanceof Qv){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Lr(this,void 0,void 0,function*(){try{return{data:yield zT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Lr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},CR),r),{prefix:t||""});return{data:yield js(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const AR="2.7.1",OR={"X-Client-Info":`storage-js/${AR}`};var No=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class DR{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},OR),r),this.fetch=HT(n)}listBuckets(){return No(this,void 0,void 0,function*(){try{return{data:yield F0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(qt(t))return{data:null,error:t};throw t}})}getBucket(t){return No(this,void 0,void 0,function*(){try{return{data:yield F0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return No(this,void 0,void 0,function*(){try{return{data:yield js(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return No(this,void 0,void 0,function*(){try{return{data:yield kR(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return No(this,void 0,void 0,function*(){try{return{data:yield js(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return No(this,void 0,void 0,function*(){try{return{data:yield zT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}}class jR extends DR{constructor(t,r={},n){super(t,r,n)}from(t){return new NR(this.url,this.headers,t,this.fetch)}}const PR="2.49.3";let Rc="";typeof Deno<"u"?Rc="deno":typeof document<"u"?Rc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Rc="react-native":Rc="node";const FR={"X-Client-Info":`supabase-js-${Rc}/${PR}`},RR={headers:FR},MR={schema:"public"},IR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},LR={};var $R=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const UR=e=>{let t;return e?t=e:typeof fetch>"u"?t=AT:t=fetch,(...r)=>t(...r)},BR=()=>typeof Headers>"u"?OT:Headers,WR=(e,t,r)=>{const n=UR(r),a=BR();return(s,i)=>$R(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var VR=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function HR(e){return e.replace(/\/$/,"")}function zR(e,t){const{db:r,auth:n,realtime:a,global:s}=e,{db:i,auth:o,realtime:l,global:c}=t,f={db:Object.assign(Object.assign({},i),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),s),accessToken:()=>VR(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const YT="2.69.1",Fo=30*1e3,eg=3,gm=eg*Fo,YR="http://localhost:9999",GR="supabase.auth.token",KR={"X-Client-Info":`gotrue-js/${YT}`},tg="X-Supabase-Api-Version",GT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},qR=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,XR=6e5;class e1 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Pe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class JR extends e1{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function QR(e){return Pe(e)&&e.name==="AuthApiError"}class KT extends e1{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class mi extends e1{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Ns extends mi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ZR(e){return Pe(e)&&e.name==="AuthSessionMissingError"}class xm extends mi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fd extends mi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class dd extends mi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function eM(e){return Pe(e)&&e.name==="AuthImplicitGrantRedirectError"}class Cw extends mi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rg extends mi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ym(e){return Pe(e)&&e.name==="AuthRetryableFetchError"}class Nw extends mi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Jc extends mi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Aw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ow=` 	
\r=`.split(""),tM=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ow.length;t+=1)e[Ow[t].charCodeAt(0)]=-2;for(let t=0;t<Aw.length;t+=1)e[Aw[t].charCodeAt(0)]=t;return e})();function qT(e,t,r){const n=tM[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Dw(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{aM(i,n,r)};for(let i=0;i<e.length;i+=1)qT(e.charCodeAt(i),a,s);return t.join("")}function rM(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function nM(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}rM(n,t)}}function aM(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function sM(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)qT(e.charCodeAt(a),r,n);return new Uint8Array(t)}function iM(e){const t=[];return nM(e,r=>t.push(r)),new Uint8Array(t)}function oM(e){return Math.round(Date.now()/1e3)+e}function lM(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ma=()=>typeof window<"u"&&typeof document<"u",Si={tested:!1,writable:!1},Qc=()=>{if(!ma())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Si.tested)return Si.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Si.tested=!0,Si.writable=!0}catch{Si.tested=!0,Si.writable=!1}return Si.writable};function cM(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const XT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Sl(async()=>{const{default:n}=await Promise.resolve().then(()=>Bl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},uM=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",JT=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},hd=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},pd=async(e,t)=>{await e.removeItem(t)};class Hh{constructor(){this.promise=new Hh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Hh.promiseConstructor=Promise;function _m(e){const t=e.split(".");if(t.length!==3)throw new Jc("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!qR.test(t[n]))throw new Jc("JWT not in base64url format");return{header:JSON.parse(Dw(t[0])),payload:JSON.parse(Dw(t[1])),signature:sM(t[2]),raw:{header:t[0],payload:t[1]}}}async function fM(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function dM(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function hM(e){return("0"+e.toString(16)).substr(-2)}function pM(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,hM).join("")}async function mM(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function vM(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await mM(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ao(e,t,r=!1){const n=pM();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await JT(e,`${t}-code-verifier`,a);const s=await vM(n);return[s,n===s?"plain":"s256"]}const gM=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xM(e){const t=e.headers.get(tg);if(!t||!t.match(gM))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function yM(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function _M(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var wM=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Ci=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),bM=[502,503,504];async function jw(e){var t;if(!uM(e))throw new rg(Ci(e),0);if(bM.includes(e.status))throw new rg(Ci(e),e.status);let r;try{r=await e.json()}catch(s){throw new KT(Ci(s),s)}let n;const a=xM(e);if(a&&a.getTime()>=GT["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Nw(Ci(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ns}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Nw(Ci(r),e.status,r.weak_password.reasons);throw new JR(Ci(r),e.status||500,n)}const SM=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ie(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[tg]||(s[tg]=GT["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await EM(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function EM(e,t,r,n,a,s){const i=SM(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new rg(Ci(l),0)}if(o.ok||await jw(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await jw(l)}}function As(e){var t;let r=null;NM(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=oM(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Pw(e){const t=As(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Rs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function kM(e){return{data:e,error:null}}function TM(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=wM(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function CM(e){return e}function NM(e){return e.access_token&&e.refresh_token&&e.expires_in}var AM=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class OM{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=XT(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Ie(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Rs})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=AM(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:TM,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Rs})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},f=await Ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:CM});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(v=>{const p=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);c[`${_}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Pe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Ie(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Rs})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Ie(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Rs})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Rs})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Ie(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}}const DM={getItem:e=>Qc()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Qc()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Qc()&&globalThis.localStorage.removeItem(e)}};function Fw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function jM(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Oo={debug:!!(globalThis&&Qc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class QT extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class PM extends QT{}async function FM(e,t,r){Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new PM(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Oo.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}jM();const RM={url:YR,storageKey:GR,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:KR,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Rw(e,t,r){return await r()}class Fu{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Fu.nextInstanceID,Fu.nextInstanceID+=1,this.instanceID>0&&ma()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},RM),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new OM({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=XT(a.fetch),this.lock=a.lock||Rw,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ma()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=FM:this.lock=Rw,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Qc()?this.storage=DM:(this.memoryStorage={},this.storage=Fw(this.memoryStorage)):(this.memoryStorage={},this.storage=Fw(this.memoryStorage)),ma()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${YT}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=cM(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),ma()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),eM(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pe(r)?{error:r}:{error:new KT("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:As}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:f,password:d,options:h}=t;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Ao(this.storage,this.storageKey)),s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:v},xform:As})}else if("phone"in t){const{phone:f,password:d,options:h}=t;s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:As})}else throw new fd("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Pw})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Pw})}else throw new fd("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new xm}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await hd(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:As});if(await pd(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new xm}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Pe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:As}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new xm}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await Ao(this.storage,this.storageKey));const{error:d}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:f}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new fd("You must provide either an email or phone number.")}catch(o){if(Pe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:As});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Pe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Ao(this.storage,this.storageKey)),await Ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:kM})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ns;const{error:a}=await Ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Pe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new fd("You must provide either an email or phone number and a type")}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await hd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<gm:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,f)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,f))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Rs}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ns}:await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Rs})})}catch(r){if(Pe(r))return ZR(r)&&(await this._removeSession(),await pd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Ns;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Ao(this.storage,this.storageKey));const{data:c,error:f}=await Ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Rs});if(f)throw f;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ns;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=_m(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Pe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ns;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!ma())throw new dd("No browser detected.");if(t.error||t.error_description||t.error_code)throw new dd(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Cw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new dd("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Cw("No code detected.");const{data:y,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new dd("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;l&&(h=parseInt(l));const m=h-f;m*1e3<=Fo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const v=h-d;f-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,f):f-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,f);const{data:p,error:_}=await this._getUser(s);if(_)throw _;const g={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(n){if(Pe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await hd(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(QR(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await pd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=lM(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Ao(this.storage,this.storageKey,!0));try{return await Ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,f;const{data:d,error:h}=s;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ie(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return ma()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Pe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Ie(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await dM(async a=>(a>0&&await fM(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:As})),(a,s)=>{const i=200*Math.pow(2,a);return s&&ym(s)&&Date.now()+i-n<Fo})}catch(n){if(this._debug(r,"error",n),Pe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ma()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await hd(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<gm;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${gm}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),ym(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ns;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Hh;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Ns;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Pe(s)){const i={session:null,error:s};return ym(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await JT(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await pd(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ma()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Fo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Fo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Fo}ms, refresh threshold is ${eg} ticks`),a<=eg&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof QT)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ma()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Ao(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Ie(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Ie(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=_m(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(i=>i.kid===t);if(n||(n=this.jwks.keys.find(i=>i.kid===t),n&&this.jwks_cached_at+XR>Date.now()))return n;const{data:a,error:s}=await Ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!a.keys||a.keys.length===0)throw new Jc("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(i=>i.kid===t),!n)throw new Jc("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:m,error:v}=await this.getSession();if(v||!m.session)return{data:null,error:v};n=m.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=_m(n);if(yM(s.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:a,signature:i},error:null}}const c=_M(a.alg),f=await this.fetchJwk(a.kid,r),d=await crypto.subtle.importKey("jwk",f,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,i,iM(`${o}.${l}`)))throw new Jc("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}}Fu.nextInstanceID=0;const MM=Fu;class IM extends MM{constructor(t){super(t)}}var LM=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class $M{constructor(t,r,n){var a,s,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=HR(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:MR,realtime:LR,auth:Object.assign(Object.assign({},IR),{storageKey:l}),global:RR},f=zR(n??{},c);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=WR(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new nR(`${o}/rest/v1`,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new PF(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new jR(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return LM(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:i,lock:o,debug:l},c,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new IM({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:i,lock:o,debug:l,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new xR(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const UM=(e,t,r)=>new $M(e,t,r),BM="https://wgewrecaqwhpynuktuxp.supabase.co",WM="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnZXdyZWNhcXdocHludWt0dXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg2MTI2NzMsImV4cCI6MjA1NDE4ODY3M30.xsi-rH3yossZT99w9JcLVE_FUpMs7lN6jKQUOadIV-Y",se=UM(BM,WM),Qe=kF((e,t)=>({user:null,role:null,currentTime:null,notifications:[],setUser:r=>e({user:r}),setRole:r=>e({role:r}),addNotification:async r=>{try{const{data:n,error:a}=await se.from("notifications").insert([{...r,is_delivered:!1}]).select();if(a)throw a;n&&e(s=>({notifications:[...s.notifications,...n]}))}catch(n){console.error("Error adding notification:",n)}},markNotificationAsDelivered:async r=>{try{await se.from("notifications").update({is_delivered:!0}).eq("id",r),e(n=>({notifications:n.notifications.map(a=>a.id===r?{...a,is_delivered:!0}:a)}))}catch(n){console.error("Error marking notification as delivered:",n)}},logout:async()=>{await se.auth.signOut(),e({user:null,role:null,notifications:[],currentTime:null})}}));/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var VM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),We=(e,t)=>{const r=D.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},f)=>D.createElement("svg",{ref:f,...VM,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${HM(e)}`,o].join(" "),...c},[...t.map(([d,h])=>D.createElement(d,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=We("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=We("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YM=We("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=We("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=We("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=We("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=We("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=We("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=We("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=We("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=We("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=We("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=We("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=We("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=We("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=We("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=We("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=We("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=We("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=We("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=We("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=We("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=We("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=We("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=We("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=We("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=We("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=We("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=We("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=We("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=We("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=We("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=We("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=We("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function e6(){const[e,t]=D.useState(""),[r,n]=D.useState(""),[a,s]=D.useState(!1),[i,o]=D.useState(""),l=Rn(),{setUser:c,setRole:f}=Qe(),[d,h]=D.useState(!1);D.useEffect(()=>{(async()=>{const{data:{session:p}}=await se.auth.getSession();if(p){const{data:_,error:g}=await se.from("employees").select("*").eq("id",p.user.id).single();g||(c(p.user),f(_.role),l("/dashboard"))}else t(""),n("")})()},[l,c,f]);async function m(v){v.preventDefault(),s(!0),o("");try{const{data:p,error:_}=await se.auth.signInWithPassword({email:e,password:r});if(_)throw _;const{data:g,error:y}=await se.from("employees").select("*").eq("id",p.user.id).single();if(y)throw y;c(p.user),f(g.role),l("/dashboard")}catch(p){o(p.message)}finally{s(!1)}}return u.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx(Zc,{className:"w-12 h-12 text-blue-600"})}),u.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-8",children:"Login"}),i&&u.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:i}),u.jsxs("form",{onSubmit:m,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:e,onChange:v=>t(v.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:d?"text":"password",value:r,onChange:v=>n(v.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),u.jsx("button",{type:"button",className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",onClick:()=>h(!d),children:d?"Hide":"Show"})]})]}),u.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:a?"Logging in...":"Login"})]})]})})}function ds(e){"@babel/helpers - typeof";return ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ds(e)}function t6(e,t){if(ds(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ds(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rC(e){var t=t6(e,"string");return ds(t)=="symbol"?t:t+""}function Oi(e,t,r){return(t=rC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ww(Object(r),!0).forEach(function(n){Oi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ww(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zh(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Oa(e,t){if(e==null)return{};var r,n,a=zh(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Yt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rC(n.key),n)}}function Gt(e,t,r){return t&&Vw(e.prototype,t),r&&Vw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I0(e){return I0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I0(e)}function nC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nC=function(){return!!e})()}function r6(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n6(e,t){if(t&&(ds(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r6(e)}function Er(e,t,r){return t=I0(t),n6(e,nC()?Reflect.construct(t,r||[],I0(e).constructor):t.apply(e,r))}function L0(e,t){return L0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},L0(e,t)}function kr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L0(e,t)}function aC(e){if(Array.isArray(e))return e}function a6(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,a=f}finally{try{if(!l&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}function ig(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function r1(e,t){if(e){if(typeof e=="string")return ig(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ig(e,t):void 0}}function sC(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bn(e,t){return aC(e)||a6(e,t)||r1(e,t)||sC()}function iC(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=iC(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Ct(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=iC(e))&&(n&&(n+=" "),n+=t);return n}function kt(){return kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kt.apply(null,arguments)}var s6=function(e,t,r,n,a,s,i,o){if(!e){var l;if(t===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,a,s,i,o],f=0;l=new Error(t.replace(/%s/g,function(){return c[f++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},i6=s6;const Ru=Sr(i6);var o6=function(){};function l6(e,t){var r={};return Object.keys(e).forEach(function(n){r[Xd(n)]=o6}),r}function Hw(e,t){return e[t]!==void 0}function Xd(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function c6(e){return!!e&&(typeof e!="function"||e.prototype&&e.prototype.isReactComponent)}function u6(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,L0(e,t)}function oC(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function lC(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function cC(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}oC.__suppressDeprecationWarning=!0;lC.__suppressDeprecationWarning=!0;cC.__suppressDeprecationWarning=!0;function f6(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,a=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),r!==null||n!==null||a!==null){var s=e.displayName||e.name,i=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+i+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=oC,t.componentWillReceiveProps=lC),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=cC;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,f,d){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:d;o.call(this,c,f,h)}}return e}var d6="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function uC(e,t,r){r===void 0&&(r=[]);var n=e.displayName||e.name||"Component",a=c6(e),s=Object.keys(t),i=s.map(Xd);a||!r.length||Ru(!1);var o=function(c){u6(f,c);function f(){for(var h,m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];h=c.call.apply(c,[this].concat(v))||this,h.handlers=Object.create(null),s.forEach(function(g){var y=t[g],x=function(E){if(h.props[y]){var S;h._notifying=!0;for(var b=arguments.length,T=new Array(b>1?b-1:0),C=1;C<b;C++)T[C-1]=arguments[C];(S=h.props)[y].apply(S,[E].concat(T)),h._notifying=!1}h.unmounted||h.setState(function(F){var M,j=F.values;return{values:kt(Object.create(null),j,(M={},M[g]=E,M))}})};h.handlers[y]=x}),r.length&&(h.attachRef=function(g){h.inner=g});var _=Object.create(null);return s.forEach(function(g){_[g]=h.props[Xd(g)]}),h.state={values:_,prevProps:{}},h}var d=f.prototype;return d.shouldComponentUpdate=function(){return!this._notifying},f.getDerivedStateFromProps=function(m,v){var p=v.values,_=v.prevProps,g={values:kt(Object.create(null),p),prevProps:{}};return s.forEach(function(y){g.prevProps[y]=m[y],!Hw(m,y)&&Hw(_,y)&&(g.values[y]=m[Xd(y)])}),g},d.componentWillUnmount=function(){this.unmounted=!0},d.render=function(){var m=this,v=this.props,p=v.innerRef,_=zh(v,["innerRef"]);i.forEach(function(y){delete _[y]});var g={};return s.forEach(function(y){var x=m.props[y];g[y]=x!==void 0?x:m.state.values[y]}),Q.createElement(e,kt({},_,g,this.handlers,{ref:p||this.attachRef}))},f}(Q.Component);f6(o),o.displayName="Uncontrolled("+n+")",o.propTypes=kt({innerRef:function(){}},l6(t)),r.forEach(function(c){o.prototype[c]=function(){var d;return(d=this.inner)[c].apply(d,arguments)}});var l=o;return Q.forwardRef&&(l=Q.forwardRef(function(c,f){return Q.createElement(o,kt({},c,{innerRef:f,__source:{fileName:d6,lineNumber:128},__self:this}))}),l.propTypes=o.propTypes),l.ControlledComponent=e,l.deferControlTo=function(c,f,d){return f===void 0&&(f={}),uC(c,kt({},t,f),d)},l}var fC={exports:{}},h6="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",p6=h6,m6=p6;function dC(){}function hC(){}hC.resetWarningCache=dC;var v6=function(){function e(n,a,s,i,o,l){if(l!==m6){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:hC,resetWarningCache:dC};return r.PropTypes=r,r};fC.exports=v6();var g6=fC.exports;const ue=Sr(g6);var $0="milliseconds",Mu="seconds",Iu="minutes",Lu="hours",Ji="day",kl="week",$u="month",Qi="year",Zi="decade",eo="century",pC={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},x6={month:1,year:12,decade:10*12,century:100*12};function y6(e){return[31,_6(e),31,30,31,30,31,31,30,31,30,31]}function _6(e){return e%4===0&&e%100!==0||e%400===0?29:28}function sa(e,t,r){switch(e=new Date(e),r){case $0:case Mu:case Iu:case Lu:case Ji:case kl:return w6(e,t*pC[r]);case $u:case Qi:case Zi:case eo:return b6(e,t*x6[r])}throw new TypeError('Invalid units: "'+r+'"')}function w6(e,t){var r=new Date(+e+t);return S6(e,r)}function b6(e,t){var r=e.getFullYear(),n=e.getMonth(),a=e.getDate(),s=r*12+n+t,i=Math.trunc(s/12),o=s%12,l=Math.min(a,y6(i)[o]),c=new Date(e);return c.setFullYear(i),c.setDate(1),c.setMonth(o),c.setDate(l),c}function S6(e,t){var r=e.getTimezoneOffset(),n=t.getTimezoneOffset(),a=n-r;return new Date(+t+a*pC.minutes)}function Uu(e,t,r){return sa(e,-t,r)}function lr(e,t,r){switch(e=new Date(e),t){case eo:case Zi:case Qi:e=B0(e,0);case $u:e=yC(e,1);case kl:case Ji:e=Vu(e,0);case Lu:e=Tl(e,0);case Iu:e=Wu(e,0);case Mu:e=Bu(e,0)}return t===Zi&&(e=Uu(e,to(e)%10,"year")),t===eo&&(e=Uu(e,to(e)%100,"year")),t===kl&&(e=_C(e,0,r)),e}function U0(e,t,r){switch(e=new Date(e),e=lr(e,t,r),t){case eo:case Zi:case Qi:case $u:case kl:e=sa(e,1,t),e=Uu(e,1,Ji),e.setHours(23,59,59,999);break;case Ji:e.setHours(23,59,59,999);break;case Lu:case Iu:case Mu:e=sa(e,1,t),e=Uu(e,1,$0)}return e}var _f=Yl(function(e,t){return e===t}),n1=Yl(function(e,t){return e!==t}),Yh=Yl(function(e,t){return e>t}),wf=Yl(function(e,t){return e>=t}),a1=Yl(function(e,t){return e<t}),zl=Yl(function(e,t){return e<=t});function mC(){return new Date(Math.min.apply(Math,arguments))}function vC(){return new Date(Math.max.apply(Math,arguments))}function gC(e,t,r,n){return n=n||"day",(!t||wf(e,t,n))&&(!r||zl(e,r,n))}var Bu=vi("Milliseconds"),Wu=vi("Seconds"),Tl=vi("Minutes"),Vu=vi("Hours"),xC=vi("Day"),yC=vi("Date"),B0=vi("Month"),to=vi("FullYear");function E6(e,t){return t===void 0?to(lr(e,Zi)):sa(e,t+10,Qi)}function k6(e,t){return t===void 0?to(lr(e,eo)):sa(e,t+100,Qi)}function _C(e,t,r){var n=(xC(e)+7-(r||0))%7;return t===void 0?n:sa(e,t-n,Ji)}function T6(e,t,r,n){var a,s,i;switch(r){case $0:case Mu:case Iu:case Lu:case Ji:case kl:a=t.getTime()-e.getTime();break;case $u:case Qi:case Zi:case eo:a=(to(t)-to(e))*12+B0(t)-B0(e);break;default:throw new TypeError('Invalid units: "'+r+'"')}switch(r){case $0:s=1;break;case Mu:s=1e3;break;case Iu:s=1e3*60;break;case Lu:s=1e3*60*60;break;case Ji:s=1e3*60*60*24;break;case kl:s=1e3*60*60*24*7;break;case $u:s=1;break;case Qi:s=12;break;case Zi:s=120;break;case eo:s=1200;break;default:throw new TypeError('Invalid units: "'+r+'"')}return i=a/s,n?i:Math.round(i)}function vi(e){var t=function(r){switch(r){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(e);return function(r,n){if(n===void 0)return r["get"+e]();var a=new Date(r);return a["set"+e](n),t&&a["get"+e]()!=n&&(e==="Hours"||n>=t&&a.getHours()-r.getHours()<Math.floor(n/t))&&a["set"+e](n+t),a}}function Yl(e){return function(t,r,n){return e(+lr(t,n),+lr(r,n))}}const zw=Object.freeze(Object.defineProperty({__proto__:null,add:sa,century:k6,date:yC,day:xC,decade:E6,diff:T6,endOf:U0,eq:_f,gt:Yh,gte:wf,hours:Vu,inRange:gC,lt:a1,lte:zl,max:vC,milliseconds:Bu,min:mC,minutes:Tl,month:B0,neq:n1,seconds:Wu,startOf:lr,subtract:Uu,weekday:_C,year:to},Symbol.toStringTag,{value:"Module"}));function C6(e){if(Array.isArray(e))return ig(e)}function wC(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function N6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jd(e){return C6(e)||wC(e)||r1(e)||N6()}function A6(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(a);++n<a;)s[n]=e[n+t];return s}var bC=A6;function O6(e,t){return e===t||e!==e&&t!==t}var bf=O6,D6=typeof wt=="object"&&wt&&wt.Object===Object&&wt,SC=D6,j6=SC,P6=typeof self=="object"&&self&&self.Object===Object&&self,F6=j6||P6||Function("return this")(),Fa=F6,R6=Fa,M6=R6.Symbol,Gl=M6,Yw=Gl,EC=Object.prototype,I6=EC.hasOwnProperty,L6=EC.toString,bc=Yw?Yw.toStringTag:void 0;function $6(e){var t=I6.call(e,bc),r=e[bc];try{e[bc]=void 0;var n=!0}catch{}var a=L6.call(e);return n&&(t?e[bc]=r:delete e[bc]),a}var U6=$6,B6=Object.prototype,W6=B6.toString;function V6(e){return W6.call(e)}var H6=V6,Gw=Gl,z6=U6,Y6=H6,G6="[object Null]",K6="[object Undefined]",Kw=Gw?Gw.toStringTag:void 0;function q6(e){return e==null?e===void 0?K6:G6:Kw&&Kw in Object(e)?z6(e):Y6(e)}var Kl=q6;function X6(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var xs=X6,J6=Kl,Q6=xs,Z6="[object AsyncFunction]",eI="[object Function]",tI="[object GeneratorFunction]",rI="[object Proxy]";function nI(e){if(!Q6(e))return!1;var t=J6(e);return t==eI||t==tI||t==Z6||t==rI}var s1=nI,aI=9007199254740991;function sI(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=aI}var i1=sI,iI=s1,oI=i1;function lI(e){return e!=null&&oI(e.length)&&!iI(e)}var Sf=lI,cI=9007199254740991,uI=/^(?:0|[1-9]\d*)$/;function fI(e,t){var r=typeof e;return t=t??cI,!!t&&(r=="number"||r!="symbol"&&uI.test(e))&&e>-1&&e%1==0&&e<t}var o1=fI,dI=bf,hI=Sf,pI=o1,mI=xs;function vI(e,t,r){if(!mI(r))return!1;var n=typeof t;return(n=="number"?hI(r)&&pI(t,r.length):n=="string"&&t in r)?dI(r[t],e):!1}var Gh=vI,gI=/\s/;function xI(e){for(var t=e.length;t--&&gI.test(e.charAt(t)););return t}var yI=xI,_I=yI,wI=/^\s+/;function bI(e){return e&&e.slice(0,_I(e)+1).replace(wI,"")}var SI=bI;function EI(e){return e!=null&&typeof e=="object"}var gi=EI,kI=Kl,TI=gi,CI="[object Symbol]";function NI(e){return typeof e=="symbol"||TI(e)&&kI(e)==CI}var Ef=NI,AI=SI,qw=xs,OI=Ef,Xw=NaN,DI=/^[-+]0x[0-9a-f]+$/i,jI=/^0b[01]+$/i,PI=/^0o[0-7]+$/i,FI=parseInt;function RI(e){if(typeof e=="number")return e;if(OI(e))return Xw;if(qw(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=qw(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=AI(e);var r=jI.test(e);return r||PI.test(e)?FI(e.slice(2),r?2:8):DI.test(e)?Xw:+e}var MI=RI,II=MI,Jw=1/0,LI=17976931348623157e292;function $I(e){if(!e)return e===0?e:0;if(e=II(e),e===Jw||e===-Jw){var t=e<0?-1:1;return t*LI}return e===e?e:0}var kC=$I,UI=kC;function BI(e){var t=UI(e),r=t%1;return t===t?r?t-r:t:0}var TC=BI,WI=bC,VI=Gh,HI=TC,zI=Math.ceil,YI=Math.max;function GI(e,t,r){(r?VI(e,t,r):t===void 0)?t=1:t=YI(HI(t),0);var n=e==null?0:e.length;if(!n||t<1)return[];for(var a=0,s=0,i=Array(zI(n/t));a<n;)i[s++]=WI(e,a,a+=t);return i}var KI=GI;const qI=Sr(KI);function kf(e){return e&&e.ownerDocument||document}function XI(e){var t=kf(e);return t&&t.defaultView||window}function JI(e,t){return XI(e).getComputedStyle(e,t)}var QI=/([A-Z])/g;function ZI(e){return e.replace(QI,"-$1").toLowerCase()}var e8=/^ms-/;function vd(e){return ZI(e).replace(e8,"-ms-")}var t8=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function r8(e){return!!(e&&t8.test(e))}function Ro(e,t){var r="",n="";if(typeof t=="string")return e.style.getPropertyValue(vd(t))||JI(e).getPropertyValue(vd(t));Object.keys(t).forEach(function(a){var s=t[a];!s&&s!==0?e.style.removeProperty(vd(a)):r8(a)?n+=a+"("+s+") ":r+=vd(a)+": "+s+";"}),n&&(r+="transform: "+n+";"),e.style.cssText+=";"+r}function Hu(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function n8(e){return"nodeType"in e&&e.nodeType===document.DOCUMENT_NODE}function l1(e){return"window"in e&&e.window===e?e:n8(e)&&e.defaultView||!1}function CC(e){var t=e==="pageXOffset"?"scrollLeft":"scrollTop";function r(n,a){var s=l1(n);if(a===void 0)return s?s[e]:n[t];s?s.scrollTo(s[e],a):n[t]=a}return r}const NC=CC("pageXOffset"),AC=CC("pageYOffset");function $i(e){var t=kf(e),r={top:0,left:0,height:0,width:0},n=t&&t.documentElement;return!n||!Hu(n,e)||(e.getBoundingClientRect!==void 0&&(r=e.getBoundingClientRect()),r={top:r.top+AC(n)-(n.clientTop||0),left:r.left+NC(n)-(n.clientLeft||0),width:r.width,height:r.height}),r}var a8=function(t){return!!t&&"offsetParent"in t};function s8(e){for(var t=kf(e),r=e&&e.offsetParent;a8(r)&&r.nodeName!=="HTML"&&Ro(r,"position")==="static";)r=r.offsetParent;return r||t.documentElement}var i8=function(t){return t.nodeName&&t.nodeName.toLowerCase()};function OC(e,t){var r={top:0,left:0},n;if(Ro(e,"position")==="fixed")n=e.getBoundingClientRect();else{var a=t||s8(e);n=$i(e),i8(a)!=="html"&&(r=$i(a));var s=String(Ro(a,"borderTopWidth")||0);r.top+=parseInt(s,10)-AC(a)||0;var i=String(Ro(a,"borderLeftWidth")||0);r.left+=parseInt(i,10)-NC(a)||0}var o=String(Ro(e,"marginTop")||0),l=String(Ro(e,"marginLeft")||0);return kt({},n,{top:n.top-r.top-(parseInt(o,10)||0),left:n.left-r.left-(parseInt(l,10)||0)})}const c1=!!(typeof window<"u"&&window.document&&window.document.createElement);var Qw=new Date().getTime();function o8(e){var t=new Date().getTime(),r=Math.max(0,16-(t-Qw)),n=setTimeout(e,r);return Qw=t,n}var l8=["","webkit","moz","o","ms"],og="clearTimeout",lg=o8,Zw=function(t,r){return t+(t?r[0].toUpperCase()+r.substr(1):r)+"AnimationFrame"};c1&&l8.some(function(e){var t=Zw(e,"request");return t in window&&(og=Zw(e,"cancel"),lg=function(n){return window[t](n)}),!!lg});var e2=function(t){typeof window[og]=="function"&&window[og](t)},DC=lg,wm;function c8(e,t){if(!wm){var r=document.body,n=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;wm=function(s,i){return n.call(s,i)}}return wm(e,t)}var u8=Function.prototype.bind.call(Function.prototype.call,[].slice);function f8(e,t){return u8(e.querySelectorAll(t))}var cg=!1,ug=!1;try{var bm={get passive(){return cg=!0},get once(){return ug=cg=!0}};c1&&(window.addEventListener("test",bm,bm),window.removeEventListener("test",bm,!0))}catch{}function d8(e,t,r,n){if(n&&typeof n!="boolean"&&!ug){var a=n.once,s=n.capture,i=r;!ug&&a&&(i=r.__once||function o(l){this.removeEventListener(t,o,s),r.call(this,l)},r.__once=i),e.addEventListener(t,i,cg?n:s)}e.addEventListener(t,r,n)}function h8(e){const t=D.useRef(e);return D.useEffect(()=>{t.current=e},[e]),t}function t2(e){const t=h8(e);return D.useCallback(function(...r){return t.current&&t.current(...r)},[t])}function r2(){return D.useState(null)}function p8(){const e=D.useRef(!0),t=D.useRef(()=>e.current);return D.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function m8(e){const t=p8();return[e[0],D.useCallback(r=>{if(t())return e[1](r)},[t,e[1]])]}var Gr="top",jn="bottom",Pn="right",Kr="left",u1="auto",Tf=[Gr,jn,Pn,Kr],Cl="start",zu="end",v8="clippingParents",jC="viewport",Sc="popper",g8="reference",n2=Tf.reduce(function(e,t){return e.concat([t+"-"+Cl,t+"-"+zu])},[]),f1=[].concat(Tf,[u1]).reduce(function(e,t){return e.concat([t,t+"-"+Cl,t+"-"+zu])},[]),x8="beforeRead",y8="read",_8="afterRead",w8="beforeMain",b8="main",S8="afterMain",E8="beforeWrite",k8="write",T8="afterWrite",C8=[x8,y8,_8,w8,b8,S8,E8,k8,T8];function ka(e){return e.split("-")[0]}function ln(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ro(e){var t=ln(e).Element;return e instanceof t||e instanceof Element}function Ta(e){var t=ln(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function d1(e){if(typeof ShadowRoot>"u")return!1;var t=ln(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var Ui=Math.max,W0=Math.min,Nl=Math.round;function fg(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function PC(){return!/^((?!chrome|android).)*safari/i.test(fg())}function Al(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,s=1;t&&Ta(e)&&(a=e.offsetWidth>0&&Nl(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&Nl(n.height)/e.offsetHeight||1);var i=ro(e)?ln(e):window,o=i.visualViewport,l=!PC()&&r,c=(n.left+(l&&o?o.offsetLeft:0))/a,f=(n.top+(l&&o?o.offsetTop:0))/s,d=n.width/a,h=n.height/s;return{width:d,height:h,top:f,right:c+d,bottom:f+h,left:c,x:c,y:f}}function h1(e){var t=Al(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function FC(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&d1(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function si(e){return e?(e.nodeName||"").toLowerCase():null}function hs(e){return ln(e).getComputedStyle(e)}function N8(e){return["table","td","th"].indexOf(si(e))>=0}function xi(e){return((ro(e)?e.ownerDocument:e.document)||window.document).documentElement}function Kh(e){return si(e)==="html"?e:e.assignedSlot||e.parentNode||(d1(e)?e.host:null)||xi(e)}function a2(e){return!Ta(e)||hs(e).position==="fixed"?null:e.offsetParent}function A8(e){var t=/firefox/i.test(fg()),r=/Trident/i.test(fg());if(r&&Ta(e)){var n=hs(e);if(n.position==="fixed")return null}var a=Kh(e);for(d1(a)&&(a=a.host);Ta(a)&&["html","body"].indexOf(si(a))<0;){var s=hs(a);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return a;a=a.parentNode}return null}function Cf(e){for(var t=ln(e),r=a2(e);r&&N8(r)&&hs(r).position==="static";)r=a2(r);return r&&(si(r)==="html"||si(r)==="body"&&hs(r).position==="static")?t:r||A8(e)||t}function p1(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function tu(e,t,r){return Ui(e,W0(t,r))}function O8(e,t,r){var n=tu(e,t,r);return n>r?r:n}function RC(){return{top:0,right:0,bottom:0,left:0}}function MC(e){return Object.assign({},RC(),e)}function IC(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var D8=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,MC(typeof t!="number"?t:IC(t,Tf))};function j8(e){var t,r=e.state,n=e.name,a=e.options,s=r.elements.arrow,i=r.modifiersData.popperOffsets,o=ka(r.placement),l=p1(o),c=[Kr,Pn].indexOf(o)>=0,f=c?"height":"width";if(!(!s||!i)){var d=D8(a.padding,r),h=h1(s),m=l==="y"?Gr:Kr,v=l==="y"?jn:Pn,p=r.rects.reference[f]+r.rects.reference[l]-i[l]-r.rects.popper[f],_=i[l]-r.rects.reference[l],g=Cf(s),y=g?l==="y"?g.clientHeight||0:g.clientWidth||0:0,x=p/2-_/2,w=d[m],E=y-h[f]-d[v],S=y/2-h[f]/2+x,b=tu(w,S,E),T=l;r.modifiersData[n]=(t={},t[T]=b,t.centerOffset=b-S,t)}}function P8(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||FC(t.elements.popper,a)&&(t.elements.arrow=a))}const F8={name:"arrow",enabled:!0,phase:"main",fn:j8,effect:P8,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ol(e){return e.split("-")[1]}var R8={top:"auto",right:"auto",bottom:"auto",left:"auto"};function M8(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:Nl(r*a)/a||0,y:Nl(n*a)/a||0}}function s2(e){var t,r=e.popper,n=e.popperRect,a=e.placement,s=e.variation,i=e.offsets,o=e.position,l=e.gpuAcceleration,c=e.adaptive,f=e.roundOffsets,d=e.isFixed,h=i.x,m=h===void 0?0:h,v=i.y,p=v===void 0?0:v,_=typeof f=="function"?f({x:m,y:p}):{x:m,y:p};m=_.x,p=_.y;var g=i.hasOwnProperty("x"),y=i.hasOwnProperty("y"),x=Kr,w=Gr,E=window;if(c){var S=Cf(r),b="clientHeight",T="clientWidth";if(S===ln(r)&&(S=xi(r),hs(S).position!=="static"&&o==="absolute"&&(b="scrollHeight",T="scrollWidth")),S=S,a===Gr||(a===Kr||a===Pn)&&s===zu){w=jn;var C=d&&S===E&&E.visualViewport?E.visualViewport.height:S[b];p-=C-n.height,p*=l?1:-1}if(a===Kr||(a===Gr||a===jn)&&s===zu){x=Pn;var F=d&&S===E&&E.visualViewport?E.visualViewport.width:S[T];m-=F-n.width,m*=l?1:-1}}var M=Object.assign({position:o},c&&R8),j=f===!0?M8({x:m,y:p},ln(r)):{x:m,y:p};if(m=j.x,p=j.y,l){var A;return Object.assign({},M,(A={},A[w]=y?"0":"",A[x]=g?"0":"",A.transform=(E.devicePixelRatio||1)<=1?"translate("+m+"px, "+p+"px)":"translate3d("+m+"px, "+p+"px, 0)",A))}return Object.assign({},M,(t={},t[w]=y?p+"px":"",t[x]=g?m+"px":"",t.transform="",t))}function I8(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,s=r.adaptive,i=s===void 0?!0:s,o=r.roundOffsets,l=o===void 0?!0:o,c={placement:ka(t.placement),variation:Ol(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,s2(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,s2(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const L8={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:I8,data:{}};var gd={passive:!0};function $8(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,s=a===void 0?!0:a,i=n.resize,o=i===void 0?!0:i,l=ln(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(f){f.addEventListener("scroll",r.update,gd)}),o&&l.addEventListener("resize",r.update,gd),function(){s&&c.forEach(function(f){f.removeEventListener("scroll",r.update,gd)}),o&&l.removeEventListener("resize",r.update,gd)}}const U8={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:$8,data:{}};var B8={left:"right",right:"left",bottom:"top",top:"bottom"};function Qd(e){return e.replace(/left|right|bottom|top/g,function(t){return B8[t]})}var W8={start:"end",end:"start"};function i2(e){return e.replace(/start|end/g,function(t){return W8[t]})}function m1(e){var t=ln(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function v1(e){return Al(xi(e)).left+m1(e).scrollLeft}function V8(e,t){var r=ln(e),n=xi(e),a=r.visualViewport,s=n.clientWidth,i=n.clientHeight,o=0,l=0;if(a){s=a.width,i=a.height;var c=PC();(c||!c&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:s,height:i,x:o+v1(e),y:l}}function H8(e){var t,r=xi(e),n=m1(e),a=(t=e.ownerDocument)==null?void 0:t.body,s=Ui(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),i=Ui(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),o=-n.scrollLeft+v1(e),l=-n.scrollTop;return hs(a||r).direction==="rtl"&&(o+=Ui(r.clientWidth,a?a.clientWidth:0)-s),{width:s,height:i,x:o,y:l}}function g1(e){var t=hs(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function LC(e){return["html","body","#document"].indexOf(si(e))>=0?e.ownerDocument.body:Ta(e)&&g1(e)?e:LC(Kh(e))}function ru(e,t){var r;t===void 0&&(t=[]);var n=LC(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),s=ln(n),i=a?[s].concat(s.visualViewport||[],g1(n)?n:[]):n,o=t.concat(i);return a?o:o.concat(ru(Kh(i)))}function dg(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function z8(e,t){var r=Al(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function o2(e,t,r){return t===jC?dg(V8(e,r)):ro(t)?z8(t,r):dg(H8(xi(e)))}function Y8(e){var t=ru(Kh(e)),r=["absolute","fixed"].indexOf(hs(e).position)>=0,n=r&&Ta(e)?Cf(e):e;return ro(n)?t.filter(function(a){return ro(a)&&FC(a,n)&&si(a)!=="body"}):[]}function G8(e,t,r,n){var a=t==="clippingParents"?Y8(e):[].concat(t),s=[].concat(a,[r]),i=s[0],o=s.reduce(function(l,c){var f=o2(e,c,n);return l.top=Ui(f.top,l.top),l.right=W0(f.right,l.right),l.bottom=W0(f.bottom,l.bottom),l.left=Ui(f.left,l.left),l},o2(e,i,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function $C(e){var t=e.reference,r=e.element,n=e.placement,a=n?ka(n):null,s=n?Ol(n):null,i=t.x+t.width/2-r.width/2,o=t.y+t.height/2-r.height/2,l;switch(a){case Gr:l={x:i,y:t.y-r.height};break;case jn:l={x:i,y:t.y+t.height};break;case Pn:l={x:t.x+t.width,y:o};break;case Kr:l={x:t.x-r.width,y:o};break;default:l={x:t.x,y:t.y}}var c=a?p1(a):null;if(c!=null){var f=c==="y"?"height":"width";switch(s){case Cl:l[c]=l[c]-(t[f]/2-r[f]/2);break;case zu:l[c]=l[c]+(t[f]/2-r[f]/2);break}}return l}function Yu(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,s=r.strategy,i=s===void 0?e.strategy:s,o=r.boundary,l=o===void 0?v8:o,c=r.rootBoundary,f=c===void 0?jC:c,d=r.elementContext,h=d===void 0?Sc:d,m=r.altBoundary,v=m===void 0?!1:m,p=r.padding,_=p===void 0?0:p,g=MC(typeof _!="number"?_:IC(_,Tf)),y=h===Sc?g8:Sc,x=e.rects.popper,w=e.elements[v?y:h],E=G8(ro(w)?w:w.contextElement||xi(e.elements.popper),l,f,i),S=Al(e.elements.reference),b=$C({reference:S,element:x,strategy:"absolute",placement:a}),T=dg(Object.assign({},x,b)),C=h===Sc?T:S,F={top:E.top-C.top+g.top,bottom:C.bottom-E.bottom+g.bottom,left:E.left-C.left+g.left,right:C.right-E.right+g.right},M=e.modifiersData.offset;if(h===Sc&&M){var j=M[a];Object.keys(F).forEach(function(A){var G=[Pn,jn].indexOf(A)>=0?1:-1,X=[Gr,jn].indexOf(A)>=0?"y":"x";F[A]+=j[X]*G})}return F}function K8(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,s=r.rootBoundary,i=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,c=l===void 0?f1:l,f=Ol(n),d=f?o?n2:n2.filter(function(v){return Ol(v)===f}):Tf,h=d.filter(function(v){return c.indexOf(v)>=0});h.length===0&&(h=d);var m=h.reduce(function(v,p){return v[p]=Yu(e,{placement:p,boundary:a,rootBoundary:s,padding:i})[ka(p)],v},{});return Object.keys(m).sort(function(v,p){return m[v]-m[p]})}function q8(e){if(ka(e)===u1)return[];var t=Qd(e);return[i2(e),t,i2(t)]}function X8(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,o=i===void 0?!0:i,l=r.fallbackPlacements,c=r.padding,f=r.boundary,d=r.rootBoundary,h=r.altBoundary,m=r.flipVariations,v=m===void 0?!0:m,p=r.allowedAutoPlacements,_=t.options.placement,g=ka(_),y=g===_,x=l||(y||!v?[Qd(_)]:q8(_)),w=[_].concat(x).reduce(function(N,P){return N.concat(ka(P)===u1?K8(t,{placement:P,boundary:f,rootBoundary:d,padding:c,flipVariations:v,allowedAutoPlacements:p}):P)},[]),E=t.rects.reference,S=t.rects.popper,b=new Map,T=!0,C=w[0],F=0;F<w.length;F++){var M=w[F],j=ka(M),A=Ol(M)===Cl,G=[Gr,jn].indexOf(j)>=0,X=G?"width":"height",H=Yu(t,{placement:M,boundary:f,rootBoundary:d,altBoundary:h,padding:c}),q=G?A?Pn:Kr:A?jn:Gr;E[X]>S[X]&&(q=Qd(q));var Z=Qd(q),Y=[];if(s&&Y.push(H[j]<=0),o&&Y.push(H[q]<=0,H[Z]<=0),Y.every(function(N){return N})){C=M,T=!1;break}b.set(M,Y)}if(T)for(var ce=v?3:1,z=function(P){var K=w.find(function(ne){var J=b.get(ne);if(J)return J.slice(0,P).every(function(ie){return ie})});if(K)return C=K,"break"},k=ce;k>0;k--){var I=z(k);if(I==="break")break}t.placement!==C&&(t.modifiersData[n]._skip=!0,t.placement=C,t.reset=!0)}}const J8={name:"flip",enabled:!0,phase:"main",fn:X8,requiresIfExists:["offset"],data:{_skip:!1}};function l2(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function c2(e){return[Gr,Pn,jn,Kr].some(function(t){return e[t]>=0})}function Q8(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,s=t.modifiersData.preventOverflow,i=Yu(t,{elementContext:"reference"}),o=Yu(t,{altBoundary:!0}),l=l2(i,n),c=l2(o,a,s),f=c2(l),d=c2(c);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:f,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":d})}const Z8={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Q8};function eL(e,t,r){var n=ka(e),a=[Kr,Gr].indexOf(n)>=0?-1:1,s=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,i=s[0],o=s[1];return i=i||0,o=(o||0)*a,[Kr,Pn].indexOf(n)>=0?{x:o,y:i}:{x:i,y:o}}function tL(e){var t=e.state,r=e.options,n=e.name,a=r.offset,s=a===void 0?[0,0]:a,i=f1.reduce(function(f,d){return f[d]=eL(d,t.rects,s),f},{}),o=i[t.placement],l=o.x,c=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=i}const rL={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tL};function nL(e){var t=e.state,r=e.name;t.modifiersData[r]=$C({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const aL={name:"popperOffsets",enabled:!0,phase:"read",fn:nL,data:{}};function sL(e){return e==="x"?"y":"x"}function iL(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,o=i===void 0?!1:i,l=r.boundary,c=r.rootBoundary,f=r.altBoundary,d=r.padding,h=r.tether,m=h===void 0?!0:h,v=r.tetherOffset,p=v===void 0?0:v,_=Yu(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:f}),g=ka(t.placement),y=Ol(t.placement),x=!y,w=p1(g),E=sL(w),S=t.modifiersData.popperOffsets,b=t.rects.reference,T=t.rects.popper,C=typeof p=="function"?p(Object.assign({},t.rects,{placement:t.placement})):p,F=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),M=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,j={x:0,y:0};if(S){if(s){var A,G=w==="y"?Gr:Kr,X=w==="y"?jn:Pn,H=w==="y"?"height":"width",q=S[w],Z=q+_[G],Y=q-_[X],ce=m?-T[H]/2:0,z=y===Cl?b[H]:T[H],k=y===Cl?-T[H]:-b[H],I=t.elements.arrow,N=m&&I?h1(I):{width:0,height:0},P=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:RC(),K=P[G],ne=P[X],J=tu(0,b[H],N[H]),ie=x?b[H]/2-ce-J-K-F.mainAxis:z-J-K-F.mainAxis,oe=x?-b[H]/2+ce+J+ne+F.mainAxis:k+J+ne+F.mainAxis,Se=t.elements.arrow&&Cf(t.elements.arrow),W=Se?w==="y"?Se.clientTop||0:Se.clientLeft||0:0,Ne=(A=M==null?void 0:M[w])!=null?A:0,ke=q+ie-Ne-W,Xe=q+oe-Ne,Oe=tu(m?W0(Z,ke):Z,q,m?Ui(Y,Xe):Y);S[w]=Oe,j[w]=Oe-q}if(o){var me,tt=w==="x"?Gr:Kr,cr=w==="x"?jn:Pn,gt=S[E],Ir=E==="y"?"height":"width",Ss=gt+_[tt],Un=gt-_[cr],er=[Gr,Kr].indexOf(g)!==-1,pn=(me=M==null?void 0:M[E])!=null?me:0,Bn=er?Ss:gt-b[Ir]-T[Ir]-pn+F.altAxis,Es=er?gt+b[Ir]+T[Ir]-pn-F.altAxis:Un,Kt=m&&er?O8(Bn,gt,Es):tu(m?Bn:Ss,gt,m?Es:Un);S[E]=Kt,j[E]=Kt-gt}t.modifiersData[n]=j}}const oL={name:"preventOverflow",enabled:!0,phase:"main",fn:iL,requiresIfExists:["offset"]};function lL(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function cL(e){return e===ln(e)||!Ta(e)?m1(e):lL(e)}function uL(e){var t=e.getBoundingClientRect(),r=Nl(t.width)/e.offsetWidth||1,n=Nl(t.height)/e.offsetHeight||1;return r!==1||n!==1}function fL(e,t,r){r===void 0&&(r=!1);var n=Ta(t),a=Ta(t)&&uL(t),s=xi(t),i=Al(e,a,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((si(t)!=="body"||g1(s))&&(o=cL(t)),Ta(t)?(l=Al(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=v1(s))),{x:i.left+o.scrollLeft-l.x,y:i.top+o.scrollTop-l.y,width:i.width,height:i.height}}function dL(e){var t=new Map,r=new Set,n=[];e.forEach(function(s){t.set(s.name,s)});function a(s){r.add(s.name);var i=[].concat(s.requires||[],s.requiresIfExists||[]);i.forEach(function(o){if(!r.has(o)){var l=t.get(o);l&&a(l)}}),n.push(s)}return e.forEach(function(s){r.has(s.name)||a(s)}),n}function hL(e){var t=dL(e);return C8.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function pL(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function mL(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var u2={placement:"bottom",modifiers:[],strategy:"absolute"};function f2(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function vL(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,s=a===void 0?u2:a;return function(o,l,c){c===void 0&&(c=s);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},u2,s),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},d=[],h=!1,m={state:f,setOptions:function(g){var y=typeof g=="function"?g(f.options):g;p(),f.options=Object.assign({},s,f.options,y),f.scrollParents={reference:ro(o)?ru(o):o.contextElement?ru(o.contextElement):[],popper:ru(l)};var x=hL(mL([].concat(n,f.options.modifiers)));return f.orderedModifiers=x.filter(function(w){return w.enabled}),v(),m.update()},forceUpdate:function(){if(!h){var g=f.elements,y=g.reference,x=g.popper;if(f2(y,x)){f.rects={reference:fL(y,Cf(x),f.options.strategy==="fixed"),popper:h1(x)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(F){return f.modifiersData[F.name]=Object.assign({},F.data)});for(var w=0;w<f.orderedModifiers.length;w++){if(f.reset===!0){f.reset=!1,w=-1;continue}var E=f.orderedModifiers[w],S=E.fn,b=E.options,T=b===void 0?{}:b,C=E.name;typeof S=="function"&&(f=S({state:f,options:T,name:C,instance:m})||f)}}}},update:pL(function(){return new Promise(function(_){m.forceUpdate(),_(f)})}),destroy:function(){p(),h=!0}};if(!f2(o,l))return m;m.setOptions(c).then(function(_){!h&&c.onFirstUpdate&&c.onFirstUpdate(_)});function v(){f.orderedModifiers.forEach(function(_){var g=_.name,y=_.options,x=y===void 0?{}:y,w=_.effect;if(typeof w=="function"){var E=w({state:f,name:g,instance:m,options:x}),S=function(){};d.push(E||S)}})}function p(){d.forEach(function(_){return _()}),d=[]}return m}}var gL=vL({defaultModifiers:[Z8,aL,L8,U8,rL,J8,oL,F8]}),d2=function(t){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},xL={name:"applyStyles",enabled:!1},yL={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(t){var r=t.state;return function(){var n=r.elements,a=n.reference,s=n.popper;if("removeAttribute"in a){var i=(a.getAttribute("aria-describedby")||"").split(",").filter(function(o){return o.trim()!==s.id});i.length?a.setAttribute("aria-describedby",i.join(",")):a.removeAttribute("aria-describedby")}}},fn:function(t){var r,n=t.state,a=n.elements,s=a.popper,i=a.reference,o=(r=s.getAttribute("role"))==null?void 0:r.toLowerCase();if(s.id&&o==="tooltip"&&"setAttribute"in i){var l=i.getAttribute("aria-describedby");if(l&&l.split(",").indexOf(s.id)!==-1)return;i.setAttribute("aria-describedby",l?l+","+s.id:s.id)}}},_L=[];function wL(e,t,r){var n=r===void 0?{}:r,a=n.enabled,s=a===void 0?!0:a,i=n.placement,o=i===void 0?"bottom":i,l=n.strategy,c=l===void 0?"absolute":l,f=n.modifiers,d=f===void 0?_L:f,h=zh(n,["enabled","placement","strategy","modifiers"]),m=D.useRef(),v=D.useCallback(function(){var w;(w=m.current)==null||w.update()},[]),p=D.useCallback(function(){var w;(w=m.current)==null||w.forceUpdate()},[]),_=m8(D.useState({placement:o,update:v,forceUpdate:p,attributes:{},styles:{popper:d2(c),arrow:{}}})),g=_[0],y=_[1],x=D.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(E){var S=E.state,b={},T={};Object.keys(S.elements).forEach(function(C){b[C]=S.styles[C],T[C]=S.attributes[C]}),y({state:S,styles:b,attributes:T,update:v,forceUpdate:p,placement:S.placement})}}},[v,p,y]);return D.useEffect(function(){!m.current||!s||m.current.setOptions({placement:o,strategy:c,modifiers:[].concat(d,[x,xL])})},[c,o,x,s]),D.useEffect(function(){if(!(!s||e==null||t==null))return m.current=gL(e,t,kt({},h,{placement:o,strategy:c,modifiers:[].concat(d,[yL,x])})),function(){m.current!=null&&(m.current.destroy(),m.current=void 0,y(function(w){return kt({},w,{attributes:{},styles:{popper:d2(c)}})}))}},[s,e,t]),g}function bL(e,t,r,n){var a=n&&typeof n!="boolean"?n.capture:n;e.removeEventListener(t,r,a),r.__once&&e.removeEventListener(t,r.__once,a)}function Mc(e,t,r,n){return d8(e,t,r,n),function(){bL(e,t,r,n)}}var SL=function(){},EL=SL;const kL=Sr(EL);function TL(e){return e&&"setState"in e?dT.findDOMNode(e):e??null}const CL=function(e){return kf(TL(e))};var NL=27,h2=function(){};function AL(e){return e.button===0}function OL(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var p2=function(t){return t&&("current"in t?t.current:t)};function DL(e,t,r){var n=r===void 0?{}:r,a=n.disabled,s=n.clickTrigger,i=s===void 0?"click":s,o=D.useRef(!1),l=t||h2,c=D.useCallback(function(h){var m,v=p2(e);kL(!!v,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),o.current=!v||OL(h)||!AL(h)||!!Hu(v,(m=h.composedPath==null?void 0:h.composedPath()[0])!=null?m:h.target)},[e]),f=t2(function(h){o.current||l(h)}),d=t2(function(h){h.keyCode===NL&&l(h)});D.useEffect(function(){if(!(a||e==null)){var h=window.event,m=CL(p2(e)),v=Mc(m,i,c,!0),p=Mc(m,i,function(y){if(y===h){h=void 0;return}f(y)}),_=Mc(m,"keyup",function(y){if(y===h){h=void 0;return}d(y)}),g=[];return"ontouchstart"in m.documentElement&&(g=[].slice.call(m.body.children).map(function(y){return Mc(y,"mousemove",h2)})),function(){v(),p(),_(),g.forEach(function(y){return y()})}}},[e,a,i,c,f,d])}function jL(e){var t={};return Array.isArray(e)?(e==null||e.forEach(function(r){t[r.name]=r}),t):e||t}function PL(e){return e===void 0&&(e={}),Array.isArray(e)?e:Object.keys(e).map(function(t){return e[t].name=t,e[t]})}function FL(e){var t,r,n,a,s=e.enabled,i=e.enableEvents,o=e.placement,l=e.flip,c=e.offset,f=e.fixed,d=e.containerPadding,h=e.arrowElement,m=e.popperConfig,v=m===void 0?{}:m,p=jL(v.modifiers);return kt({},v,{placement:o,enabled:s,strategy:f?"fixed":v.strategy,modifiers:PL(kt({},p,{eventListeners:{enabled:i},preventOverflow:kt({},p.preventOverflow,{options:d?kt({padding:d},(t=p.preventOverflow)==null?void 0:t.options):(r=p.preventOverflow)==null?void 0:r.options}),offset:{options:kt({offset:c},(n=p.offset)==null?void 0:n.options)},arrow:kt({},p.arrow,{enabled:!!h,options:kt({},(a=p.arrow)==null?void 0:a.options,{element:h})}),flip:kt({enabled:!!l},p.flip)}))})}function RL(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function ML(e,t){e.classList?e.classList.add(t):RL(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}function m2(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function IL(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=m2(e.className,t):e.setAttribute("class",m2(e.className&&e.className.baseVal||"",t))}var xd;function x1(e){if((!xd&&xd!==0||e)&&c1){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),xd=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return xd}var Sm=function(t){var r;return typeof document>"u"?null:t==null?kf().body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),(r=t)!=null&&r.nodeType&&t||null)};function v2(e,t){var r=D.useState(function(){return Sm(e)}),n=r[0],a=r[1];if(!n){var s=Sm(e);s&&a(s)}return D.useEffect(function(){},[t,n]),D.useEffect(function(){var i=Sm(e);i!==n&&a(i)},[e,n]),n}const g2=e=>!e||typeof e=="function"?e:t=>{e.current=t};function LL(e,t){const r=g2(e),n=g2(t);return a=>{r&&r(a),n&&n(a)}}function $L(e,t){return D.useMemo(()=>LL(e,t),[e,t])}var y1=Q.forwardRef(function(e,t){var r=e.flip,n=e.offset,a=e.placement,s=e.containerPadding,i=s===void 0?5:s,o=e.popperConfig,l=o===void 0?{}:o,c=e.transition,f=r2(),d=f[0],h=f[1],m=r2(),v=m[0],p=m[1],_=$L(h,t),g=v2(e.container),y=v2(e.target),x=D.useState(!e.show),w=x[0],E=x[1],S=wL(y,d,FL({placement:a,enableEvents:!!e.show,containerPadding:i||5,flip:r,offset:n,arrowElement:v,popperConfig:l})),b=S.styles,T=S.attributes,C=zh(S,["styles","attributes"]);e.show?w&&E(!1):!e.transition&&!w&&E(!0);var F=function(){E(!0),e.onExited&&e.onExited.apply(e,arguments)},M=e.show||c&&!w;if(DL(d,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!M)return null;var j=e.children(kt({},C,{show:!!e.show,props:kt({},T.popper,{style:b.popper,ref:_}),arrowProps:kt({},T.arrow,{style:b.arrow,ref:p})}));if(c){var A=e.onExit,G=e.onExiting,X=e.onEnter,H=e.onEntering,q=e.onEntered;j=Q.createElement(c,{in:e.show,appear:!0,onExit:A,onExiting:G,onExited:F,onEnter:X,onEntering:H,onEntered:q},j)}return g?dT.createPortal(j,g):null});y1.displayName="Overlay";y1.propTypes={show:ue.bool,placement:ue.oneOf(f1),target:ue.any,container:ue.any,flip:ue.bool,children:ue.func.isRequired,containerPadding:ue.number,popperConfig:ue.object,rootClose:ue.bool,rootCloseEvent:ue.oneOf(["click","mousedown"]),rootCloseDisabled:ue.bool,onHide:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];if(t.rootClose){var s;return(s=ue.func).isRequired.apply(s,[t].concat(n))}return ue.func.apply(ue,[t].concat(n))},transition:ue.elementType,onEnter:ue.func,onEntering:ue.func,onEntered:ue.func,onExit:ue.func,onExiting:ue.func,onExited:ue.func};function UL(){this.__data__=[],this.size=0}var BL=UL,WL=bf;function VL(e,t){for(var r=e.length;r--;)if(WL(e[r][0],t))return r;return-1}var qh=VL,HL=qh,zL=Array.prototype,YL=zL.splice;function GL(e){var t=this.__data__,r=HL(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():YL.call(t,r,1),--this.size,!0}var KL=GL,qL=qh;function XL(e){var t=this.__data__,r=qL(t,e);return r<0?void 0:t[r][1]}var JL=XL,QL=qh;function ZL(e){return QL(this.__data__,e)>-1}var e5=ZL,t5=qh;function r5(e,t){var r=this.__data__,n=t5(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var n5=r5,a5=BL,s5=KL,i5=JL,o5=e5,l5=n5;function ql(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ql.prototype.clear=a5;ql.prototype.delete=s5;ql.prototype.get=i5;ql.prototype.has=o5;ql.prototype.set=l5;var Xh=ql,c5=Xh;function u5(){this.__data__=new c5,this.size=0}var f5=u5;function d5(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var h5=d5;function p5(e){return this.__data__.get(e)}var m5=p5;function v5(e){return this.__data__.has(e)}var g5=v5,x5=Fa,y5=x5["__core-js_shared__"],_5=y5,Em=_5,x2=function(){var e=/[^.]+$/.exec(Em&&Em.keys&&Em.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function w5(e){return!!x2&&x2 in e}var b5=w5,S5=Function.prototype,E5=S5.toString;function k5(e){if(e!=null){try{return E5.call(e)}catch{}try{return e+""}catch{}}return""}var UC=k5,T5=s1,C5=b5,N5=xs,A5=UC,O5=/[\\^$.*+?()[\]{}|]/g,D5=/^\[object .+?Constructor\]$/,j5=Function.prototype,P5=Object.prototype,F5=j5.toString,R5=P5.hasOwnProperty,M5=RegExp("^"+F5.call(R5).replace(O5,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function I5(e){if(!N5(e)||C5(e))return!1;var t=T5(e)?M5:D5;return t.test(A5(e))}var L5=I5;function $5(e,t){return e==null?void 0:e[t]}var U5=$5,B5=L5,W5=U5;function V5(e,t){var r=W5(e,t);return B5(r)?r:void 0}var mo=V5,H5=mo,z5=Fa,Y5=H5(z5,"Map"),_1=Y5,G5=mo,K5=G5(Object,"create"),Jh=K5,y2=Jh;function q5(){this.__data__=y2?y2(null):{},this.size=0}var X5=q5;function J5(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Q5=J5,Z5=Jh,e$="__lodash_hash_undefined__",t$=Object.prototype,r$=t$.hasOwnProperty;function n$(e){var t=this.__data__;if(Z5){var r=t[e];return r===e$?void 0:r}return r$.call(t,e)?t[e]:void 0}var a$=n$,s$=Jh,i$=Object.prototype,o$=i$.hasOwnProperty;function l$(e){var t=this.__data__;return s$?t[e]!==void 0:o$.call(t,e)}var c$=l$,u$=Jh,f$="__lodash_hash_undefined__";function d$(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=u$&&t===void 0?f$:t,this}var h$=d$,p$=X5,m$=Q5,v$=a$,g$=c$,x$=h$;function Xl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xl.prototype.clear=p$;Xl.prototype.delete=m$;Xl.prototype.get=v$;Xl.prototype.has=g$;Xl.prototype.set=x$;var y$=Xl,_2=y$,_$=Xh,w$=_1;function b$(){this.size=0,this.__data__={hash:new _2,map:new(w$||_$),string:new _2}}var S$=b$;function E$(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var k$=E$,T$=k$;function C$(e,t){var r=e.__data__;return T$(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Qh=C$,N$=Qh;function A$(e){var t=N$(this,e).delete(e);return this.size-=t?1:0,t}var O$=A$,D$=Qh;function j$(e){return D$(this,e).get(e)}var P$=j$,F$=Qh;function R$(e){return F$(this,e).has(e)}var M$=R$,I$=Qh;function L$(e,t){var r=I$(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var $$=L$,U$=S$,B$=O$,W$=P$,V$=M$,H$=$$;function Jl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Jl.prototype.clear=U$;Jl.prototype.delete=B$;Jl.prototype.get=W$;Jl.prototype.has=V$;Jl.prototype.set=H$;var w1=Jl,z$=Xh,Y$=_1,G$=w1,K$=200;function q$(e,t){var r=this.__data__;if(r instanceof z$){var n=r.__data__;if(!Y$||n.length<K$-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new G$(n)}return r.set(e,t),this.size=r.size,this}var X$=q$,J$=Xh,Q$=f5,Z$=h5,e7=m5,t7=g5,r7=X$;function Ql(e){var t=this.__data__=new J$(e);this.size=t.size}Ql.prototype.clear=Q$;Ql.prototype.delete=Z$;Ql.prototype.get=e7;Ql.prototype.has=t7;Ql.prototype.set=r7;var b1=Ql,n7="__lodash_hash_undefined__";function a7(e){return this.__data__.set(e,n7),this}var s7=a7;function i7(e){return this.__data__.has(e)}var o7=i7,l7=w1,c7=s7,u7=o7;function V0(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new l7;++t<r;)this.add(e[t])}V0.prototype.add=V0.prototype.push=c7;V0.prototype.has=u7;var f7=V0;function d7(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var h7=d7;function p7(e,t){return e.has(t)}var m7=p7,v7=f7,g7=h7,x7=m7,y7=1,_7=2;function w7(e,t,r,n,a,s){var i=r&y7,o=e.length,l=t.length;if(o!=l&&!(i&&l>o))return!1;var c=s.get(e),f=s.get(t);if(c&&f)return c==t&&f==e;var d=-1,h=!0,m=r&_7?new v7:void 0;for(s.set(e,t),s.set(t,e);++d<o;){var v=e[d],p=t[d];if(n)var _=i?n(p,v,d,t,e,s):n(v,p,d,e,t,s);if(_!==void 0){if(_)continue;h=!1;break}if(m){if(!g7(t,function(g,y){if(!x7(m,y)&&(v===g||a(v,g,r,n,s)))return m.push(y)})){h=!1;break}}else if(!(v===p||a(v,p,r,n,s))){h=!1;break}}return s.delete(e),s.delete(t),h}var BC=w7,b7=Fa,S7=b7.Uint8Array,WC=S7;function E7(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var k7=E7;function T7(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var C7=T7,w2=Gl,b2=WC,N7=bf,A7=BC,O7=k7,D7=C7,j7=1,P7=2,F7="[object Boolean]",R7="[object Date]",M7="[object Error]",I7="[object Map]",L7="[object Number]",$7="[object RegExp]",U7="[object Set]",B7="[object String]",W7="[object Symbol]",V7="[object ArrayBuffer]",H7="[object DataView]",S2=w2?w2.prototype:void 0,km=S2?S2.valueOf:void 0;function z7(e,t,r,n,a,s,i){switch(r){case H7:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case V7:return!(e.byteLength!=t.byteLength||!s(new b2(e),new b2(t)));case F7:case R7:case L7:return N7(+e,+t);case M7:return e.name==t.name&&e.message==t.message;case $7:case B7:return e==t+"";case I7:var o=O7;case U7:var l=n&j7;if(o||(o=D7),e.size!=t.size&&!l)return!1;var c=i.get(e);if(c)return c==t;n|=P7,i.set(e,t);var f=A7(o(e),o(t),n,a,s,i);return i.delete(e),f;case W7:if(km)return km.call(e)==km.call(t)}return!1}var Y7=z7;function G7(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var S1=G7,K7=Array.isArray,Mn=K7,q7=S1,X7=Mn;function J7(e,t,r){var n=t(e);return X7(e)?n:q7(n,r(e))}var VC=J7;function Q7(e,t){for(var r=-1,n=e==null?0:e.length,a=0,s=[];++r<n;){var i=e[r];t(i,r,e)&&(s[a++]=i)}return s}var Z7=Q7;function eU(){return[]}var HC=eU,tU=Z7,rU=HC,nU=Object.prototype,aU=nU.propertyIsEnumerable,E2=Object.getOwnPropertySymbols,sU=E2?function(e){return e==null?[]:(e=Object(e),tU(E2(e),function(t){return aU.call(e,t)}))}:rU,E1=sU;function iU(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var oU=iU,lU=Kl,cU=gi,uU="[object Arguments]";function fU(e){return cU(e)&&lU(e)==uU}var dU=fU,k2=dU,hU=gi,zC=Object.prototype,pU=zC.hasOwnProperty,mU=zC.propertyIsEnumerable,vU=k2(function(){return arguments}())?k2:function(e){return hU(e)&&pU.call(e,"callee")&&!mU.call(e,"callee")},k1=vU,H0={exports:{}};function gU(){return!1}var xU=gU;H0.exports;(function(e,t){var r=Fa,n=xU,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,o=i?r.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||n;e.exports=c})(H0,H0.exports);var Zh=H0.exports,yU=Kl,_U=i1,wU=gi,bU="[object Arguments]",SU="[object Array]",EU="[object Boolean]",kU="[object Date]",TU="[object Error]",CU="[object Function]",NU="[object Map]",AU="[object Number]",OU="[object Object]",DU="[object RegExp]",jU="[object Set]",PU="[object String]",FU="[object WeakMap]",RU="[object ArrayBuffer]",MU="[object DataView]",IU="[object Float32Array]",LU="[object Float64Array]",$U="[object Int8Array]",UU="[object Int16Array]",BU="[object Int32Array]",WU="[object Uint8Array]",VU="[object Uint8ClampedArray]",HU="[object Uint16Array]",zU="[object Uint32Array]",lt={};lt[IU]=lt[LU]=lt[$U]=lt[UU]=lt[BU]=lt[WU]=lt[VU]=lt[HU]=lt[zU]=!0;lt[bU]=lt[SU]=lt[RU]=lt[EU]=lt[MU]=lt[kU]=lt[TU]=lt[CU]=lt[NU]=lt[AU]=lt[OU]=lt[DU]=lt[jU]=lt[PU]=lt[FU]=!1;function YU(e){return wU(e)&&_U(e.length)&&!!lt[yU(e)]}var GU=YU;function KU(e){return function(t){return e(t)}}var ep=KU,z0={exports:{}};z0.exports;(function(e,t){var r=SC,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,i=s&&r.process,o=function(){try{var l=a&&a.require&&a.require("util").types;return l||i&&i.binding&&i.binding("util")}catch{}}();e.exports=o})(z0,z0.exports);var T1=z0.exports,qU=GU,XU=ep,T2=T1,C2=T2&&T2.isTypedArray,JU=C2?XU(C2):qU,C1=JU,QU=oU,ZU=k1,eB=Mn,tB=Zh,rB=o1,nB=C1,aB=Object.prototype,sB=aB.hasOwnProperty;function iB(e,t){var r=eB(e),n=!r&&ZU(e),a=!r&&!n&&tB(e),s=!r&&!n&&!a&&nB(e),i=r||n||a||s,o=i?QU(e.length,String):[],l=o.length;for(var c in e)(t||sB.call(e,c))&&!(i&&(c=="length"||a&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||rB(c,l)))&&o.push(c);return o}var YC=iB,oB=Object.prototype;function lB(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||oB;return e===r}var N1=lB;function cB(e,t){return function(r){return e(t(r))}}var GC=cB,uB=GC,fB=uB(Object.keys,Object),dB=fB,hB=N1,pB=dB,mB=Object.prototype,vB=mB.hasOwnProperty;function gB(e){if(!hB(e))return pB(e);var t=[];for(var r in Object(e))vB.call(e,r)&&r!="constructor"&&t.push(r);return t}var xB=gB,yB=YC,_B=xB,wB=Sf;function bB(e){return wB(e)?yB(e):_B(e)}var Nf=bB,SB=VC,EB=E1,kB=Nf;function TB(e){return SB(e,kB,EB)}var KC=TB,N2=KC,CB=1,NB=Object.prototype,AB=NB.hasOwnProperty;function OB(e,t,r,n,a,s){var i=r&CB,o=N2(e),l=o.length,c=N2(t),f=c.length;if(l!=f&&!i)return!1;for(var d=l;d--;){var h=o[d];if(!(i?h in t:AB.call(t,h)))return!1}var m=s.get(e),v=s.get(t);if(m&&v)return m==t&&v==e;var p=!0;s.set(e,t),s.set(t,e);for(var _=i;++d<l;){h=o[d];var g=e[h],y=t[h];if(n)var x=i?n(y,g,h,t,e,s):n(g,y,h,e,t,s);if(!(x===void 0?g===y||a(g,y,r,n,s):x)){p=!1;break}_||(_=h=="constructor")}if(p&&!_){var w=e.constructor,E=t.constructor;w!=E&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof E=="function"&&E instanceof E)&&(p=!1)}return s.delete(e),s.delete(t),p}var DB=OB,jB=mo,PB=Fa,FB=jB(PB,"DataView"),RB=FB,MB=mo,IB=Fa,LB=MB(IB,"Promise"),$B=LB,UB=mo,BB=Fa,WB=UB(BB,"Set"),VB=WB,HB=mo,zB=Fa,YB=HB(zB,"WeakMap"),GB=YB,hg=RB,pg=_1,mg=$B,vg=VB,gg=GB,qC=Kl,Zl=UC,A2="[object Map]",KB="[object Object]",O2="[object Promise]",D2="[object Set]",j2="[object WeakMap]",P2="[object DataView]",qB=Zl(hg),XB=Zl(pg),JB=Zl(mg),QB=Zl(vg),ZB=Zl(gg),Ni=qC;(hg&&Ni(new hg(new ArrayBuffer(1)))!=P2||pg&&Ni(new pg)!=A2||mg&&Ni(mg.resolve())!=O2||vg&&Ni(new vg)!=D2||gg&&Ni(new gg)!=j2)&&(Ni=function(e){var t=qC(e),r=t==KB?e.constructor:void 0,n=r?Zl(r):"";if(n)switch(n){case qB:return P2;case XB:return A2;case JB:return O2;case QB:return D2;case ZB:return j2}return t});var tp=Ni,Tm=b1,e9=BC,t9=Y7,r9=DB,F2=tp,R2=Mn,M2=Zh,n9=C1,a9=1,I2="[object Arguments]",L2="[object Array]",yd="[object Object]",s9=Object.prototype,$2=s9.hasOwnProperty;function i9(e,t,r,n,a,s){var i=R2(e),o=R2(t),l=i?L2:F2(e),c=o?L2:F2(t);l=l==I2?yd:l,c=c==I2?yd:c;var f=l==yd,d=c==yd,h=l==c;if(h&&M2(e)){if(!M2(t))return!1;i=!0,f=!1}if(h&&!f)return s||(s=new Tm),i||n9(e)?e9(e,t,r,n,a,s):t9(e,t,l,r,n,a,s);if(!(r&a9)){var m=f&&$2.call(e,"__wrapped__"),v=d&&$2.call(t,"__wrapped__");if(m||v){var p=m?e.value():e,_=v?t.value():t;return s||(s=new Tm),a(p,_,r,n,s)}}return h?(s||(s=new Tm),r9(e,t,r,n,a,s)):!1}var o9=i9,l9=o9,U2=gi;function XC(e,t,r,n,a){return e===t?!0:e==null||t==null||!U2(e)&&!U2(t)?e!==e&&t!==t:l9(e,t,r,n,XC,a)}var A1=XC,c9=A1;function u9(e,t){return c9(e,t)}var f9=u9;const d9=Sr(f9);function Cm(e,t){var r=l1(e);return r?r.innerHeight:$i(e).height}function JC(e,t,r){e.closest&&!r&&e.closest(t);var n=e;do{if(c8(n,t))return n;n=n.parentElement}while(n&&n!==r&&n.nodeType===document.ELEMENT_NODE);return null}function h9(e,t,r,n){for(var a=e.length,s=r+(n?1:-1);n?s--:++s<a;)if(t(e[s],s,e))return s;return-1}var p9=h9,m9=b1,v9=A1,g9=1,x9=2;function y9(e,t,r,n){var a=r.length,s=a,i=!n;if(e==null)return!s;for(e=Object(e);a--;){var o=r[a];if(i&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<s;){o=r[a];var l=o[0],c=e[l],f=o[1];if(i&&o[2]){if(c===void 0&&!(l in e))return!1}else{var d=new m9;if(n)var h=n(c,f,l,e,t,d);if(!(h===void 0?v9(f,c,g9|x9,n,d):h))return!1}}return!0}var _9=y9,w9=xs;function b9(e){return e===e&&!w9(e)}var QC=b9,S9=QC,E9=Nf;function k9(e){for(var t=E9(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,S9(a)]}return t}var T9=k9;function C9(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var ZC=C9,N9=_9,A9=T9,O9=ZC;function D9(e){var t=A9(e);return t.length==1&&t[0][2]?O9(t[0][0],t[0][1]):function(r){return r===e||N9(r,e,t)}}var j9=D9,P9=Mn,F9=Ef,R9=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,M9=/^\w*$/;function I9(e,t){if(P9(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||F9(e)?!0:M9.test(e)||!R9.test(e)||t!=null&&e in Object(t)}var O1=I9,eN=w1,L9="Expected a function";function D1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(L9);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var i=e.apply(this,n);return r.cache=s.set(a,i)||s,i};return r.cache=new(D1.Cache||eN),r}D1.Cache=eN;var $9=D1,U9=$9,B9=500;function W9(e){var t=U9(e,function(n){return r.size===B9&&r.clear(),n}),r=t.cache;return t}var V9=W9,H9=V9,z9=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Y9=/\\(\\)?/g,G9=H9(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(z9,function(r,n,a,s){t.push(a?s.replace(Y9,"$1"):n||r)}),t}),K9=G9;function q9(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var j1=q9,B2=Gl,X9=j1,J9=Mn,Q9=Ef,Z9=1/0,W2=B2?B2.prototype:void 0,V2=W2?W2.toString:void 0;function tN(e){if(typeof e=="string")return e;if(J9(e))return X9(e,tN)+"";if(Q9(e))return V2?V2.call(e):"";var t=e+"";return t=="0"&&1/e==-Z9?"-0":t}var eW=tN,tW=eW;function rW(e){return e==null?"":tW(e)}var nW=rW,aW=Mn,sW=O1,iW=K9,oW=nW;function lW(e,t){return aW(e)?e:sW(e,t)?[e]:iW(oW(e))}var rp=lW,cW=Ef,uW=1/0;function fW(e){if(typeof e=="string"||cW(e))return e;var t=e+"";return t=="0"&&1/e==-uW?"-0":t}var Af=fW,dW=rp,hW=Af;function pW(e,t){t=dW(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[hW(t[r++])];return r&&r==n?e:void 0}var np=pW,mW=np;function vW(e,t,r){var n=e==null?void 0:mW(e,t);return n===void 0?r:n}var gW=vW;function xW(e,t){return e!=null&&t in Object(e)}var yW=xW,_W=rp,wW=k1,bW=Mn,SW=o1,EW=i1,kW=Af;function TW(e,t,r){t=_W(t,e);for(var n=-1,a=t.length,s=!1;++n<a;){var i=kW(t[n]);if(!(s=e!=null&&r(e,i)))break;e=e[i]}return s||++n!=a?s:(a=e==null?0:e.length,!!a&&EW(a)&&SW(i,a)&&(bW(e)||wW(e)))}var CW=TW,NW=yW,AW=CW;function OW(e,t){return e!=null&&AW(e,t,NW)}var DW=OW,jW=A1,PW=gW,FW=DW,RW=O1,MW=QC,IW=ZC,LW=Af,$W=1,UW=2;function BW(e,t){return RW(e)&&MW(t)?IW(LW(e),t):function(r){var n=PW(r,e);return n===void 0&&n===t?FW(r,e):jW(t,n,$W|UW)}}var WW=BW;function VW(e){return e}var ap=VW;function HW(e){return function(t){return t==null?void 0:t[e]}}var zW=HW,YW=np;function GW(e){return function(t){return YW(t,e)}}var KW=GW,qW=zW,XW=KW,JW=O1,QW=Af;function ZW(e){return JW(e)?qW(QW(e)):XW(e)}var eV=ZW,tV=j9,rV=WW,nV=ap,aV=Mn,sV=eV;function iV(e){return typeof e=="function"?e:e==null?nV:typeof e=="object"?aV(e)?rV(e[0],e[1]):tV(e):sV(e)}var sp=iV,oV=p9,lV=sp,cV=TC,uV=Math.max;function fV(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:cV(r);return a<0&&(a=uV(n+a,0)),oV(e,lV(t),a)}var dV=fV;const hV=Sr(dV);var pV=Math.ceil,mV=Math.max;function vV(e,t,r,n){for(var a=-1,s=mV(pV((t-e)/(r||1)),0),i=Array(s);s--;)i[n?s:++a]=e,e+=r;return i}var gV=vV,xV=gV,yV=Gh,Nm=kC;function _V(e){return function(t,r,n){return n&&typeof n!="number"&&yV(t,r,n)&&(r=n=void 0),t=Nm(t),r===void 0?(r=t,t=0):r=Nm(r),n=n===void 0?t<r?1:-1:Nm(n),xV(t,r,n,e)}}var wV=_V,bV=wV,SV=bV(),EV=SV;const kV=Sr(EV);var H2=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function TV(e,t){return!!(e===t||H2(e)&&H2(t))}function CV(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!TV(e[r],t[r]))return!1;return!0}function rN(e,t){t===void 0&&(t=CV);var r=null;function n(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var i=e.apply(this,a);return r={lastResult:i,lastArgs:a,lastThis:this},i}return n.clear=function(){r=null},n}function xg(e,t){var r=l1(e);return r?r.innerWidth:$i(e).width}var z2=Gl,NV=k1,AV=Mn,Y2=z2?z2.isConcatSpreadable:void 0;function OV(e){return AV(e)||NV(e)||!!(Y2&&e&&e[Y2])}var DV=OV,jV=S1,PV=DV;function nN(e,t,r,n,a){var s=-1,i=e.length;for(r||(r=PV),a||(a=[]);++s<i;){var o=e[s];t>0&&r(o)?t>1?nN(o,t-1,r,n,a):jV(a,o):n||(a[a.length]=o)}return a}var aN=nN;function FV(e){return function(t,r,n){for(var a=-1,s=Object(t),i=n(t),o=i.length;o--;){var l=i[e?o:++a];if(r(s[l],l,s)===!1)break}return t}}var RV=FV,MV=RV,IV=MV(),LV=IV,$V=LV,UV=Nf;function BV(e,t){return e&&$V(e,t,UV)}var P1=BV,WV=Sf;function VV(e,t){return function(r,n){if(r==null)return r;if(!WV(r))return e(r,n);for(var a=r.length,s=t?a:-1,i=Object(r);(t?s--:++s<a)&&n(i[s],s,i)!==!1;);return r}}var HV=VV,zV=P1,YV=HV,GV=YV(zV),KV=GV,qV=KV,XV=Sf;function JV(e,t){var r=-1,n=XV(e)?Array(e.length):[];return qV(e,function(a,s,i){n[++r]=t(a,s,i)}),n}var QV=JV;function ZV(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var eH=ZV,G2=Ef;function tH(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,s=G2(e),i=t!==void 0,o=t===null,l=t===t,c=G2(t);if(!o&&!c&&!s&&e>t||s&&i&&l&&!o&&!c||n&&i&&l||!r&&l||!a)return 1;if(!n&&!s&&!c&&e<t||c&&r&&a&&!n&&!s||o&&r&&a||!i&&a||!l)return-1}return 0}var rH=tH,nH=rH;function aH(e,t,r){for(var n=-1,a=e.criteria,s=t.criteria,i=a.length,o=r.length;++n<i;){var l=nH(a[n],s[n]);if(l){if(n>=o)return l;var c=r[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}var sH=aH,Am=j1,iH=np,oH=sp,lH=QV,cH=eH,uH=ep,fH=sH,dH=ap,hH=Mn;function pH(e,t,r){t.length?t=Am(t,function(s){return hH(s)?function(i){return iH(i,s.length===1?s[0]:s)}:s}):t=[dH];var n=-1;t=Am(t,uH(oH));var a=lH(e,function(s,i,o){var l=Am(t,function(c){return c(s)});return{criteria:l,index:++n,value:s}});return cH(a,function(s,i){return fH(s,i,r)})}var mH=pH;function vH(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var gH=vH,xH=gH,K2=Math.max;function yH(e,t,r){return t=K2(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,s=K2(n.length-t,0),i=Array(s);++a<s;)i[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(i),xH(e,this,o)}}var sN=yH;function _H(e){return function(){return e}}var wH=_H,bH=mo,SH=function(){try{var e=bH(Object,"defineProperty");return e({},"",{}),e}catch{}}(),iN=SH,EH=wH,q2=iN,kH=ap,TH=q2?function(e,t){return q2(e,"toString",{configurable:!0,enumerable:!1,value:EH(t),writable:!0})}:kH,CH=TH,NH=800,AH=16,OH=Date.now;function DH(e){var t=0,r=0;return function(){var n=OH(),a=AH-(n-r);if(r=n,a>0){if(++t>=NH)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var jH=DH,PH=CH,FH=jH,RH=FH(PH),oN=RH,MH=ap,IH=sN,LH=oN;function $H(e,t){return LH(IH(e,t,MH),e+"")}var lN=$H,UH=aN,BH=mH,WH=lN,X2=Gh,VH=WH(function(e,t){if(e==null)return[];var r=t.length;return r>1&&X2(e,t[0],t[1])?t=[]:r>2&&X2(t[0],t[1],t[2])&&(t=[t[0]]),BH(e,UH(t,1),[])}),HH=VH;const zH=Sr(HH);function cN(e){return aC(e)||wC(e)||r1(e)||sC()}function YH(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var GH=YH,KH=xs,qH=N1,XH=GH,JH=Object.prototype,QH=JH.hasOwnProperty;function ZH(e){if(!KH(e))return XH(e);var t=qH(e),r=[];for(var n in e)n=="constructor"&&(t||!QH.call(e,n))||r.push(n);return r}var ez=ZH,tz=YC,rz=ez,nz=Sf;function az(e){return nz(e)?tz(e,!0):rz(e)}var ip=az,sz=lN,iz=bf,oz=Gh,lz=ip,uN=Object.prototype,cz=uN.hasOwnProperty,uz=sz(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&oz(t[0],t[1],a)&&(n=1);++r<n;)for(var s=t[r],i=lz(s),o=-1,l=i.length;++o<l;){var c=i[o],f=e[c];(f===void 0||iz(f,uN[c])&&!cz.call(e,c))&&(e[c]=s[c])}return e}),fz=uz;const dz=Sr(fz);var J2=iN;function hz(e,t,r){t=="__proto__"&&J2?J2(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var F1=hz,pz=F1,mz=P1,vz=sp;function gz(e,t){var r={};return t=vz(t),mz(e,function(n,a,s){pz(r,a,t(n,a,s))}),r}var xz=gz;const yz=Sr(xz);function _z(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var fN=_z,wz=F1,bz=bf,Sz=Object.prototype,Ez=Sz.hasOwnProperty;function kz(e,t,r){var n=e[t];(!(Ez.call(e,t)&&bz(n,r))||r===void 0&&!(t in e))&&wz(e,t,r)}var dN=kz,Tz=dN,Cz=F1;function Nz(e,t,r,n){var a=!r;r||(r={});for(var s=-1,i=t.length;++s<i;){var o=t[s],l=n?n(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),a?Cz(r,o,l):Tz(r,o,l)}return r}var Of=Nz,Az=Of,Oz=Nf;function Dz(e,t){return e&&Az(t,Oz(t),e)}var jz=Dz,Pz=Of,Fz=ip;function Rz(e,t){return e&&Pz(t,Fz(t),e)}var Mz=Rz,Y0={exports:{}};Y0.exports;(function(e,t){var r=Fa,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,i=s?r.Buffer:void 0,o=i?i.allocUnsafe:void 0;function l(c,f){if(f)return c.slice();var d=c.length,h=o?o(d):new c.constructor(d);return c.copy(h),h}e.exports=l})(Y0,Y0.exports);var Iz=Y0.exports;function Lz(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var $z=Lz,Uz=Of,Bz=E1;function Wz(e,t){return Uz(e,Bz(e),t)}var Vz=Wz,Hz=GC,zz=Hz(Object.getPrototypeOf,Object),op=zz,Yz=S1,Gz=op,Kz=E1,qz=HC,Xz=Object.getOwnPropertySymbols,Jz=Xz?function(e){for(var t=[];e;)Yz(t,Kz(e)),e=Gz(e);return t}:qz,hN=Jz,Qz=Of,Zz=hN;function eY(e,t){return Qz(e,Zz(e),t)}var tY=eY,rY=VC,nY=hN,aY=ip;function sY(e){return rY(e,aY,nY)}var pN=sY,iY=Object.prototype,oY=iY.hasOwnProperty;function lY(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&oY.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var cY=lY,Q2=WC;function uY(e){var t=new e.constructor(e.byteLength);return new Q2(t).set(new Q2(e)),t}var R1=uY,fY=R1;function dY(e,t){var r=t?fY(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var hY=dY,pY=/\w*$/;function mY(e){var t=new e.constructor(e.source,pY.exec(e));return t.lastIndex=e.lastIndex,t}var vY=mY,Z2=Gl,eb=Z2?Z2.prototype:void 0,tb=eb?eb.valueOf:void 0;function gY(e){return tb?Object(tb.call(e)):{}}var xY=gY,yY=R1;function _Y(e,t){var r=t?yY(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var wY=_Y,bY=R1,SY=hY,EY=vY,kY=xY,TY=wY,CY="[object Boolean]",NY="[object Date]",AY="[object Map]",OY="[object Number]",DY="[object RegExp]",jY="[object Set]",PY="[object String]",FY="[object Symbol]",RY="[object ArrayBuffer]",MY="[object DataView]",IY="[object Float32Array]",LY="[object Float64Array]",$Y="[object Int8Array]",UY="[object Int16Array]",BY="[object Int32Array]",WY="[object Uint8Array]",VY="[object Uint8ClampedArray]",HY="[object Uint16Array]",zY="[object Uint32Array]";function YY(e,t,r){var n=e.constructor;switch(t){case RY:return bY(e);case CY:case NY:return new n(+e);case MY:return SY(e,r);case IY:case LY:case $Y:case UY:case BY:case WY:case VY:case HY:case zY:return TY(e,r);case AY:return new n;case OY:case PY:return new n(e);case DY:return EY(e);case jY:return new n;case FY:return kY(e)}}var GY=YY,KY=xs,rb=Object.create,qY=function(){function e(){}return function(t){if(!KY(t))return{};if(rb)return rb(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),mN=qY,XY=mN,JY=op,QY=N1;function ZY(e){return typeof e.constructor=="function"&&!QY(e)?XY(JY(e)):{}}var eG=ZY,tG=tp,rG=gi,nG="[object Map]";function aG(e){return rG(e)&&tG(e)==nG}var sG=aG,iG=sG,oG=ep,nb=T1,ab=nb&&nb.isMap,lG=ab?oG(ab):iG,cG=lG,uG=tp,fG=gi,dG="[object Set]";function hG(e){return fG(e)&&uG(e)==dG}var pG=hG,mG=pG,vG=ep,sb=T1,ib=sb&&sb.isSet,gG=ib?vG(ib):mG,xG=gG,yG=b1,_G=fN,wG=dN,bG=jz,SG=Mz,EG=Iz,kG=$z,TG=Vz,CG=tY,NG=KC,AG=pN,OG=tp,DG=cY,jG=GY,PG=eG,FG=Mn,RG=Zh,MG=cG,IG=xs,LG=xG,$G=Nf,UG=ip,BG=1,WG=2,VG=4,vN="[object Arguments]",HG="[object Array]",zG="[object Boolean]",YG="[object Date]",GG="[object Error]",gN="[object Function]",KG="[object GeneratorFunction]",qG="[object Map]",XG="[object Number]",xN="[object Object]",JG="[object RegExp]",QG="[object Set]",ZG="[object String]",eK="[object Symbol]",tK="[object WeakMap]",rK="[object ArrayBuffer]",nK="[object DataView]",aK="[object Float32Array]",sK="[object Float64Array]",iK="[object Int8Array]",oK="[object Int16Array]",lK="[object Int32Array]",cK="[object Uint8Array]",uK="[object Uint8ClampedArray]",fK="[object Uint16Array]",dK="[object Uint32Array]",nt={};nt[vN]=nt[HG]=nt[rK]=nt[nK]=nt[zG]=nt[YG]=nt[aK]=nt[sK]=nt[iK]=nt[oK]=nt[lK]=nt[qG]=nt[XG]=nt[xN]=nt[JG]=nt[QG]=nt[ZG]=nt[eK]=nt[cK]=nt[uK]=nt[fK]=nt[dK]=!0;nt[GG]=nt[gN]=nt[tK]=!1;function Zd(e,t,r,n,a,s){var i,o=t&BG,l=t&WG,c=t&VG;if(r&&(i=a?r(e,n,a,s):r(e)),i!==void 0)return i;if(!IG(e))return e;var f=FG(e);if(f){if(i=DG(e),!o)return kG(e,i)}else{var d=OG(e),h=d==gN||d==KG;if(RG(e))return EG(e,o);if(d==xN||d==vN||h&&!a){if(i=l||h?{}:PG(e),!o)return l?CG(e,SG(i,e)):TG(e,bG(i,e))}else{if(!nt[d])return a?e:{};i=jG(e,d,o)}}s||(s=new yG);var m=s.get(e);if(m)return m;s.set(e,i),LG(e)?e.forEach(function(_){i.add(Zd(_,t,r,_,e,s))}):MG(e)&&e.forEach(function(_,g){i.set(g,Zd(_,t,r,g,e,s))});var v=c?l?AG:NG:l?UG:$G,p=f?void 0:v(e);return _G(p||e,function(_,g){p&&(g=_,_=e[g]),wG(i,g,Zd(_,t,r,g,e,s))}),i}var hK=Zd;function pK(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var mK=pK,vK=np,gK=bC;function xK(e,t){return t.length<2?e:vK(e,gK(t,0,-1))}var yK=xK,_K=rp,wK=mK,bK=yK,SK=Af;function EK(e,t){return t=_K(t,e),e=bK(e,t),e==null||delete e[SK(wK(t))]}var kK=EK,TK=Kl,CK=op,NK=gi,AK="[object Object]",OK=Function.prototype,DK=Object.prototype,yN=OK.toString,jK=DK.hasOwnProperty,PK=yN.call(Object);function FK(e){if(!NK(e)||TK(e)!=AK)return!1;var t=CK(e);if(t===null)return!0;var r=jK.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&yN.call(r)==PK}var RK=FK,MK=RK;function IK(e){return MK(e)?void 0:e}var LK=IK,$K=aN;function UK(e){var t=e==null?0:e.length;return t?$K(e,1):[]}var BK=UK,WK=BK,VK=sN,HK=oN;function zK(e){return HK(VK(e,void 0,WK),e+"")}var YK=zK,GK=j1,KK=hK,qK=kK,XK=rp,JK=Of,QK=LK,ZK=YK,eq=pN,tq=1,rq=2,nq=4,aq=ZK(function(e,t){var r={};if(e==null)return r;var n=!1;t=GK(t,function(s){return s=XK(s,e),n||(n=s.length>1),s}),JK(e,eq(e),r),n&&(r=KK(r,tq|rq|nq,QK));for(var a=t.length;a--;)qK(r,t[a]);return r}),sq=aq;const iq=Sr(sq);var oq=fN,lq=mN,cq=P1,uq=sp,fq=op,dq=Mn,hq=Zh,pq=s1,mq=xs,vq=C1;function gq(e,t,r){var n=dq(e),a=n||hq(e)||vq(e);if(t=uq(t),r==null){var s=e&&e.constructor;a?r=n?new s:[]:mq(e)?r=pq(s)?lq(fq(e)):{}:r={}}return(a?oq:cq)(e,function(i,o,l){return t(r,i,o,l)}),r}var xq=gq;const yq=Sr(xq);var _q={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){n.prototype.isBetween=function(s,i,o,l){var c=a(s),f=a(i),d=(l=l||"()")[0]==="(",h=l[1]===")";return(d?this.isAfter(c,o):!this.isBefore(c,o))&&(h?this.isBefore(f,o):!this.isAfter(f,o))||(d?this.isBefore(c,o):!this.isAfter(c,o))&&(h?this.isAfter(f,o):!this.isBefore(f,o))}}})})(_q);var wq={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n){n.prototype.isSameOrAfter=function(a,s){return this.isSame(a,s)||this.isAfter(a,s)}}})})(wq);var bq={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n){n.prototype.isSameOrBefore=function(a,s){return this.isSame(a,s)||this.isBefore(a,s)}}})})(bq);var Sq={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){var s=n.prototype,i=function(d){return d&&(d.indexOf?d:d.s)},o=function(d,h,m,v,p){var _=d.name?d:d.$locale(),g=i(_[h]),y=i(_[m]),x=g||y.map(function(E){return E.slice(0,v)});if(!p)return x;var w=_.weekStart;return x.map(function(E,S){return x[(S+(w||0))%7]})},l=function(){return a.Ls[a.locale()]},c=function(d,h){return d.formats[h]||function(m){return m.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(v,p,_){return p||_.slice(1)})}(d.formats[h.toUpperCase()])},f=function(){var d=this;return{months:function(h){return h?h.format("MMMM"):o(d,"months")},monthsShort:function(h){return h?h.format("MMM"):o(d,"monthsShort","months",3)},firstDayOfWeek:function(){return d.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):o(d,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):o(d,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):o(d,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return c(d.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};s.localeData=function(){return f.bind(this)()},a.localeData=function(){var d=l();return{firstDayOfWeek:function(){return d.weekStart||0},weekdays:function(){return a.weekdays()},weekdaysShort:function(){return a.weekdaysShort()},weekdaysMin:function(){return a.weekdaysMin()},months:function(){return a.months()},monthsShort:function(){return a.monthsShort()},longDateFormat:function(h){return c(d,h)},meridiem:d.meridiem,ordinal:d.ordinal}},a.months=function(){return o(l(),"months")},a.monthsShort=function(){return o(l(),"monthsShort","months",3)},a.weekdays=function(d){return o(l(),"weekdays",null,null,d)},a.weekdaysShort=function(d){return o(l(),"weekdaysShort","weekdays",3,d)},a.weekdaysMin=function(d){return o(l(),"weekdaysMin","weekdays",2,d)}}})})(Sq);var Eq={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,a,s){var i=a.prototype,o=i.format;s.en.formats=r,i.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var c=this.$locale().formats,f=function(d,h){return d.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(m,v,p){var _=p&&p.toUpperCase();return v||h[p]||r[p]||h[_].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(g,y,x){return y||x.slice(1)})})}(l,c===void 0?{}:c);return o.call(this,f)}}})})(Eq);var kq={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){var s=function(i,o){if(!o||!o.length||o.length===1&&!o[0]||o.length===1&&Array.isArray(o[0])&&!o[0].length)return null;var l;o.length===1&&o[0].length>0&&(o=o[0]),l=(o=o.filter(function(f){return f}))[0];for(var c=1;c<o.length;c+=1)o[c].isValid()&&!o[c][i](l)||(l=o[c]);return l};a.max=function(){var i=[].slice.call(arguments,0);return s("isAfter",i)},a.min=function(){var i=[].slice.call(arguments,0);return s("isBefore",i)}}})})(kq);var Tq={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(s,i,o){var l=i.prototype;o.utc=function(p){var _={date:p,utc:!0,args:arguments};return new i(_)},l.utc=function(p){var _=o(this.toDate(),{locale:this.$L,utc:!0});return p?_.add(this.utcOffset(),r):_},l.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var c=l.parse;l.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),c.call(this,p)};var f=l.init;l.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else f.call(this)};var d=l.utcOffset;l.utcOffset=function(p,_){var g=this.$utils().u;if(g(p))return this.$u?0:g(this.$offset)?d.call(this):this.$offset;if(typeof p=="string"&&(p=function(E){E===void 0&&(E="");var S=E.match(n);if(!S)return null;var b=(""+S[0]).match(a)||["-",0,0],T=b[0],C=60*+b[1]+ +b[2];return C===0?0:T==="+"?C:-C}(p),p===null))return this;var y=Math.abs(p)<=16?60*p:p,x=this;if(_)return x.$offset=y,x.$u=p===0,x;if(p!==0){var w=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(x=this.local().add(y+w,r)).$offset=y,x.$x.$localOffset=w}else x=this.utc();return x};var h=l.format;l.format=function(p){var _=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,_)},l.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var m=l.toDate;l.toDate=function(p){return p==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var v=l.diff;l.diff=function(p,_,g){if(p&&this.$u===p.$u)return v.call(this,p,_,g);var y=this.local(),x=o(p).local();return v.call(y,x,_,g)}}})})(Tq);function Ha(e){return e.children}var qr={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},Pt={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},ob=Object.keys(Pt).map(function(e){return Pt[e]});ue.oneOfType([ue.string,ue.func]);ue.any;ue.func;ue.oneOfType([ue.arrayOf(ue.oneOf(ob)),ue.objectOf(function(e,t){var r=ob.indexOf(t)!==-1&&typeof e[t]=="boolean";if(r)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];return ue.elementType.apply(ue,[e,t].concat(a))})]);ue.oneOfType([ue.oneOf(["overlap","no-overlap"]),ue.func]);var lb={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function _N(e,t){var r=lr(e,"month");return lr(r,"week",t.startOfWeek())}function wN(e,t){var r=U0(e,"month");return U0(r,"week",t.startOfWeek())}function Cq(e,t){for(var r=_N(e,t),n=wN(e,t),a=[];zl(r,n,"day");)a.push(r),r=sa(r,1,"day");return a}function Nq(e,t){var r=lr(e,t);return _f(r,e)?r:sa(r,1,t)}function Aq(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",n=e,a=[];zl(n,t,r);)a.push(n),n=sa(n,1,r);return a}function Oq(e,t){return t==null&&e==null?null:(t==null&&(t=new Date),e==null&&(e=new Date),e=lr(e,"day"),e=Vu(e,Vu(t)),e=Tl(e,Tl(t)),e=Wu(e,Wu(t)),Bu(e,Bu(t)))}function cb(e){return Vu(e)===0&&Tl(e)===0&&Wu(e)===0&&Bu(e)===0}function Dq(e,t,r,n){return r==="day"&&(r="date"),Math.abs(zw[r](e,void 0,n)-zw[r](t,void 0,n))}function M1(e,t,r){return!r||r==="milliseconds"?Math.abs(+e-+t):Math.round(Math.abs(+lr(e,r)/lb[r]-+lr(t,r)/lb[r]))}var jq=ue.oneOfType([ue.string,ue.func]);function Pq(e,t,r,n,a){var s=typeof n=="function"?n(r,a,e):t.call(e,r,n,a);return Ru(s==null||typeof s=="string","`localizer format(..)` must return a string, null, or undefined"),s}function Fq(e,t,r){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,t+r,0,0)}function I1(e,t){return e.getTimezoneOffset()-t.getTimezoneOffset()}function Rq(e,t){return M1(e,t,"minutes")+I1(e,t)}function Mq(e){var t=lr(e,"day");return M1(t,e,"minutes")+I1(t,e)}function Iq(e,t){return a1(e,t,"day")}function Lq(e,t,r){var n=_f(e,t,"minutes");return n?wf(t,r,"minutes"):Yh(t,r,"minutes")}function yg(e,t){return Dq(e,t,"day")}function $q(e){var t=e.evtA,r=t.start,n=t.end,a=t.allDay,s=e.evtB,i=s.start,o=s.end,l=s.allDay,c=+lr(r,"day")-+lr(i,"day"),f=yg(r,n),d=yg(i,o);return c||d-f||!!l-!!a||+r-+i||+n-+o}function Uq(e){var t=e.event,r=t.start,n=t.end,a=e.range,s=a.start,i=a.end,o=lr(r,"day"),l=zl(o,i,"day"),c=n1(o,n,"minutes"),f=c?Yh(n,s,"minutes"):wf(n,s,"minutes");return l&&f}function Bq(e,t){return _f(e,t,"day")}function Wq(e,t){return cb(e)&&cb(t)}var Vq=Gt(function e(t){var r=this;Yt(this,e),Ru(typeof t.format=="function","date localizer `format(..)` must be a function"),Ru(typeof t.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=t.propType||jq,this.formats=t.formats,this.format=function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return Pq.apply(void 0,[r,t.format].concat(a))},this.startOfWeek=t.firstOfWeek,this.merge=t.merge||Oq,this.inRange=t.inRange||gC,this.lt=t.lt||a1,this.lte=t.lte||zl,this.gt=t.gt||Yh,this.gte=t.gte||wf,this.eq=t.eq||_f,this.neq=t.neq||n1,this.startOf=t.startOf||lr,this.endOf=t.endOf||U0,this.add=t.add||sa,this.range=t.range||Aq,this.diff=t.diff||M1,this.ceil=t.ceil||Nq,this.min=t.min||mC,this.max=t.max||vC,this.minutes=t.minutes||Tl,this.daySpan=t.daySpan||yg,this.firstVisibleDay=t.firstVisibleDay||_N,this.lastVisibleDay=t.lastVisibleDay||wN,this.visibleDays=t.visibleDays||Cq,this.getSlotDate=t.getSlotDate||Fq,this.getTimezoneOffset=t.getTimezoneOffset||function(n){return n.getTimezoneOffset()},this.getDstOffset=t.getDstOffset||I1,this.getTotalMin=t.getTotalMin||Rq,this.getMinutesFromMidnight=t.getMinutesFromMidnight||Mq,this.continuesPrior=t.continuesPrior||Iq,this.continuesAfter=t.continuesAfter||Lq,this.sortEvents=t.sortEvents||$q,this.inEventRange=t.inEventRange||Uq,this.isSameDate=t.isSameDate||Bq,this.startAndEndAreDateOnly=t.startAndEndAreDateOnly||Wq,this.segmentOffset=t.browserTZOffset?t.browserTZOffset():0});function Hq(e,t,r,n){var a=et(et({},e.formats),r);return et(et({},e),{},{messages:n,startOfWeek:function(){return e.startOfWeek(t)},format:function(i,o){return e.format(i,a[o]||o,t)}})}var zq=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Er(this,t,[].concat(a)),r.navigate=function(i){r.props.onNavigate(i)},r.view=function(i){r.props.onView(i)},r}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.localizer.messages,s=n.label;return Q.createElement("div",{className:"rbc-toolbar"},Q.createElement("span",{className:"rbc-btn-group"},Q.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.TODAY)},a.today),Q.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.PREVIOUS)},a.previous),Q.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.NEXT)},a.next)),Q.createElement("span",{className:"rbc-toolbar-label"},s),Q.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(a)))}},{key:"viewNamesGroup",value:function(n){var a=this,s=this.props.views,i=this.props.view;if(s.length>1)return s.map(function(o){return Q.createElement("button",{type:"button",key:o,className:Ct({"rbc-active":i===o}),onClick:a.view.bind(null,o)},n[o])})}}])}(Q.Component);function ct(e,t){e&&e.apply(null,[].concat(t))}var Yq={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(t){return"+".concat(t," more")}};function Gq(e){return et(et({},Yq),e)}function Kq(e){var t=e.ref,r=e.callback;D.useEffect(function(){var n=function(s){t.current&&!t.current.contains(s.target)&&r()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[t,r])}var qq=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],bN=function(e){function t(){return Yt(this,t),Er(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.style,s=n.className,i=n.event,o=n.selected,l=n.isAllDay,c=n.onSelect,f=n.onDoubleClick,d=n.onKeyPress,h=n.localizer,m=n.continuesPrior,v=n.continuesAfter,p=n.accessors,_=n.getters,g=n.children,y=n.components,x=y.event,w=y.eventWrapper,E=n.slotStart,S=n.slotEnd,b=Oa(n,qq);delete b.resizable;var T=p.title(i),C=p.tooltip(i),F=p.end(i),M=p.start(i),j=p.allDay(i),A=l||j||h.diff(M,h.ceil(F,"day"),"day")>1,G=_.eventProp(i,M,F,o),X=Q.createElement("div",{className:"rbc-event-content",title:C||void 0},x?Q.createElement(x,{event:i,continuesPrior:m,continuesAfter:v,title:T,isAllDay:j,localizer:h,slotStart:E,slotEnd:S}):T);return Q.createElement(w,Object.assign({},this.props,{type:"date"}),Q.createElement("div",Object.assign({},b,{style:et(et({},G.style),a),className:Ct("rbc-event",s,G.className,{"rbc-selected":o,"rbc-event-allday":A,"rbc-event-continues-prior":m,"rbc-event-continues-after":v}),onClick:function(q){return c&&c(i,q)},onDoubleClick:function(q){return f&&f(i,q)},onKeyDown:function(q){return d&&d(i,q)}}),typeof g=="function"?g(X):X))}}])}(Q.Component);function lp(e,t){return!e||t==null?!1:d9(e,t)}function SN(e,t){var r=e.right-e.left,n=r/t;return n}function EN(e,t,r,n){var a=SN(e,n);return r?n-1-Math.floor((t-e.left)/a):Math.floor((t-e.left)/a)}function Xq(e,t){var r=t.x,n=t.y;return n>=e.top&&n<=e.bottom&&r>=e.left&&r<=e.right}function Jq(e,t,r,n,a){var s=-1,i=-1,o=n-1,l=SN(t,n),c=EN(t,r.x,a,n),f=t.top<r.y&&t.bottom>r.y,d=t.top<e.y&&t.bottom>e.y,h=e.y>t.bottom,m=t.top>e.y,v=r.top<t.top&&r.bottom>t.bottom;return v&&(s=0,i=o),f&&(m?(s=0,i=c):h&&(s=c,i=o)),d&&(s=i=a?o-Math.floor((e.x-t.left)/l):Math.floor((e.x-t.left)/l),f?c<s?s=c:i=c:e.y<r.y?i=o:s=0),{startIdx:s,endIdx:i}}function Qq(e){var t=e.target,r=e.offset,n=e.container,a=e.box,s=$i(t),i=s.top,o=s.left,l=s.width,c=s.height,f=$i(n),d=f.top,h=f.left,m=f.width,v=f.height,p=$i(a),_=p.width,g=p.height,y=d+v,x=h+m,w=i+g,E=o+_,S=r.x,b=r.y,T=w>y?i-g-b:i+b+c,C=E>x?o+S-_+l:o+S;return{topOffset:T,leftOffset:C}}function Zq(e){var t=e.containerRef,r=e.accessors,n=e.getters,a=e.selected,s=e.components,i=e.localizer,o=e.position,l=e.show,c=e.events,f=e.slotStart,d=e.slotEnd,h=e.onSelect,m=e.onDoubleClick,v=e.onKeyPress,p=e.handleDragStart,_=e.popperRef,g=e.target,y=e.offset;Kq({ref:_,callback:l}),D.useLayoutEffect(function(){var E=Qq({target:g,offset:y,container:t.current,box:_.current}),S=E.topOffset,b=E.leftOffset;_.current.style.top="".concat(S,"px"),_.current.style.left="".concat(b,"px")},[y.x,y.y,g]);var x=o.width,w={minWidth:x+x/2};return Q.createElement("div",{style:w,className:"rbc-overlay",ref:_},Q.createElement("div",{className:"rbc-overlay-header"},i.format(f,"dayHeaderFormat")),c.map(function(E,S){return Q.createElement(bN,{key:S,type:"popup",localizer:i,event:E,getters:n,onSelect:h,accessors:r,components:s,onDoubleClick:m,onKeyPress:v,continuesPrior:i.lt(r.end(E),f,"day"),continuesAfter:i.gte(r.start(E),d,"day"),slotStart:f,slotEnd:d,selected:lp(E,a),draggable:!0,onDragStart:function(){return p(E)},onDragEnd:function(){return l()}})}))}var kN=Q.forwardRef(function(e,t){return Q.createElement(Zq,Object.assign({},e,{popperRef:t}))});kN.propTypes={accessors:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,components:ue.object.isRequired,localizer:ue.object.isRequired,position:ue.object.isRequired,show:ue.func.isRequired,events:ue.array.isRequired,slotStart:ue.instanceOf(Date).isRequired,slotEnd:ue.instanceOf(Date),onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func,handleDragStart:ue.func,style:ue.object,offset:ue.shape({x:ue.number,y:ue.number})};function eX(e){var t=e.containerRef,r=e.popupOffset,n=r===void 0?5:r,a=e.overlay,s=e.accessors,i=e.localizer,o=e.components,l=e.getters,c=e.selected,f=e.handleSelectEvent,d=e.handleDoubleClickEvent,h=e.handleKeyPressEvent,m=e.handleDragStart,v=e.onHide,p=e.overlayDisplay,_=D.useRef(null);if(!a.position)return null;var g=n;isNaN(n)||(g={x:n,y:n});var y=a.position,x=a.events,w=a.date,E=a.end;return Q.createElement(y1,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:v,target:a.target},function(S){var b=S.props;return Q.createElement(kN,Object.assign({},b,{containerRef:t,ref:_,target:a.target,offset:g,accessors:s,getters:l,selected:c,components:o,localizer:i,position:y,show:p,events:x,slotStart:w,slotEnd:E,onSelect:f,onDoubleClick:d,onKeyPress:h,handleDragStart:m}))})}var L1=Q.forwardRef(function(e,t){return Q.createElement(eX,Object.assign({},e,{containerRef:t}))});L1.propTypes={popupOffset:ue.oneOfType([ue.number,ue.shape({x:ue.number,y:ue.number})]),overlay:ue.shape({position:ue.object,events:ue.array,date:ue.instanceOf(Date),end:ue.instanceOf(Date)}),accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,handleSelectEvent:ue.func,handleDoubleClickEvent:ue.func,handleKeyPressEvent:ue.func,handleDragStart:ue.func,onHide:ue.func,overlayDisplay:ue.func};function hr(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return Mc(r,e,t,{passive:!1})}function tX(e,t,r){return!e||Hu(e,document.elementFromPoint(t,r))}function rX(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return JC(a,".rbc-event",e)}function nX(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return JC(a,".rbc-show-more",e)}function G0(e,t){return!!rX(e,t)}function aX(e,t){return!!nX(e,t)}function Ec(e){var t=e;return e.touches&&e.touches.length&&(t=e.touches[0]),{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var ub=5,sX=250,TN=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.global,a=n===void 0?!1:n,s=r.longPressThreshold,i=s===void 0?250:s,o=r.validContainers,l=o===void 0?[]:o;Yt(this,e),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=t,this.globalMouse=!t||a,this.longPressThreshold=i,this.validContainers=l,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=hr("touchmove",function(){},window),this._removeKeyDownListener=hr("keydown",this._keyListener),this._removeKeyUpListener=hr("keyup",this._keyListener),this._removeDropFromOutsideListener=hr("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=hr("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return Gt(e,[{key:"on",value:function(r,n){var a=this._listeners[r]||(this._listeners[r]=[]);return a.push(n),{remove:function(){var i=a.indexOf(n);i!==-1&&a.splice(i,1)}}}},{key:"emit",value:function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];var i,o=this._listeners[r]||[];return o.forEach(function(l){i===void 0&&(i=l.apply(void 0,a))}),i}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(r){var n=this._selectRect;return!n||!this.selecting?!1:fb(n,no(r))}},{key:"filter",value:function(r){var n=this._selectRect;return!n||!this.selecting?[]:r.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(r,n){var a=this,s=null,i=null,o=null,l=function(h){s=setTimeout(function(){f(),r(h)},a.longPressThreshold),i=hr("touchmove",function(){return f()}),o=hr("touchend",function(){return f()})},c=hr("touchstart",l),f=function(){s&&clearTimeout(s),i&&i(),o&&o(),s=null,i=null,o=null};return n&&l(n),function(){f(),c()}}},{key:"_addInitialEventListener",value:function(){var r=this,n=hr("mousedown",function(s){r._removeInitialEventListener(),r._handleInitialEvent(s),r._removeInitialEventListener=hr("mousedown",r._handleInitialEvent)}),a=hr("touchstart",function(s){r._removeInitialEventListener(),r._removeInitialEventListener=r._addLongPressListener(r._handleInitialEvent,s)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(r){var n=Ec(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY;this.emit("dropFromOutside",{x:a,y:s,clientX:i,clientY:o}),r.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(r){var n=Ec(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY;this.emit("dragOverFromOutside",{x:a,y:s,clientX:i,clientY:o}),r.preventDefault()}},{key:"_handleInitialEvent",value:function(r){if(this._initialEvent=r,!this.isDetached){var n=Ec(r),a=n.clientX,s=n.clientY,i=n.pageX,o=n.pageY,l=this.container(),c,f;if(!(r.which===3||r.button===2||!tX(l,a,s))){if(!this.globalMouse&&l&&!Hu(l,r.target)){var d=iX(0),h=d.top,m=d.left,v=d.bottom,p=d.right;if(f=no(l),c=fb({top:f.top-h,left:f.left-m,bottom:f.bottom+v,right:f.right+p},{top:o,left:i}),!c)return}var _=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(r.type),x:i,y:o,clientX:a,clientY:s});if(_!==!1)switch(r.type){case"mousedown":this._removeEndListener=hr("mouseup",this._handleTerminatingEvent),this._onEscListener=hr("keydown",this._handleTerminatingEvent),this._removeMoveListener=hr("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(r),this._removeEndListener=hr("touchend",this._handleTerminatingEvent),this._removeMoveListener=hr("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(r){var n=r.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(s){return!!n.closest(s)})}},{key:"_handleTerminatingEvent",value:function(r){var n=this.selecting,a=this._selectRect;if(!n&&r.type.includes("key")&&(r=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!r){var s=!this.container||Hu(this.container(),r.target),i=this._isWithinValidContainer(r);return r.key==="Escape"||!i?this.emit("reset"):!n&&s?this._handleClickEvent(r):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(r){var n=Ec(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY,l=new Date().getTime();return this._lastClickData&&l-this._lastClickData.timestamp<sX?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:s,clientX:i,clientY:o})):(this._lastClickData={timestamp:l},this.emit("click",{x:a,y:s,clientX:i,clientY:o}))}},{key:"_handleMoveEvent",value:function(r){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,s=n.y,i=Ec(r),o=i.pageX,l=i.pageY,c=Math.abs(a-o),f=Math.abs(s-l),d=Math.min(o,a),h=Math.min(l,s),m=this.selecting,v=this.isClick(o,l);v&&!m&&!(c||f)||(!m&&!v&&this.emit("selectStart",this._initialEventData),v||(this.selecting=!0,this._selectRect={top:h,left:d,x:o,y:l,right:d+c,bottom:h+f},this.emit("selecting",this._selectRect)),r.preventDefault())}}},{key:"_keyListener",value:function(r){this.ctrl=r.metaKey||r.ctrlKey}},{key:"isClick",value:function(r,n){var a=this._initialEventData,s=a.x,i=a.y,o=a.isTouch;return!o&&Math.abs(r-s)<=ub&&Math.abs(n-i)<=ub}}])}();function iX(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return ds(e)!=="object"&&(e={top:e,left:e,right:e,bottom:e}),e}function fb(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=no(e),a=n.top,s=n.left,i=n.right,o=i===void 0?s:i,l=n.bottom,c=l===void 0?a:l,f=no(t),d=f.top,h=f.left,m=f.right,v=m===void 0?h:m,p=f.bottom,_=p===void 0?d:p;return!(c-r<d||a+r>_||o-r<h||s+r>v)}function no(e){if(!e.getBoundingClientRect)return e;var t=e.getBoundingClientRect(),r=t.left+db("left"),n=t.top+db("top");return{top:n,left:r,right:(e.offsetWidth||0)+r,bottom:(e.offsetHeight||0)+n}}function db(e){if(e==="left")return window.pageXOffset||document.body.scrollLeft||0;if(e==="top")return window.pageYOffset||document.body.scrollTop||0}var oX=function(e){function t(r,n){var a;return Yt(this,t),a=Er(this,t,[r,n]),a.state={selecting:!1},a.containerRef=D.createRef(),a}return kr(t,e),Gt(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(n){!n.selectable&&this.props.selectable&&this._selectable(),n.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var n=this.props,a=n.range,s=n.getNow,i=n.getters,o=n.date,l=n.components.dateCellWrapper,c=n.localizer,f=this.state,d=f.selecting,h=f.startIdx,m=f.endIdx,v=s();return Q.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},a.map(function(p,_){var g=d&&_>=h&&_<=m,y=i.dayProp(p),x=y.className,w=y.style;return Q.createElement(l,{key:_,value:p,range:a},Q.createElement("div",{style:w,className:Ct("rbc-day-bg",x,g&&"rbc-selected-cell",c.isSameDate(p,v)&&"rbc-today",o&&c.neq(o,p,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var n=this,a=this.containerRef.current,s=this._selector=new TN(this.props.container,{longPressThreshold:this.props.longPressThreshold}),i=function(l,c){if(!G0(a,l)&&!aX(a,l)){var f=no(a),d=n.props,h=d.range,m=d.rtl;if(Xq(f,l)){var v=EN(f,l.x,m,h.length);n._selectSlot({startIdx:v,endIdx:v,action:c,box:l})}}n._initial={},n.setState({selecting:!1})};s.on("selecting",function(o){var l=n.props,c=l.range,f=l.rtl,d=-1,h=-1;if(n.state.selecting||(ct(n.props.onSelectStart,[o]),n._initial={x:o.x,y:o.y}),s.isSelected(a)){var m=no(a),v=Jq(n._initial,m,o,c.length,f);d=v.startIdx,h=v.endIdx}n.setState({selecting:!0,startIdx:d,endIdx:h})}),s.on("beforeSelect",function(o){if(n.props.selectable==="ignoreEvents")return!G0(n.containerRef.current,o)}),s.on("click",function(o){return i(o,"click")}),s.on("doubleClick",function(o){return i(o,"doubleClick")}),s.on("select",function(o){n._selectSlot(et(et({},n.state),{},{action:"select",bounds:o})),n._initial={},n.setState({selecting:!1}),ct(n.props.onSelectEnd,[n.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(n){var a=n.endIdx,s=n.startIdx,i=n.action,o=n.bounds,l=n.box;a!==-1&&s!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:s,end:a,action:i,bounds:o,box:l,resourceId:this.props.resourceId})}}])}(Q.Component),ya={propTypes:{slotMetrics:ue.object.isRequired,selected:ue.object,isAllDay:ue.bool,accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func},defaultProps:{segments:[],selected:{}},renderEvent:function(t,r){var n=t.selected;t.isAllDay;var a=t.accessors,s=t.getters,i=t.onSelect,o=t.onDoubleClick,l=t.onKeyPress,c=t.localizer,f=t.slotMetrics,d=t.components,h=t.resizable,m=f.continuesPrior(r),v=f.continuesAfter(r);return Q.createElement(bN,{event:r,getters:s,localizer:c,accessors:a,components:d,onSelect:i,onDoubleClick:o,onKeyPress:l,continuesPrior:m,continuesAfter:v,slotStart:f.first,slotEnd:f.last,selected:lp(r,n),resizable:h})},renderSpan:function(t,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",s=Math.abs(r)/t*100+"%";return Q.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:s,flexBasis:s,maxWidth:s}},a)}},CN=function(e){function t(){return Yt(this,t),Er(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this,a=this.props,s=a.segments,i=a.slotMetrics.slots,o=a.className,l=1;return Q.createElement("div",{className:Ct(o,"rbc-row")},s.reduce(function(c,f,d){var h=f.event,m=f.left,v=f.right,p=f.span,_="_lvl_"+d,g=m-l,y=ya.renderEvent(n.props,h);return g&&c.push(ya.renderSpan(i,g,"".concat(_,"_gap"))),c.push(ya.renderSpan(i,p,_,y)),l=v+1,c},[]))}}])}(Q.Component);CN.defaultProps=et({},ya.defaultProps);function NN(e){var t=e.dateRange,r=e.unit,n=r===void 0?"day":r,a=e.localizer;return{first:t[0],last:a.add(t[t.length-1],1,n)}}function lX(e,t,r,n){var a=NN({dateRange:t,localizer:n}),s=a.first,i=a.last,o=n.diff(s,i,"day"),l=n.max(n.startOf(r.start(e),"day"),s),c=n.min(n.ceil(r.end(e),"day"),i),f=hV(t,function(h){return n.isSameDate(h,l)}),d=n.diff(l,c,"day");return d=Math.min(d,o),d=Math.max(d-n.segmentOffset,1),{event:e,span:d,left:f+1,right:Math.max(f+d,1)}}function AN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r,n,a,s=[],i=[];for(r=0;r<e.length;r++){for(a=e[r],n=0;n<s.length&&cX(a,s[n]);n++);n>=t?i.push(a):(s[n]||(s[n]=[])).push(a)}for(r=0;r<s.length;r++)s[r].sort(function(o,l){return o.left-l.left});return{levels:s,extra:i}}function Gu(e,t,r,n,a){var s={start:n.start(e),end:n.end(e)},i={start:t,end:r};return a.inEventRange({event:s,range:i})}function cX(e,t){return t.some(function(r){return r.left<=e.right&&r.right>=e.left})}function uX(e,t,r){var n=Jd(e),a=[],s=[];n.forEach(function(l){var c=t.start(l),f=t.end(l);r.daySpan(c,f)>1?a.push(l):s.push(l)});var i=a.sort(function(l,c){return _g(l,c,t,r)}),o=s.sort(function(l,c){return _g(l,c,t,r)});return[].concat(Jd(i),Jd(o))}function _g(e,t,r,n){var a={start:r.start(e),end:r.end(e),allDay:r.allDay(e)},s={start:r.start(t),end:r.end(t),allDay:r.allDay(t)};return n.sortEvents({evtA:a,evtB:s})}var ON=function(t,r){return t.left<=r&&t.right>=r},hb=function(t,r){return t.filter(function(n){return ON(n,r)}).map(function(n){return n.event})},DN=function(e){function t(){return Yt(this,t),Er(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){for(var n=this.props,a=n.segments,s=n.slotMetrics.slots,i=AN(a).levels[0],o=1,l=1,c=[];o<=s;){var f="_lvl_"+o,d=i.filter(function(y){return ON(y,o)})[0]||{},h=d.event,m=d.left,v=d.right,p=d.span;if(!h){o++;continue}var _=Math.max(0,m-l);if(this.canRenderSlotEvent(m,p)){var g=ya.renderEvent(this.props,h);_&&c.push(ya.renderSpan(s,_,f+"_gap")),c.push(ya.renderSpan(s,p,f,g)),l=o=v+1}else _&&c.push(ya.renderSpan(s,_,f+"_gap")),c.push(ya.renderSpan(s,1,f,this.renderShowMore(a,o))),l=o=o+1}return Q.createElement("div",{className:"rbc-row"},c)}},{key:"canRenderSlotEvent",value:function(n,a){var s=this.props.segments;return kV(n,n+a).every(function(i){var o=hb(s,i).length;return o===1})}},{key:"renderShowMore",value:function(n,a){var s=this,i=this.props,o=i.localizer,l=i.slotMetrics,c=i.components,f=l.getEventsForSlot(a),d=hb(n,a),h=d.length;if(c!=null&&c.showMore){var m=c.showMore,v=l.getDateForSlot(a-1);return h?Q.createElement(m,{localizer:o,slotDate:v,slot:a,count:h,events:f,remainingEvents:d}):!1}return h?Q.createElement("button",{type:"button",key:"sm_"+a,className:Ct("rbc-button-link","rbc-show-more"),onClick:function(_){return s.showMore(a,_)}},o.messages.showMore(h,d,f)):!1}},{key:"showMore",value:function(n,a){a.preventDefault(),a.stopPropagation(),this.props.onShowMore(n,a.target)}}])}(Q.Component);DN.defaultProps=et({},ya.defaultProps);var fX=function(t){var r=t.children;return Q.createElement("div",{className:"rbc-row-content-scroll-container"},r)},dX=function(t,r){return t.left<=r&&t.right>=r},hX=function(t,r){return t[0].range===r[0].range&&t[0].events===r[0].events};function jN(){return rN(function(e){for(var t=e.range,r=e.events,n=e.maxRows,a=e.minRows,s=e.accessors,i=e.localizer,o=NN({dateRange:t,localizer:i}),l=o.first,c=o.last,f=r.map(function(p){return lX(p,t,s,i)}),d=AN(f,Math.max(n-1,1)),h=d.levels,m=d.extra,v=m.length>0?a-1:a;h.length<v;)h.push([]);return{first:l,last:c,levels:h,extra:m,range:t,slots:t.length,clone:function(_){var g=jN();return g(et(et({},e),_))},getDateForSlot:function(_){return t[_]},getSlotForDate:function(_){return t.find(function(g){return i.isSameDate(g,_)})},getEventsForSlot:function(_){return f.filter(function(g){return dX(g,_)}).map(function(g){return g.event})},continuesPrior:function(_){return i.continuesPrior(s.start(_),l)},continuesAfter:function(_){var g=s.start(_),y=s.end(_);return i.continuesAfter(g,y,c)}}},hX)}var Ku=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Er(this,t,[].concat(a)),r.handleSelectSlot=function(i){var o=r.props,l=o.range,c=o.onSelectSlot;c(l.slice(i.start,i.end+1),i)},r.handleShowMore=function(i,o){var l=r.props,c=l.range,f=l.onShowMore,d=r.slotMetrics(r.props),h=f8(r.containerRef.current,".rbc-row-bg")[0],m;h&&(m=h.children[i-1]);var v=d.getEventsForSlot(i);f(v,c[i-1],m,i,o)},r.getContainer=function(){var i=r.props.container;return i?i():r.containerRef.current},r.renderHeadingCell=function(i,o){var l=r.props,c=l.renderHeader,f=l.getNow,d=l.localizer;return c({date:i,key:"header_".concat(o),className:Ct("rbc-date-cell",d.isSameDate(i,f())&&"rbc-now")})},r.renderDummy=function(){var i=r.props,o=i.className,l=i.range,c=i.renderHeader,f=i.showAllEvents;return Q.createElement("div",{className:o,ref:r.containerRef},Q.createElement("div",{className:Ct("rbc-row-content",f&&"rbc-row-content-scrollable")},c&&Q.createElement("div",{className:"rbc-row",ref:r.headingRowRef},l.map(r.renderHeadingCell)),Q.createElement("div",{className:"rbc-row",ref:r.eventRowRef},Q.createElement("div",{className:"rbc-row-segment"},Q.createElement("div",{className:"rbc-event"},Q.createElement("div",{className:"rbc-event-content"}," "))))))},r.containerRef=D.createRef(),r.headingRowRef=D.createRef(),r.eventRowRef=D.createRef(),r.slotMetrics=jN(),r}return kr(t,e),Gt(t,[{key:"getRowLimit",value:function(){var n,a=Cm(this.eventRowRef.current),s=(n=this.headingRowRef)!==null&&n!==void 0&&n.current?Cm(this.headingRowRef.current):0,i=Cm(this.containerRef.current)-s;return Math.max(Math.floor(i/a),1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.rtl,i=n.range,o=n.className,l=n.selected,c=n.selectable,f=n.renderForMeasure,d=n.accessors,h=n.getters,m=n.components,v=n.getNow,p=n.renderHeader,_=n.onSelect,g=n.localizer,y=n.onSelectStart,x=n.onSelectEnd,w=n.onDoubleClick,E=n.onKeyPress,S=n.resourceId,b=n.longPressThreshold,T=n.isAllDay,C=n.resizable,F=n.showAllEvents;if(f)return this.renderDummy();var M=this.slotMetrics(this.props),j=M.levels,A=M.extra,G=F?fX:Ha,X=m.weekWrapper,H={selected:l,accessors:d,getters:h,localizer:g,components:m,onSelect:_,onDoubleClick:w,onKeyPress:E,resourceId:S,slotMetrics:M,resizable:C};return Q.createElement("div",{className:o,role:"rowgroup",ref:this.containerRef},Q.createElement(oX,{localizer:g,date:a,getNow:v,rtl:s,range:i,selectable:c,container:this.getContainer,getters:h,onSelectStart:y,onSelectEnd:x,onSelectSlot:this.handleSelectSlot,components:m,longPressThreshold:b,resourceId:S}),Q.createElement("div",{className:Ct("rbc-row-content",F&&"rbc-row-content-scrollable"),role:"row"},p&&Q.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},i.map(this.renderHeadingCell)),Q.createElement(G,null,Q.createElement(X,Object.assign({isAllDay:T},H,{rtl:this.props.rtl}),j.map(function(q,Z){return Q.createElement(CN,Object.assign({key:Z,segments:q},H))}),!!A.length&&Q.createElement(DN,Object.assign({segments:A,onShowMore:this.handleShowMore},H))))))}}])}(Q.Component);Ku.defaultProps={minRows:0,maxRows:1/0};var $1=function(t){var r=t.label;return Q.createElement("span",{role:"columnheader","aria-sort":"none"},r)},pX=function(t){var r=t.label,n=t.drilldownView,a=t.onDrillDown;return n?Q.createElement("button",{type:"button",className:"rbc-button-link",onClick:a},r):Q.createElement("span",null,r)},mX=["date","className"],vX=function(t,r,n,a,s){return t.filter(function(i){return Gu(i,r,n,a,s)})},cp=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Er(this,t,[].concat(a)),r.getContainer=function(){return r.containerRef.current},r.renderWeek=function(i,o){var l=r.props,c=l.events,f=l.components,d=l.selectable,h=l.getNow,m=l.selected,v=l.date,p=l.localizer,_=l.longPressThreshold,g=l.accessors,y=l.getters,x=l.showAllEvents,w=r.state,E=w.needLimitMeasure,S=w.rowLimit,b=vX(Jd(c),i[0],i[i.length-1],g,p),T=uX(b,g,p);return Q.createElement(Ku,{key:o,ref:o===0?r.slotRowRef:void 0,container:r.getContainer,className:"rbc-month-row",getNow:h,date:v,range:i,events:T,maxRows:x?1/0:S,selected:m,selectable:d,components:f,accessors:g,getters:y,localizer:p,renderHeader:r.readerDateHeading,renderForMeasure:E,onShowMore:r.handleShowMore,onSelect:r.handleSelectEvent,onDoubleClick:r.handleDoubleClickEvent,onKeyPress:r.handleKeyPressEvent,onSelectSlot:r.handleSelectSlot,longPressThreshold:_,rtl:r.props.rtl,resizable:r.props.resizable,showAllEvents:x})},r.readerDateHeading=function(i){var o=i.date,l=i.className,c=Oa(i,mX),f=r.props,d=f.date,h=f.getDrilldownView,m=f.localizer,v=m.neq(o,d,"month"),p=m.isSameDate(o,d),_=h(o),g=m.format(o,"dateFormat"),y=r.props.components.dateHeader||pX;return Q.createElement("div",Object.assign({},c,{className:Ct(l,v&&"rbc-off-range",p&&"rbc-current"),role:"cell"}),Q.createElement(y,{label:g,date:o,drilldownView:_,isOffRange:v,onDrillDown:function(w){return r.handleHeadingClick(o,_,w)}}))},r.handleSelectSlot=function(i,o){r._pendingSelection=r._pendingSelection.concat(i),clearTimeout(r._selectTimer),r._selectTimer=setTimeout(function(){return r.selectDates(o)})},r.handleHeadingClick=function(i,o,l){l.preventDefault(),r.clearSelection(),ct(r.props.onDrillDown,[i,o])},r.handleSelectEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r.handleDoubleClickEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r.handleKeyPressEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.handleShowMore=function(i,o,l,c,f){var d=r.props,h=d.popup,m=d.onDrillDown,v=d.onShowMore,p=d.getDrilldownView,_=d.doShowMoreDrillDown;if(r.clearSelection(),h){var g=OC(l,r.containerRef.current);r.setState({overlay:{date:o,events:i,position:g,target:f}})}else _&&ct(m,[o,p(o)||Pt.DAY]);ct(v,[i,o,c])},r.overlayDisplay=function(){r.setState({overlay:null})},r.state={rowLimit:5,needLimitMeasure:!0,date:null},r.containerRef=D.createRef(),r.slotRowRef=D.createRef(),r._bgRows=[],r._pendingSelection=[],r}return kr(t,e),Gt(t,[{key:"componentDidMount",value:function(){var n=this,a;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){a||DC(function(){a=!1,n.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.className,o=s.visibleDays(a,s),l=qI(o,7);return this._weekCount=l.length,Q.createElement("div",{className:Ct("rbc-month-view",i),role:"table","aria-label":"Month View",ref:this.containerRef},Q.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(l[0])),l.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(n){var a=this.props,s=a.localizer,i=a.components,o=n[0],l=n[n.length-1],c=i.header||$1;return s.range(o,l,"day").map(function(f,d){return Q.createElement("div",{key:"header_"+d,className:"rbc-header"},Q.createElement(c,{date:f,localizer:s,label:s.format(f,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var n,a,s=this,i=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},o=this.props,l=o.accessors,c=o.localizer,f=o.components,d=o.getters,h=o.selected,m=o.popupOffset,v=o.handleDragStart,p=function(){return s.setState({overlay:null})};return Q.createElement(L1,{overlay:i,accessors:l,localizer:c,components:f,getters:d,selected:h,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!i.position,overlayDisplay:this.overlayDisplay,onHide:p})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(n){var a=this._pendingSelection.slice();this._pendingSelection=[],a.sort(function(o,l){return+o-+l});var s=new Date(a[0]),i=new Date(a[a.length-1]);i.setDate(a[a.length-1].getDate()+1),ct(this.props.onSelectSlot,{slots:a,start:s,end:i,action:n.action,bounds:n.bounds,box:n.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(n,a){var s=n.date,i=n.localizer;return{date:s,needLimitMeasure:i.neq(s,a.date,"month")}}}])}(Q.Component);cp.range=function(e,t){var r=t.localizer,n=r.firstVisibleDay(e,r),a=r.lastVisibleDay(e,r);return{start:n,end:a}};cp.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"month");case qr.NEXT:return n.add(e,1,"month");default:return e}};cp.title=function(e,t){var r=t.localizer;return r.format(e,"monthHeaderFormat")};var pb=function(t){var r=t.min,n=t.max,a=t.step,s=t.slots,i=t.localizer;return"".concat(+i.startOf(r,"minutes"))+"".concat(+i.startOf(n,"minutes"))+"".concat(a,"-").concat(s)};function U1(e){for(var t=e.min,r=e.max,n=e.step,a=e.timeslots,s=e.localizer,i=pb({start:t,end:r,step:n,timeslots:a,localizer:s}),o=1+s.getTotalMin(t,r),l=s.getMinutesFromMidnight(t),c=Math.ceil((o-1)/(n*a)),f=c*a,d=new Array(c),h=new Array(f),m=0;m<c;m++){d[m]=new Array(a);for(var v=0;v<a;v++){var p=m*a+v,_=p*n;h[p]=d[m][v]=s.getSlotDate(t,l,_)}}var g=h.length*n;h.push(s.getSlotDate(t,l,g));function y(x){var w=s.diff(t,x,"minutes")+s.getDstOffset(t,x);return Math.min(w,o)}return{groups:d,update:function(w){return pb(w)!==i?U1(w):this},dateIsInGroup:function(w,E){var S=d[E+1];return s.inRange(w,d[E][0],S?S[0]:r,"minutes")},nextSlot:function(w){var E=h[Math.min(h.findIndex(function(S){return S===w||s.eq(S,w)})+1,h.length-1)];return s.eq(E,w)&&(E=s.add(w,n,"minutes")),E},closestSlotToPosition:function(w){var E=Math.min(h.length-1,Math.max(0,Math.floor(w*f)));return h[E]},closestSlotFromPoint:function(w,E){var S=Math.abs(E.top-E.bottom);return this.closestSlotToPosition((w.y-E.top)/S)},closestSlotFromDate:function(w){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(s.lt(w,t,"minutes"))return h[0];if(s.gt(w,r,"minutes"))return h[h.length-1];var S=s.diff(t,w,"minutes");return h[(S-S%n)/n+E]},startsBeforeDay:function(w){return s.lt(w,t,"day")},startsAfterDay:function(w){return s.gt(w,r,"day")},startsBefore:function(w){return s.lt(s.merge(t,w),t,"minutes")},startsAfter:function(w){return s.gt(s.merge(r,w),r,"minutes")},getRange:function(w,E,S,b){S||(w=s.min(r,s.max(t,w))),b||(E=s.min(r,s.max(t,E)));var T=y(w),C=y(E),F=C>n*f&&!s.eq(r,E)?(T-n)/(n*f)*100:T/(n*f)*100;return{top:F,height:C/(n*f)*100-F,start:y(w),startDate:w,end:y(E),endDate:E}},getCurrentTimePosition:function(w){var E=y(w),S=E/(n*f)*100;return S}}}var gX=function(){function e(t,r){var n=r.accessors,a=r.slotMetrics;Yt(this,e);var s=a.getRange(n.start(t),n.end(t)),i=s.start,o=s.startDate,l=s.end,c=s.endDate,f=s.top,d=s.height;this.start=i,this.end=l,this.startMs=+o,this.endMs=+c,this.top=f,this.height=d,this.data=t}return Gt(e,[{key:"_width",get:function(){if(this.rows){var r=this.rows.reduce(function(a,s){return Math.max(a,s.leaves.length+1)},0)+1;return 100/r}if(this.leaves){var n=100-this.container._width;return n/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var r=this._width,n=Math.min(100,this._width*1.7);if(this.rows)return n;if(this.leaves)return this.leaves.length>0?n:r;var a=this.row.leaves,s=a.indexOf(this);return s===a.length-1?r:n}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var r=this.row,n=r.leaves,a=r.xOffset,s=r._width,i=n.indexOf(this)+1;return a+i*s}}])}();function xX(e,t,r){return Math.abs(t.start-e.start)<r||t.start>e.start&&t.start<e.end}function yX(e){for(var t=zH(e,["startMs",function(o){return-o.endMs}]),r=[];t.length>0;){var n=t.shift();r.push(n);for(var a=0;a<t.length;a++){var s=t[a];if(!(n.endMs>s.startMs)){if(a>0){var i=t.splice(a,1)[0];r.push(i)}break}}}return r}function PN(e){for(var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=t.map(function(f){return new gX(f,{slotMetrics:n,accessors:a})}),i=yX(s),o=[],l=function(){var d=i[c],h=o.find(function(p){return p.end>d.start||Math.abs(d.start-p.start)<r});if(!h)return d.rows=[],o.push(d),1;d.container=h;for(var m=null,v=h.rows.length-1;!m&&v>=0;v--)xX(h.rows[v],d,r)&&(m=h.rows[v]);m?(m.leaves.push(d),d.row=m):(d.leaves=[],h.rows.push(d))},c=0;c<i.length;c++)l();return i.map(function(f){return{event:f.data,style:{top:f.top,height:f.height,width:f.width,xOffset:Math.max(0,f.xOffset)}}})}function FN(e,t,r){for(var n=0;n<e.friends.length;++n)if(!(r.indexOf(e.friends[n])>-1)){t=t>e.friends[n].idx?t:e.friends[n].idx,r.push(e.friends[n]);var a=FN(e.friends[n],t,r);t=t>a?t:a}return t}function _X(e){var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=PN({events:t,minimumStartDifference:r,slotMetrics:n,accessors:a});s.sort(function(X,H){return X=X.style,H=H.style,X.top!==H.top?X.top>H.top?1:-1:X.height!==H.height?X.top+X.height<H.top+H.height?1:-1:0});for(var i=0;i<s.length;++i)s[i].friends=[],delete s[i].style.left,delete s[i].style.left,delete s[i].idx,delete s[i].size;for(var o=0;o<s.length-1;++o)for(var l=s[o],c=l.style.top,f=l.style.top+l.style.height,d=o+1;d<s.length;++d){var h=s[d],m=h.style.top,v=h.style.top+h.style.height;(m>=c&&v<=f||v>c&&v<=f||m>=c&&m<f)&&(l.friends.push(h),h.friends.push(l))}for(var p=0;p<s.length;++p){for(var _=s[p],g=[],y=0;y<100;++y)g.push(1);for(var x=0;x<_.friends.length;++x)_.friends[x].idx!==void 0&&(g[_.friends[x].idx]=0);_.idx=g.indexOf(1)}for(var w=0;w<s.length;++w){var E=0;if(!s[w].size){var S=[],b=FN(s[w],0,S);E=100/(b+1),s[w].size=E;for(var T=0;T<S.length;++T)S[T].size=E}}for(var C=0;C<s.length;++C){var F=s[C];F.style.left=F.idx*F.size;for(var M=0,j=0;j<F.friends.length;++j){var A=F.friends[j].idx;M=M>A?M:A}M<=F.idx&&(F.size=100-F.idx*F.size);var G=F.idx===0?0:3;F.style.width="calc(".concat(F.size,"% - ").concat(G,"px)"),F.style.height="calc(".concat(F.style.height,"% - 2px)"),F.style.xOffset="calc(".concat(F.style.left,"% + ").concat(G,"px)")}return s}var mb={overlap:PN,"no-overlap":_X};function wX(e){return!!(e&&e.constructor&&e.call&&e.apply)}function bX(e){e.events,e.minimumStartDifference,e.slotMetrics,e.accessors;var t=e.dayLayoutAlgorithm,r=t;return t in mb&&(r=mb[t]),wX(r)?r.apply(this,arguments):[]}var RN=function(e){function t(){return Yt(this,t),Er(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.renderSlot,s=n.resource,i=n.group,o=n.getters,l=n.components,c=l===void 0?{}:l,f=c.timeSlotWrapper,d=f===void 0?Ha:f,h=o?o.slotGroupProp(i):{};return Q.createElement("div",Object.assign({className:"rbc-timeslot-group"},h),i.map(function(m,v){var p=o?o.slotProp(m,s):{};return Q.createElement(d,{key:v,value:m,resource:s},Q.createElement("div",Object.assign({},p,{className:Ct("rbc-time-slot",p.className)}),a&&a(m,v)))}))}}])}(D.Component);function _d(e){return typeof e=="string"?e:e+"%"}function SX(e){var t=e.style,r=e.className,n=e.event,a=e.accessors,s=e.rtl,i=e.selected,o=e.label,l=e.continuesPrior,c=e.continuesAfter,f=e.getters,d=e.onClick,h=e.onDoubleClick,m=e.isBackgroundEvent,v=e.onKeyPress,p=e.components,_=p.event,g=p.eventWrapper,y=a.title(n),x=a.tooltip(n),w=a.end(n),E=a.start(n),S=f.eventProp(n,E,w,i),b=[Q.createElement("div",{key:"1",className:"rbc-event-label"},o),Q.createElement("div",{key:"2",className:"rbc-event-content"},_?Q.createElement(_,{event:n,title:y}):y)],T=t.height,C=t.top,F=t.width,M=t.xOffset,j=et(et({},S.style),{},Oi({top:_d(C),height:_d(T),width:_d(F)},s?"right":"left",_d(M)));return Q.createElement(g,Object.assign({type:"time"},e),Q.createElement("div",{role:"button",tabIndex:0,onClick:d,onDoubleClick:h,style:j,onKeyDown:v,title:x?(typeof o=="string"?o+": ":"")+x:void 0,className:Ct(m?"rbc-background-event":"rbc-event",r,S.className,{"rbc-selected":i,"rbc-event-continues-earlier":l,"rbc-event-continues-later":c})},b))}var EX=function(t){var r=t.children,n=t.className,a=t.style,s=t.innerRef;return Q.createElement("div",{className:n,style:a,ref:s},r)},kX=Q.forwardRef(function(e,t){return Q.createElement(EX,Object.assign({},e,{innerRef:t}))}),TX=["dayProp"],CX=["eventContainerWrapper"],MN=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Er(this,t,[].concat(a)),r.state={selecting:!1,timeIndicatorPosition:null},r.intervalTriggered=!1,r.renderEvents=function(i){var o=i.events,l=i.isBackgroundEvent,c=r.props,f=c.rtl,d=c.selected,h=c.accessors,m=c.localizer,v=c.getters,p=c.components,_=c.step,g=c.timeslots,y=c.dayLayoutAlgorithm,x=c.resizable,w=r,E=w.slotMetrics,S=m.messages,b=bX({events:o,accessors:h,slotMetrics:E,minimumStartDifference:Math.ceil(_*g/2),dayLayoutAlgorithm:y});return b.map(function(T,C){var F,M=T.event,j=T.style,A=h.end(M),G=h.start(M),X=(F=h.eventId(M))!==null&&F!==void 0?F:"evt_"+C,H="eventTimeRangeFormat",q,Z=E.startsBeforeDay(G),Y=E.startsAfterDay(A);Z?H="eventTimeRangeEndFormat":Y&&(H="eventTimeRangeStartFormat"),Z&&Y?q=S.allDay:q=m.format({start:G,end:A},H);var ce=Z||E.startsBefore(G),z=Y||E.startsAfter(A);return Q.createElement(SX,{style:j,event:M,label:q,key:X,getters:v,rtl:f,components:p,continuesPrior:ce,continuesAfter:z,accessors:h,resource:r.props.resource,selected:lp(M,d),onClick:function(I){return r._select(et(et(et({},M),r.props.resource&&{sourceResource:r.props.resource}),l&&{isBackgroundEvent:!0}),I)},onDoubleClick:function(I){return r._doubleClick(M,I)},isBackgroundEvent:l,onKeyPress:function(I){return r._keyPress(M,I)},resizable:x})})},r._selectable=function(){var i=r.containerRef.current,o=r.props,l=o.longPressThreshold,c=o.localizer,f=r._selector=new TN(function(){return i},{longPressThreshold:l}),d=function(p){var _=r.props.onSelecting,g=r.state||{},y=h(p),x=y.startDate,w=y.endDate;_&&(c.eq(g.startDate,x,"minutes")&&c.eq(g.endDate,w,"minutes")||_({start:x,end:w,resourceId:r.props.resource})===!1)||(r.state.start!==y.start||r.state.end!==y.end||r.state.selecting!==y.selecting)&&r.setState(y)},h=function(p){var _=r.slotMetrics.closestSlotFromPoint(p,no(i));r.state.selecting||(r._initialSlot=_);var g=r._initialSlot;c.lte(g,_)?_=r.slotMetrics.nextSlot(_):c.gt(g,_)&&(g=r.slotMetrics.nextSlot(g));var y=r.slotMetrics.getRange(c.min(g,_),c.max(g,_));return et(et({},y),{},{selecting:!0,top:"".concat(y.top,"%"),height:"".concat(y.height,"%")})},m=function(p,_){if(!G0(r.containerRef.current,p)){var g=h(p),y=g.startDate,x=g.endDate;r._selectSlot({startDate:y,endDate:x,action:_,box:p})}r.setState({selecting:!1})};f.on("selecting",d),f.on("selectStart",d),f.on("beforeSelect",function(v){if(r.props.selectable==="ignoreEvents")return!G0(r.containerRef.current,v)}),f.on("click",function(v){return m(v,"click")}),f.on("doubleClick",function(v){return m(v,"doubleClick")}),f.on("select",function(v){r.state.selecting&&(r._selectSlot(et(et({},r.state),{},{action:"select",bounds:v})),r.setState({selecting:!1}))}),f.on("reset",function(){r.state.selecting&&r.setState({selecting:!1})})},r._teardownSelectable=function(){r._selector&&(r._selector.teardown(),r._selector=null)},r._selectSlot=function(i){for(var o=i.startDate,l=i.endDate,c=i.action,f=i.bounds,d=i.box,h=o,m=[];r.props.localizer.lte(h,l);)m.push(h),h=new Date(+h+r.props.step*60*1e3);ct(r.props.onSelectSlot,{slots:m,start:o,end:l,resourceId:r.props.resource,action:c,bounds:f,box:d})},r._select=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r._doubleClick=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r._keyPress=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.slotMetrics=U1(r.props),r.containerRef=D.createRef(),r}return kr(t,e),Gt(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(n,a){this.props.selectable&&!n.selectable&&this._selectable(),!this.props.selectable&&n.selectable&&this._teardownSelectable();var s=this.props,i=s.getNow,o=s.isNow,l=s.localizer,c=s.date,f=s.min,d=s.max,h=l.neq(n.getNow(),i(),"minutes");if(n.isNow!==o||h){if(this.clearTimeIndicatorInterval(),o){var m=!h&&l.eq(n.date,c,"minutes")&&a.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(m)}}else o&&(l.neq(n.min,f,"minutes")||l.neq(n.max,d,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!a&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){n.intervalTriggered=!0,n.positionTimeIndicator(),n.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var n=this.props,a=n.min,s=n.max,i=n.getNow,o=i();if(o>=a&&o<=s){var l=this.slotMetrics.getCurrentTimePosition(o);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:l})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.max,i=n.rtl,o=n.isNow,l=n.resource,c=n.accessors,f=n.localizer,d=n.getters,h=d.dayProp,m=Oa(d,TX),v=n.components,p=v.eventContainerWrapper,_=Oa(v,CX);this.slotMetrics=this.slotMetrics.update(this.props);var g=this.slotMetrics,y=this.state,x=y.selecting,w=y.top,E=y.height,S=y.startDate,b=y.endDate,T={start:S,end:b},C=h(s,l),F=C.className,M=C.style,j=_.dayColumnWrapper||kX;return Q.createElement(j,{ref:this.containerRef,date:a,style:M,className:Ct(F,"rbc-day-slot","rbc-time-column",o&&"rbc-now",o&&"rbc-today",x&&"rbc-slot-selecting"),slotMetrics:g,resource:l},g.groups.map(function(A,G){return Q.createElement(RN,{key:G,group:A,resource:l,getters:m,components:_})}),Q.createElement(p,{localizer:f,resource:l,accessors:c,getters:m,components:_,slotMetrics:g},Q.createElement("div",{className:Ct("rbc-events-container",i&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),x&&Q.createElement("div",{className:"rbc-slot-selection",style:{top:w,height:E}},Q.createElement("span",null,f.format(T,"selectRangeFormat"))),o&&this.intervalTriggered&&Q.createElement("div",{className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}}))}}])}(Q.Component);MN.defaultProps={dragThroughEvents:!0,timeslots:2};var IN=function(t){var r=t.label;return Q.createElement(Q.Fragment,null,r)},NX=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Er(this,t,[].concat(a)),r.handleHeaderClick=function(i,o,l){l.preventDefault(),ct(r.props.onDrillDown,[i,o])},r.renderRow=function(i){var o=r.props,l=o.events,c=o.rtl,f=o.selectable,d=o.getNow,h=o.range,m=o.getters,v=o.localizer,p=o.accessors,_=o.components,g=o.resizable,y=p.resourceId(i),x=i?l.filter(function(w){return p.resource(w)===y}):l;return Q.createElement(Ku,{isAllDay:!0,rtl:c,getNow:d,minRows:2,maxRows:r.props.allDayMaxRows+1,range:h,events:x,resourceId:y,className:"rbc-allday-cell",selectable:f,selected:r.props.selected,components:_,accessors:p,getters:m,localizer:v,onSelect:r.props.onSelectEvent,onShowMore:r.props.onShowMore,onDoubleClick:r.props.onDoubleClickEvent,onKeyPress:r.props.onKeyPressEvent,onSelectSlot:r.props.onSelectSlot,longPressThreshold:r.props.longPressThreshold,resizable:g})},r}return kr(t,e),Gt(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,i=s.localizer,o=s.getDrilldownView,l=s.getNow,c=s.getters.dayProp,f=s.components.header,d=f===void 0?$1:f,h=l();return n.map(function(m,v){var p=o(m),_=i.format(m,"dayFormat"),g=c(m),y=g.className,x=g.style,w=Q.createElement(d,{date:m,label:_,localizer:i});return Q.createElement("div",{key:v,style:x,className:Ct("rbc-header",y,i.isSameDate(m,h)&&"rbc-today")},p?Q.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(S){return a.handleHeaderClick(m,p,S)}},w):Q.createElement("span",null,w))})}},{key:"render",value:function(){var n=this,a=this.props,s=a.width,i=a.rtl,o=a.resources,l=a.range,c=a.events,f=a.getNow,d=a.accessors,h=a.selectable,m=a.components,v=a.getters,p=a.scrollRef,_=a.localizer,g=a.isOverflowing,y=a.components,x=y.timeGutterHeader,w=y.resourceHeader,E=w===void 0?IN:w,S=a.resizable,b={};g&&(b[i?"marginLeft":"marginRight"]="".concat(x1()-1,"px"));var T=o.groupEvents(c);return Q.createElement("div",{style:b,ref:p,className:Ct("rbc-time-header",g&&"rbc-overflowing")},Q.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:s,minWidth:s,maxWidth:s}},x&&Q.createElement(x,null)),o.map(function(C,F){var M=bn(C,2),j=M[0],A=M[1];return Q.createElement("div",{className:"rbc-time-header-content",key:j||F},A&&Q.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(F)},Q.createElement("div",{className:"rbc-header"},Q.createElement(E,{index:F,label:d.resourceTitle(A),resource:A}))),Q.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(l.length<=1?" rbc-time-header-cell-single-day":"")},n.renderHeaderCells(l)),Q.createElement(Ku,{isAllDay:!0,rtl:i,getNow:f,minRows:2,maxRows:n.props.allDayMaxRows+1,range:l,events:T.get(j)||[],resourceId:A&&j,className:"rbc-allday-cell",selectable:h,selected:n.props.selected,components:m,accessors:d,getters:v,localizer:_,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:S}))}))}}])}(Q.Component),AX=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Er(this,t,[].concat(a)),r.handleHeaderClick=function(i,o,l){l.preventDefault(),ct(r.props.onDrillDown,[i,o])},r}return kr(t,e),Gt(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,i=s.localizer,o=s.getDrilldownView,l=s.getNow,c=s.getters.dayProp,f=s.components,d=f.header,h=d===void 0?$1:d,m=f.resourceHeader,v=m===void 0?IN:m,p=s.resources,_=s.accessors,g=s.events,y=s.rtl,x=s.selectable,w=s.components,E=s.getters,S=s.resizable,b=l(),T=p.groupEvents(g);return n.map(function(C,F){var M=o(C),j=i.format(C,"dayFormat"),A=c(C),G=A.className,X=A.style,H=Q.createElement(h,{date:C,label:j,localizer:i});return Q.createElement("div",{key:F,className:"rbc-time-header-content rbc-resource-grouping"},Q.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(n.length<=1?" rbc-time-header-cell-single-day":"")},Q.createElement("div",{style:X,className:Ct("rbc-header",G,i.isSameDate(C,b)&&"rbc-today")},M?Q.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(Z){return a.handleHeaderClick(C,M,Z)}},H):Q.createElement("span",null,H))),Q.createElement("div",{className:"rbc-row"},p.map(function(q,Z){var Y=bn(q,2),ce=Y[0],z=Y[1];return Q.createElement("div",{key:"resource_".concat(ce,"_").concat(Z),className:Ct("rbc-header",G,i.isSameDate(C,b)&&"rbc-today")},Q.createElement(v,{index:Z,label:_.resourceTitle(z),resource:z}))})),Q.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},p.map(function(q,Z){var Y=bn(q,2),ce=Y[0],z=Y[1],k=(T.get(ce)||[]).filter(function(I){return i.isSameDate(I.start,C)||i.isSameDate(I.end,C)});return Q.createElement(Ku,{key:"resource_".concat(ce,"_").concat(Z),isAllDay:!0,rtl:y,getNow:l,minRows:2,maxRows:a.props.allDayMaxRows+1,range:[C],events:k,resourceId:z&&ce,className:"rbc-allday-cell",selectable:x,selected:a.props.selected,components:w,accessors:_,getters:E,localizer:i,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:S})})))})}},{key:"render",value:function(){var n=this.props,a=n.width,s=n.rtl,i=n.range,o=n.scrollRef,l=n.isOverflowing,c=n.components.timeGutterHeader,f={};return l&&(f[s?"marginLeft":"marginRight"]="".concat(x1()-1,"px")),Q.createElement("div",{style:f,ref:o,className:Ct("rbc-time-header",l&&"rbc-overflowing")},Q.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:a,minWidth:a,maxWidth:a}},c&&Q.createElement(c,null)),this.renderHeaderCells(i))}}])}(Q.Component);function OX(e){var t=e.min,r=e.max,n=e.localizer;return n.getTimezoneOffset(t)!==n.getTimezoneOffset(r)?{start:n.add(t,-1,"day"),end:n.add(r,-1,"day")}:{start:t,end:r}}var DX=function(t){var r=t.min,n=t.max,a=t.timeslots,s=t.step,i=t.localizer,o=t.getNow,l=t.resource,c=t.components,f=t.getters,d=t.gutterRef,h=c.timeGutterWrapper,m=D.useMemo(function(){return OX({min:r,max:n,localizer:i})},[r==null?void 0:r.toISOString(),n==null?void 0:n.toISOString(),i]),v=m.start,p=m.end,_=D.useState(U1({min:v,max:p,timeslots:a,step:s,localizer:i})),g=bn(_,2),y=g[0],x=g[1];D.useEffect(function(){y&&x(y.update({min:v,max:p,timeslots:a,step:s,localizer:i}))},[v==null?void 0:v.toISOString(),p==null?void 0:p.toISOString(),a,s]);var w=D.useCallback(function(E,S){if(S)return null;var b=y.dateIsInGroup(o(),S);return Q.createElement("span",{className:Ct("rbc-label",b&&"rbc-now")},i.format(E,"timeGutterFormat"))},[y,i,o]);return Q.createElement(h,{slotMetrics:y},Q.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:d},y.groups.map(function(E,S){return Q.createElement(RN,{key:S,group:E,resource:l,components:c,renderSlot:w,getters:f})})))},jX=Q.forwardRef(function(e,t){return Q.createElement(DX,Object.assign({gutterRef:t},e))}),Om={};function PX(e,t){return{map:function(n){return e?e.map(function(a,s){return n([t.resourceId(a),a],s)}):[n([Om,null],0)]},groupEvents:function(n){var a=new Map;return e?(n.forEach(function(s){var i=t.resource(s)||Om;if(Array.isArray(i))i.forEach(function(l){var c=a.get(l)||[];c.push(s),a.set(l,c)});else{var o=a.get(i)||[];o.push(s),a.set(i,o)}}),a):(a.set(Om,n),a)}}}var ec=function(e){function t(r){var n;return Yt(this,t),n=Er(this,t,[r]),n.handleScroll=function(a){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=a.target.scrollLeft)},n.handleResize=function(){e2(n.rafHandle),n.rafHandle=DC(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onKeyPressEvent,s)},n.handleSelectEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onSelectEvent,s)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onDoubleClickEvent,s)},n.handleShowMore=function(a,s,i,o,l){var c=n.props,f=c.popup,d=c.onDrillDown,h=c.onShowMore,m=c.getDrilldownView,v=c.doShowMoreDrillDown;if(n.clearSelection(),f){var p=OC(i,n.containerRef.current);n.setState({overlay:{date:s,events:a,position:et(et({},p),{},{width:"200px"}),target:l}})}else v&&ct(d,[s,m(s)||Pt.DAY]);ct(h,[a,s,o])},n.handleSelectAllDaySlot=function(a,s){var i=n.props.onSelectSlot,o=new Date(a[0]),l=new Date(a[a.length-1]);l.setDate(a[a.length-1].getDate()+1),ct(i,{slots:a,start:o,end:l,action:s.action,resourceId:s.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var a=n.contentRef.current;if(a!=null&&a.scrollHeight){var s=a.scrollHeight>a.clientHeight;n.state.isOverflowing!==s&&(n._updatingOverflow=!0,n.setState({isOverflowing:s},function(){n._updatingOverflow=!1}))}}},n.memoizedResources=rN(function(a,s){return PX(a,s)}),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=Q.createRef(),n.contentRef=Q.createRef(),n.containerRef=Q.createRef(),n._scrollRatio=null,n.gutterRef=D.createRef(),n}return kr(t,e),Gt(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),e2(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(n,a,s,i,o,l,c,f,d,h){var m=this.props,v=m.min,p=m.max,_=(i.get(a)||[]).filter(function(y){return l.inRange(n,c.start(y),c.end(y),"day")}),g=(o.get(a)||[]).filter(function(y){return l.inRange(n,c.start(y),c.end(y),"day")});return Q.createElement(MN,Object.assign({},this.props,{localizer:l,min:l.merge(n,v),max:l.merge(n,p),resource:s&&a,components:f,isNow:l.isSameDate(n,h),key:"".concat(a,"-").concat(n),date:n,events:_,backgroundEvents:g,dayLayoutAlgorithm:d}))}},{key:"renderResourcesFirst",value:function(n,a,s,i,o,l,c,f,d){var h=this;return a.map(function(m){var v=bn(m,2),p=v[0],_=v[1];return n.map(function(g){return h.renderDayColumn(g,p,_,s,i,o,l,f,d,c)})})}},{key:"renderRangeFirst",value:function(n,a,s,i,o,l,c,f,d){var h=this;return n.map(function(m){return Q.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:m},a.map(function(v){var p=bn(v,2),_=p[0],g=p[1];return Q.createElement("div",{style:{flex:1},key:l.resourceId(g)},h.renderDayColumn(m,_,g,s,i,o,l,f,d,c))}))})}},{key:"renderEvents",value:function(n,a,s,i){var o=this.props,l=o.accessors,c=o.localizer,f=o.resourceGroupingLayout,d=o.components,h=o.dayLayoutAlgorithm,m=this.memoizedResources(this.props.resources,l),v=m.groupEvents(a),p=m.groupEvents(s);return f?this.renderRangeFirst(n,m,v,p,c,l,i,d,h):this.renderResourcesFirst(n,m,v,p,c,l,i,d,h)}},{key:"render",value:function(){var n,a=this.props,s=a.events,i=a.backgroundEvents,o=a.range,l=a.width,c=a.rtl,f=a.selected,d=a.getNow,h=a.resources,m=a.components,v=a.accessors,p=a.getters,_=a.localizer,g=a.min,y=a.max,x=a.showMultiDayTimes,w=a.longPressThreshold,E=a.resizable,S=a.resourceGroupingLayout;l=l||this.state.gutterWidth;var b=o[0],T=o[o.length-1];this.slots=o.length;var C=[],F=[],M=[];s.forEach(function(A){if(Gu(A,b,T,v,_)){var G=v.start(A),X=v.end(A);v.allDay(A)||_.startAndEndAreDateOnly(G,X)||!x&&!_.isSameDate(G,X)?C.push(A):F.push(A)}}),i.forEach(function(A){Gu(A,b,T,v,_)&&M.push(A)}),C.sort(function(A,G){return _g(A,G,v,_)});var j={range:o,events:C,width:l,rtl:c,getNow:d,localizer:_,selected:f,allDayMaxRows:this.props.showAllEvents?1/0:(n=this.props.allDayMaxRows)!==null&&n!==void 0?n:1/0,resources:this.memoizedResources(h,v),selectable:this.props.selectable,accessors:v,getters:p,components:m,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:w,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:E};return Q.createElement("div",{className:Ct("rbc-time-view",h&&"rbc-time-view-resources"),ref:this.containerRef},h&&h.length>1&&S?Q.createElement(AX,j):Q.createElement(NX,j),this.props.popup&&this.renderOverlay(),Q.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},Q.createElement(jX,{date:b,ref:this.gutterRef,localizer:_,min:_.merge(b,g),max:_.merge(b,y),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:m,className:"rbc-time-gutter",getters:p}),this.renderEvents(o,F,M,d())))}},{key:"renderOverlay",value:function(){var n,a,s=this,i=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},o=this.props,l=o.accessors,c=o.localizer,f=o.components,d=o.getters,h=o.selected,m=o.popupOffset,v=o.handleDragStart,p=function(){return s.setState({overlay:null})};return Q.createElement(L1,{overlay:i,accessors:l,localizer:c,components:f,getters:d,selected:h,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!i.position,overlayDisplay:this.overlayDisplay,onHide:p})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var n=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var a,s=(a=n.gutterRef)!==null&&a!==void 0&&a.current?xg(n.gutterRef.current):void 0;s&&n.state.gutterWidth!==s&&n.setState({gutterWidth:s})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var n=this.contentRef.current;n.scrollTop=n.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,a=n.min,s=n.max,i=n.scrollToTime,o=n.localizer,l=o.diff(o.merge(i,a),i,"milliseconds"),c=o.diff(a,s,"milliseconds");this._scrollRatio=l/c}}])}(D.Component);ec.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var FX=["date","localizer","min","max","scrollToTime","enableAutoScroll"],up=function(e){function t(){return Yt(this,t),Er(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,m=h===void 0?!0:h,v=Oa(n,FX),p=t.range(a,{localizer:s});return Q.createElement(ec,Object.assign({},v,{range:p,eventOffset:10,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:m}))}}])}(Q.Component);up.range=function(e,t){var r=t.localizer;return[r.startOf(e,"day")]};up.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"day");case qr.NEXT:return n.add(e,1,"day");default:return e}};up.title=function(e,t){var r=t.localizer;return r.format(e,"dayHeaderFormat")};var RX=["date","localizer","min","max","scrollToTime","enableAutoScroll"],ii=function(e){function t(){return Yt(this,t),Er(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,m=h===void 0?!0:h,v=Oa(n,RX),p=t.range(a,this.props);return Q.createElement(ec,Object.assign({},v,{range:p,eventOffset:15,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:m}))}}])}(Q.Component);ii.defaultProps=ec.defaultProps;ii.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"week");case qr.NEXT:return n.add(e,1,"week");default:return e}};ii.range=function(e,t){var r=t.localizer,n=r.startOfWeek(),a=r.startOf(e,"week",n),s=r.endOf(e,"week",n);return r.range(a,s)};ii.title=function(e,t){var r=t.localizer,n=ii.range(e,{localizer:r}),a=cN(n),s=a[0],i=a.slice(1);return r.format({start:s,end:i.pop()},"dayRangeHeaderFormat")};var MX=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function B1(e,t){return ii.range(e,t).filter(function(r){return[6,0].indexOf(r.getDay())===-1})}var Df=function(e){function t(){return Yt(this,t),Er(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,m=h===void 0?!0:h,v=Oa(n,MX),p=B1(a,this.props);return Q.createElement(ec,Object.assign({},v,{range:p,eventOffset:15,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:m}))}}])}(Q.Component);Df.defaultProps=ec.defaultProps;Df.range=B1;Df.navigate=ii.navigate;Df.title=function(e,t){var r=t.localizer,n=B1(e,{localizer:r}),a=cN(n),s=a[0],i=a.slice(1);return r.format({start:s,end:i.pop()},"dayRangeHeaderFormat")};var fp=30;function dp(e){var t=e.accessors,r=e.components,n=e.date,a=e.events,s=e.getters,i=e.length,o=i===void 0?fp:i,l=e.localizer,c=e.onDoubleClickEvent,f=e.onSelectEvent,d=e.selected,h=D.useRef(null),m=D.useRef(null),v=D.useRef(null),p=D.useRef(null),_=D.useRef(null);D.useEffect(function(){x()});var g=function(T,C,F){var M=r.event,j=r.date;return C=C.filter(function(A){return Gu(A,l.startOf(T,"day"),l.endOf(T,"day"),t,l)}),C.map(function(A,G){var X=t.title(A),H=t.end(A),q=t.start(A),Z=s.eventProp(A,q,H,lp(A,d)),Y=G===0&&l.format(T,"agendaDateFormat"),ce=G===0?Q.createElement("td",{rowSpan:C.length,className:"rbc-agenda-date-cell"},j?Q.createElement(j,{day:T,label:Y}):Y):!1;return Q.createElement("tr",{key:F+"_"+G,className:Z.className,style:Z.style},ce,Q.createElement("td",{className:"rbc-agenda-time-cell"},y(T,A)),Q.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(k){return f&&f(A,k)},onDoubleClick:function(k){return c&&c(A,k)}},M?Q.createElement(M,{event:A,title:X}):X))},[])},y=function(T,C){var F="",M=r.time,j=l.messages.allDay,A=t.end(C),G=t.start(C);return t.allDay(C)||(l.eq(G,A)?j=l.format(G,"agendaTimeFormat"):l.isSameDate(G,A)?j=l.format({start:G,end:A},"agendaTimeRangeFormat"):l.isSameDate(T,G)?j=l.format(G,"agendaTimeFormat"):l.isSameDate(T,A)&&(j=l.format(A,"agendaTimeFormat"))),l.gt(T,G,"day")&&(F="rbc-continues-prior"),l.lt(T,A,"day")&&(F+=" rbc-continues-after"),Q.createElement("span",{className:F.trim()},M?Q.createElement(M,{event:C,day:T,label:j}):j)},x=function(){if(_.current){var T=h.current,C=_.current.firstChild;if(C){var F=p.current.scrollHeight>p.current.clientHeight,M=[],j=M;M=[xg(C.children[0]),xg(C.children[1])],(j[0]!==M[0]||j[1]!==M[1])&&(m.current.style.width=M[0]+"px",v.current.style.width=M[1]+"px"),F?(ML(T,"rbc-header-overflowing"),T.style.marginRight=x1()+"px"):IL(T,"rbc-header-overflowing")}}},w=l.messages,E=l.add(n,o,"day"),S=l.range(n,E,"day");return a=a.filter(function(b){return Gu(b,l.startOf(n,"day"),l.endOf(E,"day"),t,l)}),a.sort(function(b,T){return+t.start(b)-+t.start(T)}),Q.createElement("div",{className:"rbc-agenda-view"},a.length!==0?Q.createElement(Q.Fragment,null,Q.createElement("table",{ref:h,className:"rbc-agenda-table"},Q.createElement("thead",null,Q.createElement("tr",null,Q.createElement("th",{className:"rbc-header",ref:m},w.date),Q.createElement("th",{className:"rbc-header",ref:v},w.time),Q.createElement("th",{className:"rbc-header"},w.event)))),Q.createElement("div",{className:"rbc-agenda-content",ref:p},Q.createElement("table",{className:"rbc-agenda-table"},Q.createElement("tbody",{ref:_},S.map(function(b,T){return g(b,a,T)}))))):Q.createElement("span",{className:"rbc-agenda-empty"},w.noEventsInRange))}dp.range=function(e,t){var r=t.length,n=r===void 0?fp:r,a=t.localizer,s=a.add(e,n,"day");return{start:e,end:s}};dp.navigate=function(e,t,r){var n=r.length,a=n===void 0?fp:n,s=r.localizer;switch(t){case qr.PREVIOUS:return s.add(e,-a,"day");case qr.NEXT:return s.add(e,a,"day");default:return e}};dp.title=function(e,t){var r=t.length,n=r===void 0?fp:r,a=t.localizer,s=a.add(e,n,"day");return a.format({start:e,end:s},"agendaHeaderFormat")};var e0=Oi(Oi(Oi(Oi(Oi({},Pt.MONTH,cp),Pt.WEEK,ii),Pt.WORK_WEEK,Df),Pt.DAY,up),Pt.AGENDA,dp),IX=["action","date","today"];function LX(e,t){var r=t.action,n=t.date,a=t.today,s=Oa(t,IX);switch(e=typeof e=="string"?e0[e]:e,r){case qr.TODAY:n=a||new Date;break;case qr.DATE:break;default:Ru(e&&typeof e.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),n=e.navigate(n,r,s)}return n}function $X(e,t){var r=null;return typeof t=="function"?r=t(e):typeof t=="string"&&ds(e)==="object"&&e!=null&&t in e&&(r=e[t]),r}var Ua=function(t){return function(r){return $X(r,t)}},UX=["view","date","getNow","onNavigate"],BX=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function LN(e){if(Array.isArray(e))return e;for(var t=[],r=0,n=Object.entries(e);r<n.length;r++){var a=bn(n[r],2),s=a[0],i=a[1];i&&t.push(s)}return t}function WX(e,t){var r=t.views,n=LN(r);return n.indexOf(e)!==-1}var $N=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Er(this,t,[].concat(a)),r.getViews=function(){var i=r.props.views;return Array.isArray(i)?yq(i,function(o,l){return o[l]=e0[l]},{}):ds(i)==="object"?yz(i,function(o,l){return o===!0?e0[l]:o}):e0},r.getView=function(){var i=r.getViews();return i[r.props.view]},r.getDrilldownView=function(i){var o=r.props,l=o.view,c=o.drilldownView,f=o.getDrilldownView;return f?f(i,l,Object.keys(r.getViews())):c},r.handleRangeChange=function(i,o,l){var c=r.props,f=c.onRangeChange,d=c.localizer;f&&o.range&&f(o.range(i,{localizer:d}),l)},r.handleNavigate=function(i,o){var l=r.props,c=l.view,f=l.date,d=l.getNow,h=l.onNavigate,m=Oa(l,UX),v=r.getView(),p=d();f=LX(v,et(et({},m),{},{action:i,date:o||f||p,today:p})),h(f,c,i),r.handleRangeChange(f,v)},r.handleViewChange=function(i){i!==r.props.view&&WX(i,r.props)&&r.props.onView(i);var o=r.getViews();r.handleRangeChange(r.props.date||r.props.getNow(),o[i],i)},r.handleSelectEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r.handleDoubleClickEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r.handleKeyPressEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.handleSelectSlot=function(i){ct(r.props.onSelectSlot,i)},r.handleDrillDown=function(i,o){var l=r.props.onDrillDown;if(l){l(i,o,r.drilldownView);return}o&&r.handleViewChange(o),r.handleNavigate(qr.DATE,i)},r.state={context:t.getContext(r.props)},r}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.view,s=n.toolbar,i=n.events,o=n.backgroundEvents,l=n.resourceGroupingLayout,c=n.style,f=n.className,d=n.elementProps,h=n.date,m=n.getNow,v=n.length,p=n.showMultiDayTimes,_=n.onShowMore,g=n.doShowMoreDrillDown;n.components,n.formats,n.messages,n.culture;var y=Oa(n,BX);h=h||m();var x=this.getView(),w=this.state.context,E=w.accessors,S=w.components,b=w.getters,T=w.localizer,C=w.viewNames,F=S.toolbar||zq,M=x.title(h,{localizer:T,length:v});return Q.createElement("div",Object.assign({},d,{className:Ct(f,"rbc-calendar",y.rtl&&"rbc-rtl"),style:c}),s&&Q.createElement(F,{date:h,view:a,views:C,label:M,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:T}),Q.createElement(x,Object.assign({},y,{events:i,backgroundEvents:o,date:h,getNow:m,length:v,localizer:T,getters:b,components:S,accessors:E,showMultiDayTimes:p,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:_,doShowMoreDrillDown:g,resourceGroupingLayout:l})))}}],[{key:"getDerivedStateFromProps",value:function(n){return{context:t.getContext(n)}}},{key:"getContext",value:function(n){var a=n.startAccessor,s=n.endAccessor,i=n.allDayAccessor,o=n.tooltipAccessor,l=n.titleAccessor,c=n.resourceAccessor,f=n.resourceIdAccessor,d=n.resourceTitleAccessor,h=n.eventIdAccessor,m=n.eventPropGetter,v=n.backgroundEventPropGetter,p=n.slotPropGetter,_=n.slotGroupPropGetter,g=n.dayPropGetter,y=n.view,x=n.views,w=n.localizer,E=n.culture,S=n.messages,b=S===void 0?{}:S,T=n.components,C=T===void 0?{}:T,F=n.formats,M=F===void 0?{}:F,j=LN(x),A=Gq(b);return{viewNames:j,localizer:Hq(w,E,M,A),getters:{eventProp:function(){return m&&m.apply(void 0,arguments)||{}},backgroundEventProp:function(){return v&&v.apply(void 0,arguments)||{}},slotProp:function(){return p&&p.apply(void 0,arguments)||{}},slotGroupProp:function(){return _&&_.apply(void 0,arguments)||{}},dayProp:function(){return g&&g.apply(void 0,arguments)||{}}},components:dz(C[y]||{},iq(C,j),{eventWrapper:Ha,backgroundEventWrapper:Ha,eventContainerWrapper:Ha,dateCellWrapper:Ha,weekWrapper:Ha,timeSlotWrapper:Ha,timeGutterWrapper:Ha}),accessors:{start:Ua(a),end:Ua(s),allDay:Ua(i),tooltip:Ua(o),title:Ua(l),resource:Ua(c),resourceId:Ua(f),resourceTitle:Ua(d),eventId:Ua(h)}}}}])}(Q.Component);$N.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:Pt.MONTH,views:[Pt.MONTH,Pt.WEEK,Pt.DAY,Pt.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:Pt.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var VX=uC($N,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),HX=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"MMMM DD",r)+" – "+n.format(s,n.eq(a,s,"month")?"DD":"MMMM DD",r)},zX=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"L",r)+" – "+n.format(s,"L",r)},Dm=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"LT",r)+" – "+n.format(s,"LT",r)},YX=function(t,r,n){var a=t.start;return n.format(a,"LT",r)+" – "},GX=function(t,r,n){var a=t.end;return" – "+n.format(a,"LT",r)},KX={dateFormat:"DD",dayFormat:"DD ddd",weekdayFormat:"ddd",selectRangeFormat:Dm,eventTimeRangeFormat:Dm,eventTimeRangeStartFormat:YX,eventTimeRangeEndFormat:GX,timeGutterFormat:"LT",monthHeaderFormat:"MMMM YYYY",dayHeaderFormat:"dddd MMM DD",dayRangeHeaderFormat:HX,agendaHeaderFormat:zX,agendaDateFormat:"ddd MMM DD",agendaTimeFormat:"LT",agendaTimeRangeFormat:Dm};function Ts(e){var t=e&&e.toLowerCase();return t==="FullYear"?t="year":t||(t=void 0),t}function qX(e){var t=function(k,I){return I?k.locale(I):k};function r(z){return e(z).toDate().getTimezoneOffset()}function n(z,k){var I,N,P=e(z).local(),K=e(k).local();if(!e.tz)return P.toDate().getTimezoneOffset()-K.toDate().getTimezoneOffset();var ne=(I=P==null||(N=P._z)===null||N===void 0?void 0:N.name)!==null&&I!==void 0?I:e.tz.guess(),J=e.tz.zone(ne).utcOffset(+P),ie=e.tz.zone(ne).utcOffset(+K);return J-ie}function a(z){var k=e(z).startOf("day");return n(k,z)}function s(z,k,I){var N=Ts(I),P=N?e(z).startOf(N):e(z),K=N?e(k).startOf(N):e(k);return[P,K,N]}function i(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,k=arguments.length>1?arguments[1]:void 0,I=Ts(k);return I?e(z).startOf(I).toDate():e(z).toDate()}function o(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,k=arguments.length>1?arguments[1]:void 0,I=Ts(k);return I?e(z).endOf(I).toDate():e(z).toDate()}function l(z,k,I){var N=s(z,k,I),P=bn(N,3),K=P[0],ne=P[1],J=P[2];return K.isSame(ne,J)}function c(z,k,I){return!l(z,k,I)}function f(z,k,I){var N=s(z,k,I),P=bn(N,3),K=P[0],ne=P[1],J=P[2];return K.isAfter(ne,J)}function d(z,k,I){var N=s(z,k,I),P=bn(N,3),K=P[0],ne=P[1],J=P[2];return K.isBefore(ne,J)}function h(z,k,I){var N=s(z,k,I),P=bn(N,3),K=P[0],ne=P[1],J=P[2];return K.isSameOrBefore(ne,J)}function m(z,k,I){var N=s(z,k,I),P=bn(N,3),K=P[0],ne=P[1],J=P[2];return K.isSameOrBefore(ne,J)}function v(z,k,I){var N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"day",P=Ts(N),K=e(z),ne=e(k),J=e(I);return K.isBetween(ne,J,P,"[]")}function p(z,k){var I=e(z),N=e(k),P=e.min(I,N);return P.toDate()}function _(z,k){var I=e(z),N=e(k),P=e.max(I,N);return P.toDate()}function g(z,k){if(!z&&!k)return null;var I=e(k).format("HH:mm:ss"),N=e(z).startOf("day").format("MM/DD/YYYY");return e("".concat(N," ").concat(I),"MM/DD/YYYY HH:mm:ss").toDate()}function y(z,k,I){var N=Ts(I);return e(z).add(k,N).toDate()}function x(z,k){for(var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",N=Ts(I),P=e(z).toDate(),K=[];m(P,k);)K.push(P),P=y(P,1,N);return K}function w(z,k){var I=Ts(k),N=i(z,I);return l(N,z)?N:y(N,1,I)}function E(z,k){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",N=Ts(I),P=e(z),K=e(k);return K.diff(P,N)}function S(z){var k=e(z);return k.minutes()}function b(z){var k=z?e.localeData(z):e.localeData();return k?k.firstDayOfWeek():0}function T(z){return e(z).startOf("month").startOf("week").toDate()}function C(z){return e(z).endOf("month").endOf("week").toDate()}function F(z){for(var k=T(z),I=C(z),N=[];m(k,I);)N.push(k),k=y(k,1,"d");return N}function M(z,k,I){return e(z).startOf("day").minute(k+I).toDate()}function j(z,k){return E(z,k,"minutes")}function A(z){var k=e(z).startOf("day"),I=e(z);return I.diff(k,"minutes")+a(z)}function G(z,k){var I=e(z),N=e(k);return I.isBefore(N,"day")}function X(z,k,I){var N=e(k),P=e(I);return N.isSameOrAfter(P,"minutes")}function H(z,k){var I=e(z),N=e(k),P=e.duration(N.diff(I));return P.days()}function q(z){var k=z.evtA,I=k.start,N=k.end,P=k.allDay,K=z.evtB,ne=K.start,J=K.end,ie=K.allDay,oe=+i(I,"day")-+i(ne,"day"),Se=H(I,N),W=H(ne,J);return oe||W-Se||!!ie-!!P||+I-+ne||+N-+J}function Z(z){var k=z.event,I=k.start,N=k.end,P=z.range,K=P.start,ne=P.end,J=e(I).startOf("day"),ie=e(N),oe=e(K),Se=e(ne),W=J.isSameOrBefore(Se,"day"),Ne=!J.isSame(ie,"minutes"),ke=Ne?ie.isAfter(oe,"minutes"):ie.isSameOrAfter(oe,"minutes");return W&&ke}function Y(z,k){var I=e(z),N=e(k);return I.isSame(N,"day")}function ce(){var z=new Date,k=/-/.test(z.toString())?"-":"",I=z.getTimezoneOffset(),N=Number("".concat(k).concat(Math.abs(I))),P=e().utcOffset();return P>N?1:0}return new Vq({formats:KX,firstOfWeek:b,firstVisibleDay:T,lastVisibleDay:C,visibleDays:F,format:function(k,I,N){return t(e(k),N).format(I)},lt:d,lte:m,gt:f,gte:h,eq:l,neq:c,merge:g,inRange:v,startOf:i,endOf:o,range:x,add:y,diff:E,ceil:w,min:p,max:_,minutes:S,getSlotDate:M,getTimezoneOffset:r,getDstOffset:n,getTotalMin:j,getMinutesFromMidnight:A,continuesPrior:G,continuesAfter:X,sortEvents:q,inEventRange:Z,isSameDate:Y,daySpan:H,browserTZOffset:ce})}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var UN;function xe(){return UN.apply(null,arguments)}function XX(e){UN=e}function ia(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Bi(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function W1(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Ke(e,t))return!1;return!0}function $r(e){return e===void 0}function ps(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function jf(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function BN(e,t){var r=[],n,a=e.length;for(n=0;n<a;++n)r.push(t(e[n],n));return r}function Bs(e,t){for(var r in t)Ke(t,r)&&(e[r]=t[r]);return Ke(t,"toString")&&(e.toString=t.toString),Ke(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Ra(e,t,r,n){return u4(e,t,r,n,!0).utc()}function JX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Fe(e){return e._pf==null&&(e._pf=JX()),e._pf}var wg;Array.prototype.some?wg=Array.prototype.some:wg=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function V1(e){var t=null,r=!1,n=e._d&&!isNaN(e._d.getTime());if(n&&(t=Fe(e),r=wg.call(t.parsedDateParts,function(a){return a!=null}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function hp(e){var t=Ra(NaN);return e!=null?Bs(Fe(t),e):Fe(t).userInvalidated=!0,t}var vb=xe.momentProperties=[],jm=!1;function H1(e,t){var r,n,a,s=vb.length;if($r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),$r(t._i)||(e._i=t._i),$r(t._f)||(e._f=t._f),$r(t._l)||(e._l=t._l),$r(t._strict)||(e._strict=t._strict),$r(t._tzm)||(e._tzm=t._tzm),$r(t._isUTC)||(e._isUTC=t._isUTC),$r(t._offset)||(e._offset=t._offset),$r(t._pf)||(e._pf=Fe(t)),$r(t._locale)||(e._locale=t._locale),s>0)for(r=0;r<s;r++)n=vb[r],a=t[n],$r(a)||(e[n]=a);return e}function Pf(e){H1(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),jm===!1&&(jm=!0,xe.updateOffset(this),jm=!1)}function oa(e){return e instanceof Pf||e!=null&&e._isAMomentObject!=null}function WN(e){xe.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function In(e,t){var r=!0;return Bs(function(){if(xe.deprecationHandler!=null&&xe.deprecationHandler(null,e),r){var n=[],a,s,i,o=arguments.length;for(s=0;s<o;s++){if(a="",typeof arguments[s]=="object"){a+=`
[`+s+"] ";for(i in arguments[0])Ke(arguments[0],i)&&(a+=i+": "+arguments[0][i]+", ");a=a.slice(0,-2)}else a=arguments[s];n.push(a)}WN(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var gb={};function VN(e,t){xe.deprecationHandler!=null&&xe.deprecationHandler(e,t),gb[e]||(WN(t),gb[e]=!0)}xe.suppressDeprecationWarnings=!1;xe.deprecationHandler=null;function Ma(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function QX(e){var t,r;for(r in e)Ke(e,r)&&(t=e[r],Ma(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function bg(e,t){var r=Bs({},e),n;for(n in t)Ke(t,n)&&(Bi(e[n])&&Bi(t[n])?(r[n]={},Bs(r[n],e[n]),Bs(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Ke(e,n)&&!Ke(t,n)&&Bi(e[n])&&(r[n]=Bs({},r[n]));return r}function z1(e){e!=null&&this.set(e)}var Sg;Object.keys?Sg=Object.keys:Sg=function(e){var t,r=[];for(t in e)Ke(e,t)&&r.push(t);return r};var ZX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function eJ(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Ma(n)?n.call(t,r):n}function Da(e,t,r){var n=""+Math.abs(e),a=t-n.length,s=e>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+n}var Y1=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,wd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Pm={},ll={};function Ee(e,t,r,n){var a=n;typeof n=="string"&&(a=function(){return this[n]()}),e&&(ll[e]=a),t&&(ll[t[0]]=function(){return Da(a.apply(this,arguments),t[1],t[2])}),r&&(ll[r]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function tJ(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function rJ(e){var t=e.match(Y1),r,n;for(r=0,n=t.length;r<n;r++)ll[t[r]]?t[r]=ll[t[r]]:t[r]=tJ(t[r]);return function(a){var s="",i;for(i=0;i<n;i++)s+=Ma(t[i])?t[i].call(a,e):t[i];return s}}function t0(e,t){return e.isValid()?(t=HN(t,e.localeData()),Pm[t]=Pm[t]||rJ(t),Pm[t](e)):e.localeData().invalidDate()}function HN(e,t){var r=5;function n(a){return t.longDateFormat(a)||a}for(wd.lastIndex=0;r>=0&&wd.test(e);)e=e.replace(wd,n),wd.lastIndex=0,r-=1;return e}var nJ={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function aJ(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Y1).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var sJ="Invalid date";function iJ(){return this._invalidDate}var oJ="%d",lJ=/\d{1,2}/;function cJ(e){return this._ordinal.replace("%d",e)}var uJ={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function fJ(e,t,r,n){var a=this._relativeTime[r];return Ma(a)?a(e,t,r,n):a.replace(/%d/i,e)}function dJ(e,t){var r=this._relativeTime[e>0?"future":"past"];return Ma(r)?r(t):r.replace(/%s/i,t)}var xb={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ln(e){return typeof e=="string"?xb[e]||xb[e.toLowerCase()]:void 0}function G1(e){var t={},r,n;for(n in e)Ke(e,n)&&(r=Ln(n),r&&(t[r]=e[n]));return t}var hJ={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function pJ(e){var t=[],r;for(r in e)Ke(e,r)&&t.push({unit:r,priority:hJ[r]});return t.sort(function(n,a){return n.priority-a.priority}),t}var zN=/\d/,dn=/\d\d/,YN=/\d{3}/,K1=/\d{4}/,pp=/[+-]?\d{6}/,dt=/\d\d?/,GN=/\d\d\d\d?/,KN=/\d\d\d\d\d\d?/,mp=/\d{1,3}/,q1=/\d{1,4}/,vp=/[+-]?\d{1,6}/,tc=/\d+/,gp=/[+-]?\d+/,mJ=/Z|[+-]\d\d:?\d\d/gi,xp=/Z|[+-]\d\d(?::?\d\d)?/gi,vJ=/[+-]?\d+(\.\d{1,3})?/,Ff=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,rc=/^[1-9]\d?/,X1=/^([1-9]\d|\d)/,K0;K0={};function we(e,t,r){K0[e]=Ma(t)?t:function(n,a){return n&&r?r:t}}function gJ(e,t){return Ke(K0,e)?K0[e](t._strict,t._locale):new RegExp(xJ(e))}function xJ(e){return ts(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,a,s){return r||n||a||s}))}function ts(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function wn(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Le(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=wn(t)),r}var Eg={};function Ze(e,t){var r,n=t,a;for(typeof e=="string"&&(e=[e]),ps(t)&&(n=function(s,i){i[t]=Le(s)}),a=e.length,r=0;r<a;r++)Eg[e[r]]=n}function Rf(e,t){Ze(e,function(r,n,a,s){a._w=a._w||{},t(r,a._w,a,s)})}function yJ(e,t,r){t!=null&&Ke(Eg,e)&&Eg[e](t,r._a,r,e)}function yp(e){return e%4===0&&e%100!==0||e%400===0}var yr=0,Ja=1,_a=2,Vt=3,Xn=4,Qa=5,Ri=6,_J=7,wJ=8;Ee("Y",0,0,function(){var e=this.year();return e<=9999?Da(e,4):"+"+e});Ee(0,["YY",2],0,function(){return this.year()%100});Ee(0,["YYYY",4],0,"year");Ee(0,["YYYYY",5],0,"year");Ee(0,["YYYYYY",6,!0],0,"year");we("Y",gp);we("YY",dt,dn);we("YYYY",q1,K1);we("YYYYY",vp,pp);we("YYYYYY",vp,pp);Ze(["YYYYY","YYYYYY"],yr);Ze("YYYY",function(e,t){t[yr]=e.length===2?xe.parseTwoDigitYear(e):Le(e)});Ze("YY",function(e,t){t[yr]=xe.parseTwoDigitYear(e)});Ze("Y",function(e,t){t[yr]=parseInt(e,10)});function nu(e){return yp(e)?366:365}xe.parseTwoDigitYear=function(e){return Le(e)+(Le(e)>68?1900:2e3)};var qN=nc("FullYear",!0);function bJ(){return yp(this.year())}function nc(e,t){return function(r){return r!=null?(XN(this,e,r),xe.updateOffset(this,t),this):qu(this,e)}}function qu(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function XN(e,t,r){var n,a,s,i,o;if(!(!e.isValid()||isNaN(r))){switch(n=e._d,a=e._isUTC,t){case"Milliseconds":return void(a?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(a?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(a?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(a?n.setUTCHours(r):n.setHours(r));case"Date":return void(a?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,i=e.month(),o=e.date(),o=o===29&&i===1&&!yp(s)?28:o,a?n.setUTCFullYear(s,i,o):n.setFullYear(s,i,o)}}function SJ(e){return e=Ln(e),Ma(this[e])?this[e]():this}function EJ(e,t){if(typeof e=="object"){e=G1(e);var r=pJ(e),n,a=r.length;for(n=0;n<a;n++)this[r[n].unit](e[r[n].unit])}else if(e=Ln(e),Ma(this[e]))return this[e](t);return this}function kJ(e,t){return(e%t+t)%t}var Dt;Array.prototype.indexOf?Dt=Array.prototype.indexOf:Dt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function J1(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=kJ(t,12);return e+=(t-r)/12,r===1?yp(e)?29:28:31-r%7%2}Ee("M",["MM",2],"Mo",function(){return this.month()+1});Ee("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Ee("MMMM",0,0,function(e){return this.localeData().months(this,e)});we("M",dt,rc);we("MM",dt,dn);we("MMM",function(e,t){return t.monthsShortRegex(e)});we("MMMM",function(e,t){return t.monthsRegex(e)});Ze(["M","MM"],function(e,t){t[Ja]=Le(e)-1});Ze(["MMM","MMMM"],function(e,t,r,n){var a=r._locale.monthsParse(e,n,r._strict);a!=null?t[Ja]=a:Fe(r).invalidMonth=e});var TJ="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),JN="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),QN=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,CJ=Ff,NJ=Ff;function AJ(e,t){return e?ia(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||QN).test(t)?"format":"standalone"][e.month()]:ia(this._months)?this._months:this._months.standalone}function OJ(e,t){return e?ia(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[QN.test(t)?"format":"standalone"][e.month()]:ia(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function DJ(e,t,r){var n,a,s,i=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Ra([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?t==="MMM"?(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:null):(a=Dt.call(this._longMonthsParse,i),a!==-1?a:null):t==="MMM"?(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:(a=Dt.call(this._longMonthsParse,i),a!==-1?a:null)):(a=Dt.call(this._longMonthsParse,i),a!==-1?a:(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:null))}function jJ(e,t,r){var n,a,s;if(this._monthsParseExact)return DJ.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(a=Ra([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function ZN(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Le(t);else if(t=e.localeData().monthsParse(t),!ps(t))return e}var r=t,n=e.date();return n=n<29?n:Math.min(n,J1(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function e4(e){return e!=null?(ZN(this,e),xe.updateOffset(this,!0),this):qu(this,"Month")}function PJ(){return J1(this.year(),this.month())}function FJ(e){return this._monthsParseExact?(Ke(this,"_monthsRegex")||t4.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Ke(this,"_monthsShortRegex")||(this._monthsShortRegex=CJ),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function RJ(e){return this._monthsParseExact?(Ke(this,"_monthsRegex")||t4.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Ke(this,"_monthsRegex")||(this._monthsRegex=NJ),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function t4(){function e(l,c){return c.length-l.length}var t=[],r=[],n=[],a,s,i,o;for(a=0;a<12;a++)s=Ra([2e3,a]),i=ts(this.monthsShort(s,"")),o=ts(this.months(s,"")),t.push(i),r.push(o),n.push(o),n.push(i);t.sort(e),r.sort(e),n.sort(e),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function MJ(e,t,r,n,a,s,i){var o;return e<100&&e>=0?(o=new Date(e+400,t,r,n,a,s,i),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,r,n,a,s,i),o}function Xu(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function q0(e,t,r){var n=7+t-r,a=(7+Xu(e,0,n).getUTCDay()-t)%7;return-a+n-1}function r4(e,t,r,n,a){var s=(7+r-n)%7,i=q0(e,n,a),o=1+7*(t-1)+s+i,l,c;return o<=0?(l=e-1,c=nu(l)+o):o>nu(e)?(l=e+1,c=o-nu(e)):(l=e,c=o),{year:l,dayOfYear:c}}function Ju(e,t,r){var n=q0(e.year(),t,r),a=Math.floor((e.dayOfYear()-n-1)/7)+1,s,i;return a<1?(i=e.year()-1,s=a+rs(i,t,r)):a>rs(e.year(),t,r)?(s=a-rs(e.year(),t,r),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function rs(e,t,r){var n=q0(e,t,r),a=q0(e+1,t,r);return(nu(e)-n+a)/7}Ee("w",["ww",2],"wo","week");Ee("W",["WW",2],"Wo","isoWeek");we("w",dt,rc);we("ww",dt,dn);we("W",dt,rc);we("WW",dt,dn);Rf(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Le(e)});function IJ(e){return Ju(e,this._week.dow,this._week.doy).week}var LJ={dow:0,doy:6};function $J(){return this._week.dow}function UJ(){return this._week.doy}function BJ(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function WJ(e){var t=Ju(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Ee("d",0,"do","day");Ee("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Ee("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Ee("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Ee("e",0,0,"weekday");Ee("E",0,0,"isoWeekday");we("d",dt);we("e",dt);we("E",dt);we("dd",function(e,t){return t.weekdaysMinRegex(e)});we("ddd",function(e,t){return t.weekdaysShortRegex(e)});we("dddd",function(e,t){return t.weekdaysRegex(e)});Rf(["dd","ddd","dddd"],function(e,t,r,n){var a=r._locale.weekdaysParse(e,n,r._strict);a!=null?t.d=a:Fe(r).invalidWeekday=e});Rf(["d","e","E"],function(e,t,r,n){t[n]=Le(e)});function VJ(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function HJ(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Q1(e,t){return e.slice(t,7).concat(e.slice(0,t))}var zJ="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),n4="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),YJ="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),GJ=Ff,KJ=Ff,qJ=Ff;function XJ(e,t){var r=ia(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?Q1(r,this._week.dow):e?r[e.day()]:r}function JJ(e){return e===!0?Q1(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function QJ(e){return e===!0?Q1(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function ZJ(e,t,r){var n,a,s,i=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Ra([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?t==="dddd"?(a=Dt.call(this._weekdaysParse,i),a!==-1?a:null):t==="ddd"?(a=Dt.call(this._shortWeekdaysParse,i),a!==-1?a:null):(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null):t==="dddd"?(a=Dt.call(this._weekdaysParse,i),a!==-1||(a=Dt.call(this._shortWeekdaysParse,i),a!==-1)?a:(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null)):t==="ddd"?(a=Dt.call(this._shortWeekdaysParse,i),a!==-1||(a=Dt.call(this._weekdaysParse,i),a!==-1)?a:(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null)):(a=Dt.call(this._minWeekdaysParse,i),a!==-1||(a=Dt.call(this._weekdaysParse,i),a!==-1)?a:(a=Dt.call(this._shortWeekdaysParse,i),a!==-1?a:null))}function eQ(e,t,r){var n,a,s;if(this._weekdaysParseExact)return ZJ.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(a=Ra([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function tQ(e){if(!this.isValid())return e!=null?this:NaN;var t=qu(this,"Day");return e!=null?(e=VJ(e,this.localeData()),this.add(e-t,"d")):t}function rQ(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function nQ(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=HJ(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function aQ(e){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||Z1.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Ke(this,"_weekdaysRegex")||(this._weekdaysRegex=GJ),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function sQ(e){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||Z1.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ke(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=KJ),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function iQ(e){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||Z1.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ke(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=qJ),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Z1(){function e(f,d){return d.length-f.length}var t=[],r=[],n=[],a=[],s,i,o,l,c;for(s=0;s<7;s++)i=Ra([2e3,1]).day(s),o=ts(this.weekdaysMin(i,"")),l=ts(this.weekdaysShort(i,"")),c=ts(this.weekdays(i,"")),t.push(o),r.push(l),n.push(c),a.push(o),a.push(l),a.push(c);t.sort(e),r.sort(e),n.sort(e),a.sort(e),this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function ey(){return this.hours()%12||12}function oQ(){return this.hours()||24}Ee("H",["HH",2],0,"hour");Ee("h",["hh",2],0,ey);Ee("k",["kk",2],0,oQ);Ee("hmm",0,0,function(){return""+ey.apply(this)+Da(this.minutes(),2)});Ee("hmmss",0,0,function(){return""+ey.apply(this)+Da(this.minutes(),2)+Da(this.seconds(),2)});Ee("Hmm",0,0,function(){return""+this.hours()+Da(this.minutes(),2)});Ee("Hmmss",0,0,function(){return""+this.hours()+Da(this.minutes(),2)+Da(this.seconds(),2)});function a4(e,t){Ee(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}a4("a",!0);a4("A",!1);function s4(e,t){return t._meridiemParse}we("a",s4);we("A",s4);we("H",dt,X1);we("h",dt,rc);we("k",dt,rc);we("HH",dt,dn);we("hh",dt,dn);we("kk",dt,dn);we("hmm",GN);we("hmmss",KN);we("Hmm",GN);we("Hmmss",KN);Ze(["H","HH"],Vt);Ze(["k","kk"],function(e,t,r){var n=Le(e);t[Vt]=n===24?0:n});Ze(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});Ze(["h","hh"],function(e,t,r){t[Vt]=Le(e),Fe(r).bigHour=!0});Ze("hmm",function(e,t,r){var n=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Xn]=Le(e.substr(n)),Fe(r).bigHour=!0});Ze("hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Xn]=Le(e.substr(n,2)),t[Qa]=Le(e.substr(a)),Fe(r).bigHour=!0});Ze("Hmm",function(e,t,r){var n=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Xn]=Le(e.substr(n))});Ze("Hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Xn]=Le(e.substr(n,2)),t[Qa]=Le(e.substr(a))});function lQ(e){return(e+"").toLowerCase().charAt(0)==="p"}var cQ=/[ap]\.?m?\.?/i,uQ=nc("Hours",!0);function fQ(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var i4={calendar:ZX,longDateFormat:nJ,invalidDate:sJ,ordinal:oJ,dayOfMonthOrdinalParse:lJ,relativeTime:uJ,months:TJ,monthsShort:JN,week:LJ,weekdays:zJ,weekdaysMin:YJ,weekdaysShort:n4,meridiemParse:cQ},pt={},kc={},Qu;function dQ(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function yb(e){return e&&e.toLowerCase().replace("_","-")}function hQ(e){for(var t=0,r,n,a,s;t<e.length;){for(s=yb(e[t]).split("-"),r=s.length,n=yb(e[t+1]),n=n?n.split("-"):null;r>0;){if(a=_p(s.slice(0,r).join("-")),a)return a;if(n&&n.length>=r&&dQ(s,n)>=r-1)break;r--}t++}return Qu}function pQ(e){return!!(e&&e.match("^[^/\\\\]*$"))}function _p(e){var t=null,r;if(pt[e]===void 0&&typeof module<"u"&&module&&module.exports&&pQ(e))try{t=Qu._abbr,r=require,r("./locale/"+e),ti(t)}catch{pt[e]=null}return pt[e]}function ti(e,t){var r;return e&&($r(t)?r=ys(e):r=ty(e,t),r?Qu=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Qu._abbr}function ty(e,t){if(t!==null){var r,n=i4;if(t.abbr=e,pt[e]!=null)VN("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=pt[e]._config;else if(t.parentLocale!=null)if(pt[t.parentLocale]!=null)n=pt[t.parentLocale]._config;else if(r=_p(t.parentLocale),r!=null)n=r._config;else return kc[t.parentLocale]||(kc[t.parentLocale]=[]),kc[t.parentLocale].push({name:e,config:t}),null;return pt[e]=new z1(bg(n,t)),kc[e]&&kc[e].forEach(function(a){ty(a.name,a.config)}),ti(e),pt[e]}else return delete pt[e],null}function mQ(e,t){if(t!=null){var r,n,a=i4;pt[e]!=null&&pt[e].parentLocale!=null?pt[e].set(bg(pt[e]._config,t)):(n=_p(e),n!=null&&(a=n._config),t=bg(a,t),n==null&&(t.abbr=e),r=new z1(t),r.parentLocale=pt[e],pt[e]=r),ti(e)}else pt[e]!=null&&(pt[e].parentLocale!=null?(pt[e]=pt[e].parentLocale,e===ti()&&ti(e)):pt[e]!=null&&delete pt[e]);return pt[e]}function ys(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Qu;if(!ia(e)){if(t=_p(e),t)return t;e=[e]}return hQ(e)}function vQ(){return Sg(pt)}function ry(e){var t,r=e._a;return r&&Fe(e).overflow===-2&&(t=r[Ja]<0||r[Ja]>11?Ja:r[_a]<1||r[_a]>J1(r[yr],r[Ja])?_a:r[Vt]<0||r[Vt]>24||r[Vt]===24&&(r[Xn]!==0||r[Qa]!==0||r[Ri]!==0)?Vt:r[Xn]<0||r[Xn]>59?Xn:r[Qa]<0||r[Qa]>59?Qa:r[Ri]<0||r[Ri]>999?Ri:-1,Fe(e)._overflowDayOfYear&&(t<yr||t>_a)&&(t=_a),Fe(e)._overflowWeeks&&t===-1&&(t=_J),Fe(e)._overflowWeekday&&t===-1&&(t=wJ),Fe(e).overflow=t),e}var gQ=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xQ=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yQ=/Z|[+-]\d\d(?::?\d\d)?/,bd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Fm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],_Q=/^\/?Date\((-?\d+)/i,wQ=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,bQ={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function o4(e){var t,r,n=e._i,a=gQ.exec(n)||xQ.exec(n),s,i,o,l,c=bd.length,f=Fm.length;if(a){for(Fe(e).iso=!0,t=0,r=c;t<r;t++)if(bd[t][1].exec(a[1])){i=bd[t][0],s=bd[t][2]!==!1;break}if(i==null){e._isValid=!1;return}if(a[3]){for(t=0,r=f;t<r;t++)if(Fm[t][1].exec(a[3])){o=(a[2]||" ")+Fm[t][0];break}if(o==null){e._isValid=!1;return}}if(!s&&o!=null){e._isValid=!1;return}if(a[4])if(yQ.exec(a[4]))l="Z";else{e._isValid=!1;return}e._f=i+(o||"")+(l||""),ay(e)}else e._isValid=!1}function SQ(e,t,r,n,a,s){var i=[EQ(e),JN.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(a,10)];return s&&i.push(parseInt(s,10)),i}function EQ(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function kQ(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function TQ(e,t,r){if(e){var n=n4.indexOf(e),a=new Date(t[0],t[1],t[2]).getDay();if(n!==a)return Fe(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function CQ(e,t,r){if(e)return bQ[e];if(t)return 0;var n=parseInt(r,10),a=n%100,s=(n-a)/100;return s*60+a}function l4(e){var t=wQ.exec(kQ(e._i)),r;if(t){if(r=SQ(t[4],t[3],t[2],t[5],t[6],t[7]),!TQ(t[1],r,e))return;e._a=r,e._tzm=CQ(t[8],t[9],t[10]),e._d=Xu.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Fe(e).rfc2822=!0}else e._isValid=!1}function NQ(e){var t=_Q.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(o4(e),e._isValid===!1)delete e._isValid;else return;if(l4(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:xe.createFromInputFallback(e)}xe.createFromInputFallback=In("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Mo(e,t,r){return e??t??r}function AQ(e){var t=new Date(xe.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function ny(e){var t,r,n=[],a,s,i;if(!e._d){for(a=AQ(e),e._w&&e._a[_a]==null&&e._a[Ja]==null&&OQ(e),e._dayOfYear!=null&&(i=Mo(e._a[yr],a[yr]),(e._dayOfYear>nu(i)||e._dayOfYear===0)&&(Fe(e)._overflowDayOfYear=!0),r=Xu(i,0,e._dayOfYear),e._a[Ja]=r.getUTCMonth(),e._a[_a]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=a[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Vt]===24&&e._a[Xn]===0&&e._a[Qa]===0&&e._a[Ri]===0&&(e._nextDay=!0,e._a[Vt]=0),e._d=(e._useUTC?Xu:MJ).apply(null,n),s=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Vt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==s&&(Fe(e).weekdayMismatch=!0)}}function OQ(e){var t,r,n,a,s,i,o,l,c;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(s=1,i=4,r=Mo(t.GG,e._a[yr],Ju(ft(),1,4).year),n=Mo(t.W,1),a=Mo(t.E,1),(a<1||a>7)&&(l=!0)):(s=e._locale._week.dow,i=e._locale._week.doy,c=Ju(ft(),s,i),r=Mo(t.gg,e._a[yr],c.year),n=Mo(t.w,c.week),t.d!=null?(a=t.d,(a<0||a>6)&&(l=!0)):t.e!=null?(a=t.e+s,(t.e<0||t.e>6)&&(l=!0)):a=s),n<1||n>rs(r,s,i)?Fe(e)._overflowWeeks=!0:l!=null?Fe(e)._overflowWeekday=!0:(o=r4(r,n,a,s,i),e._a[yr]=o.year,e._dayOfYear=o.dayOfYear)}xe.ISO_8601=function(){};xe.RFC_2822=function(){};function ay(e){if(e._f===xe.ISO_8601){o4(e);return}if(e._f===xe.RFC_2822){l4(e);return}e._a=[],Fe(e).empty=!0;var t=""+e._i,r,n,a,s,i,o=t.length,l=0,c,f;for(a=HN(e._f,e._locale).match(Y1)||[],f=a.length,r=0;r<f;r++)s=a[r],n=(t.match(gJ(s,e))||[])[0],n&&(i=t.substr(0,t.indexOf(n)),i.length>0&&Fe(e).unusedInput.push(i),t=t.slice(t.indexOf(n)+n.length),l+=n.length),ll[s]?(n?Fe(e).empty=!1:Fe(e).unusedTokens.push(s),yJ(s,n,e)):e._strict&&!n&&Fe(e).unusedTokens.push(s);Fe(e).charsLeftOver=o-l,t.length>0&&Fe(e).unusedInput.push(t),e._a[Vt]<=12&&Fe(e).bigHour===!0&&e._a[Vt]>0&&(Fe(e).bigHour=void 0),Fe(e).parsedDateParts=e._a.slice(0),Fe(e).meridiem=e._meridiem,e._a[Vt]=DQ(e._locale,e._a[Vt],e._meridiem),c=Fe(e).era,c!==null&&(e._a[yr]=e._locale.erasConvertYear(c,e._a[yr])),ny(e),ry(e)}function DQ(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function jQ(e){var t,r,n,a,s,i,o=!1,l=e._f.length;if(l===0){Fe(e).invalidFormat=!0,e._d=new Date(NaN);return}for(a=0;a<l;a++)s=0,i=!1,t=H1({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[a],ay(t),V1(t)&&(i=!0),s+=Fe(t).charsLeftOver,s+=Fe(t).unusedTokens.length*10,Fe(t).score=s,o?s<n&&(n=s,r=t):(n==null||s<n||i)&&(n=s,r=t,i&&(o=!0));Bs(e,r||t)}function PQ(e){if(!e._d){var t=G1(e._i),r=t.day===void 0?t.date:t.day;e._a=BN([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),ny(e)}}function FQ(e){var t=new Pf(ry(c4(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function c4(e){var t=e._i,r=e._f;return e._locale=e._locale||ys(e._l),t===null||r===void 0&&t===""?hp({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),oa(t)?new Pf(ry(t)):(jf(t)?e._d=t:ia(r)?jQ(e):r?ay(e):RQ(e),V1(e)||(e._d=null),e))}function RQ(e){var t=e._i;$r(t)?e._d=new Date(xe.now()):jf(t)?e._d=new Date(t.valueOf()):typeof t=="string"?NQ(e):ia(t)?(e._a=BN(t.slice(0),function(r){return parseInt(r,10)}),ny(e)):Bi(t)?PQ(e):ps(t)?e._d=new Date(t):xe.createFromInputFallback(e)}function u4(e,t,r,n,a){var s={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Bi(e)&&W1(e)||ia(e)&&e.length===0)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=r,s._i=e,s._f=t,s._strict=n,FQ(s)}function ft(e,t,r,n){return u4(e,t,r,n,!1)}var MQ=In("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ft.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:hp()}),IQ=In("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ft.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:hp()});function f4(e,t){var r,n;if(t.length===1&&ia(t[0])&&(t=t[0]),!t.length)return ft();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function LQ(){var e=[].slice.call(arguments,0);return f4("isBefore",e)}function $Q(){var e=[].slice.call(arguments,0);return f4("isAfter",e)}var UQ=function(){return Date.now?Date.now():+new Date},Tc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function BQ(e){var t,r=!1,n,a=Tc.length;for(t in e)if(Ke(e,t)&&!(Dt.call(Tc,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<a;++n)if(e[Tc[n]]){if(r)return!1;parseFloat(e[Tc[n]])!==Le(e[Tc[n]])&&(r=!0)}return!0}function WQ(){return this._isValid}function VQ(){return ua(NaN)}function wp(e){var t=G1(e),r=t.year||0,n=t.quarter||0,a=t.month||0,s=t.week||t.isoWeek||0,i=t.day||0,o=t.hour||0,l=t.minute||0,c=t.second||0,f=t.millisecond||0;this._isValid=BQ(t),this._milliseconds=+f+c*1e3+l*6e4+o*1e3*60*60,this._days=+i+s*7,this._months=+a+n*3+r*12,this._data={},this._locale=ys(),this._bubble()}function r0(e){return e instanceof wp}function kg(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function HQ(e,t,r){var n=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0,i;for(i=0;i<n;i++)Le(e[i])!==Le(t[i])&&s++;return s+a}function d4(e,t){Ee(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Da(~~(r/60),2)+t+Da(~~r%60,2)})}d4("Z",":");d4("ZZ","");we("Z",xp);we("ZZ",xp);Ze(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=sy(xp,e)});var zQ=/([\+\-]|\d\d)/gi;function sy(e,t){var r=(t||"").match(e),n,a,s;return r===null?null:(n=r[r.length-1]||[],a=(n+"").match(zQ)||["-",0,0],s=+(a[1]*60)+Le(a[2]),s===0?0:a[0]==="+"?s:-s)}function iy(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(oa(e)||jf(e)?e.valueOf():ft(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),xe.updateOffset(r,!1),r):ft(e).local()}function Tg(e){return-Math.round(e._d.getTimezoneOffset())}xe.updateOffset=function(){};function YQ(e,t,r){var n=this._offset||0,a;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=sy(xp,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(a=Tg(this)),this._offset=e,this._isUTC=!0,a!=null&&this.add(a,"m"),n!==e&&(!t||this._changeInProgress?m4(this,ua(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,xe.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Tg(this)}function GQ(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function KQ(e){return this.utcOffset(0,e)}function qQ(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Tg(this),"m")),this}function XQ(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=sy(mJ,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function JQ(e){return this.isValid()?(e=e?ft(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function QQ(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function ZQ(){if(!$r(this._isDSTShifted))return this._isDSTShifted;var e={},t;return H1(e,this),e=c4(e),e._a?(t=e._isUTC?Ra(e._a):ft(e._a),this._isDSTShifted=this.isValid()&&HQ(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function eZ(){return this.isValid()?!this._isUTC:!1}function tZ(){return this.isValid()?this._isUTC:!1}function h4(){return this.isValid()?this._isUTC&&this._offset===0:!1}var rZ=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,nZ=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ua(e,t){var r=e,n=null,a,s,i;return r0(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:ps(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=rZ.exec(e))?(a=n[1]==="-"?-1:1,r={y:0,d:Le(n[_a])*a,h:Le(n[Vt])*a,m:Le(n[Xn])*a,s:Le(n[Qa])*a,ms:Le(kg(n[Ri]*1e3))*a}):(n=nZ.exec(e))?(a=n[1]==="-"?-1:1,r={y:Ei(n[2],a),M:Ei(n[3],a),w:Ei(n[4],a),d:Ei(n[5],a),h:Ei(n[6],a),m:Ei(n[7],a),s:Ei(n[8],a)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(i=aZ(ft(r.from),ft(r.to)),r={},r.ms=i.milliseconds,r.M=i.months),s=new wp(r),r0(e)&&Ke(e,"_locale")&&(s._locale=e._locale),r0(e)&&Ke(e,"_isValid")&&(s._isValid=e._isValid),s}ua.fn=wp.prototype;ua.invalid=VQ;function Ei(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function _b(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function aZ(e,t){var r;return e.isValid()&&t.isValid()?(t=iy(t,e),e.isBefore(t)?r=_b(e,t):(r=_b(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function p4(e,t){return function(r,n){var a,s;return n!==null&&!isNaN(+n)&&(VN(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),a=ua(r,n),m4(this,a,e),this}}function m4(e,t,r,n){var a=t._milliseconds,s=kg(t._days),i=kg(t._months);e.isValid()&&(n=n??!0,i&&ZN(e,qu(e,"Month")+i*r),s&&XN(e,"Date",qu(e,"Date")+s*r),a&&e._d.setTime(e._d.valueOf()+a*r),n&&xe.updateOffset(e,s||i))}var sZ=p4(1,"add"),iZ=p4(-1,"subtract");function v4(e){return typeof e=="string"||e instanceof String}function oZ(e){return oa(e)||jf(e)||v4(e)||ps(e)||cZ(e)||lZ(e)||e===null||e===void 0}function lZ(e){var t=Bi(e)&&!W1(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],a,s,i=n.length;for(a=0;a<i;a+=1)s=n[a],r=r||Ke(e,s);return t&&r}function cZ(e){var t=ia(e),r=!1;return t&&(r=e.filter(function(n){return!ps(n)&&v4(e)}).length===0),t&&r}function uZ(e){var t=Bi(e)&&!W1(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],a,s;for(a=0;a<n.length;a+=1)s=n[a],r=r||Ke(e,s);return t&&r}function fZ(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function dZ(e,t){arguments.length===1&&(arguments[0]?oZ(arguments[0])?(e=arguments[0],t=void 0):uZ(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||ft(),n=iy(r,this).startOf("day"),a=xe.calendarFormat(this,n)||"sameElse",s=t&&(Ma(t[a])?t[a].call(this,r):t[a]);return this.format(s||this.localeData().calendar(a,this,ft(r)))}function hZ(){return new Pf(this)}function pZ(e,t){var r=oa(e)?e:ft(e);return this.isValid()&&r.isValid()?(t=Ln(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function mZ(e,t){var r=oa(e)?e:ft(e);return this.isValid()&&r.isValid()?(t=Ln(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function vZ(e,t,r,n){var a=oa(e)?e:ft(e),s=oa(t)?t:ft(t);return this.isValid()&&a.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(a,r):!this.isBefore(a,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function gZ(e,t){var r=oa(e)?e:ft(e),n;return this.isValid()&&r.isValid()?(t=Ln(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function xZ(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function yZ(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function _Z(e,t,r){var n,a,s;if(!this.isValid())return NaN;if(n=iy(e,this),!n.isValid())return NaN;switch(a=(n.utcOffset()-this.utcOffset())*6e4,t=Ln(t),t){case"year":s=n0(this,n)/12;break;case"month":s=n0(this,n);break;case"quarter":s=n0(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-a)/864e5;break;case"week":s=(this-n-a)/6048e5;break;default:s=this-n}return r?s:wn(s)}function n0(e,t){if(e.date()<t.date())return-n0(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),a,s;return t-n<0?(a=e.clone().add(r-1,"months"),s=(t-n)/(n-a)):(a=e.clone().add(r+1,"months"),s=(t-n)/(a-n)),-(r+s)||0}xe.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";xe.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function wZ(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function bZ(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?t0(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ma(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",t0(r,"Z")):t0(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function SZ(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,a,s;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a="-MM-DD[T]HH:mm:ss.SSS",s=t+'[")]',this.format(r+n+a+s)}function EZ(e){e||(e=this.isUtc()?xe.defaultFormatUtc:xe.defaultFormat);var t=t0(this,e);return this.localeData().postformat(t)}function kZ(e,t){return this.isValid()&&(oa(e)&&e.isValid()||ft(e).isValid())?ua({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function TZ(e){return this.from(ft(),e)}function CZ(e,t){return this.isValid()&&(oa(e)&&e.isValid()||ft(e).isValid())?ua({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function NZ(e){return this.to(ft(),e)}function g4(e){var t;return e===void 0?this._locale._abbr:(t=ys(e),t!=null&&(this._locale=t),this)}var x4=In("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function y4(){return this._locale}var X0=1e3,cl=60*X0,J0=60*cl,_4=(365*400+97)*24*J0;function ul(e,t){return(e%t+t)%t}function w4(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-_4:new Date(e,t,r).valueOf()}function b4(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-_4:Date.UTC(e,t,r)}function AZ(e){var t,r;if(e=Ln(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?b4:w4,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ul(t+(this._isUTC?0:this.utcOffset()*cl),J0);break;case"minute":t=this._d.valueOf(),t-=ul(t,cl);break;case"second":t=this._d.valueOf(),t-=ul(t,X0);break}return this._d.setTime(t),xe.updateOffset(this,!0),this}function OZ(e){var t,r;if(e=Ln(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?b4:w4,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=J0-ul(t+(this._isUTC?0:this.utcOffset()*cl),J0)-1;break;case"minute":t=this._d.valueOf(),t+=cl-ul(t,cl)-1;break;case"second":t=this._d.valueOf(),t+=X0-ul(t,X0)-1;break}return this._d.setTime(t),xe.updateOffset(this,!0),this}function DZ(){return this._d.valueOf()-(this._offset||0)*6e4}function jZ(){return Math.floor(this.valueOf()/1e3)}function PZ(){return new Date(this.valueOf())}function FZ(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function RZ(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function MZ(){return this.isValid()?this.toISOString():null}function IZ(){return V1(this)}function LZ(){return Bs({},Fe(this))}function $Z(){return Fe(this).overflow}function UZ(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ee("N",0,0,"eraAbbr");Ee("NN",0,0,"eraAbbr");Ee("NNN",0,0,"eraAbbr");Ee("NNNN",0,0,"eraName");Ee("NNNNN",0,0,"eraNarrow");Ee("y",["y",1],"yo","eraYear");Ee("y",["yy",2],0,"eraYear");Ee("y",["yyy",3],0,"eraYear");Ee("y",["yyyy",4],0,"eraYear");we("N",oy);we("NN",oy);we("NNN",oy);we("NNNN",JZ);we("NNNNN",QZ);Ze(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var a=r._locale.erasParse(e,n,r._strict);a?Fe(r).era=a:Fe(r).invalidEra=e});we("y",tc);we("yy",tc);we("yyy",tc);we("yyyy",tc);we("yo",ZZ);Ze(["y","yy","yyy","yyyy"],yr);Ze(["yo"],function(e,t,r,n){var a;r._locale._eraYearOrdinalRegex&&(a=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[yr]=r._locale.eraYearOrdinalParse(e,a):t[yr]=parseInt(e,10)});function BZ(e,t){var r,n,a,s=this._eras||ys("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":a=xe(s[r].since).startOf("day"),s[r].since=a.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":a=xe(s[r].until).startOf("day").valueOf(),s[r].until=a.valueOf();break}}return s}function WZ(e,t,r){var n,a,s=this.eras(),i,o,l;for(e=e.toUpperCase(),n=0,a=s.length;n<a;++n)if(i=s[n].name.toUpperCase(),o=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(o===e)return s[n];break;case"NNNN":if(i===e)return s[n];break;case"NNNNN":if(l===e)return s[n];break}else if([i,o,l].indexOf(e)>=0)return s[n]}function VZ(e,t){var r=e.since<=e.until?1:-1;return t===void 0?xe(e.since).year():xe(e.since).year()+(t-e.offset)*r}function HZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function zZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function YZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function GZ(){var e,t,r,n,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(r=a[e].since<=a[e].until?1:-1,n=this.clone().startOf("day").valueOf(),a[e].since<=n&&n<=a[e].until||a[e].until<=n&&n<=a[e].since)return(this.year()-xe(a[e].since).year())*r+a[e].offset;return this.year()}function KZ(e){return Ke(this,"_erasNameRegex")||ly.call(this),e?this._erasNameRegex:this._erasRegex}function qZ(e){return Ke(this,"_erasAbbrRegex")||ly.call(this),e?this._erasAbbrRegex:this._erasRegex}function XZ(e){return Ke(this,"_erasNarrowRegex")||ly.call(this),e?this._erasNarrowRegex:this._erasRegex}function oy(e,t){return t.erasAbbrRegex(e)}function JZ(e,t){return t.erasNameRegex(e)}function QZ(e,t){return t.erasNarrowRegex(e)}function ZZ(e,t){return t._eraYearOrdinalRegex||tc}function ly(){var e=[],t=[],r=[],n=[],a,s,i,o,l,c=this.eras();for(a=0,s=c.length;a<s;++a)i=ts(c[a].name),o=ts(c[a].abbr),l=ts(c[a].narrow),t.push(i),e.push(o),r.push(l),n.push(i),n.push(o),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Ee(0,["gg",2],0,function(){return this.weekYear()%100});Ee(0,["GG",2],0,function(){return this.isoWeekYear()%100});function bp(e,t){Ee(0,[e,e.length],0,t)}bp("gggg","weekYear");bp("ggggg","weekYear");bp("GGGG","isoWeekYear");bp("GGGGG","isoWeekYear");we("G",gp);we("g",gp);we("GG",dt,dn);we("gg",dt,dn);we("GGGG",q1,K1);we("gggg",q1,K1);we("GGGGG",vp,pp);we("ggggg",vp,pp);Rf(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Le(e)});Rf(["gg","GG"],function(e,t,r,n){t[n]=xe.parseTwoDigitYear(e)});function eee(e){return S4.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function tee(e){return S4.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function ree(){return rs(this.year(),1,4)}function nee(){return rs(this.isoWeekYear(),1,4)}function aee(){var e=this.localeData()._week;return rs(this.year(),e.dow,e.doy)}function see(){var e=this.localeData()._week;return rs(this.weekYear(),e.dow,e.doy)}function S4(e,t,r,n,a){var s;return e==null?Ju(this,n,a).year:(s=rs(e,n,a),t>s&&(t=s),iee.call(this,e,t,r,n,a))}function iee(e,t,r,n,a){var s=r4(e,t,r,n,a),i=Xu(s.year,0,s.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}Ee("Q",0,"Qo","quarter");we("Q",zN);Ze("Q",function(e,t){t[Ja]=(Le(e)-1)*3});function oee(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Ee("D",["DD",2],"Do","date");we("D",dt,rc);we("DD",dt,dn);we("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});Ze(["D","DD"],_a);Ze("Do",function(e,t){t[_a]=Le(e.match(dt)[0])});var E4=nc("Date",!0);Ee("DDD",["DDDD",3],"DDDo","dayOfYear");we("DDD",mp);we("DDDD",YN);Ze(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Le(e)});function lee(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Ee("m",["mm",2],0,"minute");we("m",dt,X1);we("mm",dt,dn);Ze(["m","mm"],Xn);var cee=nc("Minutes",!1);Ee("s",["ss",2],0,"second");we("s",dt,X1);we("ss",dt,dn);Ze(["s","ss"],Qa);var uee=nc("Seconds",!1);Ee("S",0,0,function(){return~~(this.millisecond()/100)});Ee(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ee(0,["SSS",3],0,"millisecond");Ee(0,["SSSS",4],0,function(){return this.millisecond()*10});Ee(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ee(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ee(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ee(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ee(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});we("S",mp,zN);we("SS",mp,dn);we("SSS",mp,YN);var Ws,k4;for(Ws="SSSS";Ws.length<=9;Ws+="S")we(Ws,tc);function fee(e,t){t[Ri]=Le(("0."+e)*1e3)}for(Ws="S";Ws.length<=9;Ws+="S")Ze(Ws,fee);k4=nc("Milliseconds",!1);Ee("z",0,0,"zoneAbbr");Ee("zz",0,0,"zoneName");function dee(){return this._isUTC?"UTC":""}function hee(){return this._isUTC?"Coordinated Universal Time":""}var he=Pf.prototype;he.add=sZ;he.calendar=dZ;he.clone=hZ;he.diff=_Z;he.endOf=OZ;he.format=EZ;he.from=kZ;he.fromNow=TZ;he.to=CZ;he.toNow=NZ;he.get=SJ;he.invalidAt=$Z;he.isAfter=pZ;he.isBefore=mZ;he.isBetween=vZ;he.isSame=gZ;he.isSameOrAfter=xZ;he.isSameOrBefore=yZ;he.isValid=IZ;he.lang=x4;he.locale=g4;he.localeData=y4;he.max=IQ;he.min=MQ;he.parsingFlags=LZ;he.set=EJ;he.startOf=AZ;he.subtract=iZ;he.toArray=FZ;he.toObject=RZ;he.toDate=PZ;he.toISOString=bZ;he.inspect=SZ;typeof Symbol<"u"&&Symbol.for!=null&&(he[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});he.toJSON=MZ;he.toString=wZ;he.unix=jZ;he.valueOf=DZ;he.creationData=UZ;he.eraName=HZ;he.eraNarrow=zZ;he.eraAbbr=YZ;he.eraYear=GZ;he.year=qN;he.isLeapYear=bJ;he.weekYear=eee;he.isoWeekYear=tee;he.quarter=he.quarters=oee;he.month=e4;he.daysInMonth=PJ;he.week=he.weeks=BJ;he.isoWeek=he.isoWeeks=WJ;he.weeksInYear=aee;he.weeksInWeekYear=see;he.isoWeeksInYear=ree;he.isoWeeksInISOWeekYear=nee;he.date=E4;he.day=he.days=tQ;he.weekday=rQ;he.isoWeekday=nQ;he.dayOfYear=lee;he.hour=he.hours=uQ;he.minute=he.minutes=cee;he.second=he.seconds=uee;he.millisecond=he.milliseconds=k4;he.utcOffset=YQ;he.utc=KQ;he.local=qQ;he.parseZone=XQ;he.hasAlignedHourOffset=JQ;he.isDST=QQ;he.isLocal=eZ;he.isUtcOffset=tZ;he.isUtc=h4;he.isUTC=h4;he.zoneAbbr=dee;he.zoneName=hee;he.dates=In("dates accessor is deprecated. Use date instead.",E4);he.months=In("months accessor is deprecated. Use month instead",e4);he.years=In("years accessor is deprecated. Use year instead",qN);he.zone=In("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",GQ);he.isDSTShifted=In("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",ZQ);function pee(e){return ft(e*1e3)}function mee(){return ft.apply(null,arguments).parseZone()}function T4(e){return e}var qe=z1.prototype;qe.calendar=eJ;qe.longDateFormat=aJ;qe.invalidDate=iJ;qe.ordinal=cJ;qe.preparse=T4;qe.postformat=T4;qe.relativeTime=fJ;qe.pastFuture=dJ;qe.set=QX;qe.eras=BZ;qe.erasParse=WZ;qe.erasConvertYear=VZ;qe.erasAbbrRegex=qZ;qe.erasNameRegex=KZ;qe.erasNarrowRegex=XZ;qe.months=AJ;qe.monthsShort=OJ;qe.monthsParse=jJ;qe.monthsRegex=RJ;qe.monthsShortRegex=FJ;qe.week=IJ;qe.firstDayOfYear=UJ;qe.firstDayOfWeek=$J;qe.weekdays=XJ;qe.weekdaysMin=QJ;qe.weekdaysShort=JJ;qe.weekdaysParse=eQ;qe.weekdaysRegex=aQ;qe.weekdaysShortRegex=sQ;qe.weekdaysMinRegex=iQ;qe.isPM=lQ;qe.meridiem=fQ;function Q0(e,t,r,n){var a=ys(),s=Ra().set(n,t);return a[r](s,e)}function C4(e,t,r){if(ps(e)&&(t=e,e=void 0),e=e||"",t!=null)return Q0(e,t,r,"month");var n,a=[];for(n=0;n<12;n++)a[n]=Q0(e,n,r,"month");return a}function cy(e,t,r,n){typeof e=="boolean"?(ps(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,ps(t)&&(r=t,t=void 0),t=t||"");var a=ys(),s=e?a._week.dow:0,i,o=[];if(r!=null)return Q0(t,(r+s)%7,n,"day");for(i=0;i<7;i++)o[i]=Q0(t,(i+s)%7,n,"day");return o}function vee(e,t){return C4(e,t,"months")}function gee(e,t){return C4(e,t,"monthsShort")}function xee(e,t,r){return cy(e,t,r,"weekdays")}function yee(e,t,r){return cy(e,t,r,"weekdaysShort")}function _ee(e,t,r){return cy(e,t,r,"weekdaysMin")}ti("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Le(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});xe.lang=In("moment.lang is deprecated. Use moment.locale instead.",ti);xe.langData=In("moment.langData is deprecated. Use moment.localeData instead.",ys);var Ba=Math.abs;function wee(){var e=this._data;return this._milliseconds=Ba(this._milliseconds),this._days=Ba(this._days),this._months=Ba(this._months),e.milliseconds=Ba(e.milliseconds),e.seconds=Ba(e.seconds),e.minutes=Ba(e.minutes),e.hours=Ba(e.hours),e.months=Ba(e.months),e.years=Ba(e.years),this}function N4(e,t,r,n){var a=ua(t,r);return e._milliseconds+=n*a._milliseconds,e._days+=n*a._days,e._months+=n*a._months,e._bubble()}function bee(e,t){return N4(this,e,t,1)}function See(e,t){return N4(this,e,t,-1)}function wb(e){return e<0?Math.floor(e):Math.ceil(e)}function Eee(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,a,s,i,o,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=wb(Cg(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,a=wn(e/1e3),n.seconds=a%60,s=wn(a/60),n.minutes=s%60,i=wn(s/60),n.hours=i%24,t+=wn(i/24),l=wn(A4(t)),r+=l,t-=wb(Cg(l)),o=wn(r/12),r%=12,n.days=t,n.months=r,n.years=o,this}function A4(e){return e*4800/146097}function Cg(e){return e*146097/4800}function kee(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Ln(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+A4(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Cg(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function _s(e){return function(){return this.as(e)}}var O4=_s("ms"),Tee=_s("s"),Cee=_s("m"),Nee=_s("h"),Aee=_s("d"),Oee=_s("w"),Dee=_s("M"),jee=_s("Q"),Pee=_s("y"),Fee=O4;function Ree(){return ua(this)}function Mee(e){return e=Ln(e),this.isValid()?this[e+"s"]():NaN}function vo(e){return function(){return this.isValid()?this._data[e]:NaN}}var Iee=vo("milliseconds"),Lee=vo("seconds"),$ee=vo("minutes"),Uee=vo("hours"),Bee=vo("days"),Wee=vo("months"),Vee=vo("years");function Hee(){return wn(this.days()/7)}var za=Math.round,Xo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function zee(e,t,r,n,a){return a.relativeTime(t||1,!!r,e,n)}function Yee(e,t,r,n){var a=ua(e).abs(),s=za(a.as("s")),i=za(a.as("m")),o=za(a.as("h")),l=za(a.as("d")),c=za(a.as("M")),f=za(a.as("w")),d=za(a.as("y")),h=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||i<=1&&["m"]||i<r.m&&["mm",i]||o<=1&&["h"]||o<r.h&&["hh",o]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||c<=1&&["M"]||c<r.M&&["MM",c]||d<=1&&["y"]||["yy",d],h[2]=t,h[3]=+e>0,h[4]=n,zee.apply(null,h)}function Gee(e){return e===void 0?za:typeof e=="function"?(za=e,!0):!1}function Kee(e,t){return Xo[e]===void 0?!1:t===void 0?Xo[e]:(Xo[e]=t,e==="s"&&(Xo.ss=t-1),!0)}function qee(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Xo,a,s;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Xo,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),a=this.localeData(),s=Yee(this,!r,n,a),r&&(s=a.pastFuture(+this,s)),a.postformat(s)}var Rm=Math.abs;function Do(e){return(e>0)-(e<0)||+e}function Sp(){if(!this.isValid())return this.localeData().invalidDate();var e=Rm(this._milliseconds)/1e3,t=Rm(this._days),r=Rm(this._months),n,a,s,i,o=this.asSeconds(),l,c,f,d;return o?(n=wn(e/60),a=wn(n/60),e%=60,n%=60,s=wn(r/12),r%=12,i=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=o<0?"-":"",c=Do(this._months)!==Do(o)?"-":"",f=Do(this._days)!==Do(o)?"-":"",d=Do(this._milliseconds)!==Do(o)?"-":"",l+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(t?f+t+"D":"")+(a||n||e?"T":"")+(a?d+a+"H":"")+(n?d+n+"M":"")+(e?d+i+"S":"")):"P0D"}var Ve=wp.prototype;Ve.isValid=WQ;Ve.abs=wee;Ve.add=bee;Ve.subtract=See;Ve.as=kee;Ve.asMilliseconds=O4;Ve.asSeconds=Tee;Ve.asMinutes=Cee;Ve.asHours=Nee;Ve.asDays=Aee;Ve.asWeeks=Oee;Ve.asMonths=Dee;Ve.asQuarters=jee;Ve.asYears=Pee;Ve.valueOf=Fee;Ve._bubble=Eee;Ve.clone=Ree;Ve.get=Mee;Ve.milliseconds=Iee;Ve.seconds=Lee;Ve.minutes=$ee;Ve.hours=Uee;Ve.days=Bee;Ve.weeks=Hee;Ve.months=Wee;Ve.years=Vee;Ve.humanize=qee;Ve.toISOString=Sp;Ve.toString=Sp;Ve.toJSON=Sp;Ve.locale=g4;Ve.localeData=y4;Ve.toIsoString=In("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Sp);Ve.lang=x4;Ee("X",0,0,"unix");Ee("x",0,0,"valueOf");we("x",gp);we("X",vJ);Ze("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});Ze("x",function(e,t,r){r._d=new Date(Le(e))});//! moment.js
xe.version="2.30.1";XX(ft);xe.fn=he;xe.min=LQ;xe.max=$Q;xe.now=UQ;xe.utc=Ra;xe.unix=pee;xe.months=vee;xe.isDate=jf;xe.locale=ti;xe.invalid=hp;xe.duration=ua;xe.isMoment=oa;xe.weekdays=xee;xe.parseZone=mee;xe.localeData=ys;xe.isDuration=r0;xe.monthsShort=gee;xe.weekdaysMin=_ee;xe.defineLocale=ty;xe.updateLocale=mQ;xe.locales=vQ;xe.weekdaysShort=yee;xe.normalizeUnits=Ln;xe.relativeTimeRounding=Gee;xe.relativeTimeThreshold=Kee;xe.calendarFormat=fZ;xe.prototype=he;xe.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var uy={};uy.match=tte;uy.parse=D4;var Xee=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,Jee=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,Qee=/^(?:(min|max)-)?(.+)/,Zee=/(em|rem|px|cm|mm|in|pt|pc)?$/,ete=/(dpi|dpcm|dppx)?$/;function tte(e,t){return D4(e).some(function(r){var n=r.inverse,a=r.type==="all"||t.type===r.type;if(a&&n||!(a||n))return!1;var s=r.expressions.every(function(i){var o=i.feature,l=i.modifier,c=i.value,f=t[o];if(!f)return!1;switch(o){case"orientation":case"scan":return f.toLowerCase()===c.toLowerCase();case"width":case"height":case"device-width":case"device-height":c=Eb(c),f=Eb(f);break;case"resolution":c=Sb(c),f=Sb(f);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":c=bb(c),f=bb(f);break;case"grid":case"color":case"color-index":case"monochrome":c=parseInt(c,10)||1,f=parseInt(f,10)||0;break}switch(l){case"min":return f>=c;case"max":return f<=c;default:return f===c}});return s&&!n||!s&&n})}function D4(e){return e.split(",").map(function(t){t=t.trim();var r=t.match(Xee),n=r[1],a=r[2],s=r[3]||"",i={};return i.inverse=!!n&&n.toLowerCase()==="not",i.type=a?a.toLowerCase():"all",s=s.match(/\([^\)]+\)/g)||[],i.expressions=s.map(function(o){var l=o.match(Jee),c=l[1].toLowerCase().match(Qee);return{modifier:c[1],feature:c[2],value:l[2]}}),i})}function bb(e){var t=Number(e),r;return t||(r=e.match(/^(\d+)\s*\/\s*(\d+)$/),t=r[1]/r[2]),t}function Sb(e){var t=parseFloat(e),r=String(e).match(ete)[1];switch(r){case"dpcm":return t/2.54;case"dppx":return t*96;default:return t}}function Eb(e){var t=parseFloat(e),r=String(e).match(Zee)[1];switch(r){case"em":return t*16;case"rem":return t*16;case"cm":return t*96/2.54;case"mm":return t*96/2.54/10;case"in":return t*96;case"pt":return t*72;case"pc":return t*72/12;default:return t}}var rte=uy.match,kb=typeof window<"u"?window.matchMedia:null;function nte(e,t,r){var n=this,a;kb&&!r&&(a=kb.call(window,e)),a?(this.matches=a.matches,this.media=a.media,a.addListener(o)):(this.matches=rte(e,t),this.media=e),this.addListener=s,this.removeListener=i,this.dispose=l;function s(c){a&&a.addListener(c)}function i(c){a&&a.removeListener(c)}function o(c){n.matches=c.matches,n.media=c.media}function l(){a&&a.removeListener(o)}}function ate(e,t,r){return new nte(e,t,r)}var ste=ate;const ite=Sr(ste);var ote=/[A-Z]/g,lte=/^ms-/,Mm={};function cte(e){return"-"+e.toLowerCase()}function j4(e){if(Mm.hasOwnProperty(e))return Mm[e];var t=e.replace(ote,cte);return Mm[e]=lte.test(t)?"-"+t:t}function ute(e,t){if(e===t)return!0;if(!e||!t)return!1;const r=Object.keys(e),n=Object.keys(t),a=r.length;if(n.length!==a)return!1;for(let s=0;s<a;s++){const i=r[s];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}const Cr=ue.oneOfType([ue.string,ue.number]),fy={all:ue.bool,grid:ue.bool,aural:ue.bool,braille:ue.bool,handheld:ue.bool,print:ue.bool,projection:ue.bool,screen:ue.bool,tty:ue.bool,tv:ue.bool,embossed:ue.bool},P4={orientation:ue.oneOf(["portrait","landscape"]),scan:ue.oneOf(["progressive","interlace"]),aspectRatio:ue.string,deviceAspectRatio:ue.string,height:Cr,deviceHeight:Cr,width:Cr,deviceWidth:Cr,color:ue.bool,colorIndex:ue.bool,monochrome:ue.bool,resolution:Cr,type:Object.keys(fy)},{type:Dhe,...fte}=P4,F4={minAspectRatio:ue.string,maxAspectRatio:ue.string,minDeviceAspectRatio:ue.string,maxDeviceAspectRatio:ue.string,minHeight:Cr,maxHeight:Cr,minDeviceHeight:Cr,maxDeviceHeight:Cr,minWidth:Cr,maxWidth:Cr,minDeviceWidth:Cr,maxDeviceWidth:Cr,minColor:ue.number,maxColor:ue.number,minColorIndex:ue.number,maxColorIndex:ue.number,minMonochrome:ue.number,maxMonochrome:ue.number,minResolution:Cr,maxResolution:Cr,...fte},dte={...fy,...F4};var hte={all:dte,types:fy,matchers:P4,features:F4};const pte=e=>`not ${e}`,mte=(e,t)=>{const r=j4(e);return typeof t=="number"&&(t=`${t}px`),t===!0?r:t===!1?pte(r):`(${r}: ${t})`},vte=e=>e.join(" and "),gte=e=>{const t=[];return Object.keys(hte.all).forEach(r=>{const n=e[r];n!=null&&t.push(mte(r,n))}),vte(t)},xte=D.createContext(void 0),yte=e=>e.query||gte(e),Tb=e=>e?Object.keys(e).reduce((r,n)=>(r[j4(n)]=e[n],r),{}):void 0,R4=()=>{const e=D.useRef(!1);return D.useEffect(()=>{e.current=!0},[]),e.current},_te=e=>{const t=D.useContext(xte),r=()=>Tb(e)||Tb(t),[n,a]=D.useState(r);return D.useEffect(()=>{const s=r();ute(n,s)||a(s)},[e,t]),n},wte=e=>{const t=()=>yte(e),[r,n]=D.useState(t);return D.useEffect(()=>{const a=t();r!==a&&n(a)},[e]),r},bte=(e,t)=>{const r=()=>ite(e,t||{},!!t),[n,a]=D.useState(r),s=R4();return D.useEffect(()=>{if(s){const i=r();return a(i),()=>{i&&i.dispose()}}},[e,t]),n},Ste=e=>{const[t,r]=D.useState(e.matches);return D.useEffect(()=>{const n=a=>{r(a.matches)};return e.addListener(n),r(e.matches),()=>{e.removeListener(n)}},[e]),t},Cb=(e,t,r)=>{const n=_te(t),a=wte(e);if(!a)throw new Error("Invalid or missing MediaQuery!");const s=bte(a,n),i=Ste(s),o=R4();return D.useEffect(()=>{o&&r&&r(i)},[i]),D.useEffect(()=>()=>{s&&s.dispose()},[]),i},Ete=qX(xe);function kte(){const[e,t]=D.useState({totalClients:0,totalEmployees:0,totalQuotations:0,totalSiteVisits:0,totalpos:0,pendingNotifications:0,totalInvoices:0,totalPayments:0,totalProjects:0}),[r,n]=D.useState([]),[a,s]=D.useState([]),[i,o]=D.useState([]),[l,c]=D.useState([]),[f,d]=D.useState([]),[h,m]=D.useState([]),[v,p]=D.useState("stats"),[_,g]=D.useState(!1),y=Qe(A=>A.role),x=Qe(A=>A.user),w=Cb({maxWidth:767}),E=Cb({minWidth:768,maxWidth:1023});D.useEffect(()=>{S()},[y,x==null?void 0:x.id]);async function S(){try{if(y==="head"||y==="admin"||y==="e.head"){const H=[se.from("clients").select("*",{count:"exact",head:!0}),se.from("employees").select("*",{count:"exact",head:!0}),se.from("quotations").select("*",{count:"exact",head:!0}),se.from("site_visit").select("*",{count:"exact",head:!0}),se.from("quotations").select("*",{count:"exact",head:!0}).eq("status","approved"),se.from("notifications").select("*",{count:"exact",head:!0}).eq("is_delivered",!1)];y==="e.head"&&H.push(se.from("projects").select("*",{count:"exact",head:!0}),se.from("invoices").select("*",{count:"exact",head:!0}),se.from("payments").select("*",{count:"exact",head:!0}));const[{count:q},{count:Z},{count:Y},{count:ce},{count:z},{count:k},{count:I},{count:N},{count:P}]=await Promise.all(H);t(K=>({...K,totalClients:q||0,totalEmployees:Z||0,totalQuotations:Y||0,totalSiteVisits:ce||0,totalpos:z||0,pendingNotifications:k||0,totalProjects:I||0,totalInvoices:N||0,totalPayments:P||0}))}else if(y==="finance.employee"){const[{count:H},{count:q},{count:Z}]=await Promise.all([se.from("invoices").select("*",{count:"exact",head:!0}),se.from("payments").select("*",{count:"exact",head:!0}),se.from("notifications").select("*",{count:"exact",head:!0}).or(`assigned_to.eq.${x==null?void 0:x.id},target_role.eq.${y}`).eq("is_delivered",!1)]);t(Y=>({...Y,totalInvoices:H||0,totalPayments:q||0,pendingNotifications:Z||0}))}else{const[{count:H},{count:q},{count:Z},{count:Y},{count:ce},{count:z}]=await Promise.all([se.from("client_assignments").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id),se.from("quotations").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id),se.from("site_visit").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id),se.from("quotations").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id).eq("status","approved"),se.from("notifications").select("*",{count:"exact",head:!0}).or(`assigned_to.eq.${x==null?void 0:x.id},target_role.eq.${y}`).eq("is_delivered",!1),y==="e.employee"?se.from("project_assignments").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id):Promise.resolve({count:0})]);t(k=>({...k,totalClients:H||0,totalEmployees:0,totalQuotations:q||0,totalSiteVisits:Z||0,totalpos:Y||0,pendingNotifications:ce||0,totalProjects:z||0}))}if(y!=="finance.employee"){const{data:H}=await se.from("quotations").select(`
            *,
            clients (
              name,
              company
            )
          `).order("created_at",{ascending:!1}).limit(5);n(H||[]);const{data:q}=await se.from("site_visit").select(`
            *,
            clients (
              name,
              company
            ),
            employees (
              full_name
            ),
            address,
          `).order("created_at",{ascending:!1}).limit(5);s(q||[])}else{const{data:H}=await se.from("invoices").select(`
            *,
            clients (
              name,
              company
            ),
            projects (
              name
            )
          `).order("created_at",{ascending:!1}).limit(5);c(H||[]);const{data:q}=await se.from("payments").select(`
            *,
            invoices (
              invoice_number,
              clients (
                name,
                company
              )
            )
          `).order("created_at",{ascending:!1}).limit(5);d(q||[])}const A=y==="head"||y==="admin"||y==="e.head"?se.from("notifications").select("*").order("scheduled_at",{ascending:!1}).limit(5):se.from("notifications").select("*").or(`assigned_to.eq.${x==null?void 0:x.id},target_role.eq.${y}`).order("scheduled_at",{ascending:!1}).limit(5),{data:G}=await A;o(G||[]);const X=(G||[]).map(H=>({id:H.id,title:H.title,start:new Date(H.scheduled_at),end:new Date(new Date(H.scheduled_at).getTime()+60*60*1e3),description:H.description,assignedTo:H.assigned_to,isDelivered:H.is_delivered}));m(X)}catch(A){console.error("Error loading dashboard data:",A)}}const b=A=>{let G=A.isDelivered?"#d1fae5":"#fee2e2";return new Date(A.start)>new Date&&(G="#bfdbfe"),{style:{backgroundColor:G,borderRadius:"4px",opacity:.8,color:"#1f2937",border:"0px",display:"block"}}},T=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Invoices"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalInvoices})]}),u.jsx(Iw,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Payments"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalPayments})]}),u.jsx($w,{className:"w-6 h-6 md:w-8 md:h-8 text-green-600"})]})})]}),C=()=>u.jsx(u.Fragment,{children:u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Projects"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalProjects})]}),u.jsx(Uw,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})}),F=()=>u.jsx(u.Fragment,{children:u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Assigned Projects"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalProjects})]}),u.jsx(Uw,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})}),M=()=>u.jsxs("div",{className:"grid grid-cols-1 gap-4 md:gap-6 lg:grid-cols-2",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(Iw,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-blue-600"}),"Recent Invoices"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:l.map(A=>{var G,X;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(G=A.clients)==null?void 0:G.name," - ",A.invoice_number]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",A.amount]}),((X=A.projects)==null?void 0:X.name)&&u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Project: ",A.projects.name]})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${A.status==="paid"?"bg-green-100 text-green-800":A.status==="overdue"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:A.status.charAt(0).toUpperCase()+A.status.slice(1)})]})},A.id)})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx($w,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-green-600"}),"Recent Payments"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:f.map(A=>{var G,X,H;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(X=(G=A.invoices)==null?void 0:G.clients)==null?void 0:X.name," - ",(H=A.invoices)==null?void 0:H.invoice_number]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",A.amount]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Method: ",A.method]})]}),u.jsx("span",{className:"text-xs text-gray-400 mt-1",children:xe(A.payment_date).format("MMM D, YYYY")})]})},A.id)})})]})]}),j=()=>u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>{p("stats"),w&&g(!1)},className:`px-3 py-1 md:px-4 md:py-2 text-sm md:text-base rounded-md ${v==="stats"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Overview"}),u.jsx("button",{onClick:()=>{p("calendar"),w&&g(!1)},className:`px-3 py-1 md:px-4 md:py-2 text-sm md:text-base rounded-md ${v==="calendar"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Calendar"})]});return u.jsxs("div",{className:"space-y-4 md:space-y-6 p-2 md:p-4",children:[w&&u.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg shadow-md sticky top-0 z-10",children:[u.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Dashboard"}),u.jsx("button",{onClick:()=>g(!_),className:"p-1 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:_?u.jsx(Hl,{className:"w-6 h-6 text-gray-600"}):u.jsx(ZT,{className:"w-6 h-6 text-gray-600"})})]}),!w&&u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),j()]}),w&&_&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:j()}),v==="stats"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:`grid ${w?"grid-cols-1 gap-3":E?"grid-cols-2 gap-4":"grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6"}`,children:[y!=="finance.employee"&&y!==null&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Clients"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalClients})]}),u.jsx(Zc,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})}),(y==="head"||y==="admin"||y==="e.head")&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Employees"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalEmployees})]}),u.jsx(Xi,{className:"w-6 h-6 md:w-8 md:h-8 text-green-600"})]})}),y!=="finance.employee"&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Quotations"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalQuotations})]}),u.jsx(eu,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})]}),y==="finance.employee"&&T(),y==="e.head"&&C(),y==="e.employee"&&F(),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Pending Tasks"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.pendingNotifications})]}),u.jsx(ng,{className:"w-6 h-6 md:w-8 md:h-8 text-orange-600"})]})}),(y==="e.employee"||y==="employee")&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Site Visits"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalSiteVisits})]}),u.jsx(Mw,{className:"w-6 h-6 md:w-8 md:h-8 text-yellow-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total PO's"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalpos})]}),u.jsx(eu,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})})]})]}),u.jsx("div",{className:`grid ${w?"grid-cols-1 gap-4":E?"grid-cols-1 lg:grid-cols-2 gap-4":"grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6"}`,children:y==="finance.employee"?M():u.jsxs(u.Fragment,{children:[y!=="finance.employee"&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(eu,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-purple-600"}),"Recent Quotations"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:r.map(A=>{var G,X;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(G=A.clients)==null?void 0:G.name," - ",(X=A.clients)==null?void 0:X.company]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",A.amount]})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${A.status==="approved"?"bg-green-100 text-green-800":A.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:A.status.charAt(0).toUpperCase()+A.status.slice(1)})]})},A.id)})})]}),(y==="e.employee"||y==="employee")&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(Mw,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-yellow-600"}),"Recent Site Visits"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:a.map(A=>{var G,X,H;return u.jsxs("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(G=A.clients)==null?void 0:G.name," - ",(X=A.clients)==null?void 0:X.company]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["By: ",(H=A.employees)==null?void 0:H.full_name]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Location: ",A.address]})]},A.id)})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(ng,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-orange-600"}),"Recent Tasks"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:i.map(A=>u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base font-medium text-gray-800",children:A.title}),u.jsx("p",{className:"text-xs md:text-sm text-gray-500",children:A.description}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:xe(A.scheduled_at).format("MMM D, h:mm A")})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${A.is_delivered?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.is_delivered?"Completed":"Pending"})]})},A.id))})]})]})})]}):u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 h-[70vh] min-h-[500px]",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(xf,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-blue-600"}),"Task Calendar"]}),u.jsx(VX,{localizer:Ete,events:h,startAccessor:"start",endAccessor:"end",style:{height:w?"60vh":"65vh"},views:[Pt.MONTH,Pt.WEEK,Pt.DAY,Pt.AGENDA],defaultView:w?Pt.AGENDA:Pt.MONTH,eventPropGetter:b,onSelectEvent:A=>{alert(`Task: ${A.title}

Description: ${A.description||"No description"}

Status: ${A.isDelivered?"Completed":"Pending"}

Time: ${xe(A.start).format("MMM D, h:mm A")}`)}})]})]})}function Tte(){const[e,t]=D.useState([]),[r,n]=D.useState(!1),[a,s]=D.useState({email:"",password:"",full_name:"",role:"employee"}),[i,o]=D.useState(!1),[l,c]=D.useState(""),[f,d]=D.useState(""),[h,m]=D.useState([]);D.useEffect(()=>{v()},[]),D.useEffect(()=>{_()},[e,f]);async function v(){const{data:g,error:y}=await se.from("employees").select("*").order("created_at",{ascending:!1});if(y){console.error("Error loading employees:",y);return}t(g||[]),m(g||[])}async function p(g){var y;g.preventDefault(),o(!0),c("");try{const{data:x,error:w}=await se.auth.signUp({email:a.email,password:a.password});if(w)throw w;const{error:E}=await se.from("employees").insert([{id:(y=x.user)==null?void 0:y.id,email:a.email,full_name:a.full_name,role:a.role}]);if(E)throw E;s({email:"",password:"",full_name:"",role:"employee"}),n(!1),v()}catch(x){c(x.message)}finally{o(!1)}}const _=()=>{if(!f){m(e);return}const g=e.filter(y=>y.full_name.toLowerCase().includes(f.toLowerCase()));m(g)};return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Employees"}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"text",placeholder:"Search employees...",className:"p-2 border rounded mr-2",value:f,onChange:g=>d(g.target.value)}),u.jsxs("button",{onClick:()=>n(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Employee"]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(g=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:g.full_name}),u.jsx("p",{className:"text-gray-500",children:g.role})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${g.role==="head"?"bg-purple-100 text-purple-800":g.role==="admin"?"bg-green-100 text-green-800":g.role==="e.head"?"bg-orange-100 text-orange-800":g.role==="e.employee"?"bg-yellow-100 text-yellow-800":g.role==="finance.employee"?"bg-teal-100 text-teal-800":"bg-blue-100 text-blue-800"}`,children:g.role})]}),u.jsxs("div",{className:"mt-4 space-y-2",children:[u.jsxs("div",{className:"flex items-center text-gray-600",children:[u.jsx(Vl,{className:"w-4 h-4 mr-2"}),g.email]}),u.jsxs("div",{className:"flex items-center text-gray-600",children:[u.jsx(xf,{className:"w-4 h-4 mr-2"}),"Joined ",new Date(g.created_at).toLocaleDateString()]})]})]},g.id))}),r&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Employee"}),l&&u.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:l}),u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Full Name"}),u.jsx("input",{type:"text",value:a.full_name,onChange:g=>s({...a,full_name:g.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:a.email,onChange:g=>s({...a,email:g.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Password"}),u.jsx("input",{type:"password",value:a.password,onChange:g=>s({...a,password:g.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Role"}),u.jsxs("select",{value:a.role,onChange:g=>s({...a,role:g.target.value}),className:"w-full p-2 border rounded",children:[u.jsx("option",{value:"employee",children:"Employee"}),u.jsx("option",{value:"head",children:"Head"}),u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"e.employee",children:"E.Employee"}),u.jsx("option",{value:"e.head",children:"E.Head"}),u.jsx("option",{value:"finance.employee",children:"Finance Employee"})]})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:i?"Creating...":"Create"})]})]})]})})]})}function Cte(){const[e,t]=D.useState([]),[r,n]=D.useState(""),[a,s]=D.useState([]);D.useState(!1);const[i,o]=D.useState(!1),[l,c]=D.useState(null),[f,d]=D.useState([]),[h,m]=D.useState(""),[v,p]=D.useState([]),_=Rn(),g=Qe(T=>T.role),y=Qe(T=>T.user);D.useEffect(()=>{x(),(g==="head"||g==="admin"||g==="employee")&&E()},[g,y==null?void 0:y.id]),D.useEffect(()=>{w()},[e,r]);async function x(){try{if(g==="employee"&&(y!=null&&y.id)){const{data:T,error:C}=await se.from("client_assignments").select("client:clients(*, client_assignments(employee_id))").eq("employee_id",y.id).eq("client.status","ongoing");if(C)throw C;const F=(T==null?void 0:T.map(M=>M.client).filter(M=>M!==null))||[];t(F)}else if(g==="head"||g==="admin"){const{data:T,error:C}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","ongoing");if(C)throw C;t(T||[])}}catch(T){console.error("Error loading clients:",T)}}const w=()=>{if(!r){s(e);return}const T=e.filter(C=>{var F,M,j;return((F=C==null?void 0:C.name)==null?void 0:F.toLowerCase().includes(r.toLowerCase()))||((M=C==null?void 0:C.company)==null?void 0:M.toLowerCase().includes(r.toLowerCase()))||((j=C==null?void 0:C.address)==null?void 0:j.toLowerCase().includes(r.toLowerCase()))});s(T)};async function E(){const{data:T,error:C}=await se.from("employees").select("*").eq("role","employee");if(C){console.error("Error loading employees:",C);return}d(T||[])}async function S(){if(l)try{const T=v.map(F=>({client_id:l.id,employee_id:F}));await se.from("client_assignments").delete().eq("client_id",l.id);const{error:C}=await se.from("client_assignments").insert(T);if(C)throw C;o(!1),x()}catch(T){console.error("Error assigning employees:",T)}}const b=f.filter(T=>{var C;return(C=T==null?void 0:T.full_name)==null?void 0:C.toLowerCase().includes(h.toLowerCase())});return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Clients"}),u.jsx("div",{className:"flex items-center space-x-4",children:u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:T=>n(T.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]})})]}),a.length===0?u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No clients found"})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(T=>T&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:T.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:T.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:T.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>_(`/clients/${T.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),(g==="head"||g==="admin")&&u.jsxs("button",{onClick:()=>{var C;c(T),p(((C=T.client_assignments)==null?void 0:C.map(F=>F.employee_id))||[]),o(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Xi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},T.id))}),i&&l&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Assign Employees to ",l.name]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:h,onChange:T=>m(T.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:v,onChange:T=>{const C=Array.from(T.target.selectedOptions,F=>F.value);p(C)},className:"w-full p-2 border rounded h-40",size:5,children:b.map(T=>u.jsx("option",{value:T.id,children:T.full_name},T.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}function Nte(){const[e,t]=D.useState([]),[r,n]=D.useState(""),[a,s]=D.useState([]),[i,o]=D.useState(!1);D.useState(null);const[l,c]=D.useState([]),[f,d]=D.useState(""),[h,m]=D.useState({name:"",company:"",address:""});D.useState([]);const v=Rn(),p=Qe(S=>S.role),_=Qe(S=>S.user),g=Qe(S=>S.addNotification);D.useEffect(()=>{y(),(p==="head"||p==="employee"||p==="admin")&&w()},[p]),D.useEffect(()=>{x()},[e,r]);async function y(){const{data:S,error:b}=await se.from("clients").select("*, client_assignments(employee_id)");if(b){console.error("Error loading clients:",b);return}t(S||[])}const x=()=>{if(!r){s(e);return}const S=e.filter(b=>b.name.toLowerCase().includes(r.toLowerCase())||b.company.toLowerCase().includes(r.toLowerCase())||b.address.toLowerCase().includes(r.toLowerCase()));s(S)};async function w(){const{data:S,error:b}=await se.from("employees").select("*").eq("role","employee");if(b){console.error("Error loading employees:",b);return}c(S||[])}async function E(S){S.preventDefault();const{data:b,error:T}=await se.from("clients").insert([{...h,created_by:_==null?void 0:_.id,status:"ongoing"}]).select().single();if(T){console.error("Error creating client:",T);return}await g({title:"New Client Created",description:`A new client "${h.name}" from ${h.company} has been created.`,scheduled_at:new Date().toISOString(),created_by:_==null?void 0:_.id,assigned_to:_==null?void 0:_.id}),t([...e,b]),m({name:"",company:"",address:""}),o(!1)}return l.filter(S=>S.full_name.toLowerCase().includes(f.toLowerCase())),u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-white-800",children:"Clients"}),u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"relative mr-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:S=>n(S.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Client"]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(S=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:S.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:S.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:S.address}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("button",{onClick:()=>v(`/allclients/${S.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"})})]},S.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Client"}),u.jsxs("form",{onSubmit:E,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:h.name,onChange:S=>m({...h,name:S.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Company"}),u.jsx("input",{type:"text",value:h.company,onChange:S=>m({...h,company:S.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Address"}),u.jsx("input",{type:"text",value:h.address,onChange:S=>m({...h,address:S.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Create"})]})]})]})})]})}const Ate=864e5,dy=6e4,hy=36e5,Sd=43200,Nb=1440,Ab=Symbol.for("constructDateFrom");function oi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Ab in e?e[Ab](t):e instanceof Date?new e.constructor(t):new Date(t)}function Xr(e,t){return oi(e,e)}function Ote(e,t,r){const n=Xr(e);return isNaN(t)?oi(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function Dte(e,t,r){const n=Xr(e);if(isNaN(t))return oi(e,NaN);if(!t)return n;const a=n.getDate(),s=oi(e,n.getTime());s.setMonth(n.getMonth()+t+1,0);const i=s.getDate();return a>=i?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}function Cc(e,t,r){const{years:n=0,months:a=0,weeks:s=0,days:i=0,hours:o=0,minutes:l=0,seconds:c=0}=t,f=Xr(e),d=a||n?Dte(f,a+n*12):f,h=i||s?Ote(d,i+s*7):d,m=l+o*60,p=(c+m*60)*1e3;return oi(e,+h+p)}let jte={};function Pte(){return jte}function Z0(e){const t=Xr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function ws(e,...t){const r=oi.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function Ob(e,t){const r=Xr(e);return r.setHours(0,0,0,0),r}function Fte(e,t,r){const[n,a]=ws(r==null?void 0:r.in,e,t),s=Ob(n),i=Ob(a),o=+s-Z0(s),l=+i-Z0(i);return Math.round((o-l)/Ate)}function fl(e,t){const r=+Xr(e)-+Xr(t);return r<0?-1:r>0?1:r}function Rte(e){return oi(e,Date.now())}function Mte(e,t,r){const[n,a]=ws(r==null?void 0:r.in,e,t),s=n.getFullYear()-a.getFullYear(),i=n.getMonth()-a.getMonth();return s*12+i}function Ite(e,t,r){const[n,a]=ws(r==null?void 0:r.in,e,t);return n.getFullYear()-a.getFullYear()}function Lte(e,t,r){const[n,a]=ws(r==null?void 0:r.in,e,t),s=Db(n,a),i=Math.abs(Fte(n,a));n.setDate(n.getDate()-s*i);const o=+(Db(n,a)===-s),l=s*(i-o);return l===0?0:l}function Db(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function py(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function $te(e,t,r){const[n,a]=ws(r==null?void 0:r.in,e,t),s=(+n-+a)/hy;return py(r==null?void 0:r.roundingMethod)(s)}function M4(e,t){return+Xr(e)-+Xr(t)}function Ute(e,t,r){const n=M4(e,t)/dy;return py(r==null?void 0:r.roundingMethod)(n)}function Bte(e,t){const r=Xr(e);return r.setHours(23,59,59,999),r}function Wte(e,t){const r=Xr(e),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Vte(e,t){const r=Xr(e);return+Bte(r)==+Wte(r)}function I4(e,t,r){const[n,a,s]=ws(r==null?void 0:r.in,e,e,t),i=fl(a,s),o=Math.abs(Mte(a,s));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-i*o);let l=fl(a,s)===-i;Vte(n)&&o===1&&fl(n,s)===1&&(l=!1);const c=i*(o-+l);return c===0?0:c}function L4(e,t,r){const n=M4(e,t)/1e3;return py(r==null?void 0:r.roundingMethod)(n)}function Hte(e,t,r){const[n,a]=ws(r==null?void 0:r.in,e,t),s=fl(n,a),i=Math.abs(Ite(n,a));n.setFullYear(1584),a.setFullYear(1584);const o=fl(n,a)===-s,l=s*(i-+o);return l===0?0:l}function zte(e,t){const[r,n]=ws(e,t.start,t.end);return{start:r,end:n}}const Yte={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Gte=(e,t,r)=>{let n;const a=Yte[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Im(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Kte={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},qte={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Xte={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Jte={date:Im({formats:Kte,defaultWidth:"full"}),time:Im({formats:qte,defaultWidth:"full"}),dateTime:Im({formats:Xte,defaultWidth:"full"})},Qte={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Zte=(e,t,r,n)=>Qte[e];function Nc(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;a=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[i]}const s=e.argumentCallback?e.argumentCallback(t):t;return a[s]}}const ere={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},tre={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},rre={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},nre={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},are={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},sre={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ire=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ore={ordinalNumber:ire,era:Nc({values:ere,defaultWidth:"wide"}),quarter:Nc({values:tre,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Nc({values:rre,defaultWidth:"wide"}),day:Nc({values:nre,defaultWidth:"wide"}),dayPeriod:Nc({values:are,defaultWidth:"wide",formattingValues:sre,defaultFormattingWidth:"wide"})};function Ac(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const i=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?cre(o,d=>d.test(i)):lre(o,d=>d.test(i));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const f=t.slice(i.length);return{value:c,rest:f}}}function lre(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function cre(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function ure(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],s=t.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(a.length);return{value:i,rest:o}}}const fre=/^(\d+)(th|st|nd|rd)?/i,dre=/\d+/i,hre={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},pre={any:[/^b/i,/^(a|c)/i]},mre={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},vre={any:[/1/i,/2/i,/3/i,/4/i]},gre={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},xre={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},yre={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_re={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},wre={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},bre={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Sre={ordinalNumber:ure({matchPattern:fre,parsePattern:dre,valueCallback:e=>parseInt(e,10)}),era:Ac({matchPatterns:hre,defaultMatchWidth:"wide",parsePatterns:pre,defaultParseWidth:"any"}),quarter:Ac({matchPatterns:mre,defaultMatchWidth:"wide",parsePatterns:vre,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ac({matchPatterns:gre,defaultMatchWidth:"wide",parsePatterns:xre,defaultParseWidth:"any"}),day:Ac({matchPatterns:yre,defaultMatchWidth:"wide",parsePatterns:_re,defaultParseWidth:"any"}),dayPeriod:Ac({matchPatterns:wre,defaultMatchWidth:"any",parsePatterns:bre,defaultParseWidth:"any"})},Ere={code:"en-US",formatDistance:Gte,formatLong:Jte,formatRelative:Zte,localize:ore,match:Sre,options:{weekStartsOn:0,firstWeekContainsDate:1}};function kre(e,t,r){const n=Pte(),a=(r==null?void 0:r.locale)??n.locale??Ere,s=2520,i=fl(e,t);if(isNaN(i))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:i}),[l,c]=ws(r==null?void 0:r.in,...i>0?[t,e]:[e,t]),f=L4(c,l),d=(Z0(c)-Z0(l))/1e3,h=Math.round((f-d)/60);let m;if(h<2)return r!=null&&r.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,o):f<10?a.formatDistance("lessThanXSeconds",10,o):f<20?a.formatDistance("lessThanXSeconds",20,o):f<40?a.formatDistance("halfAMinute",0,o):f<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):h===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",h,o);if(h<45)return a.formatDistance("xMinutes",h,o);if(h<90)return a.formatDistance("aboutXHours",1,o);if(h<Nb){const v=Math.round(h/60);return a.formatDistance("aboutXHours",v,o)}else{if(h<s)return a.formatDistance("xDays",1,o);if(h<Sd){const v=Math.round(h/Nb);return a.formatDistance("xDays",v,o)}else if(h<Sd*2)return m=Math.round(h/Sd),a.formatDistance("aboutXMonths",m,o)}if(m=I4(c,l),m<12){const v=Math.round(h/Sd);return a.formatDistance("xMonths",v,o)}else{const v=m%12,p=Math.trunc(m/12);return v<3?a.formatDistance("aboutXYears",p,o):v<9?a.formatDistance("overXYears",p,o):a.formatDistance("almostXYears",p+1,o)}}function Tre(e,t){return kre(e,Rte(e),t)}function Cre(e,t){const{start:r,end:n}=zte(t==null?void 0:t.in,e),a={},s=Hte(n,r);s&&(a.years=s);const i=Cc(r,{years:a.years}),o=I4(n,i);o&&(a.months=o);const l=Cc(i,{months:a.months}),c=Lte(n,l);c&&(a.days=c);const f=Cc(l,{days:a.days}),d=$te(n,f);d&&(a.hours=d);const h=Cc(f,{hours:a.hours}),m=Ute(n,h);m&&(a.minutes=m);const v=Cc(h,{minutes:a.minutes}),p=L4(n,v);return p&&(a.seconds=p),a}function jb(e,t){const r=()=>oi(t==null?void 0:t.in,NaN),a=Dre(e);let s;if(a.date){const c=jre(a.date,2);s=Pre(c.restDateString,c.year)}if(!s||isNaN(+s))return r();const i=+s;let o=0,l;if(a.time&&(o=Fre(a.time),isNaN(o)))return r();if(a.timezone){if(l=Rre(a.timezone),isNaN(l))return r()}else{const c=new Date(i+o),f=Xr(0);return f.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),f.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),f}return Xr(i+o+l)}const Ed={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Nre=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Are=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ore=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Dre(e){const t={},r=e.split(Ed.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Ed.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Ed.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=Ed.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function jre(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function Pre(e,t){if(t===null)return new Date(NaN);const r=e.match(Nre);if(!r)return new Date(NaN);const n=!!r[4],a=Oc(r[1]),s=Oc(r[2])-1,i=Oc(r[3]),o=Oc(r[4]),l=Oc(r[5])-1;if(n)return Ure(t,o,l)?Mre(t,o,l):new Date(NaN);{const c=new Date(0);return!Lre(t,s,i)||!$re(t,a)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(a,i)),c)}}function Oc(e){return e?parseInt(e):1}function Fre(e){const t=e.match(Are);if(!t)return NaN;const r=Lm(t[1]),n=Lm(t[2]),a=Lm(t[3]);return Bre(r,n,a)?r*hy+n*dy+a*1e3:NaN}function Lm(e){return e&&parseFloat(e.replace(",","."))||0}function Rre(e){if(e==="Z")return 0;const t=e.match(Ore);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return Wre(n,a)?r*(n*hy+a*dy):NaN}function Mre(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const Ire=[31,null,31,30,31,30,31,31,30,31,30,31];function $4(e){return e%400===0||e%4===0&&e%100!==0}function Lre(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Ire[t]||($4(e)?29:28))}function $re(e,t){return t>=1&&t<=($4(e)?366:365)}function Ure(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Bre(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function Wre(e,t){return t>=0&&t<=59}function Vre(){const{id:e}=Ul(),[t,r]=D.useState(null),[n,a]=D.useState([]),[s,i]=D.useState(!1),[o,l]=D.useState(null),c=Qe(j=>j.role),[f,d]=D.useState(null),[h,m]=D.useState([]),[v,p]=D.useState(!0),[_,g]=D.useState({name:"",position:"",email:"",phone:""}),y=[{item_key:"customer_relation",label:"Customer Relation"},{item_key:"appointment",label:"Appointment",assigned:"Mr. Ashik"},{item_key:"repent",label:"Repent",assigned:"Mr. Subramani"},{item_key:"repent_approval",label:"Repent Approval",assigned:"Mrs. Shankari / Mrs. Remiga"},{item_key:"repent_transfer",label:"Repent Transfer for Performance Allowance",assigned:"Mr. Dilip Kumar"},{item_key:"repent_support",label:"Repent Support to customers",assigned:"Mr. Subramani"},{item_key:"expected_sheet",label:"Expected Sheet",assigned:"Mrs. Sapna"},{item_key:"feedback_call",label:"Feedback Call",assigned:"Mrs. Remiga"},{item_key:"dock_harbor",label:"Dock Harbor/User / Performance Allowance Approval"},{item_key:"tax_invoice_mobility",label:"Tax Invoice Mobility",assigned:"Mr. Sundar"},{item_key:"s_sheets_handbye",label:"S Sheets Handbye",assigned:"Mrs. Shankari"},{item_key:"tax_invoice_tally",label:"Tax Invoice Tally",assigned:"Mrs. Sapa"},{item_key:"g2_checking",label:"G2 Checking In",assigned:"Mr. Loganeth"},{item_key:"tax_invoice_approval",label:"Tax Invoice Approval",assigned:"Mrs. Shankari"},{item_key:"s_sheets_printout",label:"S Sheets Printout",assigned:"Mr. Subramani"},{item_key:"tax_invoice_email",label:"Tax Invoice Email",assigned:"Mr. Sundar"},{item_key:"daily_expenses",label:"Daily Expenses Monitor",assigned:"Mrs. Sapna"},{item_key:"payment_reminder",label:"Payment Reminder",assigned:"Mr. Sundar"},{item_key:"site_advance_payment",label:"Site Advance Payment",assigned:"Mr. Dilip Kumar"},{item_key:"payment_received",label:"Payment Received",assigned:"Mrs. Shankari"},{item_key:"site_advance_approval",label:"Site Advance Approval",assigned:"Mr. Subramani"},{item_key:"site_budget",label:"Site Budget",assigned:"Mrs. Sapna"},{item_key:"r1_checking",label:"R1 Checking On",assigned:"Mr. Zhailaan / Mr. Keyn"},{item_key:"m5_chaos",label:"M5 Chaos Last Verified",assigned:"Mr. Subramani"},{item_key:"toolbox_talk",label:"Tool Box Talk",assigned:"Mrs. Remiga"}];D.useEffect(()=>{e&&(T(),x())},[e]);async function x(){p(!0);try{const{data:j,error:A}=await se.from("checklist_items").select("*").eq("client_id",e).order("created_at",{ascending:!0});if(A)throw A;const G=new Date().toISOString(),X=y.map(H=>(j==null?void 0:j.find(Z=>Z.item_key===H.item_key))||{client_id:e,item_key:H.item_key,label:H.label,assigned:H.assigned,completed:!1,notes:"",created_at:G,updated_at:G});m(X)}catch(j){console.error("Error loading checklist:",j)}finally{p(!1)}}async function w(j){try{const{data:A,error:G}=await se.from("checklist_items").select("id").eq("client_id",e).eq("item_key",j.item_key).single();if(G&&G.code!=="PGRST116")throw G;const X=new Date().toISOString(),H={...j,updated_at:X,completed_at:j.completed?j.completed_at||X:null};let q;if(A){const{error:Z}=await se.from("checklist_items").update(H).eq("id",A.id);q=Z}else{const{error:Z}=await se.from("checklist_items").insert([{...H,created_at:X}]);q=Z}if(q)throw q}catch(A){console.error("Error saving checklist item:",A)}}const E=j=>{if(j===0)return null;const A=h[j],G=h[j-1];if(!(G!=null&&G.completed_at))return"Waiting for previous step to complete";if(!(A!=null&&A.completed_at))return"Current step not completed yet";try{const X=jb(G.completed_at),H=jb(A.completed_at);if(isNaN(X.getTime()))return"Invalid previous step completion time";if(isNaN(H.getTime()))return"Invalid current step completion time";const q=Cre({start:X,end:H}),Z=[];return q.days&&Z.push(`${q.days}d`),q.hours&&Z.push(`${q.hours}h`),q.minutes&&Z.push(`${q.minutes}m`),`Completed ${Z.join(" ")||"a few moments"} after previous step`}catch(X){return console.error("Error calculating time between steps:",X),"Time data error"}},S=async j=>{const A=h.map(X=>X.item_key===j?{...X,completed:!X.completed,completed_at:X.completed?void 0:new Date().toISOString()}:X);m(A);const G=A.find(X=>X.item_key===j);G&&await w(G)},b=async(j,A)=>{m(X=>X.map(H=>H.item_key===j?{...H,notes:A}:H));const G=h.find(X=>X.item_key===j);G&&await w({...G,notes:A})};async function T(){try{const{data:j,error:A}=await se.from("clients").select("*").eq("id",e).single();if(A)throw A;r(j);const{data:G,error:X}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(X)throw X;a(G||[]),j!=null&&j.created_by&&await C(j.created_by)}catch(j){console.error("Error loading client data:",j)}}async function C(j){try{const{data:A,error:G}=await se.from("employees").select("full_name").eq("id",j).single();if(G)throw G;d(A)}catch(A){console.error("Error loading employee data:",A)}}async function F(j){j.preventDefault();try{const{error:A}=await se.from("contact_persons").insert([{..._,client_id:e}]);if(A)throw A;g({name:"",position:"",email:"",phone:""}),i(!1),T()}catch(A){console.error("Error adding contact person:",A)}}async function M(j){j.preventDefault();try{const{error:A}=await se.from("contact_persons").update({name:o.name,position:o.position,email:o.email,phone:o.phone}).eq("id",o.id);if(A)throw A;l(null),T()}catch(A){console.error("Error updating contact person:",A)}}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsx("div",{className:"flex gap-2",children:u.jsxs("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-blue-700 transition-colors",children:[u.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Contact"]})})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(j=>u.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:j.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:j.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Vl,{className:"w-4 h-4 mr-2"}),j.email||"No email"]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(yf,{className:"w-4 h-4 mr-2"}),j.phone||"No phone"]})]}),c==="head"&&u.jsx("button",{onClick:()=>l(j),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300 transition-colors",children:"Edit"})]},j.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Workflow Checklist"}),v?u.jsx("div",{className:"flex justify-center py-4",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):u.jsx("div",{className:"space-y-6",children:h.map((j,A)=>u.jsxs("div",{className:"space-y-2",children:[A>0&&u.jsxs("div",{className:"flex items-center text-xs text-gray-500 ml-5 pl-5 border-l-2 border-gray-200",children:[u.jsx(qM,{className:"w-3 h-3 mr-1"}),E(A)]}),u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"flex items-center mt-1",children:u.jsx("input",{type:"checkbox",id:j.item_key,checked:j.completed,onChange:()=>S(j.item_key),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("label",{htmlFor:j.item_key,className:"block text-gray-800",children:[j.label,j.assigned&&u.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",j.assigned,")"]})]}),j.completed&&j.completed_at&&u.jsxs("span",{className:"text-xs text-gray-500",children:["Completed: ",Tre(new Date(j.completed_at),{addSuffix:!0})]})]}),u.jsx("input",{type:"text",placeholder:"Add notes...",value:j.notes||"",onChange:G=>b(j.item_key,G.target.value),className:"w-full mt-1 p-2 border rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),j.completed&&u.jsx("div",{className:"text-green-500 flex items-center",children:u.jsx(GM,{className:"w-5 h-5"})})]})]},j.item_key))})]}),c==="head"&&t.created_by&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Client Created By"}),f?u.jsxs("p",{className:"text-gray-600",children:["Employee Name: ",f==null?void 0:f.full_name]}):u.jsxs("p",{className:"text-gray-600",children:["User ID: ",t.created_by]})]}),s&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:F,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name*"}),u.jsx("input",{type:"text",value:_.name,onChange:j=>g({..._,name:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position*"}),u.jsx("input",{type:"text",value:_.position,onChange:j=>g({..._,position:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email*"}),u.jsx("input",{type:"email",value:_.email,onChange:j=>g({..._,email:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone*"}),u.jsx("input",{type:"tel",value:_.phone,onChange:j=>g({..._,phone:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Add Contact"})]})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:M,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name*"}),u.jsx("input",{type:"text",value:o.name,onChange:j=>l({...o,name:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position*"}),u.jsx("input",{type:"text",value:o.position,onChange:j=>l({...o,position:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email*"}),u.jsx("input",{type:"email",value:o.email,onChange:j=>l({...o,email:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone*"}),u.jsx("input",{type:"tel",value:o.phone,onChange:j=>l({...o,phone:j.target.value}),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Save Changes"})]})]})]})})]}):u.jsx("div",{className:"p-6",children:"Loading client data..."})}function Hre(){const{id:e}=Ul(),[t,r]=D.useState(null),[n,a]=D.useState([]),[s,i]=D.useState([]),[o,l]=D.useState([]),[c,f]=D.useState(!1),[d,h]=D.useState(!1),[m,v]=D.useState(!1),[p,_]=D.useState(!1),[g,y]=D.useState([]),[x,w]=D.useState(null),[E,S]=D.useState(!1),[b,T]=D.useState({contact:!1,quotation:!1,endClient:!1,poReceived:!1}),C=Qe(N=>N.role),F=Qe(N=>N.user),[M,j]=D.useState({name:"",position:"",email:"",phone:""}),[A,G]=D.useState({amount:"",description:"",start_date:"",end_date:"",selectedAssets:[]}),X=(N,P)=>{window.open(`https://www.google.com/maps?q=${N},${P}`,"_blank")},H=(N,P)=>{const K=`Quotation #${P.id} Details`,ne=`Dear Client,

Please find below the quotation details:

Amount: ₹${P.amount}/-
Valid From: ${new Date(P.start_date).toLocaleDateString()}
Valid Until: ${new Date(P.end_date).toLocaleDateString()}
Description: ${P.description}

Assets Included:
${P.quotation_assets.map(ie=>`- ${ie.assets.item} (Qty: ${ie.quantity})`).join(`
`)}

Best regards,
${(F==null?void 0:F.full_name)||"Your Representative"}
${(F==null?void 0:F.email)||""}`;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){const ie=`mailto:${N}?subject=${encodeURIComponent(K)}&body=${encodeURIComponent(ne)}`;window.location.href=ie}else window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${N}&su=${encodeURIComponent(K)}&body=${encodeURIComponent(ne)}`)};D.useEffect(()=>{e&&(q(),Z(),Y())},[e,E]);async function q(){try{const{data:N}=await se.from("clients").select("*").eq("id",e).single();r(N);const{data:P}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(a(P||[]),C==="admin"||C==="head"||E){const{data:K}=await se.from("quotations").select(`
            *,
            employees (
              full_name
            ),
            quotation_assets (
              asset_id,
              quantity,
              assets (
                item
              )
            )
          `).eq("client_id",e).order("created_at",{ascending:!1});i(K||[]);const{data:ne}=await se.from("site_visit").select(`
            *,
            employees (
              full_name
            ),
            site_visit_form (
              address,
              contact_no,
              notes,
              exit_location,
              created_at
            ),
            site_visit_assets (
              asset_id,
              quantity,
              assets (
                item
              )
            )
          `).eq("client_Id",e).order("created_at",{ascending:!1});l(ne||[])}}catch(N){console.error("Error loading client data:",N)}}async function Z(){try{const{data:N}=await se.from("assets").select("*").order("item");y(N||[])}catch(N){console.error("Error loading assets:",N)}}async function Y(){try{if(C==="admin"||C==="head"){S(!0);return}if(!(F!=null&&F.id)||!e){S(!1);return}const{data:N,error:P}=await se.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",F.id).single();S(!!N)}catch(N){console.error("Error checking assignment:",N)}}async function ce(N){N.preventDefault(),T(P=>({...P,contact:!0}));try{const{error:P}=await se.from("contact_persons").insert([{...M,client_id:e}]);if(P)throw P;j({name:"",position:"",email:"",phone:""}),f(!1),await q()}catch(P){console.error("Error adding contact:",P)}finally{T(P=>({...P,contact:!1}))}}async function z(N){N.preventDefault(),T(P=>({...P,contact:!0}));try{const{error:P}=await se.from("contact_persons").update({name:x.name,position:x.position,email:x.email,phone:x.phone}).eq("id",x.id);if(P)throw P;w(null),await q()}catch(P){console.error("Error updating contact:",P)}finally{T(P=>({...P,contact:!1}))}}async function k(N){N.preventDefault(),T(P=>({...P,quotation:!0}));try{const{data:P,error:K}=await se.from("quotations").insert([{client_id:e,employee_id:F==null?void 0:F.id,amount:parseFloat(A.amount),description:A.description,start_date:A.start_date,end_date:A.end_date,status:"pending"}]).select().single();if(K)throw K;if(A.selectedAssets.length>0){const{error:ne}=await se.from("quotation_assets").insert(A.selectedAssets.map(J=>({quotation_id:P.id,asset_id:J.assetId,quantity:J.quantity})));if(ne)throw ne}G({amount:"",description:"",start_date:"",end_date:"",selectedAssets:[]}),h(!1),await q()}catch(P){console.error("Error adding quotation:",P)}finally{T(P=>({...P,quotation:!1}))}}async function I(N,P){try{const{error:K}=await se.from("quotations").update({status:P}).eq("id",N);if(K)throw K;await q()}catch(K){console.error("Error updating quotation status:",K)}}return t?u.jsxs("div",{className:"space-y-6 p-4",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsxs("div",{className:"flex flex-wrap gap-2 w-full md:w-auto",children:[u.jsx("button",{onClick:()=>f(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.contact,children:b.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Contact"]})}),(C==="employee"||C==="admin")&&E&&u.jsx("button",{onClick:()=>h(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.quotation,children:b.quotation?"Loading...":u.jsxs(u.Fragment,{children:[u.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Quotation"]})})]})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(N=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:N.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:N.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Vl,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`mailto:${N.email}`,className:"hover:underline",children:N.email})]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(yf,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`tel:${N.phone}`,className:"hover:underline",children:N.phone})]})]}),C==="head"&&u.jsx("button",{onClick:()=>w(N),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},N.id))})]}),(C==="admin"||C==="head"||E)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Quotations"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No quotations found"}):u.jsx("div",{className:"space-y-4",children:s.map(N=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("p",{className:"font-semibold text-gray-800",children:["Amount: ₹",N.amount,"/-"]}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",N.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm",children:N.description}),u.jsx("div",{className:"mt-2",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Period: ",new Date(N.start_date).toLocaleDateString()," - ",new Date(N.end_date).toLocaleDateString()]})}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:N.quotation_assets.map(P=>u.jsxs("li",{children:[P.assets.item," (Qty: ",P.quantity,")"]},P.asset_id))})]})]}),u.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${N.status==="approved"?"bg-green-100 text-green-800":N.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:N.status.charAt(0).toUpperCase()+N.status.slice(1)}),C==="admin"&&u.jsxs("button",{onClick:()=>H(n[0].email,N),className:"flex items-center justify-center gap-1 px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:[u.jsx(eC,{className:"w-4 h-4"}),"Send Quotation"]}),C==="admin"&&N.status==="pending"&&u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>I(N.id,"approved"),className:"px-2 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"Approve"}),u.jsx("button",{onClick:()=>I(N.id,"rejected"),className:"px-2 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Reject"})]})]})]})},N.id))})]}),(C==="admin"||C==="head"||E)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),o.length===0?u.jsx("p",{className:"text-gray-500",children:"No site visits found"}):u.jsx("div",{className:"space-y-4",children:o.map(N=>{var P,K;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsx("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:((P=N.employees)==null?void 0:P.full_name)||"Unknown Employee"}),u.jsx("span",{className:"text-sm text-gray-500",children:new Date(N.created_at).toLocaleDateString()})]}),N.latitude&&N.longitude&&u.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center text-gray-700 mb-2",children:[u.jsx(M0,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"font-medium",children:"Visit Location"})]}),u.jsxs("button",{onClick:()=>X(parseFloat(N.latitude),parseFloat(N.longitude)),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center",children:[u.jsx(M0,{className:"w-3 h-3 mr-1"}),"View on Google Maps"]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2",children:[u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Latitude"}),u.jsx("div",{className:"font-mono text-sm",children:N.latitude})]}),u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Longitude"}),u.jsx("div",{className:"font-mono text-sm",children:N.longitude})]})]})]}),N.site_visit_form&&N.site_visit_form.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Address:"})," ",N.site_visit_form[0].address]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Contact:"})," ",N.site_visit_form[0].contact_no]}),u.jsxs("p",{className:"text-gray-500",children:[u.jsx("span",{className:"font-medium",children:"Notes:"})," ",N.site_visit_form[0].notes]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Exit Location:"})," ",N.site_visit_form[0].exit_location]})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:[(K=N.site_visit_assets)==null?void 0:K.map(ne=>{var J;return u.jsxs("li",{children:[(J=ne.assets)==null?void 0:J.item," (Qty: ",ne.quantity,")"]},ne.asset_id)}),(!N.site_visit_assets||N.site_visit_assets.length===0)&&u.jsx("li",{children:"No assets used"})]})]})]})})},N.id)})})]}),C==="head"&&u.jsx("button",{onClick:()=>v(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.endClient,children:b.endClient?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(R0,{className:"w-4 h-4 mr-2"}),"End Client"]})}),C==="admin"&&u.jsx("button",{onClick:()=>_(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.poReceived,children:b.poReceived?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(R0,{className:"w-4 h-4 mr-2"}),"PO Received"]})}),m&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as completed?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.endClient,children:"Cancel"}),u.jsx("button",{onClick:async()=>{T(N=>({...N,endClient:!0}));try{const{error:N}=await se.from("clients").update({status:"completed"}).eq("id",e);if(N)throw N;v(!1),await q()}catch(N){console.error("Error updating client status:",N)}finally{T(N=>({...N,endClient:!1}))}},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:b.endClient,children:b.endClient?"Processing...":"End Client"})]})]})}),p&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"PO Received"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Mark this client as PO Received?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.poReceived,children:"Cancel"}),u.jsx("button",{onClick:async()=>{T(N=>({...N,poReceived:!0}));try{const{error:N}=await se.from("clients").update({status:"poreceived"}).eq("id",e);if(N)throw N;_(!1),await q()}catch(N){console.error("Error updating client status:",N)}finally{T(N=>({...N,poReceived:!1}))}},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:b.poReceived,children:b.poReceived?"Processing...":"PO Received"})]})]})}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:ce,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:M.name,onChange:N=>j({...M,name:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:M.position,onChange:N=>j({...M,position:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:M.email,onChange:N=>j({...M,email:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:M.phone,onChange:N=>j({...M,phone:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:b.contact,children:b.contact?"Adding...":"Add Contact"})]})]})]})}),x&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:z,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:x.name,onChange:N=>w({...x,name:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:x.position,onChange:N=>w({...x,position:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:x.email,onChange:N=>w({...x,email:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:x.phone,onChange:N=>w({...x,phone:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>w(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:b.contact,children:b.contact?"Saving...":"Save Changes"})]})]})]})}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Quotation"}),u.jsxs("form",{onSubmit:k,children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Amount"}),u.jsx("input",{type:"number",step:"0.01",value:A.amount,onChange:N=>G({...A,amount:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Start Date"}),u.jsx("input",{type:"date",value:A.start_date,onChange:N=>G({...A,start_date:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Description"}),u.jsx("textarea",{value:A.description,onChange:N=>G({...A,description:N.target.value}),className:"w-full p-2 border rounded h-24",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"End Date"}),u.jsx("input",{type:"date",value:A.end_date,onChange:N=>G({...A,end_date:N.target.value}),className:"w-full p-2 border rounded",required:!0})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Assets"}),u.jsx("div",{className:"border rounded-lg p-4 max-h-64 overflow-y-auto",children:g.length===0?u.jsx("p",{className:"text-gray-500",children:"No assets available"}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(N=>{var P;return u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("input",{type:"checkbox",id:`asset-${N.id}`,checked:A.selectedAssets.some(K=>K.assetId===N.id),onChange:K=>{K.target.checked?G({...A,selectedAssets:[...A.selectedAssets,{assetId:N.id,quantity:1}]}):G({...A,selectedAssets:A.selectedAssets.filter(ne=>ne.assetId!==N.id)})},className:"mt-1"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{htmlFor:`asset-${N.id}`,className:"font-medium",children:N.item}),A.selectedAssets.some(K=>K.assetId===N.id)&&u.jsxs("div",{className:"mt-1",children:[u.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Quantity"}),u.jsx("input",{type:"number",min:"1",value:((P=A.selectedAssets.find(K=>K.assetId===N.id))==null?void 0:P.quantity)||1,onChange:K=>{G({...A,selectedAssets:A.selectedAssets.map(ne=>ne.assetId===N.id?{...ne,quantity:parseInt(K.target.value)||1}:ne)})},className:"w-full p-1 border rounded text-sm"})]})]})]},N.id)})})})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.quotation,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:b.quotation,children:b.quotation?"Creating...":"Create Quotation"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function zre(){const{id:e}=Ul(),[t,r]=D.useState(null),[n,a]=D.useState([]),[s,i]=D.useState([]),[o,l]=D.useState(!1),[c,f]=D.useState(!1),[d,h]=D.useState(!1),[m,v]=D.useState([]),[p,_]=D.useState(null),[g,y]=D.useState(!1),[x,w]=D.useState({contact:!1,status:!1}),E=Qe(H=>H.role),S=Qe(H=>H.user),b=(H,q)=>{window.open(`https://www.google.com/maps?q=${H},${q}`,"_blank")},[T,C]=D.useState({name:"",position:"",email:"",phone:""});D.useEffect(()=>{e&&(F(),M(),j())},[e,g]);async function F(){try{const{data:H}=await se.from("clients").select("*").eq("id",e).single();r(H);const{data:q}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(a(q||[]),E==="admin"||E==="e.head"||g){const{data:Z}=await se.from("site_visit").select(`
                        *,
                        employees (
                            full_name,
                            role
                        ),
                        site_visit_form (
                            address,
                            contact_no,
                            notes,
                            exit_location,
                            created_at
                        ),
                        site_visit_assets (
                            asset_id,
                            quantity,
                            assets (
                                item
                            )
                        )
                    `).eq("client_Id",e).order("created_at",{ascending:!1}),Y=(Z==null?void 0:Z.filter(ce=>{var z;return((z=ce.employees)==null?void 0:z.role)==="e.employee"}))||[];i(Y)}}catch(H){console.error("Error loading client data:",H)}}async function M(){try{const{data:H}=await se.from("assets").select("*").order("item");v(H||[])}catch(H){console.error("Error loading assets:",H)}}async function j(){try{if(E==="admin"||E==="e.head"){y(!0);return}if(!(S!=null&&S.id)||!e){y(!1);return}const{data:H,error:q}=await se.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",S.id).single();y(!!H)}catch(H){console.error("Error checking assignment:",H)}}async function A(H){H.preventDefault(),w({...x,contact:!0});try{const{error:q}=await se.from("contact_persons").insert([{...T,client_id:e}]);if(q)throw q;C({name:"",position:"",email:"",phone:""}),l(!1),await F()}catch(q){console.error("Error adding contact person:",q)}finally{w({...x,contact:!1})}}async function G(H){H.preventDefault(),w({...x,contact:!0});try{const{error:q}=await se.from("contact_persons").update({name:p.name,position:p.position,email:p.email,phone:p.phone}).eq("id",p.id);if(q)throw q;_(null),await F()}catch(q){console.error("Error updating contact person:",q)}finally{w({...x,contact:!1})}}async function X(H){w({...x,status:!0});try{const{error:q}=await se.from("clients").update({status:H}).eq("id",e);if(q)throw q;f(!1),h(!1),await F()}catch(q){console.error("Error updating client status:",q)}finally{w({...x,status:!1})}}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsx("div",{className:"flex gap-2",children:u.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:x.contact,children:x.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Contact"]})})})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(H=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:H.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:H.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Vl,{className:"w-4 h-4 mr-2"}),H.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(yf,{className:"w-4 h-4 mr-2"}),H.phone]})]}),E==="e.head"&&u.jsx("button",{onClick:()=>_(H),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},H.id))})]}),(E==="admin"||E==="head"||g)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No site visits found"}):u.jsx("div",{className:"space-y-4",children:s.map(H=>{var q,Z;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsx("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:((q=H.employees)==null?void 0:q.full_name)||"Unknown Employee"}),u.jsx("span",{className:"text-sm text-gray-500",children:new Date(H.created_at).toLocaleDateString()})]}),H.latitude&&H.longitude&&u.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center text-gray-700 mb-2",children:[u.jsx(M0,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"font-medium",children:"Visit Location"})]}),u.jsxs("button",{onClick:()=>b(parseFloat(H.latitude),parseFloat(H.longitude)),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center",children:[u.jsx(M0,{className:"w-3 h-3 mr-1"}),"View on Google Maps"]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2",children:[u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Latitude"}),u.jsx("div",{className:"font-mono text-sm",children:H.latitude})]}),u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Longitude"}),u.jsx("div",{className:"font-mono text-sm",children:H.longitude})]})]})]}),H.site_visit_form&&H.site_visit_form.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Address:"})," ",H.site_visit_form[0].address]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Contact:"})," ",H.site_visit_form[0].contact_no]}),u.jsxs("p",{className:"text-gray-500",children:[u.jsx("span",{className:"font-medium",children:"Notes:"})," ",H.site_visit_form[0].notes]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Exit Location:"})," ",H.site_visit_form[0].exit_location]})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:[(Z=H.site_visit_assets)==null?void 0:Z.map(Y=>{var ce;return u.jsxs("li",{children:[(ce=Y.assets)==null?void 0:ce.item," (Qty: ",Y.quantity,")"]},Y.asset_id)}),(!H.site_visit_assets||H.site_visit_assets.length===0)&&u.jsx("li",{children:"No assets used"})]})]})]})})},H.id)})})]}),E==="e.head"&&u.jsx("button",{onClick:()=>h(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:x.status,children:x.status?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(R0,{className:"w-4 h-4 mr-2"}),"E Complete"]})}),c&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as completed?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.status,children:"Cancel"}),u.jsx("button",{onClick:()=>X("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:x.status,children:"Confirm"})]})]})}),d&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ecomplete"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as Ecomplete?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.status,children:"Cancel"}),u.jsx("button",{onClick:()=>X("ecomplete"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:x.status,children:"Confirm"})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:A,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:T.name,onChange:H=>C({...T,name:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:T.position,onChange:H=>C({...T,position:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:T.email,onChange:H=>C({...T,email:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:T.phone,onChange:H=>C({...T,phone:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:x.contact,children:x.contact?"Adding...":"Add Contact"})]})]})]})}),p&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:G,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:p.name,onChange:H=>_({...p,name:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:p.position,onChange:H=>_({...p,position:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:p.email,onChange:H=>_({...p,email:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:p.phone,onChange:H=>_({...p,phone:H.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>_(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:x.contact,children:x.contact?"Saving...":"Save Changes"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function Yre(){const[e,t]=D.useState([]),[r,n]=D.useState(""),[a,s]=D.useState([]),[i,o]=D.useState(!1),[l,c]=D.useState({client_Id:"",latitude:"",longitude:"",accuracy:""}),[f,d]=D.useState([]),[h,m]=D.useState([]),[v,p]=D.useState(!1),[_,g]=D.useState(""),[y,x]=D.useState(!1),[w,E]=D.useState(null),[S,b]=D.useState(!1),[T,C]=D.useState(""),[F,M]=D.useState(""),[j,A]=D.useState(null),[G,X]=D.useState({}),H=Rn(),q=Qe(J=>J.role),Z=Qe(J=>J.user);D.useEffect(()=>{Y(),ce(),(q==="employee"||q==="e.employee")&&(Z!=null&&Z.id)&&z()},[q,Z==null?void 0:Z.id]),D.useEffect(()=>{k()},[e,r]);async function Y(){try{const{data:J,error:ie}=await se.from("site_visit").select("*").eq("status","start").order("created_at",{ascending:!1});if(ie)throw ie;if(t(J||[]),J&&J.length>0){const oe=J.map(ke=>ke.id),{data:Se,error:W}=await se.from("pd_kit_uploads").select("*").in("visit_id",oe);if(W)throw W;const Ne={};Se==null||Se.forEach(ke=>{ke.visit_id&&(Ne[ke.visit_id]||(Ne[ke.visit_id]=[]),Ne[ke.visit_id].push(ke))}),X(Ne)}}catch(J){console.error("Error loading site visits:",J)}}async function ce(){try{const{data:J,error:ie}=await se.from("clients").select("*").order("name");if(ie)throw ie;d(J||[])}catch(J){console.error("Error loading clients:",J)}}async function z(){try{if(!(Z!=null&&Z.id))return;const{data:J,error:ie}=await se.from("client_assignments").select("client_id").eq("employee_id",Z.id);if(ie)throw ie;if(J&&J.length>0){const{data:oe,error:Se}=await se.from("clients").select("*").in("id",J.map(W=>W.client_id)).order("name");if(Se)throw Se;m(oe||[])}}catch(J){console.error("Error loading assigned clients:",J)}}const k=()=>{if(!r){s(e);return}const J=r.toLowerCase(),ie=e.filter(oe=>{const Se=(q==="e.head"||q==="admin"||q==="head"?f:h).find(ke=>ke.id===oe.client_Id),W=(Se==null?void 0:Se.name.toLowerCase())||"",Ne=(Se==null?void 0:Se.company.toLowerCase())||"";return W.includes(J)||Ne.includes(J)||oe.created_at.toLowerCase().includes(J)});s(ie)},I=async()=>{if(!navigator.geolocation){g("Geolocation is not supported by your browser.");return}p(!0),g("");try{const J=await new Promise((ie,oe)=>{navigator.geolocation.getCurrentPosition(ie,oe,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})});c(ie=>({...ie,latitude:J.coords.latitude.toFixed(6),longitude:J.coords.longitude.toFixed(6),accuracy:`${J.coords.accuracy.toFixed(1)} meters`}))}catch(J){console.error("Geolocation error:",J),g(J.message||"Failed to get location")}finally{p(!1)}};async function N(J){if(J.preventDefault(),!Z){alert("You must be logged in to create a site visit");return}x(!0);try{const{data:ie,error:oe}=await se.from("site_visit").insert([{client_Id:l.client_Id,latitude:l.latitude,longitude:l.longitude,employee_Id:Z.id,status:"start"}]).select().single();if(oe)throw oe;t([ie,...e]),c({client_Id:"",latitude:"",longitude:"",accuracy:""}),o(!1)}catch(ie){console.error("Error creating site visit:",ie),alert("Failed to create site visit")}finally{x(!1)}}const P=async(J,ie)=>{if(!w||!Z||!J){C("No file selected or visit not specified");return}b(!0),C(""),M("");try{const{data:oe,error:Se}=await se.from("site_visit").select("client_Id").eq("id",J).single();if(Se)throw Se;if(!oe)throw new Error("Visit not found");const W=w.name.split(".").pop(),ke=`pd-kits/${`${Z.id}-${J}-${Date.now()}.${W}`}`,{data:Xe,error:Oe}=await se.storage.from("pd-kits").upload(ke,w,{cacheControl:"3600",upsert:!1});if(Oe)throw Oe;const{data:me,error:tt}=await se.from("pd_kit_uploads").insert([{employee_id:Z.id,file_path:ke,client_id:oe.client_Id,visit_id:J,upload_type:ie}]).select();if(tt)throw tt;X(cr=>{const gt={...cr};return gt[J]||(gt[J]=[]),gt[J].push(me[0]),gt}),M("PD Kit uploaded successfully!"),E(null),setTimeout(()=>{A(null),M("")},2e3)}catch(oe){console.error("Error in handlePdKitUpload:",oe),C(oe.message||"Failed to upload PD Kit. Please try again.")}finally{b(!1)}},K=()=>q==="admin"||q==="e.head"||q==="head"?f:h,ne=J=>{const{data:ie}=se.storage.from("pd-kits").getPublicUrl(J);return ie.publicUrl};return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Site Visits"}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative w-full sm:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client or date",value:r,onChange:J=>n(J.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 w-full sm:w-auto justify-center",children:[u.jsx(fs,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Site Visit"})]})}),a.map(J=>u.jsx("button",{onClick:()=>H(`/site-visits/${J.id}/pd-kits`),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View PD Kits"},J.id))]})]}),a.length===0?u.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[u.jsx("p",{className:"text-gray-500",children:"No site visits found"}),r&&u.jsx("button",{onClick:()=>n(""),className:"text-blue-600 hover:underline mt-2",children:"Clear search"})]}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(J=>{const oe=(q==="admin"||q==="head"?f:h).find(Ne=>Ne.id===J.client_Id),Se=new Date(J.created_at).toLocaleString(),W=G[J.id]||[];return u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow flex flex-col",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:oe?oe.name:"Unknown Client"}),(oe==null?void 0:oe.company)&&u.jsx("p",{className:"text-gray-600 text-sm mb-2",children:oe.company}),u.jsx("p",{className:"text-gray-500 text-xs mb-4",children:Se}),W.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"PD Kits:"}),u.jsx("ul",{className:"space-y-2",children:W.map(Ne=>u.jsxs("li",{className:"flex items-center",children:[u.jsx(eu,{className:"w-4 h-4 text-gray-500 mr-2"}),u.jsxs("a",{href:ne(Ne.file_path),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:[new Date(Ne.uploaded_at).toLocaleString()," (",Ne.upload_type,")"]})]},Ne.id))})]})]}),u.jsxs("div",{className:"flex justify-between items-center mt-4",children:[u.jsx("button",{onClick:()=>H(`/site-visits/${J.id}`),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Site Visit"}),q==="e.employee"&&u.jsxs("button",{onClick:()=>A(J.id),className:"text-green-600 hover:text-green-800 text-sm font-medium flex items-center gap-1",children:[u.jsx(tC,{className:"w-4 h-4"}),u.jsx("span",{children:"Upload PD Kit"})]})]})]},J.id)})}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Add New Site Visit"}),u.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),u.jsxs("form",{onSubmit:N,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Client"}),u.jsxs("select",{value:l.client_Id,onChange:J=>c({...l,client_Id:J.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:y||(q==="employee"||q==="e.employee")&&h.length===0,children:[u.jsx("option",{value:"",children:"Select Client"}),K().map(J=>u.jsxs("option",{value:J.id,children:[J.name," (",J.company,")"]},J.id))]}),(q==="employee"||q==="e.employee")&&h.length===0&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:"You don't have any assigned clients"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Location"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("button",{type:"button",onClick:I,disabled:v||y,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 flex items-center justify-center gap-2",children:v?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Getting Location..."]}):"Update Current Location"}),l.latitude&&l.longitude&&u.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Latitude:"})," ",l.latitude]}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Longitude:"})," ",l.longitude]}),l.accuracy&&u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Accuracy:"})," ",l.accuracy]})]}),_&&u.jsx("p",{className:"text-red-500 text-sm",children:_})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),disabled:y,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:!l.client_Id||!l.latitude||y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:y?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Site Visit"})]})]})]})}),j&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Upload PD Kit"}),u.jsx("button",{onClick:()=>{A(null),E(null),C(""),M("")},className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Select File (Image or PDF)"}),u.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:J=>{var ie;return E(((ie=J.target.files)==null?void 0:ie[0])||null)},className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-md file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-50 file:text-blue-700
                    hover:file:bg-blue-100`,disabled:S})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Upload Type"}),u.jsx("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",disabled:S,children:u.jsx("option",{value:"start",children:"Start of Visit"})})]}),w&&u.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Selected file:"})," ",w.name]}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Size:"})," ",(w.size/1024).toFixed(2)," KB"]})]}),T&&u.jsx("p",{className:"text-red-500 text-sm",children:T}),F&&u.jsx("p",{className:"text-green-500 text-sm",children:F}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>{A(null),E(null),C(""),M("")},disabled:S,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"button",onClick:()=>{const J=document.querySelector("select"),ie=J==null?void 0:J.value;P(j,ie)},disabled:!w||S,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 flex items-center gap-2",children:S?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload PD Kit"})]})]})]})})]})}function Gre(){const{id:e}=Ul(),t=Rn(),[r,n]=D.useState(1),[a,s]=D.useState(!0),[i,o]=D.useState([]),[l,c]=D.useState(!1),[f,d]=D.useState(""),[h,m]=D.useState("");D.useState(!1),D.useState(""),D.useState(null);const[v,p]=D.useState(null),[_,g]=D.useState(!1),[y,x]=D.useState(""),[w,E]=D.useState(!1),[S,b]=D.useState(null),[T]=Qe(z=>[z.role]),[C,F]=D.useState({address:"",contactNo:"",notes:"",exitLocation:"",selectedAssets:[],latitude:"",longitude:"",pdKitFile:null,pdKitEndFile:null});D.useEffect(()=>{(async()=>{const{data:{user:k}}=await se.auth.getUser();k?b(k):t("/login")})()},[t]),D.useEffect(()=>{async function z(){if(S){s(!0),m("");try{const{data:k,error:I}=await se.from("assets").select("*").order("item");if(I)throw I;if(o(k||[]),e){const{data:N,error:P}=await se.from("site_visit").select("status, client_Id").eq("id",e).single();if(P)throw P;if(N.status==="end"){t(`/site-visits/${e}`,{replace:!0});return}const{data:K,error:ne}=await se.from("site_visit_form").select("*").eq("visit_id",e).maybeSingle();if(ne)throw ne;K&&F({address:K.address||"",contactNo:K.contact_no||"",notes:K.notes||"",exitLocation:K.exit_location||"",selectedAssets:[],latitude:K.latitude||"",longitude:K.longitude||"",pdKitFile:null,pdKitEndFile:null});const{data:J,error:ie}=await se.from("site_visit_assets").select("asset_id, quantity").eq("site_visit_id",e);if(ie)throw ie;J&&F(W=>({...W,selectedAssets:J.map(Ne=>({assetId:Ne.asset_id,quantity:Ne.quantity}))}));const{data:oe,error:Se}=await se.from("pd_kit_uploads").select("file_path").eq("visit_id",e).eq("upload_type","end").maybeSingle();if(!Se&&oe){const{data:W}=se.storage.from("pd-kits").getPublicUrl(oe.file_path);p(W.publicUrl),E(!0)}}}catch(k){console.error("Error loading data:",k),m(k.message||"Failed to load data")}finally{s(!1)}}}z()},[e,t,S]);function M(z){F(k=>({...k,...z}))}const j=async()=>{if(!navigator.geolocation){d("Geolocation is not supported by your browser.");return}c(!0),d("");try{const z=await new Promise((k,I)=>{navigator.geolocation.getCurrentPosition(k,I,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})});M({latitude:z.coords.latitude.toString(),longitude:z.coords.longitude.toString()})}catch(z){console.error("Geolocation error:",z),d(z.message||"Failed to get location")}finally{c(!1)}},A=z=>{if(z.target.files&&z.target.files[0]){const k=z.target.files[0];M({pdKitEndFile:k});const I=new FileReader;I.onload=N=>{var P;p((P=N.target)==null?void 0:P.result)},I.readAsDataURL(k),E(!1)}},G=()=>{M({pdKitEndFile:null}),p(null),x(""),E(!1)},X=async()=>{if(!S){x("User not authenticated");return}if(!C.pdKitEndFile||!e){x("Please select a file first");return}g(!0),x("");try{const{data:z,error:k}=await se.from("site_visit").select("client_Id").eq("id",e).single();if(k)throw k;if(!z)throw new Error("Visit not found");const I=C.pdKitEndFile.name.split(".").pop(),P=`pd-kits/${`${S.id}-${e}-${Date.now()}.${I}`}`,{error:K}=await se.storage.from("pd-kits").upload(P,C.pdKitEndFile);if(K)throw K;if(v&&v.includes("pd-kits/")){const ie=v.split("pd-kits/")[1].split("?")[0];await se.storage.from("pd-kits").remove([ie])}const{error:ne}=await se.from("pd_kit_uploads").upsert({employee_id:S.id,client_id:z.client_Id,visit_id:e,file_path:P,upload_type:"end"});if(ne)throw ne;const{data:J}=se.storage.from("pd-kits").getPublicUrl(P);p(J.publicUrl),E(!0)}catch(z){console.error("Error uploading PD Kit:",z),x(z.message||"Failed to upload PD Kit")}finally{g(!1)}},H=z=>z===1&&!C.notes?(m("Please enter notes"),!1):z===2&&!C.address?(m("Please enter an address"),!1):z===3&&!C.exitLocation?(m("Please enter exit location"),!1):z===3&&(!C.latitude||!C.longitude)?(m("Please update your location coordinates"),!1):(m(""),!0);async function q(z){if(z.preventDefault(),!!H(3)){s(!0),m("");try{if(!S)throw new Error("User not authenticated");let k=e;if(!e){const{data:P,error:K}=await se.from("site_visit").insert([{employee_id:S.id,status:"start",visit_date:new Date().toISOString()}]).select().single();if(K)throw K;k=P.id}const{error:I}=await se.from("site_visit").update({status:"end"}).eq("id",k);if(I)throw I;const{error:N}=await se.from("site_visit_form").upsert({id:e||void 0,visit_id:k,address:C.address,contact_no:C.contactNo,notes:C.notes,exit_location:C.exitLocation,latitude:C.latitude,longitude:C.longitude});if(N)throw N;if(C.selectedAssets.length>0){if(e){const{error:ne}=await se.from("site_visit_assets").delete().eq("site_visit_id",k);if(ne)throw ne}const P=C.selectedAssets.map(ne=>({site_visit_id:k,asset_id:ne.assetId,quantity:Math.max(1,ne.quantity)})),{error:K}=await se.from("site_visit_assets").insert(P);if(K)throw K}C.pdKitEndFile&&!w&&await X(),localStorage.removeItem("draftSiteVisitForm"),window.dispatchEvent(new CustomEvent("siteVisitUpdated",{detail:{visitId:k}})),alert(`Site visit ${e?"completed":"created"} successfully!`),t("/site-visits",{replace:!0})}catch(k){console.error("Error saving site visit:",k),m(k.message||"Failed to save site visit")}finally{s(!1)}}}function Z(){return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Notes *"}),u.jsx("textarea",{value:C.notes,onChange:z=>M({notes:z.target.value}),className:"w-full p-2 border rounded h-32",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Contact No"}),u.jsx("input",{type:"text",value:C.contactNo,onChange:z=>M({contactNo:z.target.value}),className:"w-full p-2 border rounded"})]})]})}function Y(){return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Address *"}),u.jsx("input",{type:"text",value:C.address,onChange:z=>M({address:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Assets"}),u.jsx("div",{className:"space-y-3",children:i.map(z=>{var k;return u.jsxs("div",{className:"flex items-center gap-4 p-2 border rounded",children:[u.jsx("input",{type:"checkbox",id:`asset-${z.id}`,checked:C.selectedAssets.some(I=>I.assetId===z.id),onChange:I=>{const N=I.target.checked?[...C.selectedAssets,{assetId:z.id,quantity:1}]:C.selectedAssets.filter(P=>P.assetId!==z.id);M({selectedAssets:N})},className:"h-5 w-5"}),u.jsx("label",{htmlFor:`asset-${z.id}`,className:"flex-1",children:z.item}),C.selectedAssets.some(I=>I.assetId===z.id)&&u.jsx("input",{type:"number",min:"1",value:((k=C.selectedAssets.find(I=>I.assetId===z.id))==null?void 0:k.quantity)||1,onChange:I=>{const N=C.selectedAssets.map(P=>P.assetId===z.id?{...P,quantity:Math.max(1,parseInt(I.target.value)||1)}:P);M({selectedAssets:N})},className:"w-20 p-1 border rounded"})]},z.id)})})]})]})}function ce(){return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Exit Location *"}),u.jsx("input",{type:"text",value:C.exitLocation,onChange:z=>M({exitLocation:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Location Coordinates *"}),u.jsx("button",{type:"button",onClick:j,disabled:l,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-green-400 flex items-center gap-2 mb-2",children:l?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Getting Location..."]}):"Update Current Location"}),f&&u.jsx("p",{className:"text-red-500 text-sm",children:f}),u.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium",children:"Latitude"}),u.jsx("p",{className:"text-sm text-gray-700 bg-gray-100 p-2 rounded",children:C.latitude||"Not set"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium",children:"Longitude"}),u.jsx("p",{className:"text-sm text-gray-700 bg-gray-100 p-2 rounded",children:C.longitude||"Not set"})]})]})]}),T==="e.employee"&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"PD Kit (End of Visit)"}),u.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[v?u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:v,alt:"PD Kit End Preview",className:"max-h-48 mb-2 rounded"}),u.jsx("button",{type:"button",onClick:G,className:"absolute top-0 right-0 bg-white rounded-full p-1 shadow",children:u.jsx(Hl,{className:"w-4 h-4 text-red-500"})})]}),u.jsx("button",{type:"button",onClick:()=>{var z;return(z=document.getElementById("pd-kit-end-upload"))==null?void 0:z.click()},className:"text-blue-600 hover:underline text-sm mb-2",children:"Change PD Kit"}),!w&&u.jsx("button",{type:"button",onClick:X,disabled:_,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:_?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload PD Kit"}),w&&u.jsx("p",{className:"text-green-600 text-sm mt-2",children:"PD Kit uploaded successfully!"})]}):u.jsx("label",{htmlFor:"pd-kit-end-upload",className:"cursor-pointer",children:u.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[u.jsx(tC,{className:"w-8 h-8 text-gray-400"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload PD Kit image"}),u.jsx("p",{className:"text-xs text-gray-500",children:"(Optional for employees)"})]})}),u.jsx("input",{id:"pd-kit-end-upload",type:"file",accept:"image/*",onChange:A,className:"hidden"})]}),y&&u.jsx("p",{className:"text-red-500 text-sm mt-2",children:y})]})]})}return a?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white shadow-md rounded-lg mt-6",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:e?"Complete Site Visit":"Create New Site Visit"}),h&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:h}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex justify-between mb-2 text-sm font-medium",children:[u.jsx("span",{className:r===1?"text-blue-600":"text-gray-500",children:"Step 1: Details"}),u.jsx("span",{className:r===2?"text-blue-600":"text-gray-500",children:"Step 2: Assets"}),u.jsx("span",{className:r===3?"text-blue-600":"text-gray-500",children:"Step 3: Completion"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${(r-1)/2*100}%`}})})]}),u.jsxs("form",{onSubmit:q,className:"space-y-6",children:[r===1&&Z(),r===2&&Y(),r===3&&ce(),u.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[r>1?u.jsx("button",{type:"button",onClick:()=>n(r-1),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",disabled:a,children:"Back"}):u.jsx("div",{}),r<3?u.jsx("button",{type:"button",onClick:()=>{H(r)&&n(r+1)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:a,children:"Continue"}):u.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",disabled:a||_,children:a?u.jsxs("span",{className:"flex items-center",children:[u.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):e?"Complete Visit":"Create Visit"})]})]})]})}function Kre(){const[e,t]=D.useState([]),r=Rn();D.useEffect(()=>{n()},[]);async function n(){const{data:a,error:s}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","completed");if(s){console.error("Error loading clients:",s);return}t(a||[])}return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsx("div",{className:"flex justify-between items-center mb-6",children:u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Clients History"})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(a=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:a.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:a.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:a.address}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("button",{onClick:()=>r(`/clientshistoryprofile/${a.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"})})]},a.id))})]})}function qre(){const[e,t]=D.useState([]),[r,n]=D.useState([]),[a,s]=D.useState(""),[i,o]=D.useState(!1),[l,c]=D.useState(!1),[f,d]=D.useState(null),[h,m]=D.useState([]),v=Qe(A=>A.user),[p,_]=D.useState({title:"",description:"",date:"",time:"",assignTo:"self"}),[g,y]=D.useState(!1),[x,w]=D.useState("");D.useEffect(()=>{S(),E();const A=setInterval(b,6e4);return()=>clearInterval(A)},[]),D.useEffect(()=>{b()},[e]);async function E(){const{data:A,error:G}=await se.from("employees").select("*");G||m(A||[])}async function S(){y(!0);try{const{data:A,error:G}=await se.from("notifications").select("*").order("scheduled_at",{ascending:!1});if(G)throw G;t(A||[])}catch(A){console.error("Error loading notifications:",A),w("Failed to load notifications")}finally{y(!1)}}function b(){const A=new Date,G=e.filter(X=>new Date(X.scheduled_at)<=A&&!X.is_delivered);n(G)}async function T(A){A.preventDefault(),y(!0),w("");try{const G=new Date(`${p.date}T${p.time}`).toISOString(),X=p.assignTo==="all"?h.map(Z=>Z.id):[v==null?void 0:v.id],{data:H,error:q}=await se.from("notifications").insert(X.map(Z=>({title:p.title,description:p.description,scheduled_at:G,created_by:v==null?void 0:v.id,assigned_to:Z,is_delivered:!1}))).select();if(q)throw q;t([...H,...e]),_({title:"",description:"",date:"",time:"",assignTo:"self"}),o(!1)}catch(G){console.error("Error creating notification:",G),w("Failed to create notification")}finally{y(!1)}}async function C(A){try{await se.from("notifications").update({is_delivered:!0}).eq("id",A),t(e.map(G=>G.id===A?{...G,is_delivered:!0}:G))}catch(G){console.error("Error marking notification:",G)}}async function F(A,G){y(!0);try{const X=G==="all"?h.map(Z=>Z.id):[v==null?void 0:v.id];await se.from("notifications").delete().eq("id",A);const{data:H,error:q}=await se.from("notifications").insert(X.map(Z=>({...f,id:void 0,assigned_to:Z,is_delivered:!1}))).select();if(q)throw q;t([...H,...e.filter(Z=>Z.id!==A)]),c(!1)}catch(X){console.error("Error assigning notification:",X),w("Failed to assign notification")}finally{y(!1)}}const M=A=>new Date(A).toLocaleDateString(),j=A=>new Date(A).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Notification Center"}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative w-full sm:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Notifications",value:a,onChange:A=>s(A.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 w-full sm:w-auto justify-center",disabled:g,children:[u.jsx(fs,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Notification"})]})]})]}),x&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:x}),g&&!e.length?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r.length===0?u.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:u.jsx("p",{className:"text-gray-500",children:"No active notifications"})}):u.jsx("div",{className:"space-y-4",children:r.filter(A=>A.title.toLowerCase().includes(a.toLowerCase())||A.description&&A.description.toLowerCase().includes(a.toLowerCase())).map(A=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow w-full relative",children:[u.jsx("button",{onClick:()=>C(A.id),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",title:"Dismiss notification",children:u.jsx(Hl,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex justify-between items-start pr-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:A.title}),A.description&&u.jsx("p",{className:"text-gray-600 mb-4",children:A.description}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("span",{className:"text-xs text-gray-500",children:["Scheduled: ",M(A.scheduled_at)," at ",j(A.scheduled_at)]})})]}),u.jsx("div",{className:"flex gap-2",children:((v==null?void 0:v.role)==="head"||(v==null?void 0:v.role)==="admin"||(v==null?void 0:v.role)==="employee")&&u.jsxs("button",{onClick:()=>{d(A),c(!0)},className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",title:"Reassign notification",children:[A.assigned_to===(v==null?void 0:v.id)?u.jsx(sg,{className:"w-4 h-4"}):u.jsx(Xi,{className:"w-4 h-4"}),"Reassign"]})})]})]},A.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Create Notification"}),u.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",disabled:g,children:"✕"})]}),u.jsxs("form",{onSubmit:T,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Title *"}),u.jsx("input",{type:"text",value:p.title,onChange:A=>_({...p,title:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:g})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Description"}),u.jsx("textarea",{value:p.description,onChange:A=>_({...p,description:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",rows:3,disabled:g})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Date *"}),u.jsx("input",{type:"date",value:p.date,onChange:A=>_({...p,date:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:g})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Time *"}),u.jsx("input",{type:"time",value:p.time,onChange:A=>_({...p,time:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:g})]})]}),((v==null?void 0:v.role)==="head"||(v==null?void 0:v.role)==="admin"||(v==null?void 0:v.role)==="e.head")&&u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Assign To"}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",name:"assignTo",value:"self",checked:p.assignTo==="self",onChange:()=>_({...p,assignTo:"self"}),className:"h-4 w-4",disabled:g}),u.jsx("span",{children:"Only me"})]}),u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",name:"assignTo",value:"all",checked:p.assignTo==="all",onChange:()=>_({...p,assignTo:"all"}),className:"h-4 w-4",disabled:g}),u.jsx("span",{children:"All employees"})]})]})]}),x&&u.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 text-sm rounded",children:x}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),disabled:g,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:g||!p.title||!p.date||!p.time,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:g?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Notification"})]})]})]})}),l&&f&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Reassign Notification"}),u.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",disabled:g,children:"✕"})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:f.title}),f.description&&u.jsx("p",{className:"text-gray-600 mb-4",children:f.description})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-gray-700 mb-4 font-medium",children:"Assign To"}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("button",{onClick:()=>F(f.id,"self"),disabled:g,className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:u.jsx(sg,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"font-medium",children:"Only me"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Assign this notification only to yourself"})]})]}),u.jsxs("button",{onClick:()=>F(f.id,"all"),disabled:g,className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[u.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:u.jsx(Xi,{className:"w-5 h-5 text-green-600"})}),u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"font-medium",children:"All employees"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Assign this notification to all employees"})]})]})]})]}),x&&u.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 text-sm rounded",children:x})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var U4=1252,Xre=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],my={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},vy=function(e){Xre.indexOf(e)!=-1&&(U4=my[0]=e)};function Jre(){vy(1252)}var Jn=function(e){vy(e)};function B4(){Jn(1200),Jre()}function Pb(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Qre(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function W4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ic=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Qre(e.slice(2)):t==254&&r==255?W4(e.slice(2)):t==65279?e.slice(1):e},kd=function(t){return String.fromCharCode(t)},Fb=function(t){return String.fromCharCode(t)},Ms,Vs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rb(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Vs.charAt(s)+Vs.charAt(i)+Vs.charAt(o)+Vs.charAt(l);return t}function cn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Vs.indexOf(e.charAt(c++)),i=Vs.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Vs.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Vs.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var $e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),go=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function li(e){return $e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Mb(e){return $e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var qn=function(t){return $e?go(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function xo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function gy(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return gy(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Is=$e?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:go(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Zre(e){for(var t=[],r=0,n=e.length+250,a=li(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=li(65535),n=65530)}return t.push(a.slice(0,r)),Is(t)}var Pr=/\u0000/g,Lc=/[\u0001-\u0006]/g;function dl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Qn(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}function xy(e,t){var r=""+e;return r.length>=t?r:Tt(" ",t-r.length)+r}function eh(e,t){var r=""+e;return r.length>=t?r:r+Tt(" ",t-r.length)}function ene(e,t){var r=""+Math.round(e);return r.length>=t?r:Tt("0",t-r.length)+r}function tne(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}var Ib=Math.pow(2,32);function jo(e,t){if(e>Ib||e<-Ib)return ene(e,t);var r=Math.round(e);return tne(r,t)}function th(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Lb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],$m=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function rne(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},$b={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},nne={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rh(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(a);c<t&&(d=Math.floor(a),o=d*i+s,f=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function Mi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=cne(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var V4=new Date(1899,11,31,0,0,0),ane=V4.getTime(),sne=new Date(1900,2,1,0,0,0);function H4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=sne&&(r+=24*60*60*1e3),(r-(ane+(e.getTimezoneOffset()-V4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function yy(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ine(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function one(e){var t=e<0?12:11,r=yy(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function lne(e){var t=yy(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Zu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=one(e):t===10?r=e.toFixed(10).substr(0,12):r=lne(e),yy(ine(r.toUpperCase()))}function ao(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Zu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fn(14,H4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function cne(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function une(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return $m[r.m-1][1];case 5:return $m[r.m-1][0];default:return $m[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Lb[r.q][0];default:return Lb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Qn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Qn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Qn(l,c):"";return f}function Hs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var z4=/%/g;function fne(e,t,r){var n=t.replace(z4,""),a=t.length-n.length;return ns(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function dne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ns(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Y4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var G4=/# (\?+)( ?)\/( ?)(\d+)/;function hne(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Tt(" ",e[1].length+1+e[4].length):xy(i,e[1].length)+e[2]+"/"+e[3]+Qn(o,e[4].length))}function pne(e,t,r){return r+(t===0?"":""+t)+Tt(" ",e[1].length+2+e[4].length)}var K4=/^#*0*\.([0#]+)/,q4=/\).*[0#]/,X4=/\(###\) ###\\?-####/;function Ar(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ub(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Bb(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function mne(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function vne(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(q4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gn("n",n,r):"("+gn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return dne(e,t,r);if(t.indexOf("%")!==-1)return fne(e,t,r);if(t.indexOf("E")!==-1)return Y4(t,r);if(t.charCodeAt(0)===36)return"$"+gn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+jo(l,t.length);if(t.match(/^[#?]+$/))return a=jo(r,0),a==="0"&&(a=""),a.length>t.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(G4))return hne(s,l,c);if(t.match(/^#+0+$/))return c+jo(l,t.length-t.indexOf("0"));if(s=t.match(K4))return a=Ub(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])).replace(/\.(\d*)$/,function(v,p){return"."+p+Tt("0",Ar(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Ub(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Hs(jo(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gn(e,t,-r):Hs(""+(Math.floor(r)+mne(r,s[1].length)))+"."+Qn(Bb(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return gn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=dl(gn(e,t.replace(/[\\-]/g,""),r)),i=0,dl(dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(X4))return a=gn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=rh(l,Math.pow(10,i)-1,!1),a=""+c,f=ns("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=eh(o[2],i),f.length<s[4].length&&(f=Ar(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=rh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xy(o[1],i)+s[2]+"/"+s[3]+eh(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=jo(r,0),t.length<=a.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ar(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Bb(r,s[1].length),r<0?"-"+gn(e,t,-r):Hs(vne(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Qn(0,3-v.length):"")+v})+"."+Qn(i,s[1].length);switch(t){case"###,##0.00":return gn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Hs(jo(l,0));return m!=="0"?c+m:"";case"###,###.00":return gn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return gn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function gne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ns(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function xne(e,t,r){var n=t.replace(z4,""),a=t.length-n.length;return ns(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function J4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+J4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function va(e,t,r){if(e.charCodeAt(0)===40&&!t.match(q4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?va("n",n,r):"("+va("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return gne(e,t,r);if(t.indexOf("%")!==-1)return xne(e,t,r);if(t.indexOf("E")!==-1)return J4(t,r);if(t.charCodeAt(0)===36)return"$"+va(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Qn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(G4))return pne(s,l,c);if(t.match(/^#+0+$/))return c+Qn(l,t.length-t.indexOf("0"));if(s=t.match(K4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])),a=a.replace(/\.(\d*)$/,function(v,p){return"."+p+Tt("0",Ar(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Hs(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+va(e,t,-r):Hs(""+r)+"."+Tt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return va(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=dl(va(e,t.replace(/[\\-]/g,""),r)),i=0,dl(dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(X4))return a=va(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=rh(l,Math.pow(10,i)-1,!1),a=""+c,f=ns("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=eh(o[2],i),f.length<s[4].length&&(f=Ar(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=rh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xy(o[1],i)+s[2]+"/"+s[3]+eh(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ar(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+va(e,t,-r):Hs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Qn(0,3-v.length):"")+v})+"."+Qn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Hs(""+l);return m!=="0"?c+m:"";default:if(t.match(/\.[0#?]*$/))return va(e,t.slice(0,t.lastIndexOf(".")),r)+Ar(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ns(e,t,r){return(r|0)===r?va(e,t,r):gn(e,t,r)}function yne(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Q4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ac(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":th(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Q4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function _ne(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!th(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var m=e.charAt(++i),v=m==="("||m===")"?m:"t";a[a.length]={t:v,v:m},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Mi(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Mi(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(c==null&&(c=Mi(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(c!=null&&(p.v=c.H>=12?"下午":"上午"),p.t="T",i+=5,h="h"):(p.t="t",++i),c==null&&p.t==="T")return"";a[a.length]=p,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Q4)){if(c==null&&(c=Mi(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ac(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var _=0,g=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",_<1&&(_=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(g=Math.max(g,y[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[i].v.match(/[Hh]/)&&(_=1),_<2&&a[i].v.match(/[Mm]/)&&(_=2),_<3&&a[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",w;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=une(a[i].t.charCodeAt(0),a[i].v,c,g),a[i].t="t";break;case"n":case"?":for(w=i+1;a[w]!=null&&((o=a[w].t)==="?"||o==="D"||(o===" "||o==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[i].v+=a[w].v,a[w]={v:"",t:";"},++w;x+=a[i].v,i=w-1;break;case"G":a[i].t="t",a[i].v=ao(t,r);break}var E="",S,b;if(x.length>0){x.charCodeAt(0)==40?(S=t<0&&x.charCodeAt(0)===45?-t:t,b=ns("n",x,S)):(S=t<0&&n>1?-t:t,b=ns("n",x,S),S<0&&a[0]&&a[0].t=="t"&&(b=b.substr(1),a[0].v="-"+a[0].v)),w=b.length-1;var T=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){T=i;break}var C=a.length;if(T===a.length&&b.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(w>=a[i].v.length-1?(w-=a[i].v.length,a[i].v=b.substr(w+1,a[i].v.length)):w<0?a[i].v="":(a[i].v=b.substr(0,w+1),w=-1),a[i].t="t",C=i);w>=0&&C<a.length&&(a[C].v=b.substr(0,w+1)+a[C].v)}else if(T!==a.length&&b.indexOf("E")===-1){for(w=b.indexOf(".")-1,i=T;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")-1:a[i].v.length-1,E=a[i].v.substr(f+1);f>=0;--f)w>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(E=b.charAt(w--)+E);a[i].v=E,a[i].t="t",C=i}for(w>=0&&C<a.length&&(a[C].v=b.substr(0,w+1)+a[C].v),w=b.indexOf(".")+1,i=T;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==T)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")+1:0,E=a[i].v.substr(0,f);f<a[i].v.length;++f)w<b.length&&(E+=b.charAt(w++));a[i].v=E,a[i].t="t",C=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(S=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=ns(a[i].t,a[i].v,S),a[i].t="t");var F="";for(i=0;i!==a.length;++i)a[i]!=null&&(F+=a[i].v);return F}var Wb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function wne(e,t){var r=yne(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Wb),o=r[1].match(Wb);return Vb(t,i)?[n,r[0]]:Vb(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function Fn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:je)[e],n==null&&(n=r.table&&r.table[$b[e]]||je[$b[e]]),n==null&&(n=nne[e]||"General");break}if(th(n,0))return ao(t,r);t instanceof Date&&(t=H4(t,r.date1904));var a=wne(n,t);if(th(a[1]))return ao(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return _ne(a[1],t,r,a[0])}function Wi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(je[r]==null){t<0&&(t=r);continue}if(je[r]==e){t=r;break}}t<0&&(t=391)}return je[t]=e,t}function Z4(){je=rne()}var bne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},eA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Sne(e){var t=typeof e=="number"?je[e]:e;return t=t.replace(eA,"(\\d+)"),new RegExp("^"+t+"$")}function Ene(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(eA)||[]).forEach(function(d,h){var m=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":i=m;break;case"s":l=m;break;case"m":i>=0?o=m:a=m;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?f:c+"T"+f}var kne=function(){var e={};e.version="1.2.0";function t(){for(var b=0,T=new Array(256),C=0;C!=256;++C)b=C,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,T[C]=b;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(b){var T=0,C=0,F=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)M[F]=b[F];for(F=0;F!=256;++F)for(C=b[F],T=256+F;T<4096;T+=256)C=M[T]=C>>>8^b[C&255];var j=[];for(F=1;F!=16;++F)j[F-1]=typeof Int32Array<"u"?M.subarray(F*256,F*256+256):M.slice(F*256,F*256+256);return j}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],f=a[5],d=a[6],h=a[7],m=a[8],v=a[9],p=a[10],_=a[11],g=a[12],y=a[13],x=a[14];function w(b,T){for(var C=T^-1,F=0,M=b.length;F<M;)C=C>>>8^r[(C^b.charCodeAt(F++))&255];return~C}function E(b,T){for(var C=T^-1,F=b.length-15,M=0;M<F;)C=x[b[M++]^C&255]^y[b[M++]^C>>8&255]^g[b[M++]^C>>16&255]^_[b[M++]^C>>>24]^p[b[M++]]^v[b[M++]]^m[b[M++]]^h[b[M++]]^d[b[M++]]^f[b[M++]]^c[b[M++]]^l[b[M++]]^o[b[M++]]^i[b[M++]]^s[b[M++]]^r[b[M++]];for(F+=15;M<F;)C=C>>>8^r[(C^b[M++])&255];return~C}function S(b,T){for(var C=T^-1,F=0,M=b.length,j=0,A=0;F<M;)j=b.charCodeAt(F++),j<128?C=C>>>8^r[(C^j)&255]:j<2048?(C=C>>>8^r[(C^(192|j>>6&31))&255],C=C>>>8^r[(C^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,A=b.charCodeAt(F++)&1023,C=C>>>8^r[(C^(240|j>>8&7))&255],C=C>>>8^r[(C^(128|j>>2&63))&255],C=C>>>8^r[(C^(128|A>>6&15|(j&3)<<4))&255],C=C>>>8^r[(C^(128|A&63))&255]):(C=C>>>8^r[(C^(224|j>>12&15))&255],C=C>>>8^r[(C^(128|j>>6&63))&255],C=C>>>8^r[(C^(128|j&63))&255]);return~C}return e.table=r,e.bstr=w,e.buf=E,e.str=S,e}(),Ue=function(){var t={};t.version="1.2.1";function r(O,U){for(var R=O.split("/"),L=U.split("/"),B=0,V=0,te=Math.min(R.length,L.length);B<te;++B){if(V=R[B].length-L[B].length)return V;if(R[B]!=L[B])return R[B]<L[B]?-1:1}return R.length-L.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var U=O.lastIndexOf("/");return U===-1?O:O.slice(0,U+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var U=O.lastIndexOf("/");return U===-1?O:O.slice(U+1)}function s(O,U){typeof U=="string"&&(U=new Date(U));var R=U.getHours();R=R<<6|U.getMinutes(),R=R<<5|U.getSeconds()>>>1,O.write_shift(2,R);var L=U.getFullYear()-1980;L=L<<4|U.getMonth()+1,L=L<<5|U.getDate(),O.write_shift(2,L)}function i(O){var U=O.read_shift(2)&65535,R=O.read_shift(2)&65535,L=new Date,B=R&31;R>>>=5;var V=R&15;R>>>=4,L.setMilliseconds(0),L.setFullYear(R+1980),L.setMonth(V-1),L.setDate(B);var te=U&31;U>>>=5;var le=U&63;return U>>>=6,L.setHours(U),L.setMinutes(le),L.setSeconds(te<<1),L}function o(O){rr(O,0);for(var U={},R=0;O.l<=O.length-4;){var L=O.read_shift(2),B=O.read_shift(2),V=O.l+B,te={};switch(L){case 21589:R=O.read_shift(1),R&1&&(te.mtime=O.read_shift(4)),B>5&&(R&2&&(te.atime=O.read_shift(4)),R&4&&(te.ctime=O.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}O.l=V,U[L]=te}return U}var l;function c(){return l||(l={})}function f(O,U){if(O[0]==80&&O[1]==75)return e_(O,U);if((O[0]|32)==109&&(O[1]|32)==105)return xD(O,U);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var R=3,L=512,B=0,V=0,te=0,le=0,ee=0,re=[],ae=O.slice(0,512);rr(ae,0);var fe=d(ae);switch(R=fe[0],R){case 3:L=512;break;case 4:L=4096;break;case 0:if(fe[1]==0)return e_(O,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}L!==512&&(ae=O.slice(0,L),rr(ae,28));var ve=O.slice(0,L);h(ae,R);var _e=ae.read_shift(4,"i");if(R===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);ae.l+=4,te=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),le=ae.read_shift(4,"i"),B=ae.read_shift(4,"i"),ee=ae.read_shift(4,"i"),V=ae.read_shift(4,"i");for(var pe=-1,ye=0;ye<109&&(pe=ae.read_shift(4,"i"),!(pe<0));++ye)re[ye]=pe;var De=m(O,L);_(ee,V,De,L,re);var xt=y(De,te,re,L);xt[te].name="!Directory",B>0&&le!==A&&(xt[le].name="!MiniFAT"),xt[re[0]].name="!FAT",xt.fat_addrs=re,xt.ssz=L;var yt={},ur=[],uc=[],fc=[];x(te,xt,De,ur,B,yt,uc,le),v(uc,fc,ur),ur.shift();var dc={FileIndex:uc,FullPaths:fc};return U&&U.raw&&(dc.raw={header:ve,sectors:De}),dc}function d(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(G,"Header Signature: "),O.l+=16;var U=O.read_shift(2,"u");return[O.read_shift(2,"u"),U]}function h(O,U){var R=9;switch(O.l+=2,R=O.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function m(O,U){for(var R=Math.ceil(O.length/U)-1,L=[],B=1;B<R;++B)L[B-1]=O.slice(B*U,(B+1)*U);return L[R-1]=O.slice(R*U),L}function v(O,U,R){for(var L=0,B=0,V=0,te=0,le=0,ee=R.length,re=[],ae=[];L<ee;++L)re[L]=ae[L]=L,U[L]=R[L];for(;le<ae.length;++le)L=ae[le],B=O[L].L,V=O[L].R,te=O[L].C,re[L]===L&&(B!==-1&&re[B]!==B&&(re[L]=re[B]),V!==-1&&re[V]!==V&&(re[L]=re[V])),te!==-1&&(re[te]=L),B!==-1&&L!=re[L]&&(re[B]=re[L],ae.lastIndexOf(B)<le&&ae.push(B)),V!==-1&&L!=re[L]&&(re[V]=re[L],ae.lastIndexOf(V)<le&&ae.push(V));for(L=1;L<ee;++L)re[L]===L&&(V!==-1&&re[V]!==V?re[L]=re[V]:B!==-1&&re[B]!==B&&(re[L]=re[B]));for(L=1;L<ee;++L)if(O[L].type!==0){if(le=L,le!=re[le])do le=re[le],U[L]=U[le]+"/"+U[L];while(le!==0&&re[le]!==-1&&le!=re[le]);re[L]=-1}for(U[0]+="/",L=1;L<ee;++L)O[L].type!==2&&(U[L]+="/")}function p(O,U,R){for(var L=O.start,B=O.size,V=[],te=L;R&&B>0&&te>=0;)V.push(U.slice(te*j,te*j+j)),B-=j,te=Di(R,te*4);return V.length===0?Ut(0):Is(V).slice(0,O.size)}function _(O,U,R,L,B){var V=A;if(O===A){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var te=R[O],le=(L>>>2)-1;if(!te)return;for(var ee=0;ee<le&&(V=Di(te,ee*4))!==A;++ee)B.push(V);_(Di(te,L-4),U-1,R,L,B)}}function g(O,U,R,L,B){var V=[],te=[];B||(B=[]);var le=L-1,ee=0,re=0;for(ee=U;ee>=0;){B[ee]=!0,V[V.length]=ee,te.push(O[ee]);var ae=R[Math.floor(ee*4/L)];if(re=ee*4&le,L<4+re)throw new Error("FAT boundary crossed: "+ee+" 4 "+L);if(!O[ae])break;ee=Di(O[ae],re)}return{nodes:V,data:Zb([te])}}function y(O,U,R,L){var B=O.length,V=[],te=[],le=[],ee=[],re=L-1,ae=0,fe=0,ve=0,_e=0;for(ae=0;ae<B;++ae)if(le=[],ve=ae+U,ve>=B&&(ve-=B),!te[ve]){ee=[];var pe=[];for(fe=ve;fe>=0;){pe[fe]=!0,te[fe]=!0,le[le.length]=fe,ee.push(O[fe]);var ye=R[Math.floor(fe*4/L)];if(_e=fe*4&re,L<4+_e)throw new Error("FAT boundary crossed: "+fe+" 4 "+L);if(!O[ye]||(fe=Di(O[ye],_e),pe[fe]))break}V[ve]={nodes:le,data:Zb([ee])}}return V}function x(O,U,R,L,B,V,te,le){for(var ee=0,re=L.length?2:0,ae=U[O].data,fe=0,ve=0,_e;fe<ae.length;fe+=128){var pe=ae.slice(fe,fe+128);rr(pe,64),ve=pe.read_shift(2),_e=Ey(pe,0,ve-re),L.push(_e);var ye={name:_e,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},De=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);De!==0&&(ye.ct=w(pe,pe.l-8));var xt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);xt!==0&&(ye.mt=w(pe,pe.l-8)),ye.start=pe.read_shift(4,"i"),ye.size=pe.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=A,ye.name=""),ye.type===5?(ee=ye.start,B>0&&ee!==A&&(U[ee].name="!StreamData")):ye.size>=4096?(ye.storage="fat",U[ye.start]===void 0&&(U[ye.start]=g(R,ye.start,U.fat_addrs,U.ssz)),U[ye.start].name=ye.name,ye.content=U[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:ee!==A&&ye.start!==A&&U[ee]&&(ye.content=p(ye,U[ee].data,(U[le]||{}).data))),ye.content&&rr(ye.content,0),V[_e]=ye,te.push(ye)}}function w(O,U){return new Date((en(O,U+4)/1e7*Math.pow(2,32)+en(O,U)/1e7-11644473600)*1e3)}function E(O,U){return c(),f(l.readFileSync(O),U)}function S(O,U){var R=U&&U.type;switch(R||$e&&Buffer.isBuffer(O)&&(R="buffer"),R||"base64"){case"file":return E(O,U);case"base64":return f(qn(cn(O)),U);case"binary":return f(qn(O),U)}return f(O,U)}function b(O,U){var R=U||{},L=R.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=L+"/",O.FileIndex[0]={name:L,type:5}),R.CLSID&&(O.FileIndex[0].clsid=R.CLSID),T(O)}function T(O){var U="Sh33tJ5";if(!Ue.find(O,"/"+U)){var R=Ut(4);R[0]=55,R[1]=R[3]=50,R[2]=54,O.FileIndex.push({name:U,type:2,content:R,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+U),C(O)}}function C(O,U){b(O);for(var R=!1,L=!1,B=O.FullPaths.length-1;B>=0;--B){var V=O.FileIndex[B];switch(V.type){case 0:L?R=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(V.R*V.L*V.C)&&(R=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!U)){var te=new Date(1987,1,19),le=0,ee=Object.create?Object.create(null):{},re=[];for(B=0;B<O.FullPaths.length;++B)ee[O.FullPaths[B]]=!0,O.FileIndex[B].type!==0&&re.push([O.FullPaths[B],O.FileIndex[B]]);for(B=0;B<re.length;++B){var ae=n(re[B][0]);L=ee[ae],L||(re.push([ae,{name:a(ae).replace("/",""),type:1,clsid:H,ct:te,mt:te,content:null}]),ee[ae]=!0)}for(re.sort(function(_e,pe){return r(_e[0],pe[0])}),O.FullPaths=[],O.FileIndex=[],B=0;B<re.length;++B)O.FullPaths[B]=re[B][0],O.FileIndex[B]=re[B][1];for(B=0;B<re.length;++B){var fe=O.FileIndex[B],ve=O.FullPaths[B];if(fe.name=a(ve).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||H,B===0)fe.C=re.length>1?1:-1,fe.size=0,fe.type=5;else if(ve.slice(-1)=="/"){for(le=B+1;le<re.length&&n(O.FullPaths[le])!=ve;++le);for(fe.C=le>=re.length?-1:le,le=B+1;le<re.length&&n(O.FullPaths[le])!=n(ve);++le);fe.R=le>=re.length?-1:le,fe.type=1}else n(O.FullPaths[B+1]||"")==n(ve)&&(fe.R=B+1),fe.type=2}}}function F(O,U){var R=U||{};if(R.fileType=="mad")return yD(O,R);switch(C(O),R.fileType){case"zip":return dD(O,R)}var L=function(_e){for(var pe=0,ye=0,De=0;De<_e.FileIndex.length;++De){var xt=_e.FileIndex[De];if(xt.content){var yt=xt.content.length;yt>0&&(yt<4096?pe+=yt+63>>6:ye+=yt+511>>9)}}for(var ur=_e.FullPaths.length+3>>2,uc=pe+7>>3,fc=pe+127>>7,dc=uc+ye+ur+fc,bi=dc+127>>7,Up=bi<=109?0:Math.ceil((bi-109)/127);dc+bi+Up+127>>7>bi;)Up=++bi<=109?0:Math.ceil((bi-109)/127);var $a=[1,Up,bi,fc,ur,ye,pe,0];return _e.FileIndex[0].size=pe<<6,$a[7]=(_e.FileIndex[0].start=$a[0]+$a[1]+$a[2]+$a[3]+$a[4]+$a[5])+($a[6]+7>>3),$a}(O),B=Ut(L[7]<<9),V=0,te=0;{for(V=0;V<8;++V)B.write_shift(1,X[V]);for(V=0;V<8;++V)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),V=0;V<3;++V)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,L[2]),B.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:A),B.write_shift(4,L[3]),B.write_shift(-4,L[1]?L[0]-1:A),B.write_shift(4,L[1]),V=0;V<109;++V)B.write_shift(-4,V<L[2]?L[1]+V:-1)}if(L[1])for(te=0;te<L[1];++te){for(;V<236+te*127;++V)B.write_shift(-4,V<L[2]?L[1]+V:-1);B.write_shift(-4,te===L[1]-1?A:te+1)}var le=function(_e){for(te+=_e;V<te-1;++V)B.write_shift(-4,V+1);_e&&(++V,B.write_shift(-4,A))};for(te=V=0,te+=L[1];V<te;++V)B.write_shift(-4,q.DIFSECT);for(te+=L[2];V<te;++V)B.write_shift(-4,q.FATSECT);le(L[3]),le(L[4]);for(var ee=0,re=0,ae=O.FileIndex[0];ee<O.FileIndex.length;++ee)ae=O.FileIndex[ee],ae.content&&(re=ae.content.length,!(re<4096)&&(ae.start=te,le(re+511>>9)));for(le(L[6]+7>>3);B.l&511;)B.write_shift(-4,q.ENDOFCHAIN);for(te=V=0,ee=0;ee<O.FileIndex.length;++ee)ae=O.FileIndex[ee],ae.content&&(re=ae.content.length,!(!re||re>=4096)&&(ae.start=te,le(re+63>>6)));for(;B.l&511;)B.write_shift(-4,q.ENDOFCHAIN);for(V=0;V<L[4]<<2;++V){var fe=O.FullPaths[V];if(!fe||fe.length===0){for(ee=0;ee<17;++ee)B.write_shift(4,0);for(ee=0;ee<3;++ee)B.write_shift(4,-1);for(ee=0;ee<12;++ee)B.write_shift(4,0);continue}ae=O.FileIndex[V],V===0&&(ae.start=ae.size?ae.start-1:A);var ve=V===0&&R.root||ae.name;if(re=2*(ve.length+1),B.write_shift(64,ve,"utf16le"),B.write_shift(2,re),B.write_shift(1,ae.type),B.write_shift(1,ae.color),B.write_shift(-4,ae.L),B.write_shift(-4,ae.R),B.write_shift(-4,ae.C),ae.clsid)B.write_shift(16,ae.clsid,"hex");else for(ee=0;ee<4;++ee)B.write_shift(4,0);B.write_shift(4,ae.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,ae.start),B.write_shift(4,ae.size),B.write_shift(4,0)}for(V=1;V<O.FileIndex.length;++V)if(ae=O.FileIndex[V],ae.size>=4096)if(B.l=ae.start+1<<9,$e&&Buffer.isBuffer(ae.content))ae.content.copy(B,B.l,0,ae.size),B.l+=ae.size+511&-512;else{for(ee=0;ee<ae.size;++ee)B.write_shift(1,ae.content[ee]);for(;ee&511;++ee)B.write_shift(1,0)}for(V=1;V<O.FileIndex.length;++V)if(ae=O.FileIndex[V],ae.size>0&&ae.size<4096)if($e&&Buffer.isBuffer(ae.content))ae.content.copy(B,B.l,0,ae.size),B.l+=ae.size+63&-64;else{for(ee=0;ee<ae.size;++ee)B.write_shift(1,ae.content[ee]);for(;ee&63;++ee)B.write_shift(1,0)}if($e)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function M(O,U){var R=O.FullPaths.map(function(ee){return ee.toUpperCase()}),L=R.map(function(ee){var re=ee.split("/");return re[re.length-(ee.slice(-1)=="/"?2:1)]}),B=!1;U.charCodeAt(0)===47?(B=!0,U=R[0].slice(0,-1)+U):B=U.indexOf("/")!==-1;var V=U.toUpperCase(),te=B===!0?R.indexOf(V):L.indexOf(V);if(te!==-1)return O.FileIndex[te];var le=!V.match(Lc);for(V=V.replace(Pr,""),le&&(V=V.replace(Lc,"!")),te=0;te<R.length;++te)if((le?R[te].replace(Lc,"!"):R[te]).replace(Pr,"")==V||(le?L[te].replace(Lc,"!"):L[te]).replace(Pr,"")==V)return O.FileIndex[te];return null}var j=64,A=-2,G="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],H="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:A,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:H,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(O,U,R){c();var L=F(O,R);l.writeFileSync(U,L)}function Y(O){for(var U=new Array(O.length),R=0;R<O.length;++R)U[R]=String.fromCharCode(O[R]);return U.join("")}function ce(O,U){var R=F(O,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,R),R;case"binary":return typeof R=="string"?R:Y(R);case"base64":return Rb(typeof R=="string"?R:Y(R));case"buffer":if($e)return Buffer.isBuffer(R)?R:go(R);case"array":return typeof R=="string"?qn(R):R}return R}var z;function k(O){try{var U=O.InflateRaw,R=new U;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)z=O;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function I(O,U){if(!z)return Qy(O,U);var R=z.InflateRaw,L=new R,B=L._processChunk(O.slice(O.l),L._finishFlushFlag);return O.l+=L.bytesRead,B}function N(O){return z?z.deflateRawSync(O):Re(O)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(O){var U=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(U>>16|U>>8|U)&255}for(var ie=typeof Uint8Array<"u",oe=ie?new Uint8Array(256):[],Se=0;Se<256;++Se)oe[Se]=J(Se);function W(O,U){var R=oe[O&255];return U<=8?R>>>8-U:(R=R<<8|oe[O>>8&255],U<=16?R>>>16-U:(R=R<<8|oe[O>>16&255],R>>>24-U))}function Ne(O,U){var R=U&7,L=U>>>3;return(O[L]|(R<=6?0:O[L+1]<<8))>>>R&3}function ke(O,U){var R=U&7,L=U>>>3;return(O[L]|(R<=5?0:O[L+1]<<8))>>>R&7}function Xe(O,U){var R=U&7,L=U>>>3;return(O[L]|(R<=4?0:O[L+1]<<8))>>>R&15}function Oe(O,U){var R=U&7,L=U>>>3;return(O[L]|(R<=3?0:O[L+1]<<8))>>>R&31}function me(O,U){var R=U&7,L=U>>>3;return(O[L]|(R<=1?0:O[L+1]<<8))>>>R&127}function tt(O,U,R){var L=U&7,B=U>>>3,V=(1<<R)-1,te=O[B]>>>L;return R<8-L||(te|=O[B+1]<<8-L,R<16-L)||(te|=O[B+2]<<16-L,R<24-L)||(te|=O[B+3]<<24-L),te&V}function cr(O,U,R){var L=U&7,B=U>>>3;return L<=5?O[B]|=(R&7)<<L:(O[B]|=R<<L&255,O[B+1]=(R&7)>>8-L),U+3}function gt(O,U,R){var L=U&7,B=U>>>3;return R=(R&1)<<L,O[B]|=R,U+1}function Ir(O,U,R){var L=U&7,B=U>>>3;return R<<=L,O[B]|=R&255,R>>>=8,O[B+1]=R,U+8}function Ss(O,U,R){var L=U&7,B=U>>>3;return R<<=L,O[B]|=R&255,R>>>=8,O[B+1]=R&255,O[B+2]=R>>>8,U+16}function Un(O,U){var R=O.length,L=2*R>U?2*R:U+5,B=0;if(R>=U)return O;if($e){var V=Mb(L);if(O.copy)O.copy(V);else for(;B<O.length;++B)V[B]=O[B];return V}else if(ie){var te=new Uint8Array(L);if(te.set)te.set(O);else for(;B<R;++B)te[B]=O[B];return te}return O.length=L,O}function er(O){for(var U=new Array(O),R=0;R<O;++R)U[R]=0;return U}function pn(O,U,R){var L=1,B=0,V=0,te=0,le=0,ee=O.length,re=ie?new Uint16Array(32):er(32);for(V=0;V<32;++V)re[V]=0;for(V=ee;V<R;++V)O[V]=0;ee=O.length;var ae=ie?new Uint16Array(ee):er(ee);for(V=0;V<ee;++V)re[B=O[V]]++,L<B&&(L=B),ae[V]=0;for(re[0]=0,V=1;V<=L;++V)re[V+16]=le=le+re[V-1]<<1;for(V=0;V<ee;++V)le=O[V],le!=0&&(ae[V]=re[le+16]++);var fe=0;for(V=0;V<ee;++V)if(fe=O[V],fe!=0)for(le=W(ae[V],L)>>L-fe,te=(1<<L+4-fe)-1;te>=0;--te)U[le|te<<fe]=fe&15|V<<4;return L}var Bn=ie?new Uint16Array(512):er(512),Es=ie?new Uint16Array(32):er(32);if(!ie){for(var Kt=0;Kt<512;++Kt)Bn[Kt]=0;for(Kt=0;Kt<32;++Kt)Es[Kt]=0}(function(){for(var O=[],U=0;U<32;U++)O.push(5);pn(O,Es,32);var R=[];for(U=0;U<=143;U++)R.push(8);for(;U<=255;U++)R.push(9);for(;U<=279;U++)R.push(7);for(;U<=287;U++)R.push(8);pn(R,Bn,288)})();var da=function(){for(var U=ie?new Uint8Array(32768):[],R=0,L=0;R<ne.length-1;++R)for(;L<ne[R+1];++L)U[L]=R;for(;L<32768;++L)U[L]=29;var B=ie?new Uint8Array(259):[];for(R=0,L=0;R<K.length-1;++R)for(;L<K[R+1];++L)B[L]=R;function V(le,ee){for(var re=0;re<le.length;){var ae=Math.min(65535,le.length-re),fe=re+ae==le.length;for(ee.write_shift(1,+fe),ee.write_shift(2,ae),ee.write_shift(2,~ae&65535);ae-- >0;)ee[ee.l++]=le[re++]}return ee.l}function te(le,ee){for(var re=0,ae=0,fe=ie?new Uint16Array(32768):[];ae<le.length;){var ve=Math.min(65535,le.length-ae);if(ve<10){for(re=cr(ee,re,+(ae+ve==le.length)),re&7&&(re+=8-(re&7)),ee.l=re/8|0,ee.write_shift(2,ve),ee.write_shift(2,~ve&65535);ve-- >0;)ee[ee.l++]=le[ae++];re=ee.l*8;continue}re=cr(ee,re,+(ae+ve==le.length)+2);for(var _e=0;ve-- >0;){var pe=le[ae];_e=(_e<<5^pe)&32767;var ye=-1,De=0;if((ye=fe[_e])&&(ye|=ae&-32768,ye>ae&&(ye-=32768),ye<ae))for(;le[ye+De]==le[ae+De]&&De<250;)++De;if(De>2){pe=B[De],pe<=22?re=Ir(ee,re,oe[pe+1]>>1)-1:(Ir(ee,re,3),re+=5,Ir(ee,re,oe[pe-23]>>5),re+=3);var xt=pe<8?0:pe-4>>2;xt>0&&(Ss(ee,re,De-K[pe]),re+=xt),pe=U[ae-ye],re=Ir(ee,re,oe[pe]>>3),re-=3;var yt=pe<4?0:pe-2>>1;yt>0&&(Ss(ee,re,ae-ye-ne[pe]),re+=yt);for(var ur=0;ur<De;++ur)fe[_e]=ae&32767,_e=(_e<<5^le[ae])&32767,++ae;ve-=De-1}else pe<=143?pe=pe+48:re=gt(ee,re,1),re=Ir(ee,re,oe[pe]),fe[_e]=ae&32767,++ae}re=Ir(ee,re,0)-1}return ee.l=(re+7)/8|0,ee.l}return function(ee,re){return ee.length<8?V(ee,re):te(ee,re)}}();function Re(O){var U=Ut(50+Math.floor(O.length*1.1)),R=da(O,U);return U.slice(0,R)}var At=ie?new Uint16Array(32768):er(32768),mn=ie?new Uint16Array(32768):er(32768),$t=ie?new Uint16Array(128):er(128),wi=1,Jy=1;function cD(O,U){var R=Oe(O,U)+257;U+=5;var L=Oe(O,U)+1;U+=5;var B=Xe(O,U)+4;U+=4;for(var V=0,te=ie?new Uint8Array(19):er(19),le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,re=ie?new Uint8Array(8):er(8),ae=ie?new Uint8Array(8):er(8),fe=te.length,ve=0;ve<B;++ve)te[P[ve]]=V=ke(O,U),ee<V&&(ee=V),re[V]++,U+=3;var _e=0;for(re[0]=0,ve=1;ve<=ee;++ve)ae[ve]=_e=_e+re[ve-1]<<1;for(ve=0;ve<fe;++ve)(_e=te[ve])!=0&&(le[ve]=ae[_e]++);var pe=0;for(ve=0;ve<fe;++ve)if(pe=te[ve],pe!=0){_e=oe[le[ve]]>>8-pe;for(var ye=(1<<7-pe)-1;ye>=0;--ye)$t[_e|ye<<pe]=pe&7|ve<<3}var De=[];for(ee=1;De.length<R+L;)switch(_e=$t[me(O,U)],U+=_e&7,_e>>>=3){case 16:for(V=3+Ne(O,U),U+=2,_e=De[De.length-1];V-- >0;)De.push(_e);break;case 17:for(V=3+ke(O,U),U+=3;V-- >0;)De.push(0);break;case 18:for(V=11+me(O,U),U+=7;V-- >0;)De.push(0);break;default:De.push(_e),ee<_e&&(ee=_e);break}var xt=De.slice(0,R),yt=De.slice(R);for(ve=R;ve<286;++ve)xt[ve]=0;for(ve=L;ve<30;++ve)yt[ve]=0;return wi=pn(xt,At,286),Jy=pn(yt,mn,30),U}function uD(O,U){if(O[0]==3&&!(O[1]&3))return[li(U),2];for(var R=0,L=0,B=Mb(U||1<<18),V=0,te=B.length>>>0,le=0,ee=0;!(L&1);){if(L=ke(O,R),R+=3,L>>>1)L>>1==1?(le=9,ee=5):(R=cD(O,R),le=wi,ee=Jy);else{R&7&&(R+=8-(R&7));var re=O[R>>>3]|O[(R>>>3)+1]<<8;if(R+=32,re>0)for(!U&&te<V+re&&(B=Un(B,V+re),te=B.length);re-- >0;)B[V++]=O[R>>>3],R+=8;continue}for(;;){!U&&te<V+32767&&(B=Un(B,V+32767),te=B.length);var ae=tt(O,R,le),fe=L>>>1==1?Bn[ae]:At[ae];if(R+=fe&15,fe>>>=4,!(fe>>>8&255))B[V++]=fe;else{if(fe==256)break;fe-=257;var ve=fe<8?0:fe-4>>2;ve>5&&(ve=0);var _e=V+K[fe];ve>0&&(_e+=tt(O,R,ve),R+=ve),ae=tt(O,R,ee),fe=L>>>1==1?Es[ae]:mn[ae],R+=fe&15,fe>>>=4;var pe=fe<4?0:fe-2>>1,ye=ne[fe];for(pe>0&&(ye+=tt(O,R,pe),R+=pe),!U&&te<_e&&(B=Un(B,_e+100),te=B.length);V<_e;)B[V]=B[V-ye],++V}}}return U?[B,R+7>>>3]:[B.slice(0,V),R+7>>>3]}function Qy(O,U){var R=O.slice(O.l||0),L=uD(R,U);return O.l+=L[1],L[0]}function Zy(O,U){if(O)typeof console<"u"&&console.error(U);else throw new Error(U)}function e_(O,U){var R=O;rr(R,0);var L=[],B=[],V={FileIndex:L,FullPaths:B};b(V,{root:U.root});for(var te=R.length-4;(R[te]!=80||R[te+1]!=75||R[te+2]!=5||R[te+3]!=6)&&te>=0;)--te;R.l=te+4,R.l+=4;var le=R.read_shift(2);R.l+=6;var ee=R.read_shift(4);for(R.l=ee,te=0;te<le;++te){R.l+=20;var re=R.read_shift(4),ae=R.read_shift(4),fe=R.read_shift(2),ve=R.read_shift(2),_e=R.read_shift(2);R.l+=8;var pe=R.read_shift(4),ye=o(R.slice(R.l+fe,R.l+fe+ve));R.l+=fe+ve+_e;var De=R.l;R.l=pe+4,fD(R,re,ae,V,ye),R.l=De}return V}function fD(O,U,R,L,B){O.l+=2;var V=O.read_shift(2),te=O.read_shift(2),le=i(O);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var ee=O.read_shift(4),re=O.read_shift(4),ae=O.read_shift(4),fe=O.read_shift(2),ve=O.read_shift(2),_e="",pe=0;pe<fe;++pe)_e+=String.fromCharCode(O[O.l++]);if(ve){var ye=o(O.slice(O.l,O.l+ve));(ye[21589]||{}).mt&&(le=ye[21589].mt),((B||{})[21589]||{}).mt&&(le=B[21589].mt)}O.l+=ve;var De=O.slice(O.l,O.l+re);switch(te){case 8:De=I(O,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var xt=!1;V&8&&(ee=O.read_shift(4),ee==134695760&&(ee=O.read_shift(4),xt=!0),re=O.read_shift(4),ae=O.read_shift(4)),re!=U&&Zy(xt,"Bad compressed size: "+U+" != "+re),ae!=R&&Zy(xt,"Bad uncompressed size: "+R+" != "+ae),$p(L,_e,De,{unsafe:!0,mt:le})}function dD(O,U){var R=U||{},L=[],B=[],V=Ut(1),te=R.compression?8:0,le=0,ee=0,re=0,ae=0,fe=0,ve=O.FullPaths[0],_e=ve,pe=O.FileIndex[0],ye=[],De=0;for(ee=1;ee<O.FullPaths.length;++ee)if(_e=O.FullPaths[ee].slice(ve.length),pe=O.FileIndex[ee],!(!pe.size||!pe.content||_e=="Sh33tJ5")){var xt=ae,yt=Ut(_e.length);for(re=0;re<_e.length;++re)yt.write_shift(1,_e.charCodeAt(re)&127);yt=yt.slice(0,yt.l),ye[fe]=kne.buf(pe.content,0);var ur=pe.content;te==8&&(ur=N(ur)),V=Ut(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,le),V.write_shift(2,te),pe.mt?s(V,pe.mt):V.write_shift(4,0),V.write_shift(-4,ye[fe]),V.write_shift(4,ur.length),V.write_shift(4,pe.content.length),V.write_shift(2,yt.length),V.write_shift(2,0),ae+=V.length,L.push(V),ae+=yt.length,L.push(yt),ae+=ur.length,L.push(ur),V=Ut(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,le),V.write_shift(2,te),V.write_shift(4,0),V.write_shift(-4,ye[fe]),V.write_shift(4,ur.length),V.write_shift(4,pe.content.length),V.write_shift(2,yt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,xt),De+=V.l,B.push(V),De+=yt.length,B.push(yt),++fe}return V=Ut(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,fe),V.write_shift(2,fe),V.write_shift(4,De),V.write_shift(4,ae),V.write_shift(2,0),Is([Is(L),Is(B),V])}var Gf={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function hD(O,U){if(O.ctype)return O.ctype;var R=O.name||"",L=R.match(/\.([^\.]+)$/);return L&&Gf[L[1]]||U&&(L=(R=U).match(/[\.\\]([^\.\\])+$/),L&&Gf[L[1]])?Gf[L[1]]:"application/octet-stream"}function pD(O){for(var U=Rb(O),R=[],L=0;L<U.length;L+=76)R.push(U.slice(L,L+76));return R.join(`\r
`)+`\r
`}function mD(O){var U=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ae=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],L=U.split(`\r
`),B=0;B<L.length;++B){var V=L[B];if(V.length==0){R.push("");continue}for(var te=0;te<V.length;){var le=76,ee=V.slice(te,te+le);ee.charAt(le-1)=="="?le--:ee.charAt(le-2)=="="?le-=2:ee.charAt(le-3)=="="&&(le-=3),ee=V.slice(te,te+le),te+=le,te<V.length&&(ee+="="),R.push(ee)}}return R.join(`\r
`)}function vD(O){for(var U=[],R=0;R<O.length;++R){for(var L=O[R];R<=O.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+O[++R];U.push(L)}for(var B=0;B<U.length;++B)U[B]=U[B].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return qn(U.join(`\r
`))}function gD(O,U,R){for(var L="",B="",V="",te,le=0;le<10;++le){var ee=U[le];if(!ee||ee.match(/^\s*$/))break;var re=ee.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":L=re[2].trim();break;case"content-type":V=re[2].trim();break;case"content-transfer-encoding":B=re[2].trim();break}}switch(++le,B.toLowerCase()){case"base64":te=qn(cn(U.slice(le).join("")));break;case"quoted-printable":te=vD(U.slice(le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var ae=$p(O,L.slice(R.length),te,{unsafe:!0});V&&(ae.ctype=V)}function xD(O,U){if(Y(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=U&&U.root||"",L=($e&&Buffer.isBuffer(O)?O.toString("binary"):Y(O)).split(`\r
`),B=0,V="";for(B=0;B<L.length;++B)if(V=L[B],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),R||(R=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),V.slice(0,R.length)!=R););var te=(L[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var le="--"+(te[1]||""),ee=[],re=[],ae={FileIndex:ee,FullPaths:re};b(ae);var fe,ve=0;for(B=0;B<L.length;++B){var _e=L[B];_e!==le&&_e!==le+"--"||(ve++&&gD(ae,L.slice(fe,B),R),fe=B)}return ae}function yD(O,U){var R=U||{},L=R.boundary||"SheetJS";L="------="+L;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],V=O.FullPaths[0],te=V,le=O.FileIndex[0],ee=1;ee<O.FullPaths.length;++ee)if(te=O.FullPaths[ee].slice(V.length),le=O.FileIndex[ee],!(!le.size||!le.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var re=le.content,ae=$e&&Buffer.isBuffer(re)?re.toString("binary"):Y(re),fe=0,ve=Math.min(1024,ae.length),_e=0,pe=0;pe<=ve;++pe)(_e=ae.charCodeAt(pe))>=32&&_e<128&&++fe;var ye=fe>=ve*4/5;B.push(L),B.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+te),B.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),B.push("Content-Type: "+hD(le,te)),B.push(""),B.push(ye?mD(ae):pD(ae))}return B.push(L+`--\r
`),B.join(`\r
`)}function _D(O){var U={};return b(U,O),U}function $p(O,U,R,L){var B=L&&L.unsafe;B||b(O);var V=!B&&Ue.find(O,U);if(!V){var te=O.FullPaths[0];U.slice(0,te.length)==te?te=U:(te.slice(-1)!="/"&&(te+="/"),te=(te+U).replace("//","/")),V={name:a(U),type:2},O.FileIndex.push(V),O.FullPaths.push(te),B||Ue.utils.cfb_gc(O)}return V.content=R,V.size=R?R.length:0,L&&(L.CLSID&&(V.clsid=L.CLSID),L.mt&&(V.mt=L.mt),L.ct&&(V.ct=L.ct)),V}function wD(O,U){b(O);var R=Ue.find(O,U);if(R){for(var L=0;L<O.FileIndex.length;++L)if(O.FileIndex[L]==R)return O.FileIndex.splice(L,1),O.FullPaths.splice(L,1),!0}return!1}function bD(O,U,R){b(O);var L=Ue.find(O,U);if(L){for(var B=0;B<O.FileIndex.length;++B)if(O.FileIndex[B]==L)return O.FileIndex[B].name=a(R),O.FullPaths[B]=R,!0}return!1}function SD(O){C(O,!0)}return t.find=M,t.read=S,t.parse=f,t.write=ce,t.writeFile=Z,t.utils={cfb_new:_D,cfb_add:$p,cfb_del:wD,cfb_mov:bD,cfb_gc:SD,ReadShift:au,CheckField:bA,prep_blob:rr,bconcat:Is,use_zlib:k,_deflateRaw:Re,_inflateRaw:Qy,consts:q},t}();function Tne(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ja(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function _y(e){for(var t=[],r=ja(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var nh=new Date(1899,11,30,0,0,0);function Fr(e,t){var r=e.getTime(),n=nh.getTime()+(e.getTimezoneOffset()-nh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var tA=new Date,Cne=nh.getTime()+(tA.getTimezoneOffset()-nh.getTimezoneOffset())*6e4,Hb=tA.getTimezoneOffset();function Ep(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Cne),t.getTimezoneOffset()!==Hb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Hb)*6e4),t}function Nne(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var zb=new Date("2017-02-19T19:06:09.000Z"),rA=isNaN(zb.getFullYear())?new Date("2/19/17"):zb,Ane=rA.getFullYear()==2017;function Zt(e,t){var r=new Date(e);if(Ane)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(rA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function so(e,t){if($e&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Uc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Uc(W4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Uc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Uc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sr(e[r]));return t}function Tt(e,t){for(var r="";r.length<t;)r+=e;return r}function ta(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var One=["january","february","march","april","may","june","july","august","september","october","november","december"];function Dl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&One.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Dne=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function nA(e){return e?e.content&&e.type?so(e.content,!0):e.data?Ic(e.data):e.asNodeBuffer&&$e?Ic(e.asNodeBuffer().toString("binary")):e.asBinary?Ic(e.asBinary()):e._data&&e._data.getContent?Ic(so(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function aA(e){if(!e)return null;if(e.data)return Pb(e.data);if(e.asNodeBuffer&&$e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Pb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function jne(e){return e&&e.name.slice(-4)===".bin"?aA(e):nA(e)}function xn(e,t){for(var r=e.FullPaths||ja(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function wy(e,t){var r=xn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mt(e,t,r){if(!r)return jne(wy(e,t));if(!t)return null;try{return Mt(e,t)}catch{return null}}function tn(e,t,r){if(!r)return nA(wy(e,t));if(!t)return null;try{return tn(e,t)}catch{return null}}function Pne(e,t,r){return aA(wy(e,t))}function Yb(e){for(var t=e.FullPaths||ja(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Fne(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return $e?n=go(r):n=Zre(r),Ue.utils.cfb_add(e,t,n)}Ue.utils.cfb_add(e,t,r)}else e.file(t,r)}function sA(e,t){switch(t.type){case"base64":return Ue.read(e,{type:"base64"});case"binary":return Ue.read(e,{type:"binary"});case"buffer":case"array":return Ue.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function $c(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var iA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Rne=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Gb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Mne=/<[^>]*>/g,Tr=iA.match(Gb)?Gb:Mne,Ine=/<\w*:/,Lne=/<(\/?)\w+:/;function Te(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(Rne),o=0,l="",c=0,f="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Ia(e){return e.replace(Lne,"<$1")}var oA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$ne=_y(oA),ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return oA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Une=/[&<>'"]/g,Bne=/[\u0000-\u001f]/g;function by(e){var t=e+"";return t.replace(Une,function(r){return $ne[r]}).replace(/\n/g,"<br/>").replace(Bne,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Kb=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Um(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function qb(e){var t=li(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Xb(e){return go(e,"binary").toString("utf8")}var Td="foo bar bazâð£",st=$e&&(Xb(Td)==Um(Td)&&Xb||qb(Td)==Um(Td)&&qb)||Um,Uc=$e?function(e){return go(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ef=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),lA=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Wne=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Vne=/<\/?(?:vt:)?variant>/g,Hne=/<(?:vt:)([^>]*)>([\s\S]*)</;function Jb(e,t){var r=Te(e),n=e.match(Wne(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(Vne,"").match(Hne);i&&a.push({v:st(i[2]),t:i[1]})}),a}var zne=/(^\s|\s$|\n)/;function Yne(e){return ja(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Gne(e,t,r){return"<"+e+(r!=null?Yne(r):"")+(t!=null?(t.match(zne)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sy(e){if($e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return st(xo(gy(e)));throw new Error("Bad input format: expected Buffer or string")}var tf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Kne={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qne=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Xne(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Jne(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Qb=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Zb=$e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:go(t)})):Qb(e)}:Qb,eS=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Za(e,a)));return n.join("").replace(Pr,"")},Ey=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Pr,""):eS(e,t,r)}:eS,tS=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},cA=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):tS(e,t,r)}:tS,rS=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Io(e,a)));return n.join("")},Mf=$e?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):rS(t,r,n)}:rS,uA=function(e,t){var r=en(e,t);return r>0?Mf(e,t+4,t+4+r-1):""},fA=uA,dA=function(e,t){var r=en(e,t);return r>0?Mf(e,t+4,t+4+r-1):""},hA=dA,pA=function(e,t){var r=2*en(e,t);return r>0?Mf(e,t+4,t+4+r-1):""},mA=pA,vA=function(t,r){var n=en(t,r);return n>0?Ey(t,r+4,r+4+n):""},gA=vA,xA=function(e,t){var r=en(e,t);return r>0?Mf(e,t+4,t+4+r):""},yA=xA,_A=function(e,t){return Xne(e,t)},ah=_A,wA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};$e&&(fA=function(t,r){if(!Buffer.isBuffer(t))return uA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},hA=function(t,r){if(!Buffer.isBuffer(t))return dA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},mA=function(t,r){if(!Buffer.isBuffer(t))return pA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},gA=function(t,r){if(!Buffer.isBuffer(t))return vA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},yA=function(t,r){if(!Buffer.isBuffer(t))return xA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ah=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_A(t,r)},wA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Io=function(e,t){return e[t]},Za=function(e,t){return e[t+1]*256+e[t]},Qne=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},en=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Di=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Zne=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function au(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,$e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Za(this,c)),c+=2;e*=2;break;case"utf8":r=Mf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ey(this,this.l,this.l+e);break;case"wstr":return au.call(this,e,"dbcs");case"lpstr-ansi":r=fA(this,this.l),e=4+en(this,this.l);break;case"lpstr-cp":r=hA(this,this.l),e=4+en(this,this.l);break;case"lpwstr":r=mA(this,this.l),e=4+2*en(this,this.l);break;case"lpp4":e=4+en(this,this.l),r=gA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+en(this,this.l),r=yA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Io(this,this.l+e++))!==0;)s.push(kd(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Za(this,this.l+e))!==0;)s.push(kd(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Io(this,c),this.l=c+1,o=au.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(kd(Za(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Io(this,c),this.l=c+1,o=au.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(kd(Io(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Io(this,this.l),this.l++,n;case 2:return n=(t==="i"?Qne:Za)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Di:Zne)(this,this.l),this.l+=4,n):(a=en(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=ah(this,this.l):a=ah([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=cA(this,this.l,e);break}}return this.l+=e,r}var eae=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},tae=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},rae=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function nae(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)rae(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,eae(this,t,this.l);break;case 8:if(n=8,r==="f"){Jne(this,t,this.l);break}case 16:break;case-4:n=4,tae(this,t,this.l);break}return this.l+=n,this}function bA(e,t){var r=cA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function rr(e,t){e.l=t,e.read_shift=au,e.chk=bA,e.write_shift=nae}function br(e,t){e.l+=t}function Ut(e){var t=li(e);return rr(t,0),t}function bs(e,t,r){if(e){var n,a,s;rr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=uh[o]||uh[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=l,t(f,c,o))return}}}function Ng(){var e=[],t=$e?256:2048,r=function(c){var f=Ut(c);return rr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),Is(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function su(e,t,r){var n=sr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function nS(e,t,r){var n=sr(e);return n.s=su(n.s,t.s,r),n.e=su(n.e,t.s,r),n}function iu(e,t){if(e.cRel&&e.c<0)for(e=sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ae(e);return!e.cRel&&e.cRel!=null&&(r=iae(r)),!e.rRel&&e.rRel!=null&&(r=aae(r)),r}function Bm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ir(e.s.r)+":"+(e.e.rRel?"":"$")+ir(e.e.r):iu(e.s,t.biff)+":"+iu(e.e,t.biff)}function ky(e){return parseInt(sae(e),10)-1}function ir(e){return""+(e+1)}function aae(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function sae(e){return e.replace(/\$(\d+)$/,"$1")}function Ty(e){for(var t=oae(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function iae(e){return e.replace(/^([A-Z])/,"$$$1")}function oae(e){return e.replace(/^\$([A-Z])/,"$1")}function lae(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ae(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function sc(e){var t=e.indexOf(":");return t==-1?{s:Dr(e),e:Dr(e)}:{s:Dr(e.slice(0,t)),e:Dr(e.slice(t+1))}}function Be(e,t){return typeof t>"u"||typeof t=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Ae(e)),typeof t!="string"&&(t=Ae(t)),e==t?e:e+":"+t)}function Nt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function aS(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fn(e.z,r?Fr(t):t)}catch{}try{return e.w=Fn((e.XF||{}).numFmtId||(r?14:0),r?Fr(t):t)}catch{return""+t}}function ms(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?wo[e.v]||e.v:t==null?aS(e,e.v):aS(e,t))}function yi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function SA(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Nt(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var m={v:t[d][h]},v=i+d,p=o+h;if(c.s.r>v&&(c.s.r=v),c.s.c>p&&(c.s.c=p),c.e.r<v&&(c.e.r=v),c.e.c<p&&(c.e.c=p),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))m=t[d][h];else if(Array.isArray(m.v)&&(m.f=t[d][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||je[14],n.cellDates?(m.t="d",m.w=Fn(m.z,Fr(m.v))):(m.t="n",m.v=Fr(m.v),m.w=Fn(m.z,m.v))):m.t="s";if(a)s[v]||(s[v]=[]),s[v][p]&&s[v][p].z&&(m.z=s[v][p].z),s[v][p]=m;else{var _=Ae({c:p,r:v});s[_]&&s[_].z&&(m.z=s[_].z),s[_]=m}}}return c.s.c<1e7&&(s["!ref"]=Be(c)),s}function ic(e,t){return SA(null,e,t)}function cae(e){return e.read_shift(4,"i")}function _r(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function uae(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Cy(e,t){var r=e.l,n=e.read_shift(1),a=_r(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(uae(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var fae=Cy;function $n(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function yo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var dae=_r;function Ny(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var hae=_r,Ag=Ny;function Ay(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?ah([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Di(t,0)>>2;return r?a/100:a}function EA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var _o=EA;function gr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function pae(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Vi[a];c&&(t.rgb=nf(c));break;case 2:t.rgb=nf([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function mae(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function kA(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function vae(e){return kA(e,1)}function gae(e){return kA(e,2)}var Oy=2,Ur=3,Cd=11,sS=12,sh=19,Nd=64,xae=65,yae=71,_ae=4108,wae=4126,Xt=80,TA=81,bae=[Xt,TA],Sae={1:{n:"CodePage",t:Oy},2:{n:"Category",t:Xt},3:{n:"PresentationFormat",t:Xt},4:{n:"ByteCount",t:Ur},5:{n:"LineCount",t:Ur},6:{n:"ParagraphCount",t:Ur},7:{n:"SlideCount",t:Ur},8:{n:"NoteCount",t:Ur},9:{n:"HiddenCount",t:Ur},10:{n:"MultimediaClipCount",t:Ur},11:{n:"ScaleCrop",t:Cd},12:{n:"HeadingPairs",t:_ae},13:{n:"TitlesOfParts",t:wae},14:{n:"Manager",t:Xt},15:{n:"Company",t:Xt},16:{n:"LinksUpToDate",t:Cd},17:{n:"CharacterCount",t:Ur},19:{n:"SharedDoc",t:Cd},22:{n:"HyperlinksChanged",t:Cd},23:{n:"AppVersion",t:Ur,p:"version"},24:{n:"DigSig",t:xae},26:{n:"ContentType",t:Xt},27:{n:"ContentStatus",t:Xt},28:{n:"Language",t:Xt},29:{n:"Version",t:Xt},255:{},2147483648:{n:"Locale",t:sh},2147483651:{n:"Behavior",t:sh},1919054434:{}},Eae={1:{n:"CodePage",t:Oy},2:{n:"Title",t:Xt},3:{n:"Subject",t:Xt},4:{n:"Author",t:Xt},5:{n:"Keywords",t:Xt},6:{n:"Comments",t:Xt},7:{n:"Template",t:Xt},8:{n:"LastAuthor",t:Xt},9:{n:"RevNumber",t:Xt},10:{n:"EditTime",t:Nd},11:{n:"LastPrinted",t:Nd},12:{n:"CreatedDate",t:Nd},13:{n:"ModifiedDate",t:Nd},14:{n:"PageCount",t:Ur},15:{n:"WordCount",t:Ur},16:{n:"CharCount",t:Ur},17:{n:"Thumbnail",t:yae},18:{n:"Application",t:Xt},19:{n:"DocSecurity",t:Ur},255:{},2147483648:{n:"Locale",t:sh},2147483651:{n:"Behavior",t:sh},1919054434:{}},iS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},kae=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Tae(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Cae=Tae([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vi=sr(Cae),wo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},oS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Nae(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Aae(e){var t=Nae();if(!e||!e.match)return t;var r={};if((e.match(Tr)||[]).forEach(function(n){var a=Te(n);switch(a[0].replace(Ine,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[oS[a.ContentType]]!==void 0&&t[oS[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Kne.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Jo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Og(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ou(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Tr)||[]).forEach(function(a){var s=Te(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:$c(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var Oae="application/vnd.oasis.opendocument.spreadsheet";function Dae(e,t){for(var r=Sy(e),n,a;n=tf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Te(n[0],!1),a.path=="/"&&a.type!==Oae)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var lu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],jae=function(){for(var e=new Array(lu.length),t=0;t<lu.length;++t){var r=lu[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function NA(e){var t={};e=st(e);for(var r=0;r<lu.length;++r){var n=lu[r],a=e.match(jae[r]);a!=null&&a.length>0&&(t[n[1]]=ze(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Zt(t[n[1]]))}return t}var Pae=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function AA(e,t,r,n){var a=[];if(typeof e=="string")a=Jb(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Jb(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function Fae(e,t,r){var n={};return t||(t={}),e=st(e),Pae.forEach(function(a){var s=(e.match(ef(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=ze(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&AA(n.HeadingPairs,n.TitlesOfParts,t,r),t}var Rae=/<[^>]+>[^<]*/g;function Mae(e,t){var r={},n="",a=e.match(Rae);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Te(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ze(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ze(f);break;case"bool":r[n]=mt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Zt(f);break;case"cy":case"error":r[n]=ze(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var Iae={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Wm;function Lae(e,t,r){Wm||(Wm=_y(Iae)),t=Wm[t]||t,e[t]=r}function Dy(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function OA(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function DA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function jA(e,t,r){return t===31?DA(e):OA(e,t,r)}function Dg(e,t,r){return jA(e,t,r===!1?0:4)}function $ae(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return jA(e,t,0)}function Uae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Pr,""),e.l-a&2&&(e.l+=2)}return r}function Bae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Pr,"");return r}function Wae(e){var t=e.l,r=ih(e,TA);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ih(e,Ur);return[r,n]}function Vae(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Wae(e));return r}function lS(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Pr,"").replace(Lc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function PA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Hae(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ih(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==sS&&n!==t&&bae.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===sS?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return OA(e,n,4).replace(Pr,"");case 31:return DA(e);case 64:return Dy(e);case 65:return PA(e);case 71:return Hae(e);case 80:return Dg(e,n,!s.raw).replace(Pr,"");case 81:return $ae(e,n).replace(Pr,"");case 4108:return Vae(e);case 4126:case 4127:return n==4127?Uae(e):Bae(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function cS(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(y,x){return y[1]-x[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var m=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],m=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],m=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(m=!1,e.l=s[i][1]),m)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[s[i][0]];if(h[v.n]=ih(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Jn(o=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(s[i][0]===1){if(o=h.CodePage=ih(e,Oy),Jn(o),l!==-1){var p=e.l;e.l=s[l][1],c=lS(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=lS(e,o)}else{var _=c[s[i][0]],g;switch(e[e.l]){case 65:e.l+=4,g=PA(e);break;case 30:e.l+=4,g=Dg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=Dg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Ot(e,4);break;case 64:e.l+=4,g=Zt(Dy(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[_]=g}}return e.l=r+n,h}function uS(e,t,r){var n=e.content;if(!n)return{};rr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Ue.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=cS(n,t),h={SystemIdentifier:c};for(var m in d)h[m]=d[m];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=cS(n,null)}catch{}for(m in v)h[m]=v[m];return h.FMTID=[s,i],h}function Cs(e,t){return e.read_shift(t),null}function zae(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ot(e,t){return e.read_shift(t)===1}function It(e){return e.read_shift(2,"u")}function FA(e,t){return zae(e,t,It)}function Yae(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function If(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function Gae(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function io(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Lf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):io(e,n,r)}function bo(e,t,r){if(r.biff>5)return Lf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Kae(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function qae(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Pr,"");return n&&(e.l+=24),a}function Xae(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Pr,"");return r+i}function Jae(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return qae(e);case"0303000000000000c000000000000046":return Xae(e);default:throw new Error("Unsupported Moniker "+r)}}function Ad(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Pr,""):"";return r}function Qae(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",f,d;a&16&&(s=Ad(e,r-e.l)),a&128&&(i=Ad(e,r-e.l)),(a&257)===257&&(o=Ad(e,r-e.l)),(a&257)===1&&(l=Jae(e,r-e.l)),a&8&&(c=Ad(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=Dy(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return f&&(m.guid=f),d&&(m.time=d),s&&(m.Tooltip=s),m}function RA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function MA(e,t){var r=RA(e);return r[3]=0,r}function La(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Zae(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ese(e,t,r){return t===0?"":bo(e,t,r)}function tse(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function IA(e){var t=e.read_shift(2),r=Ay(e);return[t,r]}function rse(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=If(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function kp(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function LA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var nse=LA;function $A(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function ase(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function sse(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function pr(e){e.l+=2,e.l+=e.read_shift(2)}var ise={0:pr,4:pr,5:pr,6:pr,7:sse,8:pr,9:pr,10:pr,11:pr,12:pr,13:ase,14:pr,15:pr,16:pr,17:pr,18:pr,19:pr,20:pr,21:$A};function ose(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(ise[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Od(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function lse(e,t){return t===0||e.read_shift(2),1200}function cse(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=bo(e,0,r);return e.read_shift(t+n-e.l),a}function use(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function fse(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=If(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function dse(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(Gae(e));return s.Count=n,s.Unique=a,s}function hse(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function pse(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function mse(e){var t=Zae(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function vse(e){return e.read_shift(2),e.read_shift(4)}function fS(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function gse(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function xse(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function yse(){}function _se(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=If(e,0,r),n}function wse(e){var t=La(e);return t.isst=e.read_shift(4),t}function bse(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=La(e);r.biff==2&&e.l++;var s=Lf(e,n-e.l,r);return a.val=s,a}function Sse(e,t,r){var n=e.read_shift(2),a=bo(e,0,r);return[n,a]}var Ese=bo;function dS(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function kse(e){var t=e.read_shift(2),r=e.read_shift(2),n=IA(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Tse(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(IA(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function Cse(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function Nse(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=kae[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function Ase(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Nse(e,t,n.fStyle,r),n}function Ose(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function hS(e,t,r){var n=La(e);(r.biff==2||t==9)&&++e.l;var a=Yae(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Dse(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=La(e),a=gr(e);return n.val=a,n}var pS=ese;function jse(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=io(e,s),o=[];n>e.l;)o.push(Lf(e));return[s,a,i,o]}function mS(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=rse(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var Pse=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vS(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=io(e,i,r);a&32&&(c=Pse[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:pce(e,f,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function UA(e,t,r){if(r.biff<8)return Fse(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(tse(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Fse(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=If(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Rse(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=io(e,n,r),i=io(e,a,r);return[s,i]}function Mse(e,t,r){var n=LA(e);e.l++;var a=e.read_shift(1);return t-=8,[mce(e,t,r),a,n]}function gS(e,t,r){var n=nse(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,dce(e,t,r)]}function Ise(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Lse(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=bo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function $se(e,t,r){return Lse(e,t,r)}function Use(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(kp(e));return r}function Bse(e,t,r){if(r&&r.biff<8)return Vse(e,t,r);var n=$A(e),a=ose(e,t-22,n[1]);return{cmo:n,ft:a}}var Wse={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Vse(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Wse[n]||br)(e,t,r)),{cmo:[a,n,s],ft:i}}function Hse(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=Kae(e,6,r);var o=e.read_shift(2);e.read_shift(2),It(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=io(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function zse(e,t){var r=kp(e);e.l+=16;var n=Qae(e,t-24);return[r,n]}function Yse(e,t){e.read_shift(2);var r=kp(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Pr,""),[r,n]}function Gse(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=iS[r]||r,r=e.read_shift(2),t[1]=iS[r]||r,t}function Kse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(MA(e));return r}function qse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(MA(e));return r}function Xse(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function BA(e,t,r){if(!r.cellStyles)return br(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Jse(e,t){var r={};return t<32||(e.l+=16,r.header=gr(e),r.footer=gr(e),e.l+=2),r}function Qse(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var Zse=La,eie=FA,tie=Lf;function rie(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function nie(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=La(e);++e.l;var a=bo(e,t-7,r);return n.t="str",n.val=a,n}function aie(e){var t=La(e);++e.l;var r=gr(e);return t.t="n",t.val=r,t}function sie(e){var t=La(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function iie(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function oie(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function lie(e,t,r){var n=e.l+t,a=La(e),s=e.read_shift(2),i=io(e,s,r);return e.l=n,a.t="str",a.val=i,a}var cie=[2,3,48,49,131,139,140,245],xS=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_y({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=li(1);switch(l.type){case"base64":f=qn(cn(o));break;case"binary":f=qn(o);break;case"buffer":case"array":f=o;break}rr(f,0);var d=f.read_shift(1),h=!!(d&136),m=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,_=521;d==2&&(p=f.read_shift(2)),f.l+=3,d!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(_=f.read_shift(2));var g=f.read_shift(2),y=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var x=[],w={},E=Math.min(f.length,d==2?521:_-10-(m?264:0)),S=v?32:11;f.l<E&&f[f.l]!=13;)switch(w={},w.name=Ms.utils.decode(y,f.slice(f.l,f.l+S)).replace(/[\u0000\r\n].*$/g,""),f.l+=S,w.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(w.offset=f.read_shift(4)),w.len=f.read_shift(1),d==2&&(w.offset=f.read_shift(2)),w.dec=f.read_shift(1),w.name.length&&x.push(w),d!=2&&(f.l+=v?13:14),w.type){case"B":(!m||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var b=0,T=0;for(c[0]=[],T=0;T!=x.length;++T)c[0][T]=x[T].name;for(;p-- >0;){if(f[f.l]===42){f.l+=g;continue}for(++f.l,c[++b]=[],T=0,T=0;T!=x.length;++T){var C=f.slice(f.l,f.l+x[T].len);f.l+=x[T].len,rr(C,0);var F=Ms.utils.decode(y,C);switch(x[T].type){case"C":F.trim().length&&(c[b][T]=F.replace(/\s+$/,""));break;case"D":F.length===8?c[b][T]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):c[b][T]=F;break;case"F":c[b][T]=parseFloat(F.trim());break;case"+":case"I":c[b][T]=v?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":c[b][T]=!0;break;case"N":case"F":c[b][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[b][T]="##MEMO##"+(v?parseInt(F.trim(),10):C.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(c[b][T]=+F||0);break;case"@":c[b][T]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":c[b][T]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":c[b][T]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[b][T]=-C.read_shift(-8,"f");break;case"B":if(m&&x[T].len==8){c[b][T]=C.read_shift(8,"f");break}case"G":case"P":C.l+=x[T].len;break;case"0":if(x[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[T].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=ic(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function a(o,l){try{return yi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Jn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Ng(),d=Lg(o,{header:1,raw:!0,cellDates:!0}),h=d[0],m=d.slice(1),v=o["!cols"]||[],p=0,_=0,g=0,y=1;for(p=0;p<h.length;++p){if(((v[p]||{}).DBF||{}).name){h[p]=v[p].DBF.name,++g;continue}if(h[p]!=null){if(++g,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(_=0;_<1024;++_)if(h.indexOf(h[p]+"_"+_)==-1){h[p]+="_"+_;break}}}}var x=Nt(o["!ref"]),w=[],E=[],S=[];for(p=0;p<=x.e.c-x.s.c;++p){var b="",T="",C=0,F=[];for(_=0;_<m.length;++_)m[_][p]!=null&&F.push(m[_][p]);if(F.length==0||h[p]==null){w[p]="?";continue}for(_=0;_<F.length;++_){switch(typeof F[_]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=F[_]instanceof Date?"D":"C";break;default:T="C"}C=Math.max(C,String(F[_]).length),b=b&&b!=T?"C":T}C>250&&(C=250),T=((v[p]||{}).DBF||{}).type,T=="C"&&v[p].DBF.len>C&&(C=v[p].DBF.len),b=="B"&&T=="N"&&(b="N",S[p]=v[p].DBF.dec,C=v[p].DBF.len),E[p]=b=="C"||T=="N"?C:s[b]||0,y+=E[p],w[p]=b}var M=f.next(32);for(M.write_shift(4,318902576),M.write_shift(4,m.length),M.write_shift(2,296+32*g),M.write_shift(2,y),p=0;p<4;++p)M.write_shift(4,0);for(M.write_shift(4,0|(+t[U4]||3)<<8),p=0,_=0;p<h.length;++p)if(h[p]!=null){var j=f.next(32),A=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,A,"sbcs"),j.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),j.write_shift(4,_),j.write_shift(1,E[p]||s[w[p]]||0),j.write_shift(1,S[p]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),_+=E[p]||s[w[p]]||0}var G=f.next(264);for(G.write_shift(4,13),p=0;p<65;++p)G.write_shift(4,0);for(p=0;p<m.length;++p){var X=f.next(y);for(X.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(w[_]){case"L":X.write_shift(1,m[p][_]==null?63:m[p][_]?84:70);break;case"B":X.write_shift(8,m[p][_]||0,"f");break;case"N":var H="0";for(typeof m[p][_]=="number"&&(H=m[p][_].toFixed(S[_]||0)),g=0;g<E[_]-H.length;++g)X.write_shift(1,32);X.write_shift(1,H,"sbcs");break;case"D":m[p][_]?(X.write_shift(4,("0000"+m[p][_].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(m[p][_].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+m[p][_].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var q=String(m[p][_]!=null?m[p][_]:"").slice(0,E[_]);for(X.write_shift(1,q,"sbcs"),g=0;g<E[_]-q.length;++g)X.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),uie=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ja(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var v=e[m];return typeof v=="number"?Fb(v):v},n=function(h,m,v){var p=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?h:Fb(p)};e["|"]=254;function a(h,m){switch(m.type){case"base64":return s(cn(h),m);case"binary":return s(h,m);case"buffer":return s($e&&Buffer.isBuffer(h)?h.toString("binary"):xo(h),m);case"array":return s(so(h),m)}throw new Error("Unrecognized type "+m.type)}function s(h,m){var v=h.split(/[\n\r]+/),p=-1,_=-1,g=0,y=0,x=[],w=[],E=null,S={},b=[],T=[],C=[],F=0,M;for(+m.codepage>=0&&Jn(+m.codepage);g!==v.length;++g){F=0;var j=v[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),A=j.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),G=A[0],X;if(j.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":A[1].charAt(0)=="P"&&w.push(j.slice(3).replace(/;;/g,";"));break;case"C":var H=!1,q=!1,Z=!1,Y=!1,ce=-1,z=-1;for(y=1;y<A.length;++y)switch(A[y].charAt(0)){case"A":break;case"X":_=parseInt(A[y].slice(1))-1,q=!0;break;case"Y":for(p=parseInt(A[y].slice(1))-1,q||(_=0),M=x.length;M<=p;++M)x[M]=[];break;case"K":X=A[y].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(ta(X))?isNaN(Dl(X).getDate())||(X=Zt(X)):(X=ta(X),E!==null&&ac(E)&&(X=Ep(X))),H=!0;break;case"E":Y=!0;var k=hl(A[y].slice(1),{r:p,c:_});x[p][_]=[x[p][_],k];break;case"S":Z=!0,x[p][_]=[x[p][_],"S5S"];break;case"G":break;case"R":ce=parseInt(A[y].slice(1))-1;break;case"C":z=parseInt(A[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+j)}if(H&&(x[p][_]&&x[p][_].length==2?x[p][_][0]=X:x[p][_]=X,E=null),Z){if(Y)throw new Error("SYLK shared formula cannot have own formula");var I=ce>-1&&x[ce][z];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");x[p][_][1]=JA(I[1],{r:p-ce,c:_-z})}break;case"F":var N=0;for(y=1;y<A.length;++y)switch(A[y].charAt(0)){case"X":_=parseInt(A[y].slice(1))-1,++N;break;case"Y":for(p=parseInt(A[y].slice(1))-1,M=x.length;M<=p;++M)x[M]=[];break;case"M":F=parseInt(A[y].slice(1))/20;break;case"F":break;case"G":break;case"P":E=w[parseInt(A[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=A[y].slice(1).split(" "),M=parseInt(C[0],10);M<=parseInt(C[1],10);++M)F=parseInt(C[2],10),T[M-1]=F===0?{hidden:!0}:{wch:F},jl(T[M-1]);break;case"C":_=parseInt(A[y].slice(1))-1,T[_]||(T[_]={});break;case"R":p=parseInt(A[y].slice(1))-1,b[p]||(b[p]={}),F>0?(b[p].hpt=F,b[p].hpx=af(F)):F===0&&(b[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+j)}N<1&&(E=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+j)}}return b.length>0&&(S["!rows"]=b),T.length>0&&(S["!cols"]=T),m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),[x,S]}function i(h,m){var v=a(h,m),p=v[0],_=v[1],g=ic(p,m);return ja(_).forEach(function(y){g[y]=_[y]}),g}function o(h,m){return yi(i(h,m),m)}function l(h,m,v,p){var _="C;Y"+(v+1)+";X"+(p+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+Xoe(h.f,{r:v,c:p}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,m){m.forEach(function(v,p){var _="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=lh(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ch(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function f(h,m){m.forEach(function(v,p){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*KA(v.hpx)+";"),_.length>2&&h.push(_+"R"+(p+1))})}function d(h,m){var v=["ID;PWXL;N;E"],p=[],_=Nt(h["!ref"]),g,y=Array.isArray(h),x=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&c(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var w=_.s.r;w<=_.e.r;++w)for(var E=_.s.c;E<=_.e.c;++E){var S=Ae({r:w,c:E});g=y?(h[w]||[])[E]:h[S],!(!g||g.v==null&&(!g.f||g.F))&&p.push(l(g,h,w,E))}return v.join(x)+x+p.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),fie=function(){function e(s,i){switch(i.type){case"base64":return t(cn(s),i);case"binary":return t(s,i);case"buffer":return t($e&&Buffer.isBuffer(s)?s.toString("binary"):xo(s),i);case"array":return t(so(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[f].trim().split(","),m=h[0],v=h[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+m){case-1:if(p==="BOT"){d[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[l][c]=!0:p==="FALSE"?d[l][c]=!1:isNaN(ta(v))?isNaN(Dl(v).getDate())?d[l][c]=v:d[l][c]=Zt(v):d[l][c]=ta(v),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return ic(e(s,i),i)}function n(s,i){return yi(r(s,i),i)}var a=function(){var s=function(l,c,f,d,h){l.push(c),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=Nt(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){i(c,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var p=Ae({r:m,c:v});if(d=h?(l[m]||[])[v]:l[p],!d){i(c,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,_,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Fn(d.z||je[14],Fr(Zt(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var g=`\r
`,y=c.join(g);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),die=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var m=d.split(`
`),v=-1,p=-1,_=0,g=[];_!==m.length;++_){var y=m[_].trim().split(":");if(y[0]==="cell"){var x=Dr(y[1]);if(g.length<=x.r)for(v=g.length;v<=x.r;++v)g[v]||(g[v]=[]);switch(v=x.r,p=x.c,y[2]){case"t":g[v][p]=e(y[3]);break;case"v":g[v][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":g[v][p]=!!+y[4];break;default:g[v][p]=+y[4];break}y[2]=="vtf"&&(g[v][p]=[g[v][p],w])}}}return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}function n(d,h){return ic(r(d,h),h)}function a(d,h){return yi(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],m=[],v,p="",_=sc(d["!ref"]),g=Array.isArray(d),y=_.s.r;y<=_.e.r;++y)for(var x=_.s.c;x<=_.e.c;++x)if(p=Ae({r:y,c:x}),v=g?(d[y]||[])[x]:d[p],!(!v||v.v==null||v.t==="z")){switch(m=["cell",p,"t"],v.t){case"s":case"str":m.push(t(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=t(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var w=Fr(Zt(v.v));m[2]="vtc",m[3]="nd",m[4]=""+w,m[5]=v.w||Fn(v.z||je[14],w);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,i,o,i,c(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),rf=function(){function e(f,d,h,m,v){v.raw?d[h][m]=f:f===""||(f==="TRUE"?d[h][m]=!0:f==="FALSE"?d[h][m]=!1:isNaN(ta(f))?isNaN(Dl(f).getDate())?d[h][m]=f:d[h][m]=Zt(f):d[h][m]=ta(f))}function t(f,d){var h=d||{},m=[];if(!f||f.length===0)return m;for(var v=f.split(/[\r\n]/),p=v.length-1;p>=0&&v[p].length===0;)--p;for(var _=10,g=0,y=0;y<=p;++y)g=v[y].indexOf(" "),g==-1?g=v[y].length:g++,_=Math.max(_,g);for(y=0;y<=p;++y){m[y]=[];var x=0;for(e(v[y].slice(0,_).trim(),m,y,x,h),x=1;x<=(v[y].length-_)/10+1;++x)e(v[y].slice(_+(x-1)*10,_+x*10).trim(),m,y,x,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,m=0,v=0;m<f.length;++m)(v=f.charCodeAt(m))==34?h=!h:!h&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&v.push([d[m],m]);if(!v.length){d=n;for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&v.push([d[m],m])}return v.sort(function(p,_){return p[0]-_[0]||n[p[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(f,d){var h=d||{},m="",v=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=a(f.slice(0,1024)):h&&h.FS?m=h.FS:m=a(f.slice(0,1024));var _=0,g=0,y=0,x=0,w=0,E=m.charCodeAt(0),S=!1,b=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var C=h.dateNF!=null?Sne(h.dateNF):null;function F(){var M=f.slice(x,w),j={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)j.t="z";else if(h.raw)j.t="s",j.v=M;else if(M.trim().length===0)j.t="s",j.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(j.t="s",j.v=M.slice(2,-1).replace(/""/g,'"')):Qoe(M)?(j.t="n",j.f=M.slice(1)):(j.t="s",j.v=M);else if(M=="TRUE")j.t="b",j.v=!0;else if(M=="FALSE")j.t="b",j.v=!1;else if(!isNaN(y=ta(M)))j.t="n",h.cellText!==!1&&(j.w=M),j.v=y;else if(!isNaN(Dl(M).getDate())||C&&M.match(C)){j.z=h.dateNF||je[14];var A=0;C&&M.match(C)&&(M=Ene(M,h.dateNF,M.match(C)||[]),A=1),h.cellDates?(j.t="d",j.v=Zt(M,A)):(j.t="n",j.v=Fr(Zt(M,A))),h.cellText!==!1&&(j.w=Fn(j.z,j.v instanceof Date?Fr(j.v):j.v)),h.cellNF||delete j.z}else j.t="s",j.v=M;if(j.t=="z"||(h.dense?(v[_]||(v[_]=[]),v[_][g]=j):v[Ae({c:g,r:_})]=j),x=w+1,T=f.charCodeAt(x),p.e.c<g&&(p.e.c=g),p.e.r<_&&(p.e.r=_),b==E)++g;else if(g=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;w<f.length;++w)switch(b=f.charCodeAt(w)){case 34:T===34&&(S=!S);break;case E:case 10:case 13:if(!S&&F())break e;break}return w-x>0&&F(),v["!ref"]=Be(p),v}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):ic(t(f,d),d)}function o(f,d){var h="",m=d.type=="string"?[0,0,0,0]:$y(f,d);switch(d.type){case"base64":h=cn(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Ms<"u"?h=Ms.utils.decode(d.codepage,f):h=$e&&Buffer.isBuffer(f)?f.toString("binary"):xo(f);break;case"array":h=so(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=st(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=st(h):d.type=="binary"&&typeof Ms<"u"&&d.codepage&&(h=Ms.utils.decode(d.codepage,Ms.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?die.to_sheet(d.type=="string"?h:st(h),d):i(h,d)}function l(f,d){return yi(o(f,d),d)}function c(f){for(var d=[],h=Nt(f["!ref"]),m,v=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var _=[],g=h.s.c;g<=h.e.c;++g){var y=Ae({r:p,c:g});if(m=v?(f[p]||[])[g]:f[y],!m||m.v==null){_.push("          ");continue}for(var x=(m.w||(ms(m),m.w)||"").slice(0,10);x.length<10;)x+=" ";_.push(x+(g===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function hie(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=uie.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return rf.to_workbook(e,t)}}var cu=function(){function e(k,I,N){if(k){rr(k,k.l||0);for(var P=N.Enum||ce;k.l<k.length;){var K=k.read_shift(2),ne=P[K]||P[65535],J=k.read_shift(2),ie=k.l+J,oe=ne.f&&ne.f(k,J,N);if(k.l=ie,I(oe,ne,K))return}}}function t(k,I){switch(I.type){case"base64":return r(qn(cn(k)),I);case"binary":return r(qn(k),I);case"buffer":case"array":return r(k,I)}throw"Unsupported type "+I.type}function r(k,I){if(!k)return k;var N=I||{},P=N.dense?[]:{},K="Sheet1",ne="",J=0,ie={},oe=[],Se=[],W={s:{r:0,c:0},e:{r:0,c:0}},Ne=N.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)N.Enum=ce,e(k,function(me,tt,cr){switch(cr){case 0:N.vers=me,me>=4096&&(N.qpro=!0);break;case 6:W=me;break;case 204:me&&(ne=me);break;case 222:ne=me;break;case 15:case 51:N.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:cr==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=N.dateNF||je[14],N.cellDates&&(me[1].t="d",me[1].v=Ep(me[1].v))),N.qpro&&me[3]>J&&(P["!ref"]=Be(W),ie[K]=P,oe.push(K),P=N.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},J=me[3],K=ne||"Sheet"+(J+1),ne="");var gt=N.dense?(P[me[0].r]||[])[me[0].c]:P[Ae(me[0])];if(gt){gt.t=me[1].t,gt.v=me[1].v,me[1].z!=null&&(gt.z=me[1].z),me[1].f!=null&&(gt.f=me[1].f);break}N.dense?(P[me[0].r]||(P[me[0].r]=[]),P[me[0].r][me[0].c]=me[1]):P[Ae(me[0])]=me[1];break}},N);else if(k[2]==26||k[2]==14)N.Enum=z,k[2]==14&&(N.qpro=!0,k.l=0),e(k,function(me,tt,cr){switch(cr){case 204:K=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>J&&(P["!ref"]=Be(W),ie[K]=P,oe.push(K),P=N.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},J=me[3],K="Sheet"+(J+1)),Ne>0&&me[0].r>=Ne)break;N.dense?(P[me[0].r]||(P[me[0].r]=[]),P[me[0].r][me[0].c]=me[1]):P[Ae(me[0])]=me[1],W.e.c<me[0].c&&(W.e.c=me[0].c),W.e.r<me[0].r&&(W.e.r=me[0].r);break;case 27:me[14e3]&&(Se[me[14e3][0]]=me[14e3][1]);break;case 1537:Se[me[0]]=me[1],me[0]==J&&(K=me[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(P["!ref"]=Be(W),ie[ne||K]=P,oe.push(ne||K),!Se.length)return{SheetNames:oe,Sheets:ie};for(var ke={},Xe=[],Oe=0;Oe<Se.length;++Oe)ie[oe[Oe]]?(Xe.push(Se[Oe]||oe[Oe]),ke[Se[Oe]]=ie[Se[Oe]]||ie[oe[Oe]]):(Xe.push(Se[Oe]),ke[Se[Oe]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:ke}}function n(k,I){var N=I||{};if(+N.codepage>=0&&Jn(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Ng(),K=Nt(k["!ref"]),ne=Array.isArray(k),J=[];Hn(P,0,s(1030)),Hn(P,6,l(K));for(var ie=Math.min(K.e.r,8191),oe=K.s.r;oe<=ie;++oe)for(var Se=ir(oe),W=K.s.c;W<=K.e.c;++W){oe===K.s.r&&(J[W]=Ht(W));var Ne=J[W]+Se,ke=ne?(k[oe]||[])[W]:k[Ne];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?Hn(P,13,m(oe,W,ke.v)):Hn(P,14,p(oe,W,ke.v));else{var Xe=ms(ke);Hn(P,15,d(oe,W,Xe.slice(0,239)))}}return Hn(P,1),P.end()}function a(k,I){var N=I||{};if(+N.codepage>=0&&Jn(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Ng();Hn(P,0,i(k));for(var K=0,ne=0;K<k.SheetNames.length;++K)(k.Sheets[k.SheetNames[K]]||{})["!ref"]&&Hn(P,27,Y(k.SheetNames[K],ne++));var J=0;for(K=0;K<k.SheetNames.length;++K){var ie=k.Sheets[k.SheetNames[K]];if(!(!ie||!ie["!ref"])){for(var oe=Nt(ie["!ref"]),Se=Array.isArray(ie),W=[],Ne=Math.min(oe.e.r,8191),ke=oe.s.r;ke<=Ne;++ke)for(var Xe=ir(ke),Oe=oe.s.c;Oe<=oe.e.c;++Oe){ke===oe.s.r&&(W[Oe]=Ht(Oe));var me=W[Oe]+Xe,tt=Se?(ie[ke]||[])[Oe]:ie[me];if(!(!tt||tt.t=="z"))if(tt.t=="n")Hn(P,23,F(ke,Oe,J,tt.v));else{var cr=ms(tt);Hn(P,22,b(ke,Oe,J,cr.slice(0,239)))}}++J}}return Hn(P,1),P.end()}function s(k){var I=Ut(2);return I.write_shift(2,k),I}function i(k){var I=Ut(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var N=0,P=0,K=0,ne=0;ne<k.SheetNames.length;++ne){var J=k.SheetNames[ne],ie=k.Sheets[J];if(!(!ie||!ie["!ref"])){++K;var oe=sc(ie["!ref"]);N<oe.e.r&&(N=oe.e.r),P<oe.e.c&&(P=oe.e.c)}}return N>8191&&(N=8191),I.write_shift(2,N),I.write_shift(1,K),I.write_shift(1,P),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(k,I,N){var P={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&N.qpro?(P.s.c=k.read_shift(1),k.l++,P.s.r=k.read_shift(2),P.e.c=k.read_shift(1),k.l++,P.e.r=k.read_shift(2),P):(P.s.c=k.read_shift(2),P.s.r=k.read_shift(2),I==12&&N.qpro&&(k.l+=2),P.e.c=k.read_shift(2),P.e.r=k.read_shift(2),I==12&&N.qpro&&(k.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(k){var I=Ut(8);return I.write_shift(2,k.s.c),I.write_shift(2,k.s.r),I.write_shift(2,k.e.c),I.write_shift(2,k.e.r),I}function c(k,I,N){var P=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(P[0].c=k.read_shift(1),P[3]=k.read_shift(1),P[0].r=k.read_shift(2),k.l+=2):(P[2]=k.read_shift(1),P[0].c=k.read_shift(2),P[0].r=k.read_shift(2)),P}function f(k,I,N){var P=k.l+I,K=c(k,I,N);if(K[1].t="s",N.vers==20768){k.l++;var ne=k.read_shift(1);return K[1].v=k.read_shift(ne,"utf8"),K}return N.qpro&&k.l++,K[1].v=k.read_shift(P-k.l,"cstr"),K}function d(k,I,N){var P=Ut(7+N.length);P.write_shift(1,255),P.write_shift(2,I),P.write_shift(2,k),P.write_shift(1,39);for(var K=0;K<P.length;++K){var ne=N.charCodeAt(K);P.write_shift(1,ne>=128?95:ne)}return P.write_shift(1,0),P}function h(k,I,N){var P=c(k,I,N);return P[1].v=k.read_shift(2,"i"),P}function m(k,I,N){var P=Ut(7);return P.write_shift(1,255),P.write_shift(2,I),P.write_shift(2,k),P.write_shift(2,N,"i"),P}function v(k,I,N){var P=c(k,I,N);return P[1].v=k.read_shift(8,"f"),P}function p(k,I,N){var P=Ut(13);return P.write_shift(1,255),P.write_shift(2,I),P.write_shift(2,k),P.write_shift(8,N,"f"),P}function _(k,I,N){var P=k.l+I,K=c(k,I,N);if(K[1].v=k.read_shift(8,"f"),N.qpro)k.l=P;else{var ne=k.read_shift(2);w(k.slice(k.l,k.l+ne),K),k.l+=ne}return K}function g(k,I,N){var P=I&32768;return I&=-32769,I=(P?k:0)+(I>=8192?I-16384:I),(P?"":"$")+(N?Ht(I):ir(I))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(k,I){rr(k,0);for(var N=[],P=0,K="",ne="",J="",ie="";k.l<k.length;){var oe=k[k.l++];switch(oe){case 0:N.push(k.read_shift(8,"f"));break;case 1:ne=g(I[0].c,k.read_shift(2),!0),K=g(I[0].r,k.read_shift(2),!1),N.push(ne+K);break;case 2:{var Se=g(I[0].c,k.read_shift(2),!0),W=g(I[0].r,k.read_shift(2),!1);ne=g(I[0].c,k.read_shift(2),!0),K=g(I[0].r,k.read_shift(2),!1),N.push(Se+W+":"+ne+K)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(k.read_shift(2));break;case 6:{for(var Ne="";oe=k[k.l++];)Ne+=String.fromCharCode(oe);N.push('"'+Ne.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:ie=N.pop(),J=N.pop(),N.push(["AND","OR"][oe-20]+"("+J+","+ie+")");break;default:if(oe<32&&x[oe])ie=N.pop(),J=N.pop(),N.push(J+x[oe]+ie);else if(y[oe]){if(P=y[oe][1],P==69&&(P=k[k.l++]),P>N.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+N.join("|")+"|");return}var ke=N.slice(-P);N.length-=P,N.push(y[oe][0]+"("+ke.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}N.length==1?I[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function E(k){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=k.read_shift(2),I[3]=k[k.l++],I[0].c=k[k.l++],I}function S(k,I){var N=E(k);return N[1].t="s",N[1].v=k.read_shift(I-4,"cstr"),N}function b(k,I,N,P){var K=Ut(6+P.length);K.write_shift(2,k),K.write_shift(1,N),K.write_shift(1,I),K.write_shift(1,39);for(var ne=0;ne<P.length;++ne){var J=P.charCodeAt(ne);K.write_shift(1,J>=128?95:J)}return K.write_shift(1,0),K}function T(k,I){var N=E(k);N[1].v=k.read_shift(2);var P=N[1].v>>1;if(N[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return N[1].v=P,N}function C(k,I){var N=E(k),P=k.read_shift(4),K=k.read_shift(4),ne=k.read_shift(2);if(ne==65535)return P===0&&K===3221225472?(N[1].t="e",N[1].v=15):P===0&&K===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var J=ne&32768;return ne=(ne&32767)-16446,N[1].v=(1-J*2)*(K*Math.pow(2,ne+32)+P*Math.pow(2,ne)),N}function F(k,I,N,P){var K=Ut(14);if(K.write_shift(2,k),K.write_shift(1,N),K.write_shift(1,I),P==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ne=0,J=0,ie=0,oe=0;return P<0&&(ne=1,P=-P),J=Math.log2(P)|0,P/=Math.pow(2,J-31),oe=P>>>0,oe&2147483648||(P/=2,++J,oe=P>>>0),P-=oe,oe|=2147483648,oe>>>=0,P*=Math.pow(2,32),ie=P>>>0,K.write_shift(4,ie),K.write_shift(4,oe),J+=16383+(ne?32768:0),K.write_shift(2,J),K}function M(k,I){var N=C(k);return k.l+=I-14,N}function j(k,I){var N=E(k),P=k.read_shift(4);return N[1].v=P>>6,N}function A(k,I){var N=E(k),P=k.read_shift(8,"f");return N[1].v=P,N}function G(k,I){var N=A(k);return k.l+=I-10,N}function X(k,I){return k[k.l+I-1]==0?k.read_shift(I,"cstr"):""}function H(k,I){var N=k[k.l++];N>I-1&&(N=I-1);for(var P="";P.length<N;)P+=String.fromCharCode(k[k.l++]);return P}function q(k,I,N){if(!(!N.qpro||I<21)){var P=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var K=k.read_shift(I-21,"cstr");return[P,K]}}function Z(k,I){for(var N={},P=k.l+I;k.l<P;){var K=k.read_shift(2);if(K==14e3){for(N[K]=[0,""],N[K][0]=k.read_shift(2);k[k.l];)N[K][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return N}function Y(k,I){var N=Ut(5+k.length);N.write_shift(2,14e3),N.write_shift(2,I);for(var P=0;P<k.length;++P){var K=k.charCodeAt(P);N[N.l++]=K>127?95:K}return N[N.l++]=0,N}var ce={0:{n:"BOF",f:It},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:H},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:A},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function pie(e){var t={},r=e.match(Tr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Te(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=my[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var mie=function(){var e=ef("t"),t=ef("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:ze(i[1])},l=s.match(t);return l&&(o.s=pie(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),vie=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),gie=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xie=/<(?:\w+:)?r>/,yie=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function jy(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ze(st(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=st(e),r&&(n.h=by(n.t))):e.match(xie)&&(n.r=st(e),n.t=ze(st((e.replace(yie,"").match(gie)||[]).join("").replace(Tr,""))),r&&(n.h=vie(mie(n.r)))),n):{t:""}}var _ie=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wie=/<(?:\w+:)?(?:si|sstItem)>/g,bie=/<\/(?:\w+:)?(?:si|sstItem)>/;function Sie(e,t){var r=[],n="";if(!e)return r;var a=e.match(_ie);if(a){n=a[2].replace(wie,"").split(bie);for(var s=0;s!=n.length;++s){var i=jy(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Te(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function Eie(e){return[e.read_shift(4),e.read_shift(4)]}function kie(e,t){var r=[],n=!1;return bs(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function WA(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function as(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Tie(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=as(e,4),t.U=as(e,4),t.W=as(e,4),t}function Cie(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Nie(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Cie(e));return t}function Aie(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Oie(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=as(e,4),t.U=as(e,4),t.W=as(e,4),t}function Die(e){var t=Oie(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function VA(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function HA(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function jie(e){var t=as(e);switch(t.Minor){case 2:return[t.Minor,Pie(e)];case 3:return[t.Minor,Fie()];case 4:return[t.Minor,Rie(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Pie(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=VA(e,r),a=HA(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Fie(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Rie(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Tr,function(s){var i=Te(s);switch(Ia(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Mie(e,t){var r={},n=r.EncryptionVersionInfo=as(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=VA(e,a),t-=a,r.EncryptionVerifier=HA(e,t),r}function Iie(e){var t={},r=t.EncryptionVersionInfo=as(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Lie(e){var t=0,r,n=WA(e),a=n.length+1,s,i,o,l,c;for(r=li(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var zA=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=WA(i),l=s(o),c=o.length,f=li(16),d=0;d!=16;++d)f[d]=0;var h,m,v;for((c&1)===1&&(h=l>>8,f[c]=a(e[0],h),--c,h=l&255,m=o[o.length-1],f[c]=a(m,h));c>0;)--c,h=l>>8,f[c]=a(o[c],h),--c,h=l&255,f[c]=a(o[c],h);for(c=15,v=15-o.length;v>0;)h=l>>8,f[c]=a(e[v],h),--c,--v,h=l&255,f[c]=a(o[c],h),--c,--v;return f}}(),$ie=function(e,t,r,n,a){a||(a=t),n||(n=zA(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},Uie=function(e){var t=0,r=zA(e);return function(n){var a=$ie("",n,t,r);return t=a[1],a[0]}};function Bie(e,t,r,n){var a={key:It(e),verificationBytes:It(e)};return r.password&&(a.verifier=Lie(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Uie(r.password)),a}function Wie(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Iie(e):n.Data=Mie(e,t),n}function Vie(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Wie(e,t-2,n):Bie(e,r.biff>=8?t:t-2,r,n),n}var Hie=function(){function e(a,s){switch(s.type){case"base64":return t(cn(a),s);case"binary":return t(a,s);case"buffer":return t($e&&Buffer.isBuffer(a)?a.toString("binary"):xo(a),s);case"array":return t(so(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,m=0,v,p=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var _=f.slice(m,h.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++p,_.length){var g={v:_,t:"s"};Array.isArray(o)?o[d][p]=g:o[Ae({r:d,c:p})]=g}break}m=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=Be(c),o}function r(a,s){return yi(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Nt(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Ae({r:c,c:f});o=l?(a[c]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ms(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function zie(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Yie(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function Gie(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function oh(e,t){if(t===0)return e;var r=Yie(zie(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),nf(Gie(r))}var YA=6,Kie=15,qie=1,Or=YA;function lh(e){return Math.floor((e+Math.round(128/Or)/256)*Or)}function ch(e){return Math.floor((e-5)/Or*100+.5)/100}function jg(e){return Math.round((e*Or+5)/Or*256)/256}function Vm(e){return jg(ch(lh(e)))}function Py(e){var t=Math.abs(e-Vm(e)),r=Or;if(t>.005)for(Or=qie;Or<Kie;++Or)Math.abs(e-Vm(e))<=t&&(t=Math.abs(e-Vm(e)),r=Or);Or=r}function jl(e){e.width?(e.wpx=lh(e.width),e.wch=ch(e.wpx),e.MDW=Or):e.wpx?(e.wch=ch(e.wpx),e.width=jg(e.wch),e.MDW=Or):typeof e.wch=="number"&&(e.width=jg(e.wch),e.wpx=lh(e.width),e.MDW=Or),e.customWidth&&delete e.customWidth}var Xie=96,GA=Xie;function KA(e){return e*96/GA}function af(e){return e*GA/96}var Jie={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Qie(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Te(i);switch(Ia(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=mt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=mt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function Zie(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Te(i);switch(Ia(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function eoe(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Te(i);switch(Ia(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=st(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?mt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?mt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?mt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?mt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?mt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?mt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?mt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=my[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=mt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Vi[a.color.index];a.color.index==81&&(l=Vi[1]),l||(l=Vi[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=oh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function toe(e,t,r){t.NumberFmt=[];for(var n=ja(je),a=0;a<n.length;++a)t.NumberFmt[n[a]]=je[n[a]];var s=e[0].match(Tr);if(s)for(a=0;a<s.length;++a){var i=Te(s[a]);switch(Ia(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ze(st(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Wi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Dd=["numFmtId","fillId","fontId","borderId","xfId"],jd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function roe(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Tr)||[]).forEach(function(s){var i=Te(s),o=0;switch(Ia(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Dd.length;++o)n[Dd[o]]&&(n[Dd[o]]=parseInt(n[Dd[o]],10));for(o=0;o<jd.length;++o)n[jd[o]]&&(n[jd[o]]=mt(n[jd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=mt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var noe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&toe(d,f,c),(d=o.match(a))&&eoe(d,f,l,c),(d=o.match(n))&&Zie(d,f,l,c),(d=o.match(s))&&Qie(d,f,l,c),(d=o.match(r))&&roe(d,f,c),f}}();function aoe(e,t){var r=e.read_shift(2),n=_r(e);return[r,n]}function soe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=mae(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=pae(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_r(e),n}var ioe=br;function ooe(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var loe=br;function coe(e,t,r){var n={};n.NumberFmt=[];for(var a in je)n.NumberFmt[a]=je[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return bs(e,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Wi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=oh(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var uoe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function foe(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Tr)||[]).forEach(function(a){var s=Te(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[uoe.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function doe(){}function hoe(){}var poe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,moe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,voe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function goe(e,t,r){t.themeElements={};var n;[["clrScheme",poe,foe],["fontScheme",moe,doe],["fmtScheme",voe,hoe]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var xoe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function qA(e,t){(!e||e.length===0)&&(e=yoe());var r,n={};if(!(r=e.match(xoe)))throw new Error("themeElements not found in theme");return goe(r[0],n,t),n.raw=e,n}function yoe(e,t){var r=[iA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function _oe(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=sA(s,{type:"array"})}catch{return}var o=tn(i,"theme/theme/theme1.xml",!0);if(o)return qA(o,r)}}function woe(e){return e.read_shift(4)}function boe(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Soe(e,4);break;case 2:t.xclrValue=RA(e);break;case 3:t.xclrValue=woe(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Soe(e,t){return br(e,t)}function Eoe(e,t){return br(e,t)}function koe(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=boe(e);break;case 6:n[1]=Eoe(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Toe(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(koe(e,r-e.l));return{ixfe:n,ext:s}}function Coe(e,t){t.forEach(function(r){switch(r[0]){}})}function Noe(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:_r(e)}}function Aoe(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Ooe(e){return e.l+=4,e.read_shift(4)!=0}function Doe(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return bs(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function joe(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Tr,function(o){var l=Te(o);switch(Ia(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Poe(e){var t=[];if(!e)return t;var r=1;return(e.match(Tr)||[]).forEach(function(n){var a=Te(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Foe(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ae(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Roe(e,t,r){var n=[];return bs(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Moe(e,t,r,n){if(!e)return e;var a=n||{},s=!1;bs(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function Ioe(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function yS(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Dr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=Nt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Be(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function Loe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Te(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Dr(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&jy(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function $oe(e,t){var r=[],n=!1,a={},s=0;return e.replace(Tr,function(o,l){var c=Te(o);switch(Ia(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Uoe(e,t){var r=[],n=!1;return e.replace(Tr,function(s){var i=Te(s);switch(Ia(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function Boe(e){var t={};t.iauthor=e.read_shift(4);var r=_o(e);return t.rfx=r.s,t.ref=Ae(r.s),e.l+=16,t}var Woe=_r;function Voe(e,t){var r=[],n=[],a={},s=!1;return bs(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Hoe="application/vnd.ms-office.vbaProject";function zoe(e){var t=Ue.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ue.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ue.write(t)}function Yoe(){return{"!type":"dialog"}}function Goe(){return{"!type":"dialog"}}function Koe(){return{"!type":"macro"}}function qoe(){return{"!type":"macro"}}var hl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,a+(o?"":"$")+Ht(f)+(l?"":"$")+ir(c)}return function(a,s){return t=s,a.replace(e,r)}}(),XA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xoe=function(){return function(t,r){return t.replace(XA,function(n,a,s,i,o,l){var c=Ty(i)-(s?0:r.c),f=ky(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+h})}}();function JA(e,t){return e.replace(XA,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Ht(Ty(s)+t.c))+(i=="$"?i+o:ir(ky(o)+t.r))})}function Joe(e,t,r){var n=sc(t),a=n.s,s=Dr(r),i={r:s.r-a.r,c:s.c-a.c};return JA(e,i)}function Qoe(e){return e.length!=1}function _S(e){return e.replace(/_xlfn\./g,"")}function Rt(e){e.l+=1}function ci(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function QA(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ZA(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=ci(e),o=ci(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ZA(e){var t=ci(e),r=ci(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Zoe(e,t,r){if(r.biff<8)return ZA(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=ci(e),i=ci(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function eO(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return ele(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ci(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function ele(e){var t=ci(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function tle(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function rle(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return nle(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function nle(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function ale(e,t,r){var n=(e[e.l++]&96)>>5,a=QA(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function sle(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=QA(e,s,r);return[n,a,i]}function ile(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ole(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function lle(e,t,r){var n=(e[e.l++]&96)>>5,a=Zoe(e,t-1,r);return[n,a]}function cle(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function wS(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function ule(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function fle(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function dle(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function hle(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function ple(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function tO(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function mle(e){return e.read_shift(2),tO(e)}function vle(e){return e.read_shift(2),tO(e)}function gle(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=eO(e,0,r);return[n,a]}function xle(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=rle(e,0,r);return[n,a]}function yle(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=eO(e,0,r);return[n,a,s]}function _le(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[wce[a],aO[a],n]}function wle(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:ble(e);return[a,(s[0]===0?aO:_ce)[s[1]]]}function ble(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Sle(e,t,r){e.l+=r&&r.biff==2?3:4}function Ele(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function kle(e){return e.l++,wo[e.read_shift(1)]}function Tle(e){return e.l++,e.read_shift(2)}function Cle(e){return e.l++,e.read_shift(1)!==0}function Nle(e){return e.l++,gr(e)}function Ale(e,t,r){return e.l++,If(e,t-1,r)}function Ole(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ot(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=wo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=gr(e);break;case 2:r[1]=bo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Dle(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?_o:kp)(e));return a}function jle(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=Ole(e,r.biff);return i}function Ple(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Fle(e,t,r){if(r.biff==5)return Rle(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function Rle(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Mle(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Ile(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Lle(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function $le(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Ule=br,Ble=br,Wle=br;function $f(e,t,r){return e.l+=2,[tle(e)]}function Fy(e){return e.l+=6,[]}var Vle=$f,Hle=Fy,zle=Fy,Yle=$f;function rO(e){return e.l+=2,[It(e),e.read_shift(2)&1]}var Gle=$f,Kle=rO,qle=Fy,Xle=$f,Jle=$f,Qle=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Zle(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=Qle[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function ece(e){return e.l+=2,[e.read_shift(4)]}function tce(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function rce(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function nce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ace(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sce(e){return e.l+=4,[0,0]}var bS={1:{n:"PtgExp",f:Ele},2:{n:"PtgTbl",f:Wle},3:{n:"PtgAdd",f:Rt},4:{n:"PtgSub",f:Rt},5:{n:"PtgMul",f:Rt},6:{n:"PtgDiv",f:Rt},7:{n:"PtgPower",f:Rt},8:{n:"PtgConcat",f:Rt},9:{n:"PtgLt",f:Rt},10:{n:"PtgLe",f:Rt},11:{n:"PtgEq",f:Rt},12:{n:"PtgGe",f:Rt},13:{n:"PtgGt",f:Rt},14:{n:"PtgNe",f:Rt},15:{n:"PtgIsect",f:Rt},16:{n:"PtgUnion",f:Rt},17:{n:"PtgRange",f:Rt},18:{n:"PtgUplus",f:Rt},19:{n:"PtgUminus",f:Rt},20:{n:"PtgPercent",f:Rt},21:{n:"PtgParen",f:Rt},22:{n:"PtgMissArg",f:Rt},23:{n:"PtgStr",f:Ale},26:{n:"PtgSheet",f:tce},27:{n:"PtgEndSheet",f:rce},28:{n:"PtgErr",f:kle},29:{n:"PtgBool",f:Cle},30:{n:"PtgInt",f:Tle},31:{n:"PtgNum",f:Nle},32:{n:"PtgArray",f:cle},33:{n:"PtgFunc",f:_le},34:{n:"PtgFuncVar",f:wle},35:{n:"PtgName",f:Ple},36:{n:"PtgRef",f:gle},37:{n:"PtgArea",f:ale},38:{n:"PtgMemArea",f:Mle},39:{n:"PtgMemErr",f:Ule},40:{n:"PtgMemNoMem",f:Ble},41:{n:"PtgMemFunc",f:Ile},42:{n:"PtgRefErr",f:Lle},43:{n:"PtgAreaErr",f:ile},44:{n:"PtgRefN",f:xle},45:{n:"PtgAreaN",f:lle},46:{n:"PtgMemAreaN",f:nce},47:{n:"PtgMemNoMemN",f:ace},57:{n:"PtgNameX",f:Fle},58:{n:"PtgRef3d",f:yle},59:{n:"PtgArea3d",f:sle},60:{n:"PtgRefErr3d",f:$le},61:{n:"PtgAreaErr3d",f:ole},255:{}},ice={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oce={1:{n:"PtgElfLel",f:rO},2:{n:"PtgElfRw",f:Xle},3:{n:"PtgElfCol",f:Vle},6:{n:"PtgElfRwV",f:Jle},7:{n:"PtgElfColV",f:Yle},10:{n:"PtgElfRadical",f:Gle},11:{n:"PtgElfRadicalS",f:qle},13:{n:"PtgElfColS",f:Hle},15:{n:"PtgElfColSV",f:zle},16:{n:"PtgElfRadicalLel",f:Kle},25:{n:"PtgList",f:Zle},29:{n:"PtgSxName",f:ece},255:{}},lce={0:{n:"PtgAttrNoop",f:sce},1:{n:"PtgAttrSemi",f:ple},2:{n:"PtgAttrIf",f:dle},4:{n:"PtgAttrChoose",f:ule},8:{n:"PtgAttrGoto",f:fle},16:{n:"PtgAttrSum",f:Sle},32:{n:"PtgAttrBaxcel",f:wS},33:{n:"PtgAttrBaxcel",f:wS},64:{n:"PtgAttrSpace",f:mle},65:{n:"PtgAttrSpaceSemi",f:vle},128:{n:"PtgAttrIfError",f:hle},255:{}};function Uf(e,t,r,n){if(n.biff<8)return br(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=jle(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Dle(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(br(e,t)),s}function Bf(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=bS[s]||bS[ice[s]],(s===24||s===25)&&(a=(s===24?oce:lce)[e[e.l+1]]),!a||!a.f?br(e,t):i.push([a.n,a.f(e,t,r)]);return i}function cce(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var uce={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fce(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function nO(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function SS(e,t,r){var n=nO(e,t,r);return n=="#REF"?n:fce(n,r)}function mr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,f,d=0,h=0,m,v="";if(!e[0]||!e[0][0])return"";for(var p=-1,_="",g=0,y=e[0].length;g<y;++g){var x=e[0][g];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:_=Tt(" ",e[0][p][1][1]);break;case 1:_=Tt("\r",e[0][p][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+_,p=-1}o.push(c+uce[x[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=su(x[1][1],i,a),o.push(iu(f,s));break;case"PtgRefN":f=r?su(x[1][1],r,a):x[1][1],o.push(iu(f,s));break;case"PtgRef3d":d=x[1][1],f=su(x[1][2],i,a),v=SS(n,d,a),o.push(v+"!"+iu(f,s));break;case"PtgFunc":case"PtgFuncVar":var w=x[1][0],E=x[1][1];w||(w=0),w&=127;var S=w==0?[]:o.slice(-w);o.length-=w,E==="User"&&(E=S.shift()),o.push(E+"("+S.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":m=nS(x[1][1],r?{s:r}:i,a),o.push(Bm(m,a));break;case"PtgArea":m=nS(x[1][1],i,a),o.push(Bm(m,a));break;case"PtgArea3d":d=x[1][1],m=x[1][2],v=SS(n,d,a),o.push(v+"!"+Bm(m,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var b=(n.names||[])[h-1]||(n[0]||[])[h],T=b?b.Name:"SH33TJSNAME"+String(h);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var C=x[1][1];h=x[1][2];var F;if(a.biff<=5)C<0&&(C=-C),n[C]&&(F=n[C][h]);else{var M="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][h]&&n[C][h].itab>0&&(M=n.SheetNames[n[C][h].itab-1]+"!"):M=n.SheetNames[h-1]+"!"),n[C]&&n[C][h])M+=n[C][h].Name;else if(n[0]&&n[0][h])M+=n[0][h].Name;else{var j=(nO(n,C,a)||"").split(";;");j[h-1]?M=j[h-1]:M+="SH33TJSERRX"}o.push(M);break}F||(F={Name:"SH33TJSERRY"}),o.push(F.Name);break;case"PtgParen":var A="(",G=")";if(p>=0){switch(_="",e[0][p][1][0]){case 2:A=Tt(" ",e[0][p][1][1])+A;break;case 3:A=Tt("\r",e[0][p][1][1])+A;break;case 4:G=Tt(" ",e[0][p][1][1])+G;break;case 5:G=Tt("\r",e[0][p][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(A+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[Ae(f)]){var H=n.sharedf[Ae(f)];o.push(mr(H,i,X,n,a))}else{var q=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(mr(c[1],i,X,n,a)),q=!0;break}q||o.push(x[1])}break;case"PtgArray":o.push("{"+cce(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&Z.indexOf(e[0][g][0])==-1){x=e[0][p];var Y=!0;switch(x[1][0]){case 4:Y=!1;case 0:_=Tt(" ",x[1][1]);break;case 5:Y=!1;case 1:_=Tt("\r",x[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((Y?_:"")+o.pop()+(Y?"":_)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function dce(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,t-2)];var o=Bf(e,i,r);return t!==i+a&&(s=Uf(e,t-i-a,o,r)),e.l=n,[o,s]}function hce(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,t-2)];var o=Bf(e,i,r);return t!==i+a&&(s=Uf(e,t-i-a,o,r)),e.l=n,[o,s]}function pce(e,t,r,n){var a=e.l+t,s=Bf(e,n,r),i;return a!==e.l&&(i=Uf(e,a-e.l,s,r)),[s,i]}function mce(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Bf(e,s,r);return s==65535?[[],br(e,t-2)]:(t!==s+2&&(a=Uf(e,n-s-2,i,r)),[i,a])}function vce(e){var t;if(Za(e,e.l+6)!==65535)return[gr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Hm(e,t,r){var n=e.l+t,a=La(e);r.biff==2&&++e.l;var s=vce(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=hce(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Tp(e,t,r){var n=e.read_shift(4),a=Bf(e,n,r),s=e.read_shift(4),i=s>0?Uf(e,s,a,r):null;return[a,i]}var gce=Tp,Cp=Tp,xce=Tp,yce=Tp,_ce={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},aO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},wce={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ES(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var uu={},pl={};function fu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function sO(e,t,r,n,a,s){try{n.cellNF&&(e.z=je[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Zt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(je[t]==null&&Wi(bne[t]||"General",t),e.t==="e")e.w=e.w||wo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zu(e.v);else if(e.t==="d"){var i=Fr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Zu(i)}else{if(e.v===void 0)return"";e.w=ao(e.v,pl)}else e.t==="d"?e.w=Fn(t,Fr(e.v),pl):e.w=Fn(t,e.v,pl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=oh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=oh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function bce(e,t){var r=Nt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Be(r))}var Sce=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ece=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,kce=/<(?:\w:)?hyperlink [^>]*>/mg,Tce=/"(\w*:\w*)"/,Cce=/<(?:\w:)?col\b[^>]*[\/]?>/g,Nce=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Ace=/<(?:\w:)?pageMargins[^>]*\/>/g,iO=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Oce=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Dce=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function jce(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(Ece);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var h=c.match(iO);h?Ry(h[0],o,a,r):(h=c.match(Oce))&&Pce(h[0],h[1]||"",o,a,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var v=c.slice(m,m+50).match(Tce);v&&bce(o,v[1])}var p=c.match(Dce);p&&p[1]&&$ce(p[1],a);var _=[];if(t.cellStyles){var g=c.match(Cce);g&&Mce(_,g)}d&&Uce(d[1],o,t,l,s,i);var y=f.match(Nce);y&&(o["!autofilter"]=Ice(y[0]));var x=[],w=f.match(Sce);if(w)for(m=0;m!=w.length;++m)x[m]=Nt(w[m].slice(w[m].indexOf('"')+1));var E=f.match(kce);E&&Fce(o,E,n);var S=f.match(Ace);if(S&&(o["!margins"]=Rce(Te(S[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Be(l)),t.sheetRows>0&&o["!ref"]){var b=Nt(o["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>l.e.r&&(b.e.r=l.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>l.e.c&&(b.e.c=l.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(b))}return _.length>0&&(o["!cols"]=_),x.length>0&&(o["!merges"]=x),o}function Ry(e,t,r,n){var a=Te(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ze(st(a.codeName)))}function Pce(e,t,r,n,a){Ry(e.slice(0,e.indexOf(">")),r,n,a)}function Fce(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Te(st(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+ze(s.location))):(s.Target="#"+ze(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Nt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Ae({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function Rce(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Mce(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Te(t[n],!0);a.hidden&&(a.hidden=mt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Py(a.width)),jl(a);s<=i;)e[s++]=sr(a)}}function Ice(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var Lce=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $ce(e,t){t.Views||(t.Views=[{}]),(e.match(Lce)||[]).forEach(function(r,n){var a=Te(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),mt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var Uce=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=ef("v"),i=ef("f");return function(l,c,f,d,h,m){for(var v=0,p="",_=[],g=[],y=0,x=0,w=0,E="",S,b,T=0,C=0,F,M,j=0,A=0,G=Array.isArray(m.CellXf),X,H=[],q=[],Z=Array.isArray(c),Y=[],ce={},z=!1,k=!!f.sheetStubs,I=l.split(t),N=0,P=I.length;N!=P;++N){p=I[N].trim();var K=p.length;if(K!==0){var ne=0;e:for(v=0;v<K;++v)switch(p[v]){case">":if(p[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(b=Te(p.slice(ne,v),!0),T=b.r!=null?parseInt(b.r,10):T+1,C=-1,f.sheetRows&&f.sheetRows<T)continue;ce={},z=!1,b.ht&&(z=!0,ce.hpt=parseFloat(b.ht),ce.hpx=af(ce.hpt)),b.hidden=="1"&&(z=!0,ce.hidden=!0),b.outlineLevel!=null&&(z=!0,ce.level=+b.outlineLevel),z&&(Y[T-1]=ce)}break;case"<":ne=v;break}if(ne>=v)break;if(b=Te(p.slice(ne,v),!0),T=b.r!=null?parseInt(b.r,10):T+1,C=-1,!(f.sheetRows&&f.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),f&&f.cellStyles&&(ce={},z=!1,b.ht&&(z=!0,ce.hpt=parseFloat(b.ht),ce.hpx=af(ce.hpt)),b.hidden=="1"&&(z=!0,ce.hidden=!0),b.outlineLevel!=null&&(z=!0,ce.level=+b.outlineLevel),z&&(Y[T-1]=ce)),_=p.slice(v).split(e);for(var J=0;J!=_.length&&_[J].trim().charAt(0)=="<";++J);for(_=_.slice(J),v=0;v!=_.length;++v)if(p=_[v].trim(),p.length!==0){if(g=p.match(r),y=v,x=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,g!=null&&g.length===2){for(y=0,E=g[1],x=0;x!=E.length&&!((w=E.charCodeAt(x)-64)<1||w>26);++x)y=26*y+w;--y,C=y}else++C;for(x=0;x!=p.length&&p.charCodeAt(x)!==62;++x);if(++x,b=Te(p.slice(0,x),!0),b.r||(b.r=Ae({r:T-1,c:C})),E=p.slice(x),S={t:""},(g=E.match(s))!=null&&g[1]!==""&&(S.v=ze(g[1])),f.cellFormula){if((g=E.match(i))!=null&&g[1]!==""){if(S.f=ze(st(g[1])).replace(/\r\n/g,`
`),f.xlfn||(S.f=_S(S.f)),g[0].indexOf('t="array"')>-1)S.F=(E.match(a)||[])[1],S.F.indexOf(":")>-1&&H.push([Nt(S.F),S.F]);else if(g[0].indexOf('t="shared"')>-1){M=Te(g[0]);var ie=ze(st(g[1]));f.xlfn||(ie=_S(ie)),q[parseInt(M.si,10)]=[M,ie,b.r]}}else(g=E.match(/<f[^>]*\/>/))&&(M=Te(g[0]),q[M.si]&&(S.f=Joe(q[M.si][1],q[M.si][2],b.r)));var oe=Dr(b.r);for(x=0;x<H.length;++x)oe.r>=H[x][0].s.r&&oe.r<=H[x][0].e.r&&oe.c>=H[x][0].s.c&&oe.c<=H[x][0].e.c&&(S.F=H[x][1])}if(b.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(k)S.t="z";else continue;else S.t=b.t||"n";switch(d.s.c>C&&(d.s.c=C),d.e.c<C&&(d.e.c=C),S.t){case"n":if(S.v==""||S.v==null){if(!k)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!k)continue;S.t="z"}else F=uu[parseInt(S.v,10)],S.v=F.t,S.r=F.r,f.cellHTML&&(S.h=F.h);break;case"str":S.t="s",S.v=S.v!=null?st(S.v):"",f.cellHTML&&(S.h=by(S.v));break;case"inlineStr":g=E.match(n),S.t="s",g!=null&&(F=jy(g[1]))?(S.v=F.t,f.cellHTML&&(S.h=F.h)):S.v="";break;case"b":S.v=mt(S.v);break;case"d":f.cellDates?S.v=Zt(S.v,1):(S.v=Fr(Zt(S.v,1)),S.t="n");break;case"e":(!f||f.cellText!==!1)&&(S.w=S.v),S.v=CA[S.v];break}if(j=A=0,X=null,G&&b.s!==void 0&&(X=m.CellXf[b.s],X!=null&&(X.numFmtId!=null&&(j=X.numFmtId),f.cellStyles&&X.fillId!=null&&(A=X.fillId))),sO(S,j,A,f,h,m),f.cellDates&&G&&S.t=="n"&&ac(je[j])&&(S.t="d",S.v=Ep(S.v)),b.cm&&f.xlmeta){var Se=(f.xlmeta.Cell||[])[+b.cm-1];Se&&Se.type=="XLDAPR"&&(S.D=!0)}if(Z){var W=Dr(b.r);c[W.r]||(c[W.r]=[]),c[W.r][W.c]=S}else c[b.r]=S}}}}Y.length>0&&(c["!rows"]=Y)}}();function Bce(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var Wce=_o;function Vce(){}function Hce(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=dae(e),r}function zce(e){var t=$n(e);return[t]}function Yce(e){var t=yo(e);return[t]}function Gce(e){var t=$n(e),r=e.read_shift(1);return[t,r,"b"]}function Kce(e){var t=yo(e),r=e.read_shift(1);return[t,r,"b"]}function qce(e){var t=$n(e),r=e.read_shift(1);return[t,r,"e"]}function Xce(e){var t=yo(e),r=e.read_shift(1);return[t,r,"e"]}function Jce(e){var t=$n(e),r=e.read_shift(4);return[t,r,"s"]}function Qce(e){var t=yo(e),r=e.read_shift(4);return[t,r,"s"]}function Zce(e){var t=$n(e),r=gr(e);return[t,r,"n"]}function oO(e){var t=yo(e),r=gr(e);return[t,r,"n"]}function eue(e){var t=$n(e),r=Ay(e);return[t,r,"n"]}function tue(e){var t=yo(e),r=Ay(e);return[t,r,"n"]}function rue(e){var t=$n(e),r=Cy(e);return[t,r,"is"]}function nue(e){var t=$n(e),r=_r(e);return[t,r,"str"]}function aue(e){var t=yo(e),r=_r(e);return[t,r,"str"]}function sue(e,t,r){var n=e.l+t,a=$n(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=Cp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function iue(e,t,r){var n=e.l+t,a=$n(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=Cp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function oue(e,t,r){var n=e.l+t,a=$n(e);a.r=r["!row"];var s=gr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=Cp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function lue(e,t,r){var n=e.l+t,a=$n(e);a.r=r["!row"];var s=_r(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=Cp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}var cue=_o;function uue(e,t){var r=e.l+t,n=_o(e),a=Ny(e),s=_r(e),i=_r(e),o=_r(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function fue(){}function due(e,t,r){var n=e.l+t,a=EA(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=gce(e,n-e.l,r);i[1]=o}else e.l=n;return i}function hue(e,t,r){var n=e.l+t,a=_o(e),s=[a];if(r.cellFormula){var i=yce(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var pue=["left","right","top","bottom","header","footer"];function mue(e){var t={};return pue.forEach(function(r){t[r]=gr(e)}),t}function vue(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function gue(){}function xue(){}function yue(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,m,v,p,_,g,y,x,w,E,S=[];o.biff=12,o["!row"]=0;var b=0,T=!1,C=[],F={},M=o.supbooks||a.supbooks||[[]];if(M.sharedf=F,M.arrayf=C,M.SheetNames=a.SheetNames||a.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=M,a.Names))for(var j=0;j<a.Names.length;++j)M[0][j+1]=a.Names[j];var A=[],G=[],X=!1;uh[16]={n:"BrtShortReal",f:oO};var H;if(bs(e,function(Y,ce,z){if(!h)switch(z){case 148:c=Y;break;case 0:m=Y,o.sheetRows&&o.sheetRows<=m.r&&(h=!0),w=ir(_=m.r),o["!row"]=m.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=af(Y.hpt)),G[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:Y[2]},Y[2]){case"n":v.v=Y[1];break;case"s":x=uu[Y[1]],v.v=x.t,v.r=x.r;break;case"b":v.v=!!Y[1];break;case"e":v.v=Y[1],o.cellText!==!1&&(v.w=wo[v.v]);break;case"str":v.t="s",v.v=Y[1];break;case"is":v.t="s",v.v=Y[1].t;break}if((p=i.CellXf[Y[0].iStyleRef])&&sO(v,p.numFmtId,null,o,s,i),g=Y[0].c==-1?g+1:Y[0].c,o.dense?(l[_]||(l[_]=[]),l[_][g]=v):l[Ht(g)+w]=v,o.cellFormula){for(T=!1,b=0;b<C.length;++b){var k=C[b];m.r>=k[0].s.r&&m.r<=k[0].e.r&&g>=k[0].s.c&&g<=k[0].e.c&&(v.F=Be(k[0]),T=!0)}!T&&Y.length>3&&(v.f=Y[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>g&&(f.s.c=g),f.e.r<m.r&&(f.e.r=m.r),f.e.c<g&&(f.e.c=g),o.cellDates&&p&&v.t=="n"&&ac(je[p.numFmtId])){var I=Mi(v.v);I&&(v.t="d",v.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}H&&(H.type=="XLDAPR"&&(v.D=!0),H=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;v={t:"z",v:void 0},g=Y[0].c==-1?g+1:Y[0].c,o.dense?(l[_]||(l[_]=[]),l[_][g]=v):l[Ht(g)+w]=v,f.s.r>m.r&&(f.s.r=m.r),f.s.c>g&&(f.s.c=g),f.e.r<m.r&&(f.e.r=m.r),f.e.c<g&&(f.e.c=g),H&&(H.type=="XLDAPR"&&(v.D=!0),H=void 0);break;case 176:S.push(Y);break;case 49:H=((o.xlmeta||{}).Cell||[])[Y-1];break;case 494:var N=n["!id"][Y.relId];for(N?(Y.Target=N.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=N):Y.relId==""&&(Y.Target="#"+Y.loc),_=Y.rfx.s.r;_<=Y.rfx.e.r;++_)for(g=Y.rfx.s.c;g<=Y.rfx.e.c;++g)o.dense?(l[_]||(l[_]=[]),l[_][g]||(l[_][g]={t:"z",v:void 0}),l[_][g].l=Y):(y=Ae({c:g,r:_}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=Y);break;case 426:if(!o.cellFormula)break;C.push(Y),E=o.dense?l[_][g]:l[Ht(g)+w],E.f=mr(Y[1],f,{r:m.r,c:g},M,o),E.F=Be(Y[0]);break;case 427:if(!o.cellFormula)break;F[Ae(Y[0].s)]=Y[1],E=o.dense?l[_][g]:l[Ht(g)+w],E.f=mr(Y[1],f,{r:m.r,c:g},M,o);break;case 60:if(!o.cellStyles)break;for(;Y.e>=Y.s;)A[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},X||(X=!0,Py(Y.w/256)),jl(A[Y.e+1]);break;case 161:l["!autofilter"]={ref:Be(Y)};break;case 476:l["!margins"]=Y;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),Y.name&&(a.Sheets[r].CodeName=Y.name),(Y.above||Y.left)&&(l["!outline"]={above:Y.above,left:Y.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Y.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ce.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+z.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Be(c||f)),o.sheetRows&&l["!ref"]){var q=Nt(l["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>f.e.r&&(q.e.r=f.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>f.e.c&&(q.e.c=f.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Be(q))}return S.length>0&&(l["!merges"]=S),A.length>0&&(l["!cols"]=A),G.length>0&&(l["!rows"]=G),l}function _ue(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function wue(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=_ue(d);f.s.r=f.s.c=0,f.e.c=o,c=Ht(o),h[0].forEach(function(m,v){i[c+ir(v)]={t:"n",v:m,z:h[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=Be(f)),i}function bue(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(iO);return o&&Ry(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Sue(e,t){e.l+=10;var r=_r(e);return{name:r}}function Eue(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return bs(e,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var lO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],kue=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Tue=[],Cue=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kS(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=mt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function TS(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=mt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function cO(e){TS(e.WBProps,lO),TS(e.CalcPr,Cue),kS(e.WBView,kue),kS(e.Sheets,Tue),pl.date1904=mt(e.WBProps.date1904)}var Nue="][*?/\\".split("");function Aue(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Nue.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Oue=/<\w+:workbook/;function Due(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Tr,function(l,c){var f=Te(l);switch(Ia(f[0])){case"<?xml":break;case"<workbook":l.match(Oue)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":lO.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=mt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=st(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=ze(st(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=st(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),mt(f.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=ze(st(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),qne.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return cO(r),r}function jue(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ag(e),r.name=_r(e),r}function Pue(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?_r(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Fue(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Rue(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=hae(e),i=xce(e,0,r),o=Ny(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function Mue(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],uh[16]={n:"BrtFRTArchID$",f:Fue},bs(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=mr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),cO(r),r.Names=s,r.supbooks=i,r}function Iue(e,t,r){return t.slice(-4)===".bin"?Mue(e,r):Due(e,r)}function Lue(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?yue(e,n,r,a,s,i,o):jce(e,n,r,a,s,i,o)}function $ue(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Eue(e,n,r,a,s):bue(e,n,r,a,s)}function Uue(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Koe():qoe()}function Bue(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Yoe():Goe()}function Wue(e,t,r,n){return t.slice(-4)===".bin"?coe(e,r,n):noe(e,r,n)}function Vue(e,t,r){return qA(e,r)}function Hue(e,t,r){return t.slice(-4)===".bin"?kie(e,r):Sie(e,r)}function zue(e,t,r){return t.slice(-4)===".bin"?Voe(e,r):Loe(e,r)}function Yue(e,t,r){return t.slice(-4)===".bin"?Roe(e):Poe(e)}function Gue(e,t,r,n){return r.slice(-4)===".bin"?Moe(e,t,r,n):void 0}function Kue(e,t,r){return t.slice(-4)===".bin"?Doe(e,t,r):joe(e,t,r)}var uO=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,fO=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(uO),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(fO),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function que(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(uO),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(fO),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var du;function Xue(e,t){var r=du[e]||ze(e);return r==="General"?ao(t):Fn(r,t)}function Jue(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Zt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ze(t)]=a}function Que(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||wo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zu(e.v):e.w=ao(e.v):e.w=Xue(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=du[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ac(n)){var a=Mi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function Zue(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Jie[n.Pattern]||n.Pattern)}e[t.ID]=t}function efe(e,t,r,n,a,s,i,o,l,c){var f="General",d=n.StyleID,h={};c=c||{};var m=[],v=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&m.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mt(e);break;case"String":n.t="s",n.r=Kb(ze(e)),n.v=e.indexOf("<")>-1?ze(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Zt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ze(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=CA[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Kb(t||e));break}if(Que(n,f,c),c.cellFormula!==!1)if(n.Formula){var p=ze(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=hl(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=hl("RC:RC",a):n.ArrayRange&&(n.F=hl(n.ArrayRange,a),l.push([Nt(n.F),n.F]))}else for(v=0;v<l.length;++v)a.r>=l[v][0].s.r&&a.r<=l[v][0].e.r&&a.c>=l[v][0].s.c&&a.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(m.forEach(function(_){!h.patternType&&_.patternType&&(h.patternType=_.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function tfe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ym(e,t){var r=t||{};Z4();var n=Ic(Sy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=st(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=sr(r);return i.type="string",rf.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){a.indexOf("<"+tt)>=0&&(s=!0)}),s)return ufe(n,r);du={"General Number":"General","General Date":je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":je[15],"Short Date":je[14],"Long Time":je[19],"Medium Time":je[18],"Short Time":je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:je[2],Standard:je[4],Percent:je[10],Scientific:je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},d=[],h=r.dense?[]:{},m="",v={},p={},_=Vn('<Data ss:Type="String">'),g=0,y=0,x=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},S={},b="",T=0,C=[],F={},M={},j=0,A=[],G=[],X={},H=[],q,Z=!1,Y=[],ce=[],z={},k=0,I=0,N={Sheets:[],WBProps:{date1904:!1}},P={};tf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=tf.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?efe(n.slice(g,o.index),b,_,l[l.length-1][0]=="comment"?X:v,{c:y,r:x},E,H[y],p,Y,r):(b="",_=Vn(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(v.c=G),(!r.sheetRows||r.sheetRows>x)&&v.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][y]=v):h[Ht(y)+ir(x)]=v),v.HRef&&(v.l={Target:ze(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(k=y+(parseInt(v.MergeAcross,10)|0),I=x+(parseInt(v.MergeDown,10)|0),C.push({s:{c:y,r:x},e:{c:k,r:I}})),!r.sheetStubs)v.MergeAcross?y=k+1:++y;else if(v.MergeAcross||v.MergeDown){for(var ne=y;ne<=k;++ne)for(var J=x;J<=I;++J)(ne>y||J>x)&&(r.dense?(h[J]||(h[J]=[]),h[J][ne]={t:"z"}):h[Ht(ne)+ir(J)]={t:"z"});y=k+1}else++y;else v=que(o[0]),v.Index&&(y=+v.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),o[0].slice(-2)==="/>"&&++y,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<w.s.r&&(w.s.r=x),x>w.e.r&&(w.e.r=x),o[0].slice(-2)==="/>"&&(p=Vn(o[0]),p.Index&&(x=+p.Index-1)),y=0,++x):(p=Vn(o[0]),p.Index&&(x=+p.Index-1),z={},(p.AutoFitHeight=="0"||p.Height)&&(z.hpx=parseInt(p.Height,10),z.hpt=KA(z.hpx),ce[x]=z),p.Hidden=="1"&&(z.hidden=!0,ce[x]=z));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=Be(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=Be(w))),C.length&&(h["!merges"]=C),H.length>0&&(h["!cols"]=H),ce.length>0&&(h["!rows"]=ce),f[m]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,l.push([o[3],!1]),c=Vn(o[0]),m=ze(c.Name),h=r.dense?[]:{},C=[],Y=[],ce=[],P={name:m,Hidden:0},N.Sheets.push(P);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),H=[],Z=!1}break;case"style":o[1]==="/"?Zue(E,S,r):S=Vn(o[0]);break;case"numberformat":S.nf=ze(Vn(o[0]).Format||"General"),du[S.nf]&&(S.nf=du[S.nf]);for(var ie=0;ie!=392&&je[ie]!=S.nf;++ie);if(ie==392){for(ie=57;ie!=392;++ie)if(je[ie]==null){Wi(S.nf,ie);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(q=Vn(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!Z&&q.wpx>10){Z=!0,Or=YA;for(var oe=0;oe<H.length;++oe)H[oe]&&jl(H[oe])}Z&&jl(q),H[q.Index-1||H.length]=q;for(var Se=0;Se<+q.Span;++Se)H[H.length]=sr(q);break;case"namedrange":if(o[1]==="/")break;N.Names||(N.Names=[]);var W=Te(o[0]),Ne={Name:W.Name,Ref:hl(W.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(Ne.Sheet=N.Sheets.length-1),N.Names.push(Ne);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?b+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=Vn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Lae(F,K,n.slice(j,o.index)):j=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));tfe(X),G.push(X)}else l.push([o[3],!1]),c=Vn(o[0]),X={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=Vn(o[0]);h["!autofilter"]={ref:hl(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return jS(n,r);var Xe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(j,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else j=o.index+o[0].length;break;case"header":h["!margins"]||fu(h["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(h["!margins"].header=+Te(o[0]).Margin);break;case"footer":h["!margins"]||fu(h["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(h["!margins"].footer=+Te(o[0]).Margin);break;case"pagemargins":var Oe=Te(o[0]);h["!margins"]||fu(h["!margins"]={},"xlml"),isNaN(+Oe.Top)||(h["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(h["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(h["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(h["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Jue(M,K,A,n.slice(j,o.index)):(A=o,j=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=f),me.SheetNames=d,me.Workbook=N,me.SSF=sr(je),me.Props=F,me.Custprops=M,me}function Pg(e,t){switch(Ly(t=t||{}),t.type||"base64"){case"base64":return Ym(cn(e),t);case"binary":case"buffer":case"file":return Ym(e,t);case"array":return Ym(xo(e),t)}}function rfe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=vae(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=gae(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nfe=[60,1084,2066,2165,2175];function afe(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Za(r,r.l),c=Fg[l],f=0;c!=null&&nfe.indexOf(l)>-1;)s=Za(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,c=Fg[l=Za(r,r.l)];var d=Is(i);rr(d,0);var h=0;d.lens=[];for(var m=0;m<i.length;++m)d.lens.push(h),h+=i[m].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function pa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=je[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||wo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zu(e.v):e.w=ao(e.v):e.w=Fn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ac(je[n]||String(n))){var a=Mi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Pd(e,t,r){return{v:e,ixfe:t,t:r}}function sfe(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",f={},d,h="",m,v,p,_,g={},y=[],x,w,E=[],S=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},C=function(Re){return Re<8?Vi[Re]:Re<64&&S[Re-8]||Vi[Re]},F=function(Re,At,mn){var $t=At.XF.data;if(!(!$t||!$t.patternType||!mn||!mn.cellStyles)){At.s={},At.s.patternType=$t.patternType;var wi;(wi=nf(C($t.icvFore)))&&(At.s.fgColor={rgb:wi}),(wi=nf(C($t.icvBack)))&&(At.s.bgColor={rgb:wi})}},M=function(Re,At,mn){if(!(z>1)&&!(mn.sheetRows&&Re.r>=mn.sheetRows)){if(mn.cellStyles&&At.XF&&At.XF.data&&F(Re,At,mn),delete At.ixfe,delete At.XF,d=Re,h=Ae(Re),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<i.s.r&&(i.s.r=Re.r),Re.c<i.s.c&&(i.s.c=Re.c),Re.r+1>i.e.r&&(i.e.r=Re.r+1),Re.c+1>i.e.c&&(i.e.c=Re.c+1),mn.cellFormula&&At.f){for(var $t=0;$t<y.length;++$t)if(!(y[$t][0].s.c>Re.c||y[$t][0].s.r>Re.r)&&!(y[$t][0].e.c<Re.c||y[$t][0].e.r<Re.r)){At.F=Be(y[$t][0]),(y[$t][0].s.c!=Re.c||y[$t][0].s.r!=Re.r)&&delete At.f,At.f&&(At.f=""+mr(y[$t][1],i,Re,Y,j));break}}mn.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=At):a[h]=At}},j={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var A,G=[],X=[],H=[],q=[],Z=!1,Y=[];Y.SheetNames=j.snames,Y.sharedf=j.sharedf,Y.arrayf=j.arrayf,Y.names=[],Y.XTI=[];var ce=0,z=0,k=0,I=[],N=[],P;j.codepage=1200,Jn(1200);for(var K=!1;e.l<e.length-1;){var ne=e.l,J=e.read_shift(2);if(J===0&&ce===10)break;var ie=e.l===e.length?0:e.read_shift(2),oe=Fg[J];if(oe&&oe.f){if(t.bookSheets&&ce===133&&J!==133)break;if(ce=J,oe.r===2||oe.r==12){var Se=e.read_shift(2);if(ie-=2,!j.enc&&Se!==J&&((Se&255)<<8|Se>>8)!==J)throw new Error("rt mismatch: "+Se+"!="+J);oe.r==12&&(e.l+=10,ie-=10)}var W={};if(J===10?W=oe.f(e,ie,j):W=afe(J,oe,e,ie,j),z==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(J){case 34:r.opts.Date1904=b.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(e.l=0),j.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=W;break;case 66:var Ne=Number(W);switch(Ne){case 21010:Ne=1200;break;case 32768:Ne=1e4;break;case 32769:Ne=1252;break}Jn(j.codepage=Ne),K=!0;break;case 317:j.rrtabid=W;break;case 25:j.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:j.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(a["!type"]="dialog"),W.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),W.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:E.push(W);break;case 430:Y.push([W]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(W);break;case 24:case 536:P={Name:W.Name,Ref:mr(W.rgce,i,null,Y,j)},W.itab>0&&(P.Sheet=W.itab-1),Y.names.push(P),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(N[W.itab-1]={ref:Be(W.rgce[0][0][1][2])});break;case 22:j.ExternCount=W;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(W),Y.XTI=Y.XTI.concat(W);break;case 2196:if(j.biff<8)break;P!=null&&(P.Comment=W[1]);break;case 18:a["!protect"]=W;break;case 19:W!==0&&j.WTF&&console.error("Password verifier: "+W);break;case 133:s[W.pos]=W,j.snames.push(W.name);break;case 10:{if(--z)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Be(i),t.sheetRows&&t.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Be(i),i.e.r=ke}i.e.r++,i.e.c++}G.length>0&&(a["!merges"]=G),X.length>0&&(a["!objects"]=X),H.length>0&&(a["!cols"]=H),q.length>0&&(a["!rows"]=q),b.Sheets.push(T)}c===""?f=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),j.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(j.biff=5,K=!0,Jn(j.codepage=28591)),j.biff==8&&W.BIFFVer==0&&W.dt==16&&(j.biff=2),z++)break;if(a=t.dense?[]:{},j.biff<8&&!K&&(K=!0,Jn(j.codepage=t.codepage||1252)),j.biff<5||W.BIFFVer==0&&W.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:e.l-ie,name:c};s[Xe.pos]=Xe,j.snames.push(c)}else c=(s[ne]||{name:""}).name;W.dt==32&&(a["!type"]="chart"),W.dt==64&&(a["!type"]="macro"),G=[],X=[],j.arrayf=y=[],H=[],q=[],Z=!1,T={Hidden:(s[ne]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[W.r]||[])[W.c]:a[Ae({c:W.c,r:W.r})])&&++W.c,x={ixfe:W.ixfe,XF:E[W.ixfe]||{},v:W.val,t:"n"},k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:W.c,r:W.r},x,t);break;case 5:case 517:x={ixfe:W.ixfe,XF:E[W.ixfe],v:W.val,t:W.t},k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:W.c,r:W.r},x,t);break;case 638:x={ixfe:W.ixfe,XF:E[W.ixfe],v:W.rknum,t:"n"},k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:W.c,r:W.r},x,t);break;case 189:for(var Oe=W.c;Oe<=W.C;++Oe){var me=W.rkrec[Oe-W.c][0];x={ixfe:me,XF:E[me],v:W.rkrec[Oe-W.c][1],t:"n"},k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:Oe,r:W.r},x,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){o=W;break}if(x=Pd(W.val,W.cell.ixfe,W.tt),x.XF=E[x.ixfe],t.cellFormula){var tt=W.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var cr=tt[0][0][1][0],gt=tt[0][0][1][1],Ir=Ae({r:cr,c:gt});g[Ir]?x.f=""+mr(W.formula,i,W.cell,Y,j):x.F=((t.dense?(a[cr]||[])[gt]:a[Ir])||{}).F}else x.f=""+mr(W.formula,i,W.cell,Y,j)}k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M(W.cell,x,t),o=W}break;case 7:case 519:if(o)o.val=W,x=Pd(W,o.cell.ixfe,"s"),x.XF=E[x.ixfe],t.cellFormula&&(x.f=""+mr(o.formula,i,o.cell,Y,j)),k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(W);var Ss=Ae(W[0].s);if(m=t.dense?(a[W[0].s.r]||[])[W[0].s.c]:a[Ss],t.cellFormula&&m){if(!o||!Ss||!m)break;m.f=""+mr(W[1],i,W[0],Y,j),m.F=Be(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;g[Ae(o.cell)]=W[0],m=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Ae(o.cell)],(m||{}).f=""+mr(W[0],i,d,Y,j)}}break;case 253:x=Pd(l[W.isst].t,W.ixfe,"s"),l[W.isst].h&&(x.h=l[W.isst].h),x.XF=E[x.ixfe],k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:W.c,r:W.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:W.ixfe,XF:E[W.ixfe],t:"z"},k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:W.c,r:W.r},x,t));break;case 190:if(t.sheetStubs)for(var Un=W.c;Un<=W.C;++Un){var er=W.ixfe[Un-W.c];x={ixfe:er,XF:E[er],t:"z"},k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:Un,r:W.r},x,t)}break;case 214:case 516:case 4:x=Pd(W.val,W.ixfe,"s"),x.XF=E[x.ixfe],k>0&&(x.z=I[x.ixfe>>8&63]),pa(x,t,r.opts.Date1904),M({c:W.c,r:W.r},x,t);break;case 0:case 512:z===1&&(i=W);break;case 252:l=W;break;case 1054:if(j.biff==4){I[k++]=W[1];for(var pn=0;pn<k+163&&je[pn]!=W[1];++pn);pn>=163&&Wi(W[1],k+163)}else Wi(W[1],W[0]);break;case 30:{I[k++]=W;for(var Bn=0;Bn<k+163&&je[Bn]!=W;++Bn);Bn>=163&&Wi(W,k+163)}break;case 229:G=G.concat(W);break;case 93:X[W.cmo[0]]=j.lastobj=W;break;case 438:j.lastobj.TxO=W;break;case 127:j.lastobj.ImData=W;break;case 440:for(_=W[0].s.r;_<=W[0].e.r;++_)for(p=W[0].s.c;p<=W[0].e.c;++p)m=t.dense?(a[_]||[])[p]:a[Ae({c:p,r:_})],m&&(m.l=W[1]);break;case 2048:for(_=W[0].s.r;_<=W[0].e.r;++_)for(p=W[0].s.c;p<=W[0].e.c;++p)m=t.dense?(a[_]||[])[p]:a[Ae({c:p,r:_})],m&&m.l&&(m.l.Tooltip=W[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;m=t.dense?(a[W[0].r]||[])[W[0].c]:a[Ae(W[0])];var Es=X[W[2]];m||(t.dense?(a[W[0].r]||(a[W[0].r]=[]),m=a[W[0].r][W[0].c]={t:"z"}):m=a[Ae(W[0])]={t:"z"},i.e.r=Math.max(i.e.r,W[0].r),i.s.r=Math.min(i.s.r,W[0].r),i.e.c=Math.max(i.e.c,W[0].c),i.s.c=Math.min(i.s.c,W[0].c)),m.c||(m.c=[]),v={a:W[1],t:Es.TxO.t},m.c.push(v)}break;case 2173:Coe(E[W.ixfe],W.ext);break;case 125:{if(!j.cellStyles)break;for(;W.e>=W.s;)H[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},Z||(Z=!0,Py(W.w/256)),jl(H[W.e+1])}break;case 520:{var Kt={};W.level!=null&&(q[W.r]=Kt,Kt.level=W.level),W.hidden&&(q[W.r]=Kt,Kt.hidden=!0),W.hpt&&(q[W.r]=Kt,Kt.hpt=W.hpt,Kt.hpx=af(W.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||fu(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=W;break;case 161:a["!margins"]||fu(a["!margins"]={}),a["!margins"].header=W.header,a["!margins"].footer=W.footer;break;case 574:W.RTL&&(b.Views[0].RTL=!0);break;case 146:S=W;break;case 2198:A=W;break;case 140:w=W;break;case 442:c?T.CodeName=W||T.name:b.WBProps.CodeName=W||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=ie}return r.SheetNames=ja(s).sort(function(da,Re){return Number(da)-Number(Re)}).map(function(da){return s[da].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&N.forEach(function(da,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=da}),r.Strings=l,r.SSF=sr(je),j.enc&&(r.Encryption=j.enc),A&&(r.Themes=A),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),Y.names.length>0&&(b.Names=Y.names),r.Workbook=b,r}var CS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ife(e,t,r){var n=Ue.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=uS(n,Sae,CS.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Ue.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=uS(i,Eae,CS.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(AA(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function dO(e,t){t||(t={}),Ly(t),B4(),t.codepage&&vy(t.codepage);var r,n;if(e.FullPaths){if(Ue.find(e,"/encryption"))throw new Error("File is password-protected");r=Ue.find(e,"!CompObj"),n=Ue.find(e,"/Workbook")||Ue.find(e,"/Book")}else{switch(t.type){case"base64":e=qn(cn(e));break;case"binary":e=qn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}rr(e,0),n={content:e}}var a,s;if(r&&rfe(r),t.bookProps&&!t.bookSheets)a={};else{var i=$e?"buffer":"array";if(n&&n.content)a=sfe(n.content,t);else if((s=Ue.find(e,"PerfectOffice_MAIN"))&&s.content)a=cu.to_workbook(s.content,(t.type=i,t));else if((s=Ue.find(e,"NativeContent_MAIN"))&&s.content)a=cu.to_workbook(s.content,(t.type=i,t));else throw(s=Ue.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ue.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=zoe(e))}var o={};return e.FullPaths&&ife(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var uh={0:{f:Bce},1:{f:zce},2:{f:eue},3:{f:qce},4:{f:Gce},5:{f:Zce},6:{f:nue},7:{f:Jce},8:{f:lue},9:{f:oue},10:{f:sue},11:{f:iue},12:{f:Yce},13:{f:tue},14:{f:Xce},15:{f:Kce},16:{f:oO},17:{f:aue},18:{f:Qce},19:{f:Cy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Rue},40:{},42:{},43:{f:soe},44:{f:aoe},45:{f:ioe},46:{f:loe},47:{f:ooe},48:{},49:{f:cae},50:{},51:{f:Aoe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:BA},62:{f:rue},63:{f:Foe},64:{f:gue},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vue},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Hce},148:{f:Wce,p:16},151:{f:fue},152:{},153:{f:Pue},154:{},155:{},156:{f:jue},157:{},158:{},159:{T:1,f:Eie},160:{T:-1},161:{T:1,f:_o},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cue},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Noe},336:{T:-1},337:{f:Ooe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ag},357:{},358:{},359:{},360:{T:1},361:{},362:{f:UA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:due},427:{f:hue},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:mue},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Vce},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uue},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ag},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Woe},633:{T:1},634:{T:-1},635:{T:1,f:Boe},636:{T:-1},637:{f:fae},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Sue},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xue},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fg={6:{f:Hm},10:{f:Cs},12:{f:It},13:{f:It},14:{f:Ot},15:{f:Ot},16:{f:gr},17:{f:Ot},18:{f:Ot},19:{f:It},20:{f:pS},21:{f:pS},23:{f:UA},24:{f:vS},25:{f:Ot},26:{},27:{},28:{f:$se},29:{},34:{f:Ot},35:{f:mS},38:{f:gr},39:{f:gr},40:{f:gr},41:{f:gr},42:{f:Ot},43:{f:Ot},47:{f:Vie},49:{f:_se},51:{f:It},60:{},61:{f:gse},64:{f:Ot},65:{f:yse},66:{f:It},77:{},80:{},81:{},82:{},85:{f:It},89:{},90:{},91:{},92:{f:cse},93:{f:Bse},94:{},95:{f:Ot},96:{},97:{},99:{f:Ot},125:{f:BA},128:{f:Ose},129:{f:use},130:{f:It},131:{f:Ot},132:{f:Ot},133:{f:fse},134:{},140:{f:Gse},141:{f:It},144:{},146:{f:qse},151:{},152:{},153:{},154:{},155:{},156:{f:It},157:{},158:{},160:{f:eie},161:{f:Jse},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Tse},190:{f:Cse},193:{f:Cs},197:{},198:{},199:{},200:{},201:{},202:{f:Ot},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:It},220:{},221:{f:Ot},222:{},224:{f:Ase},225:{f:lse},226:{f:Cs},227:{},229:{f:Use},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:dse},253:{f:wse},255:{f:hse},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:FA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ot},353:{f:Cs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:jse},431:{f:Ot},432:{},433:{},434:{},437:{},438:{f:Hse},439:{f:Ot},440:{f:zse},441:{},442:{f:Lf},443:{},444:{f:It},445:{},446:{},448:{f:Cs},449:{f:vse,r:2},450:{f:Cs},512:{f:dS},513:{f:Zse},515:{f:Dse},516:{f:bse},517:{f:hS},519:{f:tie},520:{f:pse},523:{},545:{f:gS},549:{f:fS},566:{},574:{f:xse},638:{f:kse},659:{},1048:{},1054:{f:Sse},1084:{},1212:{f:Mse},2048:{f:Yse},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Od},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Cs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Xse,r:12},2173:{f:Toe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ot,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Rse,r:12},2197:{},2198:{f:_oe,r:12},2199:{},2200:{},2201:{},2202:{f:Ise,r:12},2203:{f:Cs},2204:{},2205:{},2206:{},2207:{},2211:{f:mse},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:It},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Qse},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Kse},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:dS},1:{},2:{f:sie},3:{f:aie},4:{f:nie},5:{f:hS},7:{f:iie},8:{},9:{f:Od},11:{},22:{f:It},30:{f:Ese},31:{},32:{},33:{f:gS},36:{},37:{f:fS},50:{f:oie},62:{},52:{},67:{},68:{f:It},69:{},86:{},126:{},127:{f:rie},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:lie},223:{},234:{},354:{},421:{},518:{f:Hm},521:{f:Od},536:{f:vS},547:{f:mS},561:{},579:{},1030:{f:Hm},1033:{f:Od},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Hn(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&wA(r)&&e.push(r)}}function NS(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Dne(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<l.length;++i){var p=l[i].trim(),_=p.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(_!="<td"&&_!="<th")){var g=p.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var y=g[o].trim();if(y.match(/<t[dh]/i)){for(var x=y,w=0;x.charAt(0)=="<"&&(w=x.indexOf(">"))>-1;)x=x.slice(w+1);for(var E=0;E<v.length;++E){var S=v[E];S.s.c==f&&S.s.r<c&&c<=S.e.r&&(f=S.e.c+1,E=-1)}var b=Te(y.slice(0,y.indexOf(">")));h=b.colspan?+b.colspan:1,((d=+b.rowspan)>1||h>1)&&v.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+h-1}});var T=b.t||b["data-t"]||"";if(!x.length){f+=h;continue}if(x=lA(x),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!x.length){f+=h;continue}var C={t:"s",v:x};r.raw||!x.trim().length||T=="s"||(x==="TRUE"?C={t:"b",v:!0}:x==="FALSE"?C={t:"b",v:!1}:isNaN(ta(x))?isNaN(Dl(x).getDate())||(C={t:"d",v:Zt(x)},r.cellDates||(C={t:"n",v:Fr(C.v)}),C.z=r.dateNF||je[14]):C={t:"n",v:ta(x)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=C):n[Ae({r:c,c:f})]=C,f+=h}}}}return n["!ref"]=Be(m),v.length&&(n["!merges"]=v),n}function ofe(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var f=Ae({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||by(d.w||(ms(d),d.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(m["data-t"]=d&&d.t||"z",d.v!=null&&(m["data-v"]=d.v),d.z!=null&&(m["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(Gne("td",h,m))}}var v="<tr>";return v+s.join("")+"</tr>"}var lfe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cfe="</body></html>";function ufe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return yi(NS(r[0],t),t);var n=Uy();return r.forEach(function(a,s){By(n,NS(a,t),"Sheet"+(s+1))}),n}function ffe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function dfe(e,t){var r=t||{},n=r.header!=null?r.header:lfe,a=r.footer!=null?r.footer:cfe,s=[n],i=sc(e["!ref"]);r.dense=Array.isArray(e),s.push(ffe(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(ofe(e,i,o,r));return s.push("</table>"+a),s.join("")}function hO(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Dr(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=sc(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),a==-1&&(c.e.r=a=f.e.r+1)}var d=[],h=0,m=e["!rows"]||(e["!rows"]=[]),v=0,p=0,_=0,g=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&p<l;++v){var w=o[v];if(AS(w)){if(n.display)continue;m[p]={hidden:!0}}var E=w.children;for(_=g=0;_<E.length;++_){var S=E[_];if(!(n.display&&AS(S))){var b=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):lA(S.innerHTML),T=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var C=d[h];C.s.c==g+s&&C.s.r<p+a&&p+a<=C.e.r&&(g=C.e.c+1-s,h=-1)}x=+S.getAttribute("colspan")||1,((y=+S.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:p+a,c:g+s},e:{r:p+a+(y||1)-1,c:g+s+(x||1)-1}});var F={t:"s",v:b},M=S.getAttribute("data-t")||S.getAttribute("t")||"";b!=null&&(b.length==0?F.t=M||"z":n.raw||b.trim().length==0||M=="s"||(b==="TRUE"?F={t:"b",v:!0}:b==="FALSE"?F={t:"b",v:!1}:isNaN(ta(b))?isNaN(Dl(b).getDate())||(F={t:"d",v:Zt(b)},n.cellDates||(F={t:"n",v:Fr(F.v)}),F.z=n.dateNF||je[14]):F={t:"n",v:ta(b)})),F.z===void 0&&T!=null&&(F.z=T);var j="",A=S.getElementsByTagName("A");if(A&&A.length)for(var G=0;G<A.length&&!(A[G].hasAttribute("href")&&(j=A[G].getAttribute("href"),j.charAt(0)!="#"));++G);j&&j.charAt(0)!="#"&&(F.l={Target:j}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][g+s]=F):e[Ae({c:g+s,r:p+a})]=F,c.e.c<g+s&&(c.e.c=g+s),g+=x}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=Be(c),p>=l&&(e["!fullref"]=Be((c.e.r=o.length-v+p-1+a,c))),e}function pO(e,t){var r=t||{},n=r.dense?[]:{};return hO(n,e,t)}function hfe(e,t){return yi(pO(e,t),t)}function AS(e){var t="",r=pfe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function pfe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function mfe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ze(t.replace(/<[^>]*>/g,""));return[r]}var OS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mO(e,t){var r=t||{},n=Sy(e),a=[],s,i,o={name:""},l="",c=0,f,d,h={},m=[],v=r.dense?[]:{},p,_,g={value:""},y="",x=0,w=[],E=-1,S=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,C={},F=[],M={},j=0,A=0,G=[],X=1,H=1,q=[],Z={Names:[]},Y={},ce=["",""],z=[],k={},I="",N=0,P=!1,K=!1,ne=0;for(tf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=tf.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?v["!ref"]=Be(b):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(v["!fullref"]=v["!ref"],b.e.r=r.sheetRows-1,v["!ref"]=Be(b)),F.length&&(v["!merges"]=F),G.length&&(v["!rows"]=G),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),h[f.name]=v,K=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=Te(p[0],!1),E=S=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,v=r.dense?[]:{},F=[],G=[],K=!0);break;case"table-row-group":p[1]==="/"?--T:++T;break;case"table-row":case"行":if(p[1]==="/"){E+=X,X=1;break}if(d=Te(p[0],!1),d.行号?E=d.行号-1:E==-1&&(E=0),X=+d["number-rows-repeated"]||1,X<10)for(ne=0;ne<X;++ne)T>0&&(G[E+ne]={level:T});S=-1;break;case"covered-table-cell":p[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(v[E]||(v[E]=[]),v[E][S]={t:"z"}):v[Ae({r:E,c:S})]={t:"z"}),y="",w=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++S,g=Te(p[0],!1),H=parseInt(g["number-columns-repeated"]||"1",10),_={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(_.f=ES(ze(g.formula))),(g.数据类型||g["value-type"])=="string"&&(_.t="s",_.v=ze(g["string-value"]||""),r.dense?(v[E]||(v[E]=[]),v[E][S]=_):v[Ae({r:E,c:S})]=_),S+=H-1;else if(p[1]!=="/"){++S,y="",x=0,w=[],H=1;var J=X?E+X-1:E;if(S>b.e.c&&(b.e.c=S),S<b.s.c&&(b.s.c=S),E<b.s.r&&(b.s.r=E),J>b.e.r&&(b.e.r=J),g=Te(p[0],!1),z=[],k={},_={t:g.数据类型||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=ze(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(j=parseInt(g["number-matrix-rows-spanned"],10)||0,A=parseInt(g["number-matrix-columns-spanned"],10)||0,M={s:{r:E,c:S},e:{r:E+j-1,c:S+A-1}},_.F=Be(M),q.push([M,_.F])),g.formula)_.f=ES(g.formula);else for(ne=0;ne<q.length;++ne)E>=q[ne][0].s.r&&E<=q[ne][0].e.r&&S>=q[ne][0].s.c&&S<=q[ne][0].e.c&&(_.F=q[ne][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(j=parseInt(g["number-rows-spanned"],10)||0,A=parseInt(g["number-columns-spanned"],10)||0,M={s:{r:E,c:S},e:{r:E+j-1,c:S+A-1}},F.push(M)),g["number-columns-repeated"]&&(H=parseInt(g["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=mt(g["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(g.value);break;case"percentage":_.t="n",_.v=parseFloat(g.value);break;case"currency":_.t="n",_.v=parseFloat(g.value);break;case"date":_.t="d",_.v=Zt(g["date-value"]),r.cellDates||(_.t="n",_.v=Fr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=Nne(g["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Ep(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(g.数据数值);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",g["string-value"]!=null&&(y=ze(g["string-value"]),w=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(P=!1,_.t==="s"&&(_.v=y||"",w.length&&(_.R=w),P=x==0),Y.Target&&(_.l=Y),z.length>0&&(_.c=z,z=[]),y&&r.cellText!==!1&&(_.w=y),P&&(_.t="z",delete _.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var ie=0;ie<X;++ie){if(H=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(v[E+ie]||(v[E+ie]=[]),v[E+ie][S]=ie==0?_:sr(_);--H>0;)v[E+ie][S+H]=sr(_);else for(v[Ae({r:E+ie,c:S})]=_;--H>0;)v[Ae({r:E+ie,c:S+H})]=sr(_);b.e.c<=S&&(b.e.c=S)}H=parseInt(g["number-columns-repeated"]||"1",10),S+=H-1,H=0,_={},y="",w=[]}Y={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;k.t=y,w.length&&(k.R=w),k.a=I,z.push(k)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);I="",N=0,y="",x=0,w=[];break;case"creator":p[1]==="/"?I=n.slice(N,p.index):N=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",x=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(C[o.name]=l,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=Te(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Te(p[0],!1),l+=OS[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Te(p[0],!1),l+=OS[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,p.index);break}else c=p.index+p[0].length;break;case"named-range":i=Te(p[0],!1),ce=zm(i["cell-range-address"]);var oe={Name:i.name,Ref:ce[0]+"!"+ce[1]};K&&(oe.Sheet=m.length),Z.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!g||!g["string-value"])){var Se=mfe(n.slice(x,p.index));y=(y.length>0?y+`
`:"")+Se[0]}else Te(p[0],!1),x=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ce=zm(Te(p[0])["target-range-address"]),h[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Y=Te(p[0],!1),!Y.href)break;Y.Target=ze(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(ce=zm(Y.Target.slice(1)),Y.Target="#"+ce[0]+"!"+ce[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var W={Sheets:h,SheetNames:m,Workbook:Z};return r.bookSheets&&delete W.Sheets,W}function DS(e,t){t=t||{},xn(e,"META-INF/manifest.xml")&&Dae(Mt(e,"META-INF/manifest.xml"),t);var r=tn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=mO(st(r),t);return xn(e,"meta.xml")&&(n.Props=NA(Mt(e,"meta.xml"))),n}function jS(e,t){return mO(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function My(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Rg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):st(xo(e))}function Mg(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function PS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function vfe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function sf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function zt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=sf(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=sf(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Iy(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function gfe(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=sf(e,n),s=xr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:zt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=xr(o.data),c=zt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=zt(s[3][0].data)>>>0>0),r.push(i)}return r}function xfe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=sf(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Mg(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var f=Mg(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function yfe(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(xfe(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Mg(t)}function _fe(e,t,r,n){var a=My(e),s=a.getUint32(4,!0),i=(n>1?12:8)+PS(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=PS(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function wfe(e,t,r){var n=My(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);a&1&&(l=vfe(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function bfe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return _fe(e,t,r,e[0]);case 5:return wfe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ri(e){var t=xr(e);return sf(t[1][0].data)}function FS(e,t){var r=xr(t.data),n=zt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=xr(i.data),l=zt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Rg(o[3][0].data);break;case 8:{var c=e[ri(o[9][0].data)][0],f=xr(c.data),d=e[ri(f[1][0].data)][0],h=zt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=xr(d.data);s[l]=m[3].map(function(v){return Rg(v.data)}).join("")}break}}),s}function Sfe(e,t){var r,n,a,s,i,o,l,c,f,d,h,m,v,p,_=xr(e),g=zt(_[1][0].data)>>>0,y=zt(_[2][0].data)>>>0,x=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&zt(_[8][0].data)>0||!1,w,E;if((s=(a=_[7])==null?void 0:a[0])!=null&&s.data&&t!=0)w=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,E=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=_[4])==null?void 0:f[0])!=null&&d.data&&t!=1)w=(m=(h=_[4])==null?void 0:h[0])==null?void 0:m.data,E=(p=(v=_[3])==null?void 0:v[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=x?4:1,b=My(w),T=[],C=0;C<w.length/2;++C){var F=b.getUint16(C*2,!0);F<65535&&T.push([C,F])}if(T.length!=y)throw"Expected ".concat(y," cells, found ").concat(T.length);var M=[];for(C=0;C<T.length-1;++C)M[T[C][0]]=E.subarray(T[C][1]*S,T[C+1][1]*S);return T.length>=1&&(M[T[T.length-1][0]]=E.subarray(T[T.length-1][1]*S)),{R:g,cells:M}}function Efe(e,t){var r,n=xr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?zt(n[7][0].data)>>>0>0?1:0:-1,s=Iy(n[5],function(i){return Sfe(i,a)});return{nrows:zt(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function kfe(e,t,r){var n,a=xr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(zt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(zt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Be(s);var i=xr(a[4][0].data),o=FS(e,e[ri(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?FS(e,e[ri(i[17][0].data)][0]):[],c=xr(i[3][0].data),f=0;c[1].forEach(function(d){var h=xr(d.data),m=e[ri(h[2][0].data)][0],v=zt(m.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var p=Efe(e,m);p.data.forEach(function(_,g){_.forEach(function(y,x){var w=Ae({r:f+g,c:x}),E=bfe(y,o,l);E&&(r[w]=E)})}),f+=p.nrows})}function Tfe(e,t){var r=xr(t.data),n={"!ref":"A1"},a=e[ri(r[2][0].data)],s=zt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return kfe(e,a[0],n),n}function Cfe(e,t){var r,n=xr(t.data),a={name:(r=n[1])!=null&&r[0]?Rg(n[1][0].data):"",sheets:[]},s=Iy(n[2],ri);return s.forEach(function(i){e[i].forEach(function(o){var l=zt(o.meta[1][0].data);l==6e3&&a.sheets.push(Tfe(e,o))})}),a}function Nfe(e,t){var r=Uy(),n=xr(t.data),a=Iy(n[1],ri);if(a.forEach(function(s){e[s].forEach(function(i){var o=zt(i.meta[1][0].data);if(o==2){var l=Cfe(e,i);l.sheets.forEach(function(c,f){By(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Gm(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=yfe(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=gfe(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&zt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var f=zt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Nfe(s,o)}function Afe(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Ly(e){Afe([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ofe(e){return Jo.WS.indexOf(e)>-1?"sheet":e==Jo.CS?"chart":e==Jo.DS?"dialog":e==Jo.MS?"macro":e&&e.length?e:"sheet"}function Dfe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Ofe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function jfe(e,t,r,n,a,s,i,o,l,c,f,d){try{s[n]=ou(tn(e,r,!0),t);var h=Mt(e,t),m;switch(o){case"sheet":m=Lue(h,t,a,l,s[n],c,f,d);break;case"chart":if(m=$ue(h,t,a,l,s[n],c,f,d),!m||!m["!drawel"])break;var v=$c(m["!drawel"].Target,t),p=Og(v),_=Ioe(tn(e,v,!0),ou(tn(e,p,!0),v)),g=$c(_,v),y=Og(g);m=wue(tn(e,g,!0),g,l,ou(tn(e,y,!0),g),c,m);break;case"macro":m=Uue(h,t,a,l,s[n],c,f,d);break;case"dialog":m=Bue(h,t,a,l,s[n],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=m;var x=[];s&&s[n]&&ja(s[n]).forEach(function(w){var E="";if(s[n][w].Type==Jo.CMNT){E=$c(s[n][w].Target,t);var S=zue(Mt(e,E,!0),E,l);if(!S||!S.length)return;yS(m,S,!1)}s[n][w].Type==Jo.TCMNT&&(E=$c(s[n][w].Target,t),x=x.concat($oe(Mt(e,E,!0),l)))}),x&&x.length&&yS(m,x,!0,l.people||[])}catch(w){if(l.WTF)throw w}}function vn(e){return e.charAt(0)=="/"?e.slice(1):e}function Pfe(e,t){if(Z4(),t=t||{},Ly(t),xn(e,"META-INF/manifest.xml")||xn(e,"objectdata.xml"))return DS(e,t);if(xn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Gm<"u"){if(e.FileIndex)return Gm(e);var r=Ue.utils.cfb_new();return Yb(e).forEach(function(G){Fne(r,G,Pne(e,G))}),Gm(r)}throw new Error("Unsupported NUMBERS file")}if(!xn(e,"[Content_Types].xml"))throw xn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Yb(e),a=Aae(tn(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Mt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Mt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(uu=[],a.sst)try{uu=Hue(Mt(e,vn(a.sst)),a.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&a.themes.length&&(l=Vue(tn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=Wue(Mt(e,vn(a.style)),a.style,l,t))}a.links.map(function(G){try{var X=ou(tn(e,Og(vn(G))),G);return Gue(Mt(e,vn(G)),X,G,t)}catch{}});var f=Iue(Mt(e,vn(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=Mt(e,vn(a.coreprops[0]),!0),h&&(d=NA(h)),a.extprops.length!==0&&(h=Mt(e,vn(a.extprops[0]),!0),h&&Fae(h,d,t)));var m={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=tn(e,vn(a.custprops[0]),!0),h&&(m=Mae(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(X){return X.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(v.Props=d,v.Custprops=m),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var p={};t.bookDeps&&a.calcchain&&(p=Yue(Mt(e,vn(a.calcchain)),a.calcchain));var _=0,g={},y,x;{var w=f.Sheets;d.Worksheets=w.length,d.SheetNames=[];for(var E=0;E!=w.length;++E)d.SheetNames[E]=w[E].name}var S=s?"bin":"xml",b=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,b+1)+"_rels/"+a.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");xn(e,T)||(T="xl/_rels/workbook."+S+".rels");var C=ou(tn(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Kue(Mt(e,vn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Uoe(Mt(e,vn(a.people[0])),t)),C&&(C=Dfe(C,f.Sheets));var F=Mt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var M="sheet";if(C&&C[_]?(y="xl/"+C[_][1].replace(/[\/]?xl\//,""),xn(e,y)||(y=C[_][1]),xn(e,y)||(y=T.replace(/_rels\/.*$/,"")+C[_][1]),M=C[_][2]):(y="xl/worksheets/sheet"+(_+1-F)+"."+S,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,A=0;A!=t.sheets.length;++A)typeof t.sheets[A]=="number"&&t.sheets[A]==_&&(j=1),typeof t.sheets[A]=="string"&&t.sheets[A].toLowerCase()==d.SheetNames[_].toLowerCase()&&(j=1);if(!j)continue e}}jfe(e,y,x,d.SheetNames[_],_,g,i,M,t,f,l,c)}return v={Directory:a,Workbook:f,Props:d,Custprops:m,Deps:p,Sheets:i,SheetNames:d.SheetNames,Strings:uu,Styles:c,Themes:l,SSF:sr(je)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(G,X){G=G.replace(/^Root Entry[\/]/,""),v.keys.push(G),v.files[G]=e.FileIndex[X]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=Mt(e,vn(a.vba[0]),!0):a.defaults&&a.defaults.bin===Hoe&&(v.vbaraw=Mt(e,"xl/vbaProject.bin",!0))),v}function Ffe(e,t){var r=t||{},n="Workbook",a=Ue.find(e,n);try{if(n="/!DataSpaces/Version",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Tie(a.content),n="/!DataSpaces/DataSpaceMap",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Nie(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Aie(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Die(a.content)}catch{}if(n="/EncryptionInfo",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=jie(a.content);if(n="/EncryptedPackage",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function $y(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Rfe(e,t){return Ue.find(e,"EncryptedPackage")?Ffe(e,t):dO(e,t)}function Mfe(e,t){var r,n=e,a=t||{};return a.type||(a.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r=sA(n,a),Pfe(r,a)}function vO(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Pg(e.slice(r),t);default:break e}return rf.to_workbook(e,t)}function Ife(e,t){var r="",n=$y(e,t);switch(t.type){case"base64":r=cn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=so(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=st(r)),t.type="binary",vO(r,t)}function Lfe(e,t){var r=e;return t.type=="base64"&&(r=cn(r)),r=Ms.utils.decode(1200,r.slice(2),"str"),t.type="binary",vO(r,t)}function $fe(e){return e.match(/[^\x00-\x7F]/)?Uc(e):e}function Km(e,t,r,n){return n?(r.type="string",rf.to_workbook(e,r)):rf.to_workbook(t,r)}function Ig(e,t){B4();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ig(new Uint8Array(e),(r=sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),pl={},r.dateNF&&(pl.dateNF=r.dateNF),r.type||(r.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=$e?"buffer":"binary",n=Tne(e),typeof Uint8Array<"u"&&!$e&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=$fe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=sr(r),r.type="array",Ig(gy(n),r)}switch((a=$y(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Rfe(Ue.read(n,r),r);break;case 9:if(a[1]<=8)return dO(n,r);break;case 60:return Pg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return hie(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return fie.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Mfe(n,r):Km(e,n,r,s);case 239:return a[3]===60?Pg(n,r):Km(e,n,r,s);case 255:if(a[1]===254)return Lfe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return cu.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return cu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return xS.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Hie.to_workbook(n,r);break;case 10:case 13:case 32:return Ife(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return cie.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?xS.to_workbook(n,r):Km(e,n,r,s)}function Ufe(e,t,r,n,a,s,i,o){var l=ir(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var v=i?e[r][m]:e[n[m]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[m]!=null&&(h[s[m]]=c);continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[m]!=null){if(p==null)if(v.t=="e"&&p===null)h[s[m]]=null;else if(c!==void 0)h[s[m]]=c;else if(f&&p===null)h[s[m]]=null;else continue;else h[s[m]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?p:ms(v,p,o);p!=null&&(d=!1)}}return{row:h,isempty:d}}function Lg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Nt(f);break;case"number":l=Nt(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=ir(l.s.r),h=[],m=[],v=0,p=0,_=Array.isArray(e),g=l.s.r,y=0,x={};_&&!e[g]&&(e[g]=[]);var w=c.skipHidden&&e["!cols"]||[],E=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=Ht(y),r=_?e[g][y]:e[h[y]+d],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ms(r,null,c),p=x[i]||0,!p)x[i]=1;else{do o=i+"_"+p++;while(x[o]);x[i]=p,x[o]=1}s[y]=o}for(g=l.s.r+a;g<=l.e.r;++g)if(!(E[g]||{}).hidden){var S=Ufe(e,l,g,h,n,s,_,c);(S.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[v++]=S.row)}return m.length=v,m}var RS=/"/g;function Bfe(e,t,r,n,a,s,i,o){for(var l=!0,c=[],f="",d=ir(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=o.dense?(e[r]||[])[h]:e[n[h]+d];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:ms(m,null,o));for(var v=0,p=0;v!==f.length;++v)if((p=f.charCodeAt(v))===a||p===s||p===34||o.forceQuotes){f='"'+f.replace(RS,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(RS,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function gO(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Nt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(d[v]=Ht(v));for(var p=0,_=a.s.r;_<=a.e.r;++_)(m[_]||{}).hidden||(f=Bfe(e,a,_,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((p++?o:"")+f)));return delete n.dense,r.join("")}function Wfe(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=gO(e,t);return r}function Vfe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Nt(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Ht(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=ir(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function xO(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=Nt(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var h=n.header||[],m=0;t.forEach(function(p,_){ja(p).forEach(function(g){(m=h.indexOf(g))==-1&&(h[m=h.length]=g);var y=p[g],x="z",w="",E=Ae({c:o+m,r:i+_+a});c=of(s,E),y&&typeof y=="object"&&!(y instanceof Date)?s[E]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",n.cellDates||(x="n",y=Fr(y)),w=n.dateNF||je[14]):y===null&&n.nullError&&(x="e",y=0),c?(c.t=x,c.v=y,delete c.w,delete c.R,w&&(c.z=w)):s[E]=c={t:x,v:y},w&&(c.z=w))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var v=ir(i);if(a)for(m=0;m<h.length;++m)s[Ht(m+o)+v]={t:"s",v:h[m]};return s["!ref"]=Be(f),s}function Hfe(e,t){return xO(null,e,t)}function of(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Dr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?of(e,Ae(t)):of(e,Ae({r:t,c:r||0}))}function zfe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Uy(){return{SheetNames:[],Sheets:{}}}function By(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(Aue(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Yfe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=zfe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Gfe(e,t){return e.z=t,e}function yO(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Kfe(e,t,r){return yO(e,"#"+t,r)}function qfe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Xfe(e,t,r,n){for(var a=typeof t!="string"?t:Nt(t),s=typeof t=="string"?t:Be(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=of(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Jfe={encode_col:Ht,encode_row:ir,encode_cell:Ae,encode_range:Be,decode_col:Ty,decode_row:ky,split_cell:lae,decode_cell:Dr,decode_range:sc,format_cell:ms,sheet_add_aoa:SA,sheet_add_json:xO,sheet_add_dom:hO,aoa_to_sheet:ic,json_to_sheet:Hfe,table_to_sheet:pO,table_to_book:hfe,sheet_to_csv:gO,sheet_to_txt:Wfe,sheet_to_json:Lg,sheet_to_html:dfe,sheet_to_formulae:Vfe,sheet_to_row_object_array:Lg,sheet_get_cell:of,book_new:Uy,book_append_sheet:By,book_set_sheet_visibility:Yfe,cell_set_number_format:Gfe,cell_set_hyperlink:yO,cell_set_internal_link:Kfe,cell_add_comment:qfe,sheet_set_array_formula:Xfe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Qfe(){const[e,t]=D.useState([]),[r,n]=D.useState(!0),[a,s]=D.useState(null),[i,o]=D.useState(!1);D.useEffect(()=>{(async()=>{try{n(!0);const{data:h,error:m}=await se.from("contacts").select("*").eq("status","open");if(m)throw m;t(h||[])}catch(h){console.error("Error fetching contacts:",h)}finally{n(!1)}})()},[]);const l=d=>{d.target.files&&d.target.files.length>0&&s(d.target.files[0])},c=async()=>{if(a){o(!0);try{const d=await a.arrayBuffer(),h=Ig(d),m=h.Sheets[h.SheetNames[0]],p=Jfe.sheet_to_json(m).map(y=>({client:y.Client||y.client||"",name:y.Name||y.name||"",contact_name:y["Contact Name"]||y.contact_name||y.Contact||"",email:y.Email||y.email||"",phone_number:y["Phone Number"]||y.phone_number||y.Phone||"",status:"open"})),{data:_,error:g}=await se.from("contacts").insert(p).select();if(g)throw g;t([...e,..._]),alert(`${_.length} contacts imported successfully!`),s(null)}catch(d){console.error("Error processing file:",d),alert("Error importing contacts. Please check the file format.")}finally{o(!1)}}},f=async d=>{try{const{error:h}=await se.from("contacts").update({status:"close"}).eq("id",d);if(h)throw h;t(e.filter(m=>m.id!==d)),alert("Call Done")}catch(h){console.error("Error updating contact:",h),alert("Failed to update contact")}};return r?u.jsx("div",{className:"text-center py-8",children:"Loading contacts..."}):u.jsxs("div",{className:"container mx-auto p-4",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Excel Data Import"}),u.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Upload Excel File"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[u.jsxs("div",{className:"flex-1 w-full",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Excel File"}),u.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",onChange:l,className:`block w-full text-sm text-gray-500\r
                file:mr-4 file:py-2 file:px-4\r
                file:rounded-md file:border-0\r
                file:text-sm file:font-semibold\r
                file:bg-blue-50 file:text-blue-700\r
                hover:file:bg-blue-100`,disabled:i})]}),u.jsx("button",{onClick:c,disabled:!a||i,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded disabled:opacity-50 disabled:cursor-not-allowed mt-6 sm:mt-0",children:i?"Uploading...":"Import Data"})]}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Supported formats: .xlsx, .xls, .csv. File should contain columns for Client, Name, Contact Name, Email, and Phone Number."})]}),e.length>0?u.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(d=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.client}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.contact_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.email}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.phone_number}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:u.jsx("button",{onClick:()=>d.id&&f(d.id),className:"text-blue-600 hover:text-blue-900",children:"Mark Done"})})]},d.id))})]})})}):u.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:u.jsx("p",{className:"text-gray-500",children:"No contacts found. Upload an Excel file to get started."})})]})}function Zfe(){const[e,t]=D.useState([]),[r,n]=D.useState(""),[a,s]=D.useState([]);D.useState(!1);const[i,o]=D.useState(!1),[l,c]=D.useState(null),[f,d]=D.useState([]),[h,m]=D.useState(""),[v,p]=D.useState([]),_=Rn(),g=Qe(T=>T.role),y=Qe(T=>T.user);D.useEffect(()=>{x(),(g==="e.head"||g==="e.employee")&&E()},[g,y==null?void 0:y.id]),D.useEffect(()=>{w()},[e,r]);async function x(){try{if(g==="e.employee"&&(y!=null&&y.id)){const{data:T,error:C}=await se.from("client_assignments").select("client:clients(*, client_assignments(employee_id))").eq("employee_id",y.id).eq("client.status","poreceived");if(C)throw C;const F=(T==null?void 0:T.map(M=>M.client).filter(M=>M!==null))||[];t(F)}else if(g==="e.head"||g==="admin"){const{data:T,error:C}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","poreceived");if(C)throw C;t(T||[])}}catch(T){console.error("Error loading clients:",T)}}const w=()=>{if(!r){s(e);return}const T=e.filter(C=>{var F,M,j;return((F=C==null?void 0:C.name)==null?void 0:F.toLowerCase().includes(r.toLowerCase()))||((M=C==null?void 0:C.company)==null?void 0:M.toLowerCase().includes(r.toLowerCase()))||((j=C==null?void 0:C.address)==null?void 0:j.toLowerCase().includes(r.toLowerCase()))});s(T)};async function E(){const{data:T,error:C}=await se.from("employees").select("*").eq("role","e.employee");if(C){console.error("Error loading employees:",C);return}d(T||[])}async function S(){if(l)try{const T=v.map(F=>({client_id:l.id,employee_id:F}));await se.from("client_assignments").delete().eq("client_id",l.id);const{error:C}=await se.from("client_assignments").insert(T);if(C)throw C;o(!1),x()}catch(T){console.error("Error assigning employees:",T)}}const b=f.filter(T=>{var C;return(C=T==null?void 0:T.full_name)==null?void 0:C.toLowerCase().includes(h.toLowerCase())});return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"PO Received Clients"}),u.jsx("div",{className:"flex items-center space-x-4",children:u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:T=>n(T.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]})})]}),a.length===0?u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No PO received clients found"})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(T=>T&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:T.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:T.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:T.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>_(`/eclients/${T.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),(g==="e.head"||g==="admin")&&u.jsxs("button",{onClick:()=>{var C;c(T),p(((C=T.client_assignments)==null?void 0:C.map(F=>F.employee_id))||[]),o(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Xi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},T.id))}),i&&l&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Assign Employees to ",l.name]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:h,onChange:T=>m(T.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:v,onChange:T=>{const C=Array.from(T.target.selectedOptions,F=>F.value);p(C)},className:"w-full p-2 border rounded h-40",size:5,children:b.map(T=>u.jsx("option",{value:T.id,children:T.full_name},T.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}function ede(){const[e,t]=D.useState([]),[r,n]=D.useState(""),[a,s]=D.useState([]);D.useState(!1);const[i,o]=D.useState(!1),[l,c]=D.useState(null),[f,d]=D.useState([]),[h,m]=D.useState(""),[v,p]=D.useState([]),_=Rn(),g=Qe(b=>b.role);Qe(b=>b.user),D.useEffect(()=>{y(),g==="finance.employee"&&w()},[g]),D.useEffect(()=>{x()},[e,r]);async function y(){const{data:b,error:T}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","ecomplete");if(T){console.error("Error loading clients:",T);return}t(b||[])}const x=()=>{if(!r){s(e);return}const b=e.filter(T=>T.name.toLowerCase().includes(r.toLowerCase())||T.company.toLowerCase().includes(r.toLowerCase())||T.address.toLowerCase().includes(r.toLowerCase()));s(b)};async function w(){const{data:b,error:T}=await se.from("employees").select("*").eq("role","finance.employee");if(T){console.error("Error loading employees:",T);return}d(b||[])}async function E(){if(!l)return;const b=v.map(C=>({client_id:l.id,employee_id:C})),{error:T}=await se.from("client_assignments").insert(b);if(T){console.error("Error assigning employees:",T);return}o(!1),y()}const S=f.filter(b=>b.full_name.toLowerCase().includes(h.toLowerCase()));return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-white-800",children:"FClients"}),u.jsx("div",{className:"flex items-center",children:u.jsxs("div",{className:"relative mr-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search FClients",value:r,onChange:b=>n(b.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]})})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(b=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:b.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:b.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:b.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>_(`/fclients/${b.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),g==="head"&&u.jsxs("button",{onClick:()=>{c(b),o(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Xi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},b.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Assign Employees"}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:h,onChange:b=>m(b.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:v,onChange:b=>{const T=Array.from(b.target.selectedOptions,C=>C.value);p(T)},className:"w-full p-2 border rounded",children:S.map(b=>u.jsx("option",{value:b.id,children:b.full_name},b.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}function tde(){const{id:e}=Ul(),[t,r]=D.useState(null),[n,a]=D.useState([]),[s,i]=D.useState([]),[o,l]=D.useState([]),[c,f]=D.useState([]);Qe(m=>m.user),D.useEffect(()=>{e&&(d(),h())},[e]);async function d(){const{data:m}=await se.from("clients").select("*").eq("id",e).single();r(m);const{data:v}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(v||[]);const{data:p}=await se.from("quotations").select(`
                *,
                employees (
                    full_name
                ),
                quotation_assets (
                    asset_id,
                    quantity,
                    assets (
                        item
                    )
                )
            `).eq("client_id",e).order("created_at",{ascending:!1});i(p||[]);const{data:_}=await se.from("site_visits").select(`
                *,
                employees (
                    full_name
                ),
                site_visit_assets (
                    asset_id,
                    quantity,
                    assets (
                        item
                    )
                )
            `).eq("client_id",e).order("created_at",{ascending:!1});l(_||[])}async function h(){const{data:m}=await se.from("assets").select("*").order("item");f(m||[])}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsx("div",{className:"flex justify-between items-start",children:u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]})})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(m=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:m.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:m.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Vl,{className:"w-4 h-4 mr-2"}),m.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(yf,{className:"w-4 h-4 mr-2"}),m.phone]})]})]},m.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Quotations"}),u.jsx("div",{className:"space-y-4",children:s.map(m=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-semibold text-gray-800",children:["Amount: $",m.amount]}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",m.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm",children:m.description}),u.jsx("div",{className:"mt-2",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Period: ",new Date(m.start_date).toLocaleDateString()," - ",new Date(m.end_date).toLocaleDateString()]})}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:m.quotation_assets.map(v=>u.jsxs("li",{children:[v.assets.item," (Qty: ",v.quantity,")"]},v.asset_id))})]})]}),u.jsx("div",{className:"flex flex-col gap-2",children:u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${m.status==="approved"?"bg-green-100 text-green-800":m.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:m.status.charAt(0).toUpperCase()+m.status.slice(1)})})]})},m.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),u.jsx("div",{className:"space-y-4",children:o.map(m=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold text-gray-800",children:m.address}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",m.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm mt-2",children:m.notes}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:m.site_visit_assets.map(v=>u.jsxs("li",{children:[v.assets.item," (Qty: ",v.quantity,")"]},v.asset_id))})]}),u.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:["Exit Location: ",m.exit_location]})]}),u.jsx("div",{className:"text-sm text-gray-500",children:new Date(m.created_at).toLocaleDateString()})]})},m.id))})]})]}):null}function rde(){const e=Rn(),[t,r]=D.useState([]),[n,a]=D.useState(!0),[s,i]=D.useState(""),[o,l]=D.useState(""),[c,f]=D.useState(""),[d,h]=D.useState("all"),[m,v]=D.useState(!1),[p,_]=D.useState({});D.useEffect(()=>{(async()=>{try{a(!0);const{data:b,error:T}=await se.from("pd_kit_uploads").select(`
            id,
            file_path,
            uploaded_at,
            upload_type,
            visit_id
          `).order("uploaded_at",{ascending:!1});if(T)throw T;if(!b)return;const C=[...new Set(b.map(A=>A.visit_id))],{data:F,error:M}=await se.from("site_visit").select(`
            id,
            created_at,
            client_Id,
            employee_Id,
            clients (id, name, company),
            employees (id, full_name)
          `).in("id",C);if(M)throw M;const j=b.map(A=>{var X,H,q;const G=F==null?void 0:F.find(Z=>Z.id===A.visit_id);return G?{id:A.id,file_path:A.file_path,uploaded_at:A.uploaded_at,upload_type:A.upload_type,visit:{id:G.id,created_at:G.created_at,client:{id:G.client_id,name:((X=G.clients)==null?void 0:X.name)||"Unknown Client",company:((H=G.clients)==null?void 0:H.company)||""},employee:{id:G.employee_id,name:((q=G.employees)==null?void 0:q.full_name)||"Unknown Employee"}}}:{id:A.id,file_path:A.file_path,uploaded_at:A.uploaded_at,upload_type:A.upload_type,visit:{id:"",created_at:"",client:{id:"",name:"Unknown Client",company:""},employee:{id:"",name:"Unknown Employee"}}}});r(j)}catch(b){console.error("Error fetching PD kits:",b),i(b.message||"Failed to load PD kits")}finally{a(!1)}})()},[]);const g=async(S,b,T)=>{var C;try{a(!0);const{data:F,error:M}=await se.storage.from("pd-kits").download(S);if(M)throw M;if(!F)throw new Error("No data received");const j=URL.createObjectURL(F),A=document.createElement("a");A.href=j;const G=((C=S.split(".").pop())==null?void 0:C.toLowerCase())||"jpg",X=`pd-kit-${b}-${T}.${G}`;A.download=X,document.body.appendChild(A),A.click(),setTimeout(()=>{document.body.removeChild(A),URL.revokeObjectURL(j)},100)}catch(F){console.error("Error downloading file:",F),i(F.message||"Failed to download file")}finally{a(!1)}},y=S=>{_(b=>({...b,[S]:!0}))},x=t.filter(S=>{const b=S.visit.client.name.toLowerCase().includes(o.toLowerCase())||S.visit.client.company.toLowerCase().includes(o.toLowerCase())||S.visit.employee.name.toLowerCase().includes(o.toLowerCase()),T=c?new Date(S.uploaded_at).toISOString().split("T")[0]===c:!0,C=d==="all"||S.upload_type===d;return b&&T&&C}),w=()=>{l(""),f(""),h("all")},E=S=>[".jpg",".jpeg",".png",".gif",".webp"].some(T=>S.toLowerCase().endsWith(T));return n?u.jsx("div",{className:"flex items-center justify-center h-screen",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):s?u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:s}),u.jsxs("button",{onClick:()=>e(-1),className:"mt-4 px-4 py-2 bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(zM,{className:"w-4 h-4"}),"Go Back"]})]}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"All PD Kits"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client, company or employee...",value:o,onChange:S=>l(S.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>v(!m),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(t1,{className:"w-4 h-4"}),u.jsx("span",{children:"Filters"})]})]})]}),m&&u.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"font-medium",children:"Filters"}),u.jsxs("button",{onClick:w,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Hl,{className:"w-4 h-4"}),"Clear all"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Date"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(xf,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"date",value:c,onChange:S=>f(S.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Type"}),u.jsxs("select",{value:d,onChange:S=>h(S.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2",children:[u.jsx("option",{value:"all",children:"All Types"}),u.jsx("option",{value:"start",children:"Start of Visit"}),u.jsx("option",{value:"end",children:"End of Visit"})]})]})]})]}),x.length===0?u.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[u.jsx("p",{className:"text-gray-500",children:"No PD Kits found"}),(o||c||d!=="all")&&u.jsx("button",{onClick:w,className:"text-blue-600 hover:underline mt-2",children:"Clear filters"})]}):u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(S=>u.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition-shadow",children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-medium text-gray-800 line-clamp-1",children:S.visit.client.name}),u.jsx("p",{className:"text-sm text-gray-500",children:S.visit.client.company})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${S.upload_type==="start"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:S.upload_type==="start"?"Start":"End"})]})}),u.jsxs("div",{className:"w-full h-48 bg-gray-100 flex items-center justify-center relative",children:[E(S.file_path)&&!p[S.id]?u.jsx("img",{src:`${se.storage.from("pd-kits").getPublicUrl(S.file_path).data.publicUrl}`,alt:`PD Kit for ${S.visit.client.name}`,className:"w-full h-full object-contain",onError:()=>y(S.id)}):u.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-center",children:[E(S.file_path)?u.jsx(XM,{className:"w-16 h-16 text-gray-400 mb-2"}):u.jsx(eu,{className:"w-16 h-16 text-gray-400 mb-2"}),u.jsxs("p",{className:"text-sm text-gray-500",children:[E(S.file_path)?"Image preview":"Document preview"," not available"]})]}),u.jsxs("button",{onClick:()=>g(S.file_path,S.visit.client.name,S.upload_type),className:"absolute bottom-4 right-4 px-3 py-1 bg-blue-600 text-white rounded-lg flex items-center gap-1 hover:bg-blue-700 transition-colors text-sm",children:[u.jsx(ag,{className:"w-3 h-3"}),"Download"]})]}),u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[u.jsx(sg,{className:"w-4 h-4"}),S.visit.employee.name]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(S.uploaded_at).toLocaleString()})]}),u.jsxs("button",{onClick:()=>g(S.file_path,S.visit.client.name,S.upload_type),className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(ag,{className:"w-4 h-4"}),"Download"]})]})})]},S.id))})]})}function nde(){const{role:e}=Qe(),[t,r]=D.useState(!0),n=()=>{r(!t)};return u.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[u.jsx("button",{onClick:n,className:"p-2 bg-gray-200 rounded-md shadow-md m-2 focus:outline-none z-50 fixed top-22 left-0",children:u.jsx(ZT,{className:"w-4 h-4"})}),u.jsx("div",{className:`w-64 bg-white shadow-lg ${t?"block":"hidden"}`,children:u.jsxs("nav",{className:"mt-8",children:[u.jsxs(Jr,{to:"/dashboard",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(QM,{className:"w-5 h-5 mr-3"}),"Dashboard"]}),(e==="head"||e==="e.head")&&u.jsxs(Jr,{to:"/employees",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Xi,{className:"w-5 h-5 mr-3"}),"Employees"]}),(e==="head"||e==="admin"||e==="employee")&&u.jsxs(Jr,{to:"/clients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Zc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),(e==="e.employee"||e==="e.head")&&u.jsxs(Jr,{to:"/eclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Zc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),e==="finance.employee"&&u.jsxs(Jr,{to:"/fclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Zc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),e==="e.head"&&u.jsxs(Jr,{to:"/pd-kits",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Lw,{className:"w-5 h-5 mr-3"}),"PD Kits"]}),(e==="employee"||e==="e.employee")&&u.jsxs(Jr,{to:"/site-visit",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Lw,{className:"w-5 h-5 mr-3"}),"Site Visit"]}),u.jsxs(Jr,{to:"/allclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(md,{className:"w-5 h-5 mr-3"}),"All Clients"]}),(e==="head"||e==="e.head"||e==="admin")&&u.jsxs(Jr,{to:"/time-insights",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(md,{className:"w-5 h-5 mr-3"}),"Site Visit Time"]}),(e==="head"||e==="e.head"||e==="admin")&&u.jsxs(Jr,{to:"/site-time-insights",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(md,{className:"w-5 h-5 mr-3"}),"Time Report"]}),u.jsxs(Jr,{to:"/xldata",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(md,{className:"w-5 h-5 mr-3"}),"XL Data"]}),u.jsxs(Jr,{to:"/Notifications",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(ng,{className:"w-5 h-5 mr-3"}),"Notifications"]}),u.jsxs(Jr,{to:"/clients-history",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(YM,{className:"w-5 h-5 mr-3"}),"Clients History"]})]})}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsx("div",{className:"p-8",children:u.jsx(BP,{})})})]})}function Ye(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw new Error(typeof e=="number"?"[MobX] minified error nr: "+e+(r.length?" "+r.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var ade={};function Np(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:ade}var _O=Object.assign,fh=Object.getOwnPropertyDescriptor,Ca=Object.defineProperty,Ap=Object.prototype,$g=[];Object.freeze($g);var wO={};Object.freeze(wO);var sde=typeof Proxy<"u",ide=Object.toString();function bO(){sde||Ye("Proxy not available")}function SO(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var Qo=function(){};function la(e){return typeof e=="function"}function oo(e){var t=typeof e;switch(t){case"string":case"symbol":case"number":return!0}return!1}function Op(e){return e!==null&&typeof e=="object"}function ui(e){if(!Op(e))return!1;var t=Object.getPrototypeOf(e);if(t==null)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r.toString()===ide}function EO(e){var t=e==null?void 0:e.constructor;return t?t.name==="GeneratorFunction"||t.displayName==="GeneratorFunction":!1}function Dp(e,t,r){Ca(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function kO(e,t,r){Ca(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function So(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(n){return Op(n)&&n[r]===!0}}function oc(e){return e!=null&&Object.prototype.toString.call(e)==="[object Map]"}function ode(e){var t=Object.getPrototypeOf(e),r=Object.getPrototypeOf(t),n=Object.getPrototypeOf(r);return n===null}function Ga(e){return e!=null&&Object.prototype.toString.call(e)==="[object Set]"}var TO=typeof Object.getOwnPropertySymbols<"u";function lde(e){var t=Object.keys(e);if(!TO)return t;var r=Object.getOwnPropertySymbols(e);return r.length?[].concat(t,r.filter(function(n){return Ap.propertyIsEnumerable.call(e,n)})):t}var jp=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:TO?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function CO(e){return e===null?null:typeof e=="object"?""+e:e}function ss(e,t){return Ap.hasOwnProperty.call(e,t)}var cde=Object.getOwnPropertyDescriptors||function(t){var r={};return jp(t).forEach(function(n){r[n]=fh(t,n)}),r};function rn(e,t){return!!(e&t)}function nn(e,t,r){return r?e|=t:e&=~t,e}function MS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ude(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dde(n.key),n)}}function lc(e,t,r){return t&&ude(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zo(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=hde(e))||t){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lo.apply(null,arguments)}function NO(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ug(e,t)}function Ug(e,t){return Ug=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ug(e,t)}function fde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function dde(e){var t=fde(e,"string");return typeof t=="symbol"?t:t+""}function hde(e,t){if(e){if(typeof e=="string")return MS(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?MS(e,t):void 0}}var ba=Symbol("mobx-stored-annotations");function Na(e){function t(r,n){if(Vf(n))return e.decorate_20223_(r,n);Wf(r,n,e)}return Object.assign(t,e)}function Wf(e,t,r){ss(e,ba)||Dp(e,ba,lo({},e[ba])),bde(r)||(e[ba][t]=r)}function pde(e){return ss(e,ba)||Dp(e,ba,lo({},e[ba])),e[ba]}function Vf(e){return typeof e=="object"&&typeof e.kind=="string"}var Ce=Symbol("mobx administration"),_i=function(){function e(r){r===void 0&&(r="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=Ge.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=r}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},t.reportObserved=function(){return HO(this)},t.reportChanged=function(){Tn(),zO(this),Cn()},t.toString=function(){return this.name_},lc(e,[{key:"isBeingObserved",get:function(){return rn(this.flags_,e.isBeingObservedMask_)},set:function(n){this.flags_=nn(this.flags_,e.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return rn(this.flags_,e.isPendingUnobservationMask_)},set:function(n){this.flags_=nn(this.flags_,e.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return rn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=nn(this.flags_,e.diffValueMask_,n===1)}}])}();_i.isBeingObservedMask_=1;_i.isPendingUnobservationMask_=2;_i.diffValueMask_=4;var Wy=So("Atom",_i);function AO(e,t,r){t===void 0&&(t=Qo),r===void 0&&(r=Qo);var n=new _i(e);return t!==Qo&&T0e(n,t),r!==Qo&&XO(n,r),n}function mde(e,t){return e===t}function vde(e,t){return qy(e,t)}function gde(e,t){return qy(e,t,1)}function xde(e,t){return Object.is?Object.is(e,t):e===t?e!==0||1/e===1/t:e!==e&&t!==t}var dh={identity:mde,structural:vde,default:xde,shallow:gde};function co(e,t,r){return eD(e)?e:Array.isArray(e)?nr.array(e,{name:r}):ui(e)?nr.object(e,void 0,{name:r}):oc(e)?nr.map(e,{name:r}):Ga(e)?nr.set(e,{name:r}):typeof e=="function"&&!cf(e)&&!uf(e)?EO(e)?Pl(e):lf(r,e):e}function yde(e,t,r){if(e==null||Lp(e)||Ip(e)||ko(e)||wa(e))return e;if(Array.isArray(e))return nr.array(e,{name:r,deep:!1});if(ui(e))return nr.object(e,void 0,{name:r,deep:!1});if(oc(e))return nr.map(e,{name:r,deep:!1});if(Ga(e))return nr.set(e,{name:r,deep:!1})}function Pp(e){return e}function _de(e,t){return qy(e,t)?t:e}var wde="override";function bde(e){return e.annotationType_===wde}function Hf(e,t){return{annotationType_:e,options_:t,make_:Sde,extend_:Ede,decorate_20223_:kde}}function Sde(e,t,r,n){var a;if((a=this.options_)!=null&&a.bound)return this.extend_(e,t,r,!1)===null?0:1;if(n===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if(cf(r.value))return 1;var s=OO(e,this,t,r,!1);return Ca(n,t,s),2}function Ede(e,t,r,n){var a=OO(e,this,t,r);return e.defineProperty_(t,a,n)}function kde(e,t){var r=t.kind,n=t.name,a=t.addInitializer,s=this,i=function(c){var f,d,h,m;return uo((f=(d=s.options_)==null?void 0:d.name)!=null?f:n.toString(),c,(h=(m=s.options_)==null?void 0:m.autoAction)!=null?h:!1)};if(r=="field")return function(l){var c,f=l;return cf(f)||(f=i(f)),(c=s.options_)!=null&&c.bound&&(f=f.bind(this),f.isMobxAction=!0),f};if(r=="method"){var o;return cf(e)||(e=i(e)),(o=this.options_)!=null&&o.bound&&a(function(){var l=this,c=l[n].bind(l);c.isMobxAction=!0,l[n]=c}),e}Ye("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+r+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function Tde(e,t,r,n){t.annotationType_,n.value}function OO(e,t,r,n,a){var s,i,o,l,c,f,d;a===void 0&&(a=ge.safeDescriptors),Tde(e,t,r,n);var h=n.value;if((s=t.options_)!=null&&s.bound){var m;h=h.bind((m=e.proxy_)!=null?m:e.target_)}return{value:uo((i=(o=t.options_)==null?void 0:o.name)!=null?i:r.toString(),h,(l=(c=t.options_)==null?void 0:c.autoAction)!=null?l:!1,(f=t.options_)!=null&&f.bound?(d=e.proxy_)!=null?d:e.target_:void 0),configurable:a?e.isPlainObject_:!0,enumerable:!1,writable:!a}}function DO(e,t){return{annotationType_:e,options_:t,make_:Cde,extend_:Nde,decorate_20223_:Ade}}function Cde(e,t,r,n){var a;if(n===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if((a=this.options_)!=null&&a.bound&&(!ss(e.target_,t)||!uf(e.target_[t]))&&this.extend_(e,t,r,!1)===null)return 0;if(uf(r.value))return 1;var s=jO(e,this,t,r,!1,!1);return Ca(n,t,s),2}function Nde(e,t,r,n){var a,s=jO(e,this,t,r,(a=this.options_)==null?void 0:a.bound);return e.defineProperty_(t,s,n)}function Ade(e,t){var r,n=t.name,a=t.addInitializer;return uf(e)||(e=Pl(e)),(r=this.options_)!=null&&r.bound&&a(function(){var s=this,i=s[n].bind(s);i.isMobXFlow=!0,s[n]=i}),e}function Ode(e,t,r,n){t.annotationType_,n.value}function jO(e,t,r,n,a,s){s===void 0&&(s=ge.safeDescriptors),Ode(e,t,r,n);var i=n.value;if(uf(i)||(i=Pl(i)),a){var o;i=i.bind((o=e.proxy_)!=null?o:e.target_),i.isMobXFlow=!0}return{value:i,configurable:s?e.isPlainObject_:!0,enumerable:!1,writable:!s}}function Vy(e,t){return{annotationType_:e,options_:t,make_:Dde,extend_:jde,decorate_20223_:Pde}}function Dde(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function jde(e,t,r,n){return Fde(e,this,t,r),e.defineComputedProperty_(t,lo({},this.options_,{get:r.get,set:r.set}),n)}function Pde(e,t){var r=this,n=t.name,a=t.addInitializer;return a(function(){var s=cc(this)[Ce],i=lo({},r.options_,{get:e,context:this});i.name||(i.name="ObservableObject."+n.toString()),s.values_.set(n,new ca(i))}),function(){return this[Ce].getObservablePropValue_(n)}}function Fde(e,t,r,n){t.annotationType_,n.get}function Fp(e,t){return{annotationType_:e,options_:t,make_:Rde,extend_:Mde,decorate_20223_:Ide}}function Rde(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function Mde(e,t,r,n){var a,s;return Lde(e,this),e.defineObservableProperty_(t,r.value,(a=(s=this.options_)==null?void 0:s.enhancer)!=null?a:co,n)}function Ide(e,t){var r=this,n=t.kind,a=t.name,s=new WeakSet;function i(o,l){var c,f,d=cc(o)[Ce],h=new Hi(l,(c=(f=r.options_)==null?void 0:f.enhancer)!=null?c:co,"ObservableObject."+a.toString(),!1);d.values_.set(a,h),s.add(o)}if(n=="accessor")return{get:function(){return s.has(this)||i(this,e.get.call(this)),this[Ce].getObservablePropValue_(a)},set:function(l){return s.has(this)||i(this,l),this[Ce].setObservablePropValue_(a,l)},init:function(l){return s.has(this)||i(this,l),l}}}function Lde(e,t,r,n){t.annotationType_}var $de="true",Ude=PO();function PO(e){return{annotationType_:$de,options_:e,make_:Bde,extend_:Wde,decorate_20223_:Vde}}function Bde(e,t,r,n){var a,s;if(r.get)return Rp.make_(e,t,r,n);if(r.set){var i=uo(t.toString(),r.set);return n===e.target_?e.defineProperty_(t,{configurable:ge.safeDescriptors?e.isPlainObject_:!0,set:i})===null?0:2:(Ca(n,t,{configurable:!0,set:i}),2)}if(n!==e.target_&&typeof r.value=="function"){var o;if(EO(r.value)){var l,c=(l=this.options_)!=null&&l.autoBind?Pl.bound:Pl;return c.make_(e,t,r,n)}var f=(o=this.options_)!=null&&o.autoBind?lf.bound:lf;return f.make_(e,t,r,n)}var d=((a=this.options_)==null?void 0:a.deep)===!1?nr.ref:nr;if(typeof r.value=="function"&&(s=this.options_)!=null&&s.autoBind){var h;r.value=r.value.bind((h=e.proxy_)!=null?h:e.target_)}return d.make_(e,t,r,n)}function Wde(e,t,r,n){var a,s;if(r.get)return Rp.extend_(e,t,r,n);if(r.set)return e.defineProperty_(t,{configurable:ge.safeDescriptors?e.isPlainObject_:!0,set:uo(t.toString(),r.set)},n);if(typeof r.value=="function"&&(a=this.options_)!=null&&a.autoBind){var i;r.value=r.value.bind((i=e.proxy_)!=null?i:e.target_)}var o=((s=this.options_)==null?void 0:s.deep)===!1?nr.ref:nr;return o.extend_(e,t,r,n)}function Vde(e,t){Ye("'"+this.annotationType_+"' cannot be used as a decorator")}var Hde="observable",zde="observable.ref",Yde="observable.shallow",Gde="observable.struct",FO={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(FO);function Fd(e){return e||FO}var Bg=Fp(Hde),Kde=Fp(zde,{enhancer:Pp}),qde=Fp(Yde,{enhancer:yde}),Xde=Fp(Gde,{enhancer:_de}),RO=Na(Bg);function Rd(e){return e.deep===!0?co:e.deep===!1?Pp:Qde(e.defaultDecorator)}function Jde(e){var t;return e?(t=e.defaultDecorator)!=null?t:PO(e):void 0}function Qde(e){var t,r;return e&&(t=(r=e.options_)==null?void 0:r.enhancer)!=null?t:co}function MO(e,t,r){if(Vf(t))return Bg.decorate_20223_(e,t);if(oo(t)){Wf(e,t,Bg);return}return eD(e)?e:ui(e)?nr.object(e,t,r):Array.isArray(e)?nr.array(e,t):oc(e)?nr.map(e,t):Ga(e)?nr.set(e,t):typeof e=="object"&&e!==null?e:nr.box(e,t)}_O(MO,RO);var Zde={box:function(t,r){var n=Fd(r);return new Hi(t,Rd(n),n.name,!0,n.equals)},array:function(t,r){var n=Fd(r);return(ge.useProxies===!1||n.proxy===!1?J0e:B0e)(t,Rd(n),n.name)},map:function(t,r){var n=Fd(r);return new rD(t,Rd(n),n.name)},set:function(t,r){var n=Fd(r);return new nD(t,Rd(n),n.name)},object:function(t,r,n){return To(function(){return O0e(ge.useProxies===!1||(n==null?void 0:n.proxy)===!1?cc({},n):I0e({},n),t,r)})},ref:Na(Kde),shallow:Na(qde),deep:RO,struct:Na(Xde)},nr=_O(MO,Zde),IO="computed",e0e="computed.struct",Wg=Vy(IO),t0e=Vy(e0e,{equals:dh.structural}),Rp=function(t,r){if(Vf(r))return Wg.decorate_20223_(t,r);if(oo(r))return Wf(t,r,Wg);if(ui(t))return Na(Vy(IO,t));var n=ui(r)?r:{};return n.get=t,n.name||(n.name=t.name||""),new ca(n)};Object.assign(Rp,Wg);Rp.struct=Na(t0e);var IS,LS,hh=0,r0e=1,n0e=(IS=(LS=fh(function(){},"name"))==null?void 0:LS.configurable)!=null?IS:!1,$S={value:"action",configurable:!0,writable:!1,enumerable:!1};function uo(e,t,r,n){r===void 0&&(r=!1);function a(){return a0e(e,r,t,n||this,arguments)}return a.isMobxAction=!0,a.toString=function(){return t.toString()},n0e&&($S.value=e,Ca(a,"name",$S)),a}function a0e(e,t,r,n,a){var s=s0e(e,t);try{return r.apply(n,a)}catch(i){throw s.error_=i,i}finally{i0e(s)}}function s0e(e,t,r,n){var a=!1,s=0,i=ge.trackingDerivation,o=!t||!i;Tn();var l=ge.allowStateChanges;o&&(Eo(),l=Hy(!0));var c=Yy(!0),f={runAsAction_:o,prevDerivation_:i,prevAllowStateChanges_:l,prevAllowStateReads_:c,notifySpy_:a,startTime_:s,actionId_:r0e++,parentActionId_:hh};return hh=f.actionId_,f}function i0e(e){hh!==e.actionId_&&Ye(30),hh=e.parentActionId_,e.error_!==void 0&&(ge.suppressReactionErrors=!0),zy(e.prevAllowStateChanges_),hu(e.prevAllowStateReads_),Cn(),e.runAsAction_&&is(e.prevDerivation_),ge.suppressReactionErrors=!1}function Hy(e){var t=ge.allowStateChanges;return ge.allowStateChanges=e,t}function zy(e){ge.allowStateChanges=e}var Hi=function(e){function t(n,a,s,i,o){var l;return s===void 0&&(s="ObservableValue"),o===void 0&&(o=dh.default),l=e.call(this,s)||this,l.enhancer=void 0,l.name_=void 0,l.equals=void 0,l.hasUnreportedChange_=!1,l.interceptors_=void 0,l.changeListeners_=void 0,l.value_=void 0,l.dehancer=void 0,l.enhancer=a,l.name_=s,l.equals=o,l.value_=a(n,void 0,s),l}NO(t,e);var r=t.prototype;return r.dehanceValue=function(a){return this.dehancer!==void 0?this.dehancer(a):a},r.set=function(a){this.value_,a=this.prepareNewValue_(a),a!==ge.UNCHANGED&&this.setNewValue_(a)},r.prepareNewValue_=function(a){if(Sn(this)){var s=En(this,{object:this,type:Aa,newValue:a});if(!s)return ge.UNCHANGED;a=s.newValue}return a=this.enhancer(a,this.value_,this.name_),this.equals(this.value_,a)?ge.UNCHANGED:a},r.setNewValue_=function(a){var s=this.value_;this.value_=a,this.reportChanged(),ra(this)&&na(this,{type:Aa,object:this,newValue:a,oldValue:s})},r.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},r.intercept_=function(a){return zf(this,a)},r.observe_=function(a,s){return s&&a({observableKind:"value",debugObjectName:this.name_,object:this,type:Aa,newValue:this.value_,oldValue:void 0}),Yf(this,a)},r.raw=function(){return this.value_},r.toJSON=function(){return this.get()},r.toString=function(){return this.name_+"["+this.value_+"]"},r.valueOf=function(){return CO(this.get())},r[Symbol.toPrimitive]=function(){return this.valueOf()},t}(_i),ca=function(){function e(r){this.dependenciesState_=Ge.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ge.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new mh(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=ph.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,r.get||Ye(31),this.derivation=r.get,this.name_=r.name||"ComputedValue",r.set&&(this.setter_=uo("ComputedValue-setter",r.set)),this.equals_=r.equals||(r.compareStructural||r.struct?dh.structural:dh.default),this.scope_=r.context,this.requiresReaction_=r.requiresReaction,this.keepAlive_=!!r.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){f0e(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},t.get=function(){if(this.isComputing&&Ye(32,this.name_,this.derivation),ge.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)Vg(this)&&(this.warnAboutUntrackedRead_(),Tn(),this.value_=this.computeValue_(!1),Cn());else if(HO(this),Vg(this)){var n=ge.trackingContext;this.keepAlive_&&!n&&(ge.trackingContext=this),this.trackAndCompute()&&u0e(this),ge.trackingContext=n}var a=this.value_;if(a0(a))throw a.cause;return a},t.set=function(n){if(this.setter_){this.isRunningSetter&&Ye(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter=!1}}else Ye(34,this.name_)},t.trackAndCompute=function(){var n=this.value_,a=this.dependenciesState_===Ge.NOT_TRACKING_,s=this.computeValue_(!0),i=a||a0(n)||a0(s)||!this.equals_(n,s);return i&&(this.value_=s),i},t.computeValue_=function(n){this.isComputing=!0;var a=Hy(!1),s;if(n)s=LO(this,this.derivation,this.scope_);else if(ge.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(i){s=new mh(i)}return zy(a),this.isComputing=!1,s},t.suspend_=function(){this.keepAlive_||(Hg(this),this.value_=void 0)},t.observe_=function(n,a){var s=this,i=!0,o=void 0;return w0e(function(){var l=s.get();if(!i||a){var c=Eo();n({observableKind:"computed",debugObjectName:s.name_,type:Aa,object:s,newValue:l,oldValue:o}),is(c)}i=!1,o=l})},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return CO(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},lc(e,[{key:"isComputing",get:function(){return rn(this.flags_,e.isComputingMask_)},set:function(n){this.flags_=nn(this.flags_,e.isComputingMask_,n)}},{key:"isRunningSetter",get:function(){return rn(this.flags_,e.isRunningSetterMask_)},set:function(n){this.flags_=nn(this.flags_,e.isRunningSetterMask_,n)}},{key:"isBeingObserved",get:function(){return rn(this.flags_,e.isBeingObservedMask_)},set:function(n){this.flags_=nn(this.flags_,e.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return rn(this.flags_,e.isPendingUnobservationMask_)},set:function(n){this.flags_=nn(this.flags_,e.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return rn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=nn(this.flags_,e.diffValueMask_,n===1)}}])}();ca.isComputingMask_=1;ca.isRunningSetterMask_=2;ca.isBeingObservedMask_=4;ca.isPendingUnobservationMask_=8;ca.diffValueMask_=16;var Mp=So("ComputedValue",ca),Ge;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(Ge||(Ge={}));var ph;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(ph||(ph={}));var mh=function(t){this.cause=void 0,this.cause=t};function a0(e){return e instanceof mh}function Vg(e){switch(e.dependenciesState_){case Ge.UP_TO_DATE_:return!1;case Ge.NOT_TRACKING_:case Ge.STALE_:return!0;case Ge.POSSIBLY_STALE_:{for(var t=Yy(!0),r=Eo(),n=e.observing_,a=n.length,s=0;s<a;s++){var i=n[s];if(Mp(i)){if(ge.disableErrorBoundaries)i.get();else try{i.get()}catch{return is(r),hu(t),!0}if(e.dependenciesState_===Ge.STALE_)return is(r),hu(t),!0}}return UO(e),is(r),hu(t),!1}}}function LO(e,t,r){var n=Yy(!0);UO(e),e.newObserving_=new Array(e.runId_===0?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++ge.runId;var a=ge.trackingDerivation;ge.trackingDerivation=e,ge.inBatch++;var s;if(ge.disableErrorBoundaries===!0)s=t.call(r);else try{s=t.call(r)}catch(i){s=new mh(i)}return ge.inBatch--,ge.trackingDerivation=a,o0e(e),hu(n),s}function o0e(e){for(var t=e.observing_,r=e.observing_=e.newObserving_,n=Ge.UP_TO_DATE_,a=0,s=e.unboundDepsCount_,i=0;i<s;i++){var o=r[i];o.diffValue===0&&(o.diffValue=1,a!==i&&(r[a]=o),a++),o.dependenciesState_>n&&(n=o.dependenciesState_)}for(r.length=a,e.newObserving_=null,s=t.length;s--;){var l=t[s];l.diffValue===0&&WO(l,e),l.diffValue=0}for(;a--;){var c=r[a];c.diffValue===1&&(c.diffValue=0,c0e(c,e))}n!==Ge.UP_TO_DATE_&&(e.dependenciesState_=n,e.onBecomeStale_())}function Hg(e){var t=e.observing_;e.observing_=[];for(var r=t.length;r--;)WO(t[r],e);e.dependenciesState_=Ge.NOT_TRACKING_}function $O(e){var t=Eo();try{return e()}finally{is(t)}}function Eo(){var e=ge.trackingDerivation;return ge.trackingDerivation=null,e}function is(e){ge.trackingDerivation=e}function Yy(e){var t=ge.allowStateReads;return ge.allowStateReads=e,t}function hu(e){ge.allowStateReads=e}function UO(e){if(e.dependenciesState_!==Ge.UP_TO_DATE_){e.dependenciesState_=Ge.UP_TO_DATE_;for(var t=e.observing_,r=t.length;r--;)t[r].lowestObserverState_=Ge.UP_TO_DATE_}}var s0=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},i0=!0,BO=!1,ge=function(){var e=Np();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(i0=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new s0().version&&(i0=!1),i0?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new s0):(setTimeout(function(){BO||Ye(35)},1),new s0)}();function l0e(){if((ge.pendingReactions.length||ge.inBatch||ge.isRunningReactions)&&Ye(36),BO=!0,i0){var e=Np();--e.__mobxInstanceCount===0&&(e.__mobxGlobals=void 0),ge=new s0}}function c0e(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function WO(e,t){e.observers_.delete(t),e.observers_.size===0&&VO(e)}function VO(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,ge.pendingUnobservations.push(e))}function Tn(){ge.inBatch++}function Cn(){if(--ge.inBatch===0){YO();for(var e=ge.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=!1,r.observers_.size===0&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBUO()),r instanceof ca&&r.suspend_())}ge.pendingUnobservations=[]}}function HO(e){var t=ge.trackingDerivation;return t!==null?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&ge.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(e.observers_.size===0&&ge.inBatch>0&&VO(e),!1)}function zO(e){e.lowestObserverState_!==Ge.STALE_&&(e.lowestObserverState_=Ge.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ge.UP_TO_DATE_&&t.onBecomeStale_(),t.dependenciesState_=Ge.STALE_}))}function u0e(e){e.lowestObserverState_!==Ge.STALE_&&(e.lowestObserverState_=Ge.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ge.POSSIBLY_STALE_?t.dependenciesState_=Ge.STALE_:t.dependenciesState_===Ge.UP_TO_DATE_&&(e.lowestObserverState_=Ge.UP_TO_DATE_)}))}function f0e(e){e.lowestObserverState_===Ge.UP_TO_DATE_&&(e.lowestObserverState_=Ge.POSSIBLY_STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ge.UP_TO_DATE_&&(t.dependenciesState_=Ge.POSSIBLY_STALE_,t.onBecomeStale_())}))}var vs=function(){function e(r,n,a,s){r===void 0&&(r="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Ge.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=ph.NONE,this.name_=r,this.onInvalidate_=n,this.errorHandler_=a,this.requiresObservable_=s}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,ge.pendingReactions.push(this),YO())},t.runReaction_=function(){if(!this.isDisposed){Tn(),this.isScheduled=!1;var n=ge.trackingContext;if(ge.trackingContext=this,Vg(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(a){this.reportExceptionInDerivation_(a)}}ge.trackingContext=n,Cn()}},t.track=function(n){if(!this.isDisposed){Tn(),this.isRunning=!0;var a=ge.trackingContext;ge.trackingContext=this;var s=LO(this,n,void 0);ge.trackingContext=a,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&Hg(this),a0(s)&&this.reportExceptionInDerivation_(s.cause),Cn()}},t.reportExceptionInDerivation_=function(n){var a=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(ge.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";ge.suppressReactionErrors||console.error(s,n),ge.globalReactionErrorHandlers.forEach(function(i){return i(n,a)})},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Tn(),Hg(this),Cn()))},t.getDisposer_=function(n){var a=this,s=function i(){a.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",i)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[Ce]=this,s},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(n){},lc(e,[{key:"isDisposed",get:function(){return rn(this.flags_,e.isDisposedMask_)},set:function(n){this.flags_=nn(this.flags_,e.isDisposedMask_,n)}},{key:"isScheduled",get:function(){return rn(this.flags_,e.isScheduledMask_)},set:function(n){this.flags_=nn(this.flags_,e.isScheduledMask_,n)}},{key:"isTrackPending",get:function(){return rn(this.flags_,e.isTrackPendingMask_)},set:function(n){this.flags_=nn(this.flags_,e.isTrackPendingMask_,n)}},{key:"isRunning",get:function(){return rn(this.flags_,e.isRunningMask_)},set:function(n){this.flags_=nn(this.flags_,e.isRunningMask_,n)}},{key:"diffValue",get:function(){return rn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=nn(this.flags_,e.diffValueMask_,n===1)}}])}();vs.isDisposedMask_=1;vs.isScheduledMask_=2;vs.isTrackPendingMask_=4;vs.isRunningMask_=8;vs.diffValueMask_=16;var d0e=100,zg=function(t){return t()};function YO(){ge.inBatch>0||ge.isRunningReactions||zg(h0e)}function h0e(){ge.isRunningReactions=!0;for(var e=ge.pendingReactions,t=0;e.length>0;){++t===d0e&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var r=e.splice(0),n=0,a=r.length;n<a;n++)r[n].runReaction_()}ge.isRunningReactions=!1}var vh=So("Reaction",vs);function p0e(e){var t=zg;zg=function(n){return e(function(){return t(n)})}}function pu(){return!1}function m0e(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var GO="action",v0e="action.bound",KO="autoAction",g0e="autoAction.bound",x0e="<unnamed action>",Yg=Hf(GO),y0e=Hf(v0e,{bound:!0}),Gg=Hf(KO,{autoAction:!0}),_0e=Hf(g0e,{autoAction:!0,bound:!0});function qO(e){var t=function(n,a){if(la(n))return uo(n.name||x0e,n,e);if(la(a))return uo(n,a,e);if(Vf(a))return(e?Gg:Yg).decorate_20223_(n,a);if(oo(a))return Wf(n,a,e?Gg:Yg);if(oo(n))return Na(Hf(e?KO:GO,{name:n,autoAction:e}))};return t}var el=qO(!1);Object.assign(el,Yg);var lf=qO(!0);Object.assign(lf,Gg);el.bound=Na(y0e);lf.bound=Na(_0e);function cf(e){return la(e)&&e.isMobxAction===!0}function w0e(e,t){var r,n,a,s;t===void 0&&(t=wO);var i=(r=(n=t)==null?void 0:n.name)!=null?r:"Autorun",o=!t.scheduler&&!t.delay,l;if(o)l=new vs(i,function(){this.track(d)},t.onError,t.requiresObservable);else{var c=S0e(t),f=!1;l=new vs(i,function(){f||(f=!0,c(function(){f=!1,l.isDisposed||l.track(d)}))},t.onError,t.requiresObservable)}function d(){e(l)}return(a=t)!=null&&(a=a.signal)!=null&&a.aborted||l.schedule_(),l.getDisposer_((s=t)==null?void 0:s.signal)}var b0e=function(t){return t()};function S0e(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:b0e}var E0e="onBO",k0e="onBUO";function T0e(e,t,r){return JO(E0e,e,t,r)}function XO(e,t,r){return JO(k0e,e,t,r)}function JO(e,t,r,n){var a=yh(t),s=la(n)?n:r,i=e+"L";return a[i]?a[i].add(s):a[i]=new Set([s]),function(){var o=a[i];o&&(o.delete(s),o.size===0&&delete a[i])}}var C0e="never",Md="always",N0e="observed";function A0e(e){e.isolateGlobalState===!0&&l0e();var t=e.useProxies,r=e.enforceActions;if(t!==void 0&&(ge.useProxies=t===Md?!0:t===C0e?!1:typeof Proxy<"u"),t==="ifavailable"&&(ge.verifyProxies=!0),r!==void 0){var n=r===Md?Md:r===N0e;ge.enforceActions=n,ge.allowStateChanges=!(n===!0||n===Md)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(a){a in e&&(ge[a]=!!e[a])}),ge.allowStateReads=!ge.observableRequiresReaction,e.reactionScheduler&&p0e(e.reactionScheduler)}function O0e(e,t,r,n){var a=cde(t);return To(function(){var s=cc(e,n)[Ce];jp(a).forEach(function(i){s.extend_(i,a[i],r&&i in r?r[i]:!0)})}),e}function D0e(e,t){return QO(yh(e,t))}function QO(e){var t={name:e.name_};return e.observing_&&e.observing_.length>0&&(t.dependencies=j0e(e.observing_).map(QO)),t}function j0e(e){return Array.from(new Set(e))}var P0e=0;function ZO(){this.message="FLOW_CANCELLED"}ZO.prototype=Object.create(Error.prototype);var qm=DO("flow"),F0e=DO("flow.bound",{bound:!0}),Pl=Object.assign(function(t,r){if(Vf(r))return qm.decorate_20223_(t,r);if(oo(r))return Wf(t,r,qm);var n=t,a=n.name||"<unnamed flow>",s=function(){var o=this,l=arguments,c=++P0e,f=el(a+" - runid: "+c+" - init",n).apply(o,l),d,h=void 0,m=new Promise(function(v,p){var _=0;d=p;function g(w){h=void 0;var E;try{E=el(a+" - runid: "+c+" - yield "+_++,f.next).call(f,w)}catch(S){return p(S)}x(E)}function y(w){h=void 0;var E;try{E=el(a+" - runid: "+c+" - yield "+_++,f.throw).call(f,w)}catch(S){return p(S)}x(E)}function x(w){if(la(w==null?void 0:w.then)){w.then(x,p);return}return w.done?v(w.value):(h=Promise.resolve(w.value),h.then(g,y))}g(void 0)});return m.cancel=el(a+" - runid: "+c+" - cancel",function(){try{h&&US(h);var v=f.return(void 0),p=Promise.resolve(v.value);p.then(Qo,Qo),US(p),d(new ZO)}catch(_){d(_)}}),m};return s.isMobXFlow=!0,s},qm);Pl.bound=Na(F0e);function US(e){la(e.cancel)&&e.cancel()}function uf(e){return(e==null?void 0:e.isMobXFlow)===!0}function R0e(e,t){return e?Lp(e)||!!e[Ce]||Wy(e)||vh(e)||Mp(e):!1}function eD(e){return R0e(e)}function Ka(e,t){t===void 0&&(t=void 0),Tn();try{return e.apply(t)}finally{Cn()}}function Po(e){return e[Ce]}var M0e={has:function(t,r){return Po(t).has_(r)},get:function(t,r){return Po(t).get_(r)},set:function(t,r,n){var a;return oo(r)?(a=Po(t).set_(r,n,!0))!=null?a:!0:!1},deleteProperty:function(t,r){var n;return oo(r)?(n=Po(t).delete_(r,!0))!=null?n:!0:!1},defineProperty:function(t,r,n){var a;return(a=Po(t).defineProperty_(r,n))!=null?a:!0},ownKeys:function(t){return Po(t).ownKeys_()},preventExtensions:function(t){Ye(13)}};function I0e(e,t){var r,n;return bO(),e=cc(e,t),(n=(r=e[Ce]).proxy_)!=null?n:r.proxy_=new Proxy(e,M0e)}function Sn(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function zf(e,t){var r=e.interceptors_||(e.interceptors_=[]);return r.push(t),SO(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function En(e,t){var r=Eo();try{for(var n=[].concat(e.interceptors_||[]),a=0,s=n.length;a<s&&(t=n[a](t),t&&!t.type&&Ye(14),!!t);a++);return t}finally{is(r)}}function ra(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function Yf(e,t){var r=e.changeListeners_||(e.changeListeners_=[]);return r.push(t),SO(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function na(e,t){var r=Eo(),n=e.changeListeners_;if(n){n=n.slice();for(var a=0,s=n.length;a<s;a++)n[a](t);is(r)}}function L0e(e,t,r){return To(function(){var n,a=cc(e,r)[Ce];(n=t)!=null||(t=pde(e)),jp(t).forEach(function(s){return a.make_(s,t[s])})}),e}var BS="splice",Aa="update",$0e=1e4,U0e={get:function(t,r){var n=t[Ce];return r===Ce?n:r==="length"?n.getArrayLength_():typeof r=="string"&&!isNaN(r)?n.get_(parseInt(r)):ss(gh,r)?gh[r]:t[r]},set:function(t,r,n){var a=t[Ce];return r==="length"&&a.setArrayLength_(n),typeof r=="symbol"||isNaN(r)?t[r]=n:a.set_(parseInt(r),n),!0},preventExtensions:function(){Ye(15)}},Gy=function(){function e(r,n,a,s){r===void 0&&(r="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=a,this.legacyMode_=s,this.atom_=new _i(r),this.enhancer_=function(i,o){return n(i,o,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},t.intercept_=function(n){return zf(this,n)},t.observe_=function(n,a){return a===void 0&&(a=!1),a&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Yf(this,n)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&Ye("Out of range: "+n);var a=this.values_.length;if(n!==a)if(n>a){for(var s=new Array(n-a),i=0;i<n-a;i++)s[i]=void 0;this.spliceWithArray_(a,0,s)}else this.spliceWithArray_(n,a-n)},t.updateArrayLength_=function(n,a){n!==this.lastKnownLength_&&Ye(16),this.lastKnownLength_+=a,this.legacyMode_&&a>0&&oD(n+a+1)},t.spliceWithArray_=function(n,a,s){var i=this;this.atom_;var o=this.values_.length;if(n===void 0?n=0:n>o?n=o:n<0&&(n=Math.max(0,o+n)),arguments.length===1?a=o-n:a==null?a=0:a=Math.max(0,Math.min(a,o-n)),s===void 0&&(s=$g),Sn(this)){var l=En(this,{object:this.proxy_,type:BS,index:n,removedCount:a,added:s});if(!l)return $g;a=l.removedCount,s=l.added}if(s=s.length===0?s:s.map(function(d){return i.enhancer_(d,void 0)}),this.legacyMode_){var c=s.length-a;this.updateArrayLength_(o,c)}var f=this.spliceItemsIntoValues_(n,a,s);return(a!==0||s.length!==0)&&this.notifyArraySplice_(n,s,f),this.dehanceValues_(f)},t.spliceItemsIntoValues_=function(n,a,s){if(s.length<$0e){var i;return(i=this.values_).splice.apply(i,[n,a].concat(s))}else{var o=this.values_.slice(n,n+a),l=this.values_.slice(n+a);this.values_.length+=s.length-a;for(var c=0;c<s.length;c++)this.values_[n+c]=s[c];for(var f=0;f<l.length;f++)this.values_[n+s.length+f]=l[f];return o}},t.notifyArrayChildUpdate_=function(n,a,s){var i=!this.owned_&&pu(),o=ra(this),l=o||i?{observableKind:"array",object:this.proxy_,type:Aa,debugObjectName:this.atom_.name_,index:n,newValue:a,oldValue:s}:null;this.atom_.reportChanged(),o&&na(this,l)},t.notifyArraySplice_=function(n,a,s){var i=!this.owned_&&pu(),o=ra(this),l=o||i?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:BS,index:n,removed:s,added:a,removedCount:s.length,addedCount:a.length}:null;this.atom_.reportChanged(),o&&na(this,l)},t.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},t.set_=function(n,a){var s=this.values_;if(this.legacyMode_&&n>s.length&&Ye(17,n,s.length),n<s.length){this.atom_;var i=s[n];if(Sn(this)){var o=En(this,{type:Aa,object:this.proxy_,index:n,newValue:a});if(!o)return;a=o.newValue}a=this.enhancer_(a,i);var l=a!==i;l&&(s[n]=a,this.notifyArrayChildUpdate_(n,a,i))}else{for(var c=new Array(n+1-s.length),f=0;f<c.length-1;f++)c[f]=void 0;c[c.length-1]=a,this.spliceWithArray_(s.length,0,c)}},e}();function B0e(e,t,r,n){return r===void 0&&(r="ObservableArray"),n===void 0&&(n=!1),bO(),To(function(){var a=new Gy(r,t,n,!1);kO(a.values_,Ce,a);var s=new Proxy(a.values_,U0e);return a.proxy_=s,e&&e.length&&a.spliceWithArray_(0,0,e),s})}var gh={clear:function(){return this.splice(0)},replace:function(t){var r=this[Ce];return r.spliceWithArray_(0,r.values_.length,t)},toJSON:function(){return this.slice()},splice:function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];var i=this[Ce];switch(arguments.length){case 0:return[];case 1:return i.spliceWithArray_(t);case 2:return i.spliceWithArray_(t,r)}return i.spliceWithArray_(t,r,a)},spliceWithArray:function(t,r,n){return this[Ce].spliceWithArray_(t,r,n)},push:function(){for(var t=this[Ce],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.spliceWithArray_(t.values_.length,0,n),t.values_.length},pop:function(){return this.splice(Math.max(this[Ce].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=this[Ce],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.spliceWithArray_(0,0,n),t.values_.length},reverse:function(){return ge.trackingDerivation&&Ye(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){ge.trackingDerivation&&Ye(37,"sort");var t=this.slice();return t.sort.apply(t,arguments),this.replace(t),this},remove:function(t){var r=this[Ce],n=r.dehanceValues_(r.values_).indexOf(t);return n>-1?(this.splice(n,1),!0):!1}};it("at",hn);it("concat",hn);it("flat",hn);it("includes",hn);it("indexOf",hn);it("join",hn);it("lastIndexOf",hn);it("slice",hn);it("toString",hn);it("toLocaleString",hn);it("toSorted",hn);it("toSpliced",hn);it("with",hn);it("every",fa);it("filter",fa);it("find",fa);it("findIndex",fa);it("findLast",fa);it("findLastIndex",fa);it("flatMap",fa);it("forEach",fa);it("map",fa);it("some",fa);it("toReversed",fa);it("reduce",tD);it("reduceRight",tD);function it(e,t){typeof Array.prototype[e]=="function"&&(gh[e]=t(e))}function hn(e){return function(){var t=this[Ce];t.atom_.reportObserved();var r=t.dehanceValues_(t.values_);return r[e].apply(r,arguments)}}function fa(e){return function(t,r){var n=this,a=this[Ce];a.atom_.reportObserved();var s=a.dehanceValues_(a.values_);return s[e](function(i,o){return t.call(r,i,o,n)})}}function tD(e){return function(){var t=this,r=this[Ce];r.atom_.reportObserved();var n=r.dehanceValues_(r.values_),a=arguments[0];return arguments[0]=function(s,i,o){return a(s,i,o,t)},n[e].apply(n,arguments)}}var W0e=So("ObservableArrayAdministration",Gy);function Ip(e){return Op(e)&&W0e(e[Ce])}var V0e={},zs="add",xh="delete",rD=function(){function e(r,n,a){var s=this;n===void 0&&(n=co),a===void 0&&(a="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[Ce]=V0e,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=a,la(Map)||Ye(18),To(function(){s.keysAtom_=AO("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,r&&s.merge(r)})}var t=e.prototype;return t.has_=function(n){return this.data_.has(n)},t.has=function(n){var a=this;if(!ge.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var i=s=new Hi(this.has_(n),Pp,"ObservableMap.key?",!1);this.hasMap_.set(n,i),XO(i,function(){return a.hasMap_.delete(n)})}return s.get()},t.set=function(n,a){var s=this.has_(n);if(Sn(this)){var i=En(this,{type:s?Aa:zs,object:this,newValue:a,name:n});if(!i)return this;a=i.newValue}return s?this.updateValue_(n,a):this.addValue_(n,a),this},t.delete=function(n){var a=this;if(this.keysAtom_,Sn(this)){var s=En(this,{type:xh,object:this,name:n});if(!s)return!1}if(this.has_(n)){var i=pu(),o=ra(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:xh,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return Ka(function(){var c;a.keysAtom_.reportChanged(),(c=a.hasMap_.get(n))==null||c.setNewValue_(!1);var f=a.data_.get(n);f.setNewValue_(void 0),a.data_.delete(n)}),o&&na(this,l),!0}return!1},t.updateValue_=function(n,a){var s=this.data_.get(n);if(a=s.prepareNewValue_(a),a!==ge.UNCHANGED){var i=pu(),o=ra(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:Aa,object:this,oldValue:s.value_,name:n,newValue:a}:null;s.setNewValue_(a),o&&na(this,l)}},t.addValue_=function(n,a){var s=this;this.keysAtom_,Ka(function(){var c,f=new Hi(a,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,f),a=f.value_,(c=s.hasMap_.get(n))==null||c.setNewValue_(!0),s.keysAtom_.reportChanged()});var i=pu(),o=ra(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:zs,object:this,name:n,newValue:a}:null;o&&na(this,l)},t.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var n=this,a=this.keys();return WS({next:function(){var i=a.next(),o=i.done,l=i.value;return{done:o,value:o?void 0:n.get(l)}}})},t.entries=function(){var n=this,a=this.keys();return WS({next:function(){var i=a.next(),o=i.done,l=i.value;return{done:o,value:o?void 0:[l,n.get(l)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(n,a){for(var s=Zo(this),i;!(i=s()).done;){var o=i.value,l=o[0],c=o[1];n.call(a,c,l,this)}},t.merge=function(n){var a=this;return ko(n)&&(n=new Map(n)),Ka(function(){ui(n)?lde(n).forEach(function(s){return a.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var i=s[0],o=s[1];return a.set(i,o)}):oc(n)?(ode(n)||Ye(19,n),n.forEach(function(s,i){return a.set(i,s)})):n!=null&&Ye(20,n)}),this},t.clear=function(){var n=this;Ka(function(){$O(function(){for(var a=Zo(n.keys()),s;!(s=a()).done;){var i=s.value;n.delete(i)}})})},t.replace=function(n){var a=this;return Ka(function(){for(var s=H0e(n),i=new Map,o=!1,l=Zo(a.data_.keys()),c;!(c=l()).done;){var f=c.value;if(!s.has(f)){var d=a.delete(f);if(d)o=!0;else{var h=a.data_.get(f);i.set(f,h)}}}for(var m=Zo(s.entries()),v;!(v=m()).done;){var p=v.value,_=p[0],g=p[1],y=a.data_.has(_);if(a.set(_,g),a.data_.has(_)){var x=a.data_.get(_);i.set(_,x),y||(o=!0)}}if(!o)if(a.data_.size!==i.size)a.keysAtom_.reportChanged();else for(var w=a.data_.keys(),E=i.keys(),S=w.next(),b=E.next();!S.done;){if(S.value!==b.value){a.keysAtom_.reportChanged();break}S=w.next(),b=E.next()}a.data_=i}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(n,a){return Yf(this,n)},t.intercept_=function(n){return zf(this,n)},lc(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),ko=So("ObservableMap",rD);function WS(e){return e[Symbol.toStringTag]="MapIterator",Xy(e)}function H0e(e){if(oc(e)||ko(e))return e;if(Array.isArray(e))return new Map(e);if(ui(e)){var t=new Map;for(var r in e)t.set(r,e[r]);return t}else return Ye(21,e)}var z0e={},nD=function(){function e(r,n,a){var s=this;n===void 0&&(n=co),a===void 0&&(a="ObservableSet"),this.name_=void 0,this[Ce]=z0e,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=a,la(Set)||Ye(22),this.enhancer_=function(i,o){return n(i,o,a)},To(function(){s.atom_=AO(s.name_),r&&s.replace(r)})}var t=e.prototype;return t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.clear=function(){var n=this;Ka(function(){$O(function(){for(var a=Zo(n.data_.values()),s;!(s=a()).done;){var i=s.value;n.delete(i)}})})},t.forEach=function(n,a){for(var s=Zo(this),i;!(i=s()).done;){var o=i.value;n.call(a,o,o,this)}},t.add=function(n){var a=this;if(this.atom_,Sn(this)){var s=En(this,{type:zs,object:this,newValue:n});if(!s)return this}if(!this.has(n)){Ka(function(){a.data_.add(a.enhancer_(n,void 0)),a.atom_.reportChanged()});var i=!1,o=ra(this),l=o||i?{observableKind:"set",debugObjectName:this.name_,type:zs,object:this,newValue:n}:null;o&&na(this,l)}return this},t.delete=function(n){var a=this;if(Sn(this)){var s=En(this,{type:xh,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var i=!1,o=ra(this),l=o||i?{observableKind:"set",debugObjectName:this.name_,type:xh,object:this,oldValue:n}:null;return Ka(function(){a.atom_.reportChanged(),a.data_.delete(n)}),o&&na(this,l),!0}return!1},t.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},t.entries=function(){var n=this.values();return VS({next:function(){var s=n.next(),i=s.value,o=s.done;return o?{value:void 0,done:o}:{value:[i,i],done:o}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var n=this,a=this.data_.values();return VS({next:function(){var i=a.next(),o=i.value,l=i.done;return l?{value:void 0,done:l}:{value:n.dehanceValue_(o),done:l}}})},t.intersection=function(n){if(Ga(n)&&!wa(n))return n.intersection(this);var a=new Set(this);return a.intersection(n)},t.union=function(n){if(Ga(n)&&!wa(n))return n.union(this);var a=new Set(this);return a.union(n)},t.difference=function(n){return new Set(this).difference(n)},t.symmetricDifference=function(n){if(Ga(n)&&!wa(n))return n.symmetricDifference(this);var a=new Set(this);return a.symmetricDifference(n)},t.isSubsetOf=function(n){return new Set(this).isSubsetOf(n)},t.isSupersetOf=function(n){return new Set(this).isSupersetOf(n)},t.isDisjointFrom=function(n){if(Ga(n)&&!wa(n))return n.isDisjointFrom(this);var a=new Set(this);return a.isDisjointFrom(n)},t.replace=function(n){var a=this;return wa(n)&&(n=new Set(n)),Ka(function(){Array.isArray(n)?(a.clear(),n.forEach(function(s){return a.add(s)})):Ga(n)?(a.clear(),n.forEach(function(s){return a.add(s)})):n!=null&&Ye("Cannot initialize set from "+n)}),this},t.observe_=function(n,a){return Yf(this,n)},t.intercept_=function(n){return zf(this,n)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},lc(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),wa=So("ObservableSet",nD);function VS(e){return e[Symbol.toStringTag]="SetIterator",Xy(e)}var HS=Object.create(null),zS="remove",aD=function(){function e(r,n,a,s){n===void 0&&(n=new Map),s===void 0&&(s=Ude),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=r,this.values_=n,this.name_=a,this.defaultAnnotation_=s,this.keysAtom_=new _i("ObservableObject.keys"),this.isPlainObject_=ui(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(n){return this.values_.get(n).get()},t.setObservablePropValue_=function(n,a){var s=this.values_.get(n);if(s instanceof ca)return s.set(a),!0;if(Sn(this)){var i=En(this,{type:Aa,object:this.proxy_||this.target_,name:n,newValue:a});if(!i)return null;a=i.newValue}if(a=s.prepareNewValue_(a),a!==ge.UNCHANGED){var o=ra(this),l=!1,c=o||l?{type:Aa,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:a}:null;s.setNewValue_(a),o&&na(this,c)}return!0},t.get_=function(n){return ge.trackingDerivation&&!ss(this.target_,n)&&this.has_(n),this.target_[n]},t.set_=function(n,a,s){return s===void 0&&(s=!1),ss(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,a):s?Reflect.set(this.target_,n,a):(this.target_[n]=a,!0):this.extend_(n,{value:a,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},t.has_=function(n){if(!ge.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var a=this.pendingKeys_.get(n);return a||(a=new Hi(n in this.target_,Pp,"ObservableObject.key?",!1),this.pendingKeys_.set(n,a)),a.get()},t.make_=function(n,a){if(a===!0&&(a=this.defaultAnnotation_),a!==!1){if(!(n in this.target_)){var s;if((s=this.target_[ba])!=null&&s[n])return;Ye(1,a.annotationType_,this.name_+"."+n.toString())}for(var i=this.target_;i&&i!==Ap;){var o=fh(i,n);if(o){var l=a.make_(this,n,o,i);if(l===0)return;if(l===1)break}i=Object.getPrototypeOf(i)}GS(this,a,n)}},t.extend_=function(n,a,s,i){if(i===void 0&&(i=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,a,i);var o=s.extend_(this,n,a,i);return o&&GS(this,s,n),o},t.defineProperty_=function(n,a,s){s===void 0&&(s=!1),this.keysAtom_;try{Tn();var i=this.delete_(n);if(!i)return i;if(Sn(this)){var o=En(this,{object:this.proxy_||this.target_,name:n,type:zs,newValue:a.value});if(!o)return null;var l=o.newValue;a.value!==l&&(a=lo({},a,{value:l}))}if(s){if(!Reflect.defineProperty(this.target_,n,a))return!1}else Ca(this.target_,n,a);this.notifyPropertyAddition_(n,a.value)}finally{Cn()}return!0},t.defineObservableProperty_=function(n,a,s,i){i===void 0&&(i=!1),this.keysAtom_;try{Tn();var o=this.delete_(n);if(!o)return o;if(Sn(this)){var l=En(this,{object:this.proxy_||this.target_,name:n,type:zs,newValue:a});if(!l)return null;a=l.newValue}var c=YS(n),f={configurable:ge.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:c.get,set:c.set};if(i){if(!Reflect.defineProperty(this.target_,n,f))return!1}else Ca(this.target_,n,f);var d=new Hi(a,s,"ObservableObject.key",!1);this.values_.set(n,d),this.notifyPropertyAddition_(n,d.value_)}finally{Cn()}return!0},t.defineComputedProperty_=function(n,a,s){s===void 0&&(s=!1),this.keysAtom_;try{Tn();var i=this.delete_(n);if(!i)return i;if(Sn(this)){var o=En(this,{object:this.proxy_||this.target_,name:n,type:zs,newValue:void 0});if(!o)return null}a.name||(a.name="ObservableObject.key"),a.context=this.proxy_||this.target_;var l=YS(n),c={configurable:ge.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:l.get,set:l.set};if(s){if(!Reflect.defineProperty(this.target_,n,c))return!1}else Ca(this.target_,n,c);this.values_.set(n,new ca(a)),this.notifyPropertyAddition_(n,void 0)}finally{Cn()}return!0},t.delete_=function(n,a){if(a===void 0&&(a=!1),this.keysAtom_,!ss(this.target_,n))return!0;if(Sn(this)){var s=En(this,{object:this.proxy_||this.target_,name:n,type:zS});if(!s)return null}try{var i;Tn();var o=ra(this),l=!1,c=this.values_.get(n),f=void 0;if(!c&&(o||l)){var d;f=(d=fh(this.target_,n))==null?void 0:d.value}if(a){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(c&&(this.values_.delete(n),c instanceof Hi&&(f=c.value_),zO(c)),this.keysAtom_.reportChanged(),(i=this.pendingKeys_)==null||(i=i.get(n))==null||i.set(n in this.target_),o||l){var h={type:zS,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:f,name:n};o&&na(this,h)}}finally{Cn()}return!0},t.observe_=function(n,a){return Yf(this,n)},t.intercept_=function(n){return zf(this,n)},t.notifyPropertyAddition_=function(n,a){var s,i=ra(this),o=!1;if(i||o){var l=i||o?{type:zs,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:a}:null;i&&na(this,l)}(s=this.pendingKeys_)==null||(s=s.get(n))==null||s.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),jp(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function cc(e,t){var r;if(ss(e,Ce))return e;var n=(r=t==null?void 0:t.name)!=null?r:"ObservableObject",a=new aD(e,new Map,String(n),Jde(t));return Dp(e,Ce,a),e}var Y0e=So("ObservableObjectAdministration",aD);function YS(e){return HS[e]||(HS[e]={get:function(){return this[Ce].getObservablePropValue_(e)},set:function(r){return this[Ce].setObservablePropValue_(e,r)}})}function Lp(e){return Op(e)?Y0e(e[Ce]):!1}function GS(e,t,r){var n;(n=e.target_[ba])==null||delete n[r]}var G0e=iD(0),K0e=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,e===!1}(),Xm=0,sD=function(){};function q0e(e,t){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):e.prototype.__proto__!==void 0?e.prototype.__proto__=t:e.prototype=t}q0e(sD,Array.prototype);var Ky=function(e){function t(n,a,s,i){var o;return s===void 0&&(s="ObservableArray"),i===void 0&&(i=!1),o=e.call(this)||this,To(function(){var l=new Gy(s,a,i,!0);l.proxy_=o,kO(o,Ce,l),n&&n.length&&o.spliceWithArray(0,0,n),K0e&&Object.defineProperty(o,"0",G0e)}),o}NO(t,e);var r=t.prototype;return r.concat=function(){this[Ce].atom_.reportObserved();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return Array.prototype.concat.apply(this.slice(),s.map(function(o){return Ip(o)?o.slice():o}))},r[Symbol.iterator]=function(){var n=this,a=0;return Xy({next:function(){return a<n.length?{value:n[a++],done:!1}:{done:!0,value:void 0}}})},lc(t,[{key:"length",get:function(){return this[Ce].getArrayLength_()},set:function(a){this[Ce].setArrayLength_(a)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(sD);Object.entries(gh).forEach(function(e){var t=e[0],r=e[1];t!=="concat"&&Dp(Ky.prototype,t,r)});function iD(e){return{enumerable:!1,configurable:!0,get:function(){return this[Ce].get_(e)},set:function(r){this[Ce].set_(e,r)}}}function X0e(e){Ca(Ky.prototype,""+e,iD(e))}function oD(e){if(e>Xm){for(var t=Xm;t<e+100;t++)X0e(t);Xm=e}}oD(1e3);function J0e(e,t,r){return new Ky(e,t,r)}function yh(e,t){if(typeof e=="object"&&e!==null){if(Ip(e))return t!==void 0&&Ye(23),e[Ce].atom_;if(wa(e))return e.atom_;if(ko(e)){if(t===void 0)return e.keysAtom_;var r=e.data_.get(t)||e.hasMap_.get(t);return r||Ye(25,t,Kg(e)),r}if(Lp(e)){if(!t)return Ye(26);var n=e[Ce].values_.get(t);return n||Ye(27,t,Kg(e)),n}if(Wy(e)||Mp(e)||vh(e))return e}else if(la(e)&&vh(e[Ce]))return e[Ce];Ye(28)}function Q0e(e,t){if(e||Ye(29),Wy(e)||Mp(e)||vh(e)||ko(e)||wa(e))return e;if(e[Ce])return e[Ce];Ye(24,e)}function Kg(e,t){var r;if(t!==void 0)r=yh(e,t);else{if(cf(e))return e.name;Lp(e)||ko(e)||wa(e)?r=Q0e(e):r=yh(e)}return r.name_}function To(e){var t=Eo(),r=Hy(!0);Tn();try{return e()}finally{Cn(),zy(r),is(t)}}var KS=Ap.toString;function qy(e,t,r){return r===void 0&&(r=-1),qg(e,t,r)}function qg(e,t,r,n,a){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var s=typeof e;if(s!=="function"&&s!=="object"&&typeof t!="object")return!1;var i=KS.call(e);if(i!==KS.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":r>=0&&r++;break}e=qS(e),t=qS(t);var o=i==="[object Array]";if(!o){if(typeof e!="object"||typeof t!="object")return!1;var l=e.constructor,c=t.constructor;if(l!==c&&!(la(l)&&l instanceof l&&la(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}if(r===0)return!1;r<0&&(r=-1),n=n||[],a=a||[];for(var f=n.length;f--;)if(n[f]===e)return a[f]===t;if(n.push(e),a.push(t),o){if(f=e.length,f!==t.length)return!1;for(;f--;)if(!qg(e[f],t[f],r-1,n,a))return!1}else{var d=Object.keys(e),h;if(f=d.length,Object.keys(t).length!==f)return!1;for(;f--;)if(h=d[f],!(ss(t,h)&&qg(e[h],t[h],r-1,n,a)))return!1}return n.pop(),a.pop(),!0}function qS(e){return Ip(e)?e.slice():oc(e)||ko(e)||Ga(e)||wa(e)?Array.from(e.entries()):e}var XS,Z0e=((XS=Np().Iterator)==null?void 0:XS.prototype)||{};function Xy(e){return e[Symbol.iterator]=ehe,Object.assign(Object.create(Z0e),e)}function ehe(){return this}["Symbol","Map","Set"].forEach(function(e){var t=Np();typeof t[e]>"u"&&Ye("MobX requires global '"+e+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:m0e,extras:{getDebugName:Kg},$mobx:Ce});if(!D.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!L0e)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function the(e){e()}function rhe(e){e||(e=the),A0e({reactionScheduler:e})}function nhe(e){return D0e(e)}var ahe=1e4,she=1e4,ihe=function(){function e(t){var r=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(n){n===void 0&&(n=ahe),clearTimeout(r.sweepTimeout),r.sweepTimeout=void 0;var a=Date.now();r.registrations.forEach(function(s,i){a-s.registeredAt>=n&&(r.finalize(s.value),r.registrations.delete(i))}),r.registrations.size>0&&r.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){r.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(t,r,n){this.registrations.set(n,{value:r,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(t){this.registrations.delete(t)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,she))}}),e}(),ohe=typeof FinalizationRegistry<"u"?FinalizationRegistry:ihe,Xg=new ohe(function(e){var t;(t=e.reaction)===null||t===void 0||t.dispose(),e.reaction=null});function JS(e){e.reaction=new vs("observer".concat(e.name),function(){var t;e.stateVersion=Symbol(),(t=e.onStoreChange)===null||t===void 0||t.call(e)})}function lhe(e,t){t===void 0&&(t="observed");var r=Q.useRef(null);if(!r.current){var n={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:t,subscribe:function(o){return Xg.unregister(n),n.onStoreChange=o,n.reaction||(JS(n),n.stateVersion=Symbol()),function(){var l;n.onStoreChange=null,(l=n.reaction)===null||l===void 0||l.dispose(),n.reaction=null}},getSnapshot:function(){return n.stateVersion}};r.current=n}var a=r.current;a.reaction||(JS(a),Xg.register(r,a,a)),Q.useDebugValue(a.reaction,nhe),CT.useSyncExternalStore(a.subscribe,a.getSnapshot,a.getSnapshot);var s,i;if(a.reaction.track(function(){try{s=e()}catch(o){i=o}}),i)throw i;return s}var Jm,Qm,lD=typeof Symbol=="function"&&Symbol.for,che=(Qm=(Jm=Object.getOwnPropertyDescriptor(function(){},"name"))===null||Jm===void 0?void 0:Jm.configurable)!==null&&Qm!==void 0?Qm:!1,QS=lD?Symbol.for("react.forward_ref"):typeof D.forwardRef=="function"&&D.forwardRef(function(e){return null}).$$typeof,ZS=lD?Symbol.for("react.memo"):typeof D.memo=="function"&&D.memo(function(e){return null}).$$typeof;function uhe(e,t){var r;if(ZS&&e.$$typeof===ZS)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var n=(r=void 0)!==null&&r!==void 0?r:!1,a=e,s=e.displayName||e.name;if(QS&&e.$$typeof===QS&&(n=!0,a=e.render,typeof a!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var i=function(o,l){return lhe(function(){return a(o,l)},s)};return i.displayName=e.displayName,che&&Object.defineProperty(i,"name",{value:e.name,writable:!0,configurable:!0}),e.contextTypes&&(i.contextTypes=e.contextTypes),n&&(i=D.forwardRef(i)),i=D.memo(i),dhe(e,i),i}var fhe={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function dhe(e,t){Object.keys(e).forEach(function(r){fhe[r]||Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}var Zm;rhe(zx.unstable_batchedUpdates);Zm=Xg.finalizeAllImmediately;const hhe=uhe(()=>{var y;const e=Qe(),t=Rn(),[r,n]=D.useState(new Date),[a,s]=D.useState(!1),[i,o]=D.useState({full_name:"",role:""}),[l,c]=D.useState(!1),[f,d]=D.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[h,m]=D.useState("");D.useEffect(()=>{const x=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(x)},[]),D.useEffect(()=>{(async()=>{var w;if((w=e.user)!=null&&w.id)try{const{data:E,error:S}=await se.from("employees").select("full_name, role").eq("id",e.user.id).single();if(S)throw S;E&&o({full_name:E.full_name,role:E.role})}catch(E){console.error("Error fetching employee data:",E)}})()},[(y=e.user)==null?void 0:y.id]);const v=()=>{e.logout(),localStorage.clear(),sessionStorage.clear(),t("/login")},p=()=>{s(!a),a&&c(!1)},_=x=>{const{name:w,value:E}=x.target;d(S=>({...S,[w]:E}))},g=async x=>{if(x.preventDefault(),m(""),f.newPassword!==f.confirmPassword){m("New passwords don't match");return}if(f.newPassword.length<6){m("Password must be at least 6 characters");return}try{const{error:w}=await se.auth.updateUser({password:f.newPassword});if(w)throw w;d({currentPassword:"",newPassword:"",confirmPassword:""}),c(!1),alert("Password changed successfully!")}catch(w){console.error("Error changing password:",w),m(w.message||"Failed to change password")}};return u.jsxs("nav",{className:"bg-white text-black shadow-lg py-4 px-6 flex items-center justify-between",children:[u.jsx("div",{className:"text-left",children:u.jsx("p",{className:"text-sm font-medium text-gray-700",children:r.toLocaleTimeString()})}),u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:p,className:"flex items-center focus:outline-none",children:u.jsx(KM,{className:"w-7 h-7 text-gray-600 hover:text-gray-800"})}),a&&u.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-100",children:l?u.jsxs("div",{className:"p-3",children:[u.jsx("h3",{className:"text-sm font-medium mb-2",children:"Change Password"}),u.jsxs("form",{onSubmit:g,children:[u.jsxs("div",{className:"mb-2",children:[u.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Current Password"}),u.jsx("input",{type:"password",name:"currentPassword",value:f.currentPassword,onChange:_,className:"w-full px-2 py-1 text-sm border rounded",required:!0})]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"New Password"}),u.jsx("input",{type:"password",name:"newPassword",value:f.newPassword,onChange:_,className:"w-full px-2 py-1 text-sm border rounded",required:!0})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Confirm Password"}),u.jsx("input",{type:"password",name:"confirmPassword",value:f.confirmPassword,onChange:_,className:"w-full px-2 py-1 text-sm border rounded",required:!0})]}),h&&u.jsx("p",{className:"text-xs text-red-500 mb-2",children:h}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("button",{type:"button",onClick:()=>c(!1),className:"text-xs px-3 py-1 border rounded",children:"Cancel"}),u.jsx("button",{type:"submit",className:"text-xs px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Update"})]})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"px-4 py-2 border-b",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:i.full_name||"Loading..."}),u.jsx("p",{className:"text-xs text-gray-500 capitalize",children:i.role.toLowerCase().replace("."," • ")})]}),u.jsxs("button",{onClick:()=>c(!0),className:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[u.jsx(JM,{className:"w-4 h-4 mr-2"}),"Change Password"]}),u.jsx("button",{onClick:v,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Logout"})]})})]})]})});function phe(){const{id:e}=Ul(),[t,r]=D.useState(null),[n,a]=D.useState([]),[s,i]=D.useState([]),[o,l]=D.useState(!1),[c,f]=D.useState(!1),[d,h]=D.useState(!1),[m,v]=D.useState(!1),[p,_]=D.useState(null),[g,y]=D.useState(!1),[x,w]=D.useState({contact:!1,status:!1,quotation:!1,document:!1}),[E,S]=D.useState({document_type:"quotation",description:"",file:null}),[b,T]=D.useState(""),C=Qe(k=>k.role),F=Qe(k=>k.user);D.useEffect(()=>{e&&(M(),A(),j(),G())},[e,g]);async function M(){try{const{data:k}=await se.from("clients").select("*").eq("id",e).single();r(k);const{data:I}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(I||[]);const N=se.from("quotations").select(`
                    *,
                    employees (
                        full_name,
                        role
                    ),
                    quotation_assets (
                        asset_id,
                        quantity,
                        assets (
                            item
                        )
                    )
                `).eq("client_id",e);C!=="admin"&&C!=="head"&&N.eq("status","approved")}catch(k){console.error("Error loading client data:",k),T("Failed to load client data")}}async function j(){try{w(N=>({...N,document:!0}));const{data:k,error:I}=await se.from("documents").select(`
                    *,
                    employees (
                        full_name
                    )
                `).eq("client_id",e).order("created_at",{ascending:!1});if(I)throw I;i(k||[])}catch(k){console.error("Error loading documents:",k),T("Failed to load documents")}finally{w(k=>({...k,document:!1}))}}async function A(){try{const{data:k}=await se.from("assets").select("*").order("item")}catch(k){console.error("Error loading assets:",k),T("Failed to load assets")}}async function G(){try{if(C==="admin"||C==="finance.employee"){y(!0);return}if(!(F!=null&&F.id)||!e){y(!1);return}const{data:k,error:I}=await se.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",F.id).single();y(!!k)}catch(k){console.error("Error checking assignment:",k),T("Failed to check assignment")}}async function X(k){k.preventDefault(),w({...x,contact:!0});try{const{error:I}=await se.from("contact_persons").insert([{...newContact,client_id:e}]);if(I)throw I;setNewContact({name:"",position:"",email:"",phone:""}),l(!1),await M()}catch(I){console.error("Error adding contact person:",I),T("Failed to add contact")}finally{w({...x,contact:!1})}}async function H(k){k.preventDefault(),w({...x,contact:!0});try{const{error:I}=await se.from("contact_persons").update({name:p.name,position:p.position,email:p.email,phone:p.phone}).eq("id",p.id);if(I)throw I;_(null),await M()}catch(I){console.error("Error updating contact person:",I),T("Failed to update contact")}finally{w({...x,contact:!1})}}async function q(k){w({...x,status:!0});try{const{error:I}=await se.from("clients").update({status:k}).eq("id",e);if(I)throw I;h(!1),v(!1),await M()}catch(I){console.error("Error updating client status:",I),T("Failed to update status")}finally{w({...x,status:!1})}}async function Z(k){if(k.preventDefault(),!(!E.file||!(F!=null&&F.id))){w({...x,document:!0});try{const I=E.file.name.split(".").pop(),N=`${F.id}/${Date.now()}.${I}`,{error:P}=await se.storage.from("documents").upload(N,E.file);if(P)throw P;const{data:{publicUrl:K}}=se.storage.from("documents").getPublicUrl(N),{error:ne}=await se.from("documents").insert([{client_id:e,employee_id:F.id,document_type:E.document_type,description:E.description,file_name:E.file.name,file_url:K,file_path:N,file_type:E.file.type,file_size:E.file.size}]);if(ne)throw ne;S({document_type:"quotation",description:"",file:null}),f(!1),await j()}catch(I){console.error("Error uploading document:",I),T("Failed to upload document")}finally{w({...x,document:!1})}}}async function Y(k,I){if(confirm("Are you sure you want to delete this document?")){w({...x,document:!0});try{const{error:N}=await se.storage.from("documents").remove([I]);if(N)throw N;const{error:P}=await se.from("documents").delete().eq("id",k);if(P)throw P;await j()}catch(N){console.error("Error deleting document:",N),T("Failed to delete document")}finally{w({...x,document:!1})}}}const ce=async(k,I)=>{try{w(ne=>({...ne,document:!0}));const{data:N,error:P}=await se.storage.from("documents").createSignedUrl(k,60);if(P)throw P;if(!(N!=null&&N.signedUrl))throw new Error("No download URL available");const K=document.createElement("a");K.href=N.signedUrl,K.download=I,document.body.appendChild(K),K.click(),setTimeout(()=>{document.body.removeChild(K)},100)}catch(N){console.error("Error downloading file:",N),T(N.message||"Failed to download file")}finally{w(N=>({...N,document:!1}))}};async function z(k,I){const N=`Document: ${k.file_name}`,P=`Dear Client,

Please find below the link to your document:

${k.file_url}

Document Type: ${k.document_type}
Description: ${k.description||"N/A"}

Best regards,
${(F==null?void 0:F.full_name)||"Your Representative"}
${(F==null?void 0:F.email)||""}`;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))try{const J=await(await fetch(k.file_url)).blob(),ie=URL.createObjectURL(J),oe=k.createElement("a");oe.href=ie,oe.download=k.file_name,k.body.appendChild(oe),oe.click(),k.body.removeChild(oe);const Se=`mailto:${I}?subject=${encodeURIComponent(N)}&body=${encodeURIComponent(P)}`;window.location.href=Se,setTimeout(()=>URL.revokeObjectURL(ie),1e3)}catch(ne){console.error("Error handling document:",ne);const J=`mailto:${I}?subject=${encodeURIComponent(N)}&body=${encodeURIComponent(P)}`;window.location.href=J}else window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${I}&su=${encodeURIComponent(N)}&body=${encodeURIComponent(P)}`)}return t?u.jsxs("div",{className:"space-y-6",children:[b&&u.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[b,u.jsx("button",{onClick:()=>T(""),className:"float-right font-bold",children:"×"})]}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:x.contact,children:x.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(fs,{className:"w-4 h-4 mr-2"}),"Add Contact"]})}),u.jsx("button",{onClick:()=>f(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:x.document,children:x.document?"Loading...":u.jsxs(u.Fragment,{children:[u.jsx(Bw,{className:"w-4 h-4 mr-2"}),"Upload Document"]})})]})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(k=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:k.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:k.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Vl,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`mailto:${k.email}`,className:"hover:underline",children:k.email})]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(yf,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`tel:${k.phone}`,className:"hover:underline",children:k.phone})]})]}),C==="finance.employee"&&u.jsx("button",{onClick:()=>_(k),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},k.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Documents"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No documents found"}):u.jsx("div",{className:"space-y-4",children:s.map(k=>{var I;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Bw,{className:"w-4 h-4 text-gray-500"}),u.jsx("a",{href:k.file_url,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-blue-600 hover:underline",children:k.file_name})]}),u.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Type: ",k.document_type]}),k.description&&u.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Description: ",k.description]}),u.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Uploaded by ",(I=k.employees)==null?void 0:I.full_name," on ",new Date(k.created_at).toLocaleDateString()]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>ce(k.file_path,k.file_name),className:"p-2 text-green-600 hover:text-green-800",title:"Download document",disabled:x.document,children:u.jsx(ag,{className:"w-4 h-4"})}),n.length>0&&u.jsx("button",{onClick:()=>z(k,n[0].email),className:"p-2 text-blue-600 hover:text-blue-800",title:"Send to client",children:u.jsx(eC,{className:"w-4 h-4"})}),(C==="admin"||C==="finance.employee")&&u.jsx("button",{onClick:()=>Y(k.id,k.file_path),className:"p-2 text-red-600 hover:text-red-800",title:"Delete document",disabled:x.document,children:u.jsx(ZM,{className:"w-4 h-4"})})]})]})},k.id)})})]}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Upload Document"}),u.jsxs("form",{onSubmit:Z,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Document Type"}),u.jsxs("select",{value:E.document_type,onChange:k=>S({...E,document_type:k.target.value}),className:"w-full p-2 border rounded",required:!0,children:[u.jsx("option",{value:"quotation",children:"Quotation"}),u.jsx("option",{value:"contract",children:"Contract"}),u.jsx("option",{value:"invoice",children:"Invoice"}),u.jsx("option",{value:"proposal",children:"Proposal"}),u.jsx("option",{value:"other",children:"Other"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Description (Optional)"}),u.jsx("textarea",{value:E.description,onChange:k=>S({...E,description:k.target.value}),className:"w-full p-2 border rounded",rows:3})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"File"}),u.jsx("input",{type:"file",onChange:k=>{k.target.files&&k.target.files[0]&&S({...E,file:k.target.files[0]})},className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.document,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:x.document||!E.file,children:x.document?"Uploading...":"Upload Document"})]})]})]})}),C==="finance.employee"&&u.jsx("button",{onClick:()=>v(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:x.status,children:x.status?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(R0,{className:"w-4 h-4 mr-2"}),"Completed"]})}),m&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Confirm Completion"}),u.jsx("p",{className:"mb-4",children:"Are you sure you want to mark this client as completed?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.status,children:"Cancel"}),u.jsx("button",{onClick:()=>q("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:x.status,children:"Confirm"})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:X,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:newContact.name,onChange:k=>setNewContact({...newContact,name:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:newContact.position,onChange:k=>setNewContact({...newContact,position:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:newContact.email,onChange:k=>setNewContact({...newContact,email:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:newContact.phone,onChange:k=>setNewContact({...newContact,phone:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:x.contact,children:x.contact?"Adding...":"Add Contact"})]})]})]})}),p&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:H,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:p.name,onChange:k=>_({...p,name:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:p.position,onChange:k=>_({...p,position:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:p.email,onChange:k=>_({...p,email:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:p.phone,onChange:k=>_({...p,phone:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>_(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:x.contact,children:x.contact?"Saving...":"Save Changes"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function mhe(){const[e,t]=D.useState([]),[r,n]=D.useState(!0),[a,s]=D.useState(""),[i,o]=D.useState(""),[l,c]=D.useState(""),[f,d]=D.useState(!1);D.useEffect(()=>{h()},[]);async function h(){n(!0);try{const{data:g,error:y}=await se.from("site_visit").select(`
          id,
          created_at,
          status,
          employee:employee_Id (full_name),
          client:client_Id (name, address),
          form:site_visit_form (
            address,
            created_at
          )
        `).order("created_at",{ascending:!1});if(y)throw y;const x=m(g||[]);t(x)}catch(g){console.error("Error fetching time insights:",g)}finally{n(!1)}}function m(g){return g.filter(y=>{var x,w;return y.status==="end"&&((w=(x=y.form)==null?void 0:x[0])==null?void 0:w.created_at)}).map(y=>{var C,F,M,j,A;const x=new Date(y.created_at),E=(new Date(y.form[0].created_at).getTime()-x.getTime())/(1e3*60),S=Math.floor(E/(60*24)),b=Math.floor(E%(60*24)/60),T=Math.floor(E%60);return{id:y.id,client_name:((C=y.client)==null?void 0:C.name)||"Unknown",employee_name:((F=y.employee)==null?void 0:F.full_name)||"Unknown",date:x.toLocaleDateString(),raw_date:x,address:((j=(M=y.form)==null?void 0:M[0])==null?void 0:j.address)||((A=y.client)==null?void 0:A.address)||"N/A",duration:{days:S,hours:b,minutes:T}}})}const v=e.filter(g=>{const y=g.client_name.toLowerCase().includes(a.toLowerCase())||g.employee_name.toLowerCase().includes(a.toLowerCase())||g.address.toLowerCase().includes(a.toLowerCase()),x=i?g.raw_date.toISOString().split("T")[0]===i:!0,w=l?g.employee_name.toLowerCase().includes(l.toLowerCase()):!0;return y&&x&&w}),p=()=>{s(""),o(""),c("")},_=[...new Set(e.map(g=>g.employee_name))];return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Time Insights"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client, employee or address...",value:a,onChange:g=>s(g.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>d(!f),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(t1,{className:"w-4 h-4"}),u.jsx("span",{children:"Filters"})]})]})]}),f&&u.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"font-medium",children:"Filters"}),u.jsxs("button",{onClick:p,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Hl,{className:"w-4 h-4"}),"Clear all"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Visit Date"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(xf,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"date",value:i,onChange:g=>o(g.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),u.jsxs("select",{value:l,onChange:g=>c(g.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2",children:[u.jsx("option",{value:"",children:"All Employees"}),_.map(g=>u.jsx("option",{value:g,children:g},g))]})]})]})]}),r?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length>0?v.map(g=>{const y=g.duration.days*1440+g.duration.hours*60+g.duration.minutes;return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.client_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.employee_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.date}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.address}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsxs("span",{className:`px-2 py-1 rounded-full text-xs ${y>120?"bg-red-100 text-red-800":y>60?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[`${g.duration.days>0?`${g.duration.days}d `:""}${g.duration.hours}h ${g.duration.minutes}m`,y>0&&` (${y.toFixed(0)} mins)`]})})]},g.id)}):u.jsx("tr",{children:u.jsxs("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:["No matching time tracking data found",(a||i||l)&&u.jsx("button",{onClick:p,className:"text-blue-600 hover:underline ml-2",children:"Clear filters"})]})})})]})})})]})}function vhe(){const[e,t]=D.useState([]),[r,n]=D.useState({}),[a,s]=D.useState(!0),[i,o]=D.useState(""),[l,c]=D.useState(""),[f,d]=D.useState(""),[h,m]=D.useState(!1);D.useEffect(()=>{v()},[]);async function v(){s(!0);try{const{data:E,error:S}=await se.from("client_status_history").select(`
          id,
          client_id,
          old_status,
          new_status,
          changed_at,
          client:client_id (name, company)
        `).order("changed_at",{ascending:!0});if(S)throw S;const b=p(E||[]);t(b),_(b)}catch(E){console.error("Error fetching status changes:",E)}finally{s(!1)}}function p(E){return E.map(S=>{var b,T;return{id:S.id,client_id:S.client_id,client_name:((b=S.client)==null?void 0:b.name)||"Unknown",company:((T=S.client)==null?void 0:T.company)||"Unknown",old_status:S.old_status||"N/A",new_status:S.new_status,changed_at:new Date(S.changed_at).toLocaleString(),raw_date:new Date(S.changed_at)}})}function _(E){const S={},b={};E.forEach(T=>{b[T.client_id]||(b[T.client_id]=[]),b[T.client_id].push(T)}),Object.entries(b).forEach(([T,C])=>{const F=[];C.sort((M,j)=>M.raw_date.getTime()-j.raw_date.getTime());for(let M=1;M<C.length;M++){const j=C[M-1],A=C[M],G=A.raw_date.getTime()-j.raw_date.getTime(),X=Math.floor(G/(1e3*60)),H=Math.floor(X/(60*24)),q=Math.floor(X%(60*24)/60),Z=Math.floor(X%60);F.push({from_status:j.new_status,to_status:A.new_status,duration:g(H,q,Z),days:H,hours:q,minutes:Z})}S[T]=F}),n(S)}function g(E,S,b){const T=[];return E>0&&T.push(`${E}d`),S>0&&T.push(`${S}h`),(b>0||T.length===0)&&T.push(`${b}m`),T.join(" ")}const y=e.filter(E=>{const S=E.client_name.toLowerCase().includes(i.toLowerCase())||E.company.toLowerCase().includes(i.toLowerCase()),b=l?E.raw_date.toISOString().split("T")[0]===l:!0,T=f?E.new_status.toLowerCase()===f.toLowerCase():!0;return S&&b&&T}),x=()=>{o(""),c(""),d("")},w=["ongoing","completed","poreceived","ecomplete"];return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Client Status History"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dn,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client or company...",value:i,onChange:E=>o(E.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>m(!h),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(t1,{className:"w-4 h-4"}),u.jsx("span",{children:"Filters"})]})]})]}),h&&u.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"font-medium",children:"Filters"}),u.jsxs("button",{onClick:x,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Hl,{className:"w-4 h-4"}),"Clear all"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Change Date"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(xf,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"date",value:l,onChange:E=>c(E.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Status"}),u.jsxs("select",{value:f,onChange:E=>d(E.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2",children:[u.jsx("option",{value:"",children:"All Statuses"}),w.map(E=>u.jsx("option",{value:E,children:E.charAt(0).toUpperCase()+E.slice(1)},E))]})]})]})]}),a?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status Change"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time Between Statuses"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.length>0?y.map((E,S,b)=>{const T=b.findIndex((M,j)=>j<S&&M.client_id===E.client_id),C=T>=0?b[T]:null;let F="N/A";if(C){const M=E.raw_date.getTime()-C.raw_date.getTime(),j=Math.floor(M/(1e3*60)),A=Math.floor(j/(60*24)),G=Math.floor(j%(60*24)/60),X=Math.floor(j%60);F=g(A,G,X)}return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E.client_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.company}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.changed_at}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[u.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${E.old_status==="completed"?"bg-green-100 text-green-800":E.old_status==="ongoing"?"bg-blue-100 text-blue-800":E.old_status==="poreceived"?"bg-purple-100 text-purple-800":E.old_status==="ecomplete"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:E.old_status})," → ",u.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${E.new_status==="completed"?"bg-green-100 text-green-800":E.new_status==="ongoing"?"bg-blue-100 text-blue-800":E.new_status==="poreceived"?"bg-purple-100 text-purple-800":E.new_status==="ecomplete"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:E.new_status})]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:C?u.jsx("span",{className:`px-2 py-1 rounded text-xs ${F==="N/A"?"bg-gray-100 text-gray-800":ghe(E.raw_date.getTime()-C.raw_date.getTime())}`,children:F}):"Initial Status"})]},`${E.id}-${S}`)}):u.jsx("tr",{children:u.jsxs("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:["No matching status changes found",(i||l||f)&&u.jsx("button",{onClick:x,className:"text-blue-600 hover:underline ml-2",children:"Clear filters"})]})})})]})})})]})}function ghe(e){const t=e/36e5;return t>72?"bg-red-100 text-red-800":t>24?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}function Id({children:e,requiredRoles:t}){const r=Qe(n=>n.role);return t.includes(r||"")?e:u.jsx(P0,{to:"/dashboard"})}function xhe({children:e}){return Qe(r=>r.user)?e:u.jsx(P0,{to:"/login"})}function yhe(){return u.jsx(XP,{children:u.jsx(_he,{})})}function _he(){const t=$l().pathname!=="/login";return Qe(r=>r.role),u.jsxs(u.Fragment,{children:[t&&u.jsx(hhe,{}),u.jsxs(VP,{children:[u.jsx(ht,{path:"/login",element:u.jsx(e6,{})}),u.jsxs(ht,{path:"/",element:u.jsx(xhe,{children:u.jsx(nde,{})}),children:[u.jsx(ht,{path:"/",element:u.jsx(P0,{to:"/dashboard"})}),u.jsx(ht,{path:"/dashboard",element:u.jsx(kte,{})}),u.jsx(ht,{path:"/clients",element:u.jsx(Cte,{})}),u.jsx(ht,{path:"/clients-history",element:u.jsx(Kre,{})}),u.jsx(ht,{path:"/notifications",element:u.jsx(qre,{})}),u.jsx(ht,{path:"/AllClients",element:u.jsx(Nte,{})}),u.jsx(ht,{path:"/xldata",element:u.jsx(Qfe,{})}),u.jsx(ht,{path:"/time-insights",element:u.jsx(mhe,{})}),u.jsx(ht,{path:"/site-time-insights",element:u.jsx(vhe,{})}),u.jsx(ht,{path:"/clientshistoryprofile/:id",element:u.jsx(tde,{})}),u.jsx(ht,{path:"/clients/:id",element:u.jsx(Hre,{})}),u.jsx(ht,{path:"/eclients/:id",element:u.jsx(zre,{})}),u.jsx(ht,{path:"/allclients/:id",element:u.jsx(Vre,{})}),u.jsx(ht,{path:"/site-visits/:id",element:u.jsx(Gre,{})}),u.jsx(ht,{path:"/fclients/:id",element:u.jsx(phe,{})}),u.jsx(ht,{path:"/pd-kits",element:u.jsx(rde,{})}),u.jsx(ht,{path:"/employees",element:u.jsx(Id,{requiredRoles:["head","e.head"],children:u.jsx(Tte,{})})}),u.jsx(ht,{path:"/site-visit",element:u.jsx(Id,{requiredRoles:["employee","e.employee"],children:u.jsx(Yre,{})})}),u.jsx(ht,{path:"/eclients",element:u.jsx(Id,{requiredRoles:["e.head","e.employee"],children:u.jsx(Zfe,{})})}),u.jsx(ht,{path:"/fclients",element:u.jsx(Id,{requiredRoles:["finance.employee"],children:u.jsx(ede,{})})})]}),u.jsx(ht,{path:"*",element:u.jsx(P0,{to:"/dashboard"})})]})]})}hT(document.getElementById("root")).render(u.jsx(D.StrictMode,{children:u.jsx(yhe,{})}));export{Sr as g};
