function eD(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Er(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function tD(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var FE={exports:{}},lh={},RE={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nf=Symbol.for("react.element"),rD=Symbol.for("react.portal"),nD=Symbol.for("react.fragment"),aD=Symbol.for("react.strict_mode"),sD=Symbol.for("react.profiler"),iD=Symbol.for("react.provider"),oD=Symbol.for("react.context"),lD=Symbol.for("react.forward_ref"),cD=Symbol.for("react.suspense"),uD=Symbol.for("react.memo"),fD=Symbol.for("react.lazy"),Ly=Symbol.iterator;function dD(e){return e===null||typeof e!="object"?null:(e=Ly&&e[Ly]||e["@@iterator"],typeof e=="function"?e:null)}var ME={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IE=Object.assign,LE={};function Dl(e,t,r){this.props=e,this.context=t,this.refs=LE,this.updater=r||ME}Dl.prototype.isReactComponent={};Dl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Dl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $E(){}$E.prototype=Dl.prototype;function Ig(e,t,r){this.props=e,this.context=t,this.refs=LE,this.updater=r||ME}var Lg=Ig.prototype=new $E;Lg.constructor=Ig;IE(Lg,Dl.prototype);Lg.isPureReactComponent=!0;var $y=Array.isArray,BE=Object.prototype.hasOwnProperty,$g={current:null},UE={key:!0,ref:!0,__self:!0,__source:!0};function WE(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)BE.call(t,n)&&!UE.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:nf,type:e,key:s,ref:i,props:a,_owner:$g.current}}function hD(e,t){return{$$typeof:nf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bg(e){return typeof e=="object"&&e!==null&&e.$$typeof===nf}function pD(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var By=/\/+/g;function Op(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pD(""+e.key):t.toString(36)}function Cd(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case nf:case rD:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Op(i,0):n,$y(a)?(r="",e!=null&&(r=e.replace(By,"$&/")+"/"),Cd(a,t,r,"",function(c){return c})):a!=null&&(Bg(a)&&(a=hD(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(By,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",$y(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Op(s,o);i+=Cd(s,t,r,l,a)}else if(l=dD(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Op(s,o++),i+=Cd(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Bf(e,t,r){if(e==null)return e;var n=[],a=0;return Cd(e,n,"","",function(s){return t.call(r,s,a++)}),n}function mD(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rr={current:null},Nd={transition:null},vD={ReactCurrentDispatcher:Rr,ReactCurrentBatchConfig:Nd,ReactCurrentOwner:$g};function VE(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:Bf,forEach:function(e,t,r){Bf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Bf(e,function(){t++}),t},toArray:function(e){return Bf(e,function(t){return t})||[]},only:function(e){if(!Bg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Me.Component=Dl;Me.Fragment=nD;Me.Profiler=sD;Me.PureComponent=Ig;Me.StrictMode=aD;Me.Suspense=cD;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vD;Me.act=VE;Me.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=IE({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=$g.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)BE.call(t,l)&&!UE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:nf,type:e.type,key:a,ref:s,props:n,_owner:i}};Me.createContext=function(e){return e={$$typeof:oD,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:iD,_context:e},e.Consumer=e};Me.createElement=WE;Me.createFactory=function(e){var t=WE.bind(null,e);return t.type=e,t};Me.createRef=function(){return{current:null}};Me.forwardRef=function(e){return{$$typeof:lD,render:e}};Me.isValidElement=Bg;Me.lazy=function(e){return{$$typeof:fD,_payload:{_status:-1,_result:e},_init:mD}};Me.memo=function(e,t){return{$$typeof:uD,type:e,compare:t===void 0?null:t}};Me.startTransition=function(e){var t=Nd.transition;Nd.transition={};try{e()}finally{Nd.transition=t}};Me.unstable_act=VE;Me.useCallback=function(e,t){return Rr.current.useCallback(e,t)};Me.useContext=function(e){return Rr.current.useContext(e)};Me.useDebugValue=function(){};Me.useDeferredValue=function(e){return Rr.current.useDeferredValue(e)};Me.useEffect=function(e,t){return Rr.current.useEffect(e,t)};Me.useId=function(){return Rr.current.useId()};Me.useImperativeHandle=function(e,t,r){return Rr.current.useImperativeHandle(e,t,r)};Me.useInsertionEffect=function(e,t){return Rr.current.useInsertionEffect(e,t)};Me.useLayoutEffect=function(e,t){return Rr.current.useLayoutEffect(e,t)};Me.useMemo=function(e,t){return Rr.current.useMemo(e,t)};Me.useReducer=function(e,t,r){return Rr.current.useReducer(e,t,r)};Me.useRef=function(e){return Rr.current.useRef(e)};Me.useState=function(e){return Rr.current.useState(e)};Me.useSyncExternalStore=function(e,t,r){return Rr.current.useSyncExternalStore(e,t,r)};Me.useTransition=function(){return Rr.current.useTransition()};Me.version="18.3.1";RE.exports=Me;var O=RE.exports;const J=Er(O),gD=eD({__proto__:null,default:J},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xD=O,yD=Symbol.for("react.element"),_D=Symbol.for("react.fragment"),wD=Object.prototype.hasOwnProperty,bD=xD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ED={key:!0,ref:!0,__self:!0,__source:!0};function HE(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)wD.call(t,n)&&!ED.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:yD,type:e,key:s,ref:i,props:a,_owner:bD.current}}lh.Fragment=_D;lh.jsx=HE;lh.jsxs=HE;FE.exports=lh;var u=FE.exports,zE={exports:{}},cn={},YE={exports:{}},GE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(G,V){var ae=G.length;G.push(V);e:for(;0<ae;){var B=ae-1>>>1,C=G[B];if(0<a(C,V))G[B]=V,G[ae]=C,ae=B;else break e}}function r(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var V=G[0],ae=G.pop();if(ae!==V){G[0]=ae;e:for(var B=0,C=G.length,I=C>>>1;B<I;){var N=2*(B+1)-1,j=G[N],K=N+1,ie=G[K];if(0>a(j,ae))K<C&&0>a(ie,j)?(G[B]=ie,G[K]=ae,B=K):(G[B]=j,G[N]=ae,B=N);else if(K<C&&0>a(ie,ae))G[B]=ie,G[K]=ae,B=K;else break e}}return V}function a(G,V){var ae=G.sortIndex-V.sortIndex;return ae!==0?ae:G.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,h=3,m=!1,v=!1,p=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(G){for(var V=r(c);V!==null;){if(V.callback===null)n(c);else if(V.startTime<=G)n(c),V.sortIndex=V.expirationTime,t(l,V);else break;V=r(c)}}function w(G){if(p=!1,g(G),!v)if(r(l)!==null)v=!0,Y(b);else{var V=r(c);V!==null&&q(w,V.startTime-G)}}function b(G,V){v=!1,p&&(p=!1,y(S),S=-1),m=!0;var ae=h;try{for(g(V),d=r(l);d!==null&&(!(d.expirationTime>V)||G&&!M());){var B=d.callback;if(typeof B=="function"){d.callback=null,h=d.priorityLevel;var C=B(d.expirationTime<=V);V=e.unstable_now(),typeof C=="function"?d.callback=C:d===r(l)&&n(l),g(V)}else n(l);d=r(l)}if(d!==null)var I=!0;else{var N=r(c);N!==null&&q(w,N.startTime-V),I=!1}return I}finally{d=null,h=ae,m=!1}}var k=!1,E=null,S=-1,T=5,P=-1;function M(){return!(e.unstable_now()-P<T)}function L(){if(E!==null){var G=e.unstable_now();P=G;var V=!0;try{V=E(!0,G)}finally{V?D():(k=!1,E=null)}}else k=!1}var D;if(typeof x=="function")D=function(){x(L)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,ee=Q.port2;Q.port1.onmessage=L,D=function(){ee.postMessage(null)}}else D=function(){_(L,0)};function Y(G){E=G,k||(k=!0,D())}function q(G,V){S=_(function(){G(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,Y(b))},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(G){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var ae=h;h=V;try{return G()}finally{h=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,V){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ae=h;h=G;try{return V()}finally{h=ae}},e.unstable_scheduleCallback=function(G,V,ae){var B=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?B+ae:B):ae=B,G){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ae+C,G={id:f++,callback:V,priorityLevel:G,startTime:ae,expirationTime:C,sortIndex:-1},ae>B?(G.sortIndex=ae,t(c,G),r(l)===null&&G===r(c)&&(p?(y(S),S=-1):p=!0,q(w,ae-B))):(G.sortIndex=C,t(l,G),v||m||(v=!0,Y(b))),G},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(G){var V=h;return function(){var ae=h;h=V;try{return G.apply(this,arguments)}finally{h=ae}}}})(GE);YE.exports=GE;var SD=YE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kD=O,sn=SD;function de(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var KE=new Set,lu={};function co(e,t){dl(e,t),dl(e+"Capture",t)}function dl(e,t){for(lu[e]=t,e=0;e<t.length;e++)KE.add(t[e])}var is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Um=Object.prototype.hasOwnProperty,TD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Uy={},Wy={};function CD(e){return Um.call(Wy,e)?!0:Um.call(Uy,e)?!1:TD.test(e)?Wy[e]=!0:(Uy[e]=!0,!1)}function ND(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function AD(e,t,r,n){if(t===null||typeof t>"u"||ND(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Mr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var or={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){or[e]=new Mr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];or[t]=new Mr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){or[e]=new Mr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){or[e]=new Mr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){or[e]=new Mr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){or[e]=new Mr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){or[e]=new Mr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){or[e]=new Mr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){or[e]=new Mr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ug=/[\-:]([a-z])/g;function Wg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ug,Wg);or[t]=new Mr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ug,Wg);or[t]=new Mr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ug,Wg);or[t]=new Mr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){or[e]=new Mr(e,1,!1,e.toLowerCase(),null,!1,!1)});or.xlinkHref=new Mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){or[e]=new Mr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vg(e,t,r,n){var a=or.hasOwnProperty(t)?or[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(AD(t,r,a,n)&&(r=null),n||a===null?CD(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var vs=kD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Uf=Symbol.for("react.element"),Mo=Symbol.for("react.portal"),Io=Symbol.for("react.fragment"),Hg=Symbol.for("react.strict_mode"),Wm=Symbol.for("react.profiler"),qE=Symbol.for("react.provider"),XE=Symbol.for("react.context"),zg=Symbol.for("react.forward_ref"),Vm=Symbol.for("react.suspense"),Hm=Symbol.for("react.suspense_list"),Yg=Symbol.for("react.memo"),Ns=Symbol.for("react.lazy"),JE=Symbol.for("react.offscreen"),Vy=Symbol.iterator;function cc(e){return e===null||typeof e!="object"?null:(e=Vy&&e[Vy]||e["@@iterator"],typeof e=="function"?e:null)}var Et=Object.assign,Dp;function Sc(e){if(Dp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Dp=t&&t[1]||""}return`
`+Dp+e}var jp=!1;function Pp(e,t){if(!e||jp)return"";jp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{jp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Sc(e):""}function OD(e){switch(e.tag){case 5:return Sc(e.type);case 16:return Sc("Lazy");case 13:return Sc("Suspense");case 19:return Sc("SuspenseList");case 0:case 2:case 15:return e=Pp(e.type,!1),e;case 11:return e=Pp(e.type.render,!1),e;case 1:return e=Pp(e.type,!0),e;default:return""}}function zm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Io:return"Fragment";case Mo:return"Portal";case Wm:return"Profiler";case Hg:return"StrictMode";case Vm:return"Suspense";case Hm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case XE:return(e.displayName||"Context")+".Consumer";case qE:return(e._context.displayName||"Context")+".Provider";case zg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yg:return t=e.displayName||null,t!==null?t:zm(e.type)||"Memo";case Ns:t=e._payload,e=e._init;try{return zm(e(t))}catch{}}return null}function DD(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zm(t);case 8:return t===Hg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ti(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function QE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jD(e){var t=QE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wf(e){e._valueTracker||(e._valueTracker=jD(e))}function ZE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=QE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Xd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ym(e,t){var r=t.checked;return Et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Hy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ti(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function eS(e,t){t=t.checked,t!=null&&Vg(e,"checked",t,!1)}function Gm(e,t){eS(e,t);var r=ti(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Km(e,t.type,r):t.hasOwnProperty("defaultValue")&&Km(e,t.type,ti(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function zy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Km(e,t,r){(t!=="number"||Xd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var kc=Array.isArray;function Zo(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ti(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function qm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(de(91));return Et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Yy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(de(92));if(kc(r)){if(1<r.length)throw Error(de(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ti(r)}}function tS(e,t){var r=ti(t.value),n=ti(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Gy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vf,nS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Vf=Vf||document.createElement("div"),Vf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Vf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function cu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Fc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PD=["Webkit","ms","Moz","O"];Object.keys(Fc).forEach(function(e){PD.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fc[t]=Fc[e]})});function aS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Fc.hasOwnProperty(e)&&Fc[e]?(""+t).trim():t+"px"}function sS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=aS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var FD=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jm(e,t){if(t){if(FD[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(de(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(de(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(de(61))}if(t.style!=null&&typeof t.style!="object")throw Error(de(62))}}function Qm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zm=null;function Gg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ev=null,el=null,tl=null;function Ky(e){if(e=of(e)){if(typeof ev!="function")throw Error(de(280));var t=e.stateNode;t&&(t=hh(t),ev(e.stateNode,e.type,t))}}function iS(e){el?tl?tl.push(e):tl=[e]:el=e}function oS(){if(el){var e=el,t=tl;if(tl=el=null,Ky(e),t)for(e=0;e<t.length;e++)Ky(t[e])}}function lS(e,t){return e(t)}function cS(){}var Fp=!1;function uS(e,t,r){if(Fp)return e(t,r);Fp=!0;try{return lS(e,t,r)}finally{Fp=!1,(el!==null||tl!==null)&&(cS(),oS())}}function uu(e,t){var r=e.stateNode;if(r===null)return null;var n=hh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(de(231,t,typeof r));return r}var tv=!1;if(is)try{var uc={};Object.defineProperty(uc,"passive",{get:function(){tv=!0}}),window.addEventListener("test",uc,uc),window.removeEventListener("test",uc,uc)}catch{tv=!1}function RD(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Rc=!1,Jd=null,Qd=!1,rv=null,MD={onError:function(e){Rc=!0,Jd=e}};function ID(e,t,r,n,a,s,i,o,l){Rc=!1,Jd=null,RD.apply(MD,arguments)}function LD(e,t,r,n,a,s,i,o,l){if(ID.apply(this,arguments),Rc){if(Rc){var c=Jd;Rc=!1,Jd=null}else throw Error(de(198));Qd||(Qd=!0,rv=c)}}function uo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qy(e){if(uo(e)!==e)throw Error(de(188))}function $D(e){var t=e.alternate;if(!t){if(t=uo(e),t===null)throw Error(de(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return qy(a),e;if(s===n)return qy(a),t;s=s.sibling}throw Error(de(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(de(189))}}if(r.alternate!==n)throw Error(de(190))}if(r.tag!==3)throw Error(de(188));return r.stateNode.current===r?e:t}function dS(e){return e=$D(e),e!==null?hS(e):null}function hS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hS(e);if(t!==null)return t;e=e.sibling}return null}var pS=sn.unstable_scheduleCallback,Xy=sn.unstable_cancelCallback,BD=sn.unstable_shouldYield,UD=sn.unstable_requestPaint,jt=sn.unstable_now,WD=sn.unstable_getCurrentPriorityLevel,Kg=sn.unstable_ImmediatePriority,mS=sn.unstable_UserBlockingPriority,Zd=sn.unstable_NormalPriority,VD=sn.unstable_LowPriority,vS=sn.unstable_IdlePriority,ch=null,ba=null;function HD(e){if(ba&&typeof ba.onCommitFiberRoot=="function")try{ba.onCommitFiberRoot(ch,e,void 0,(e.current.flags&128)===128)}catch{}}var Jn=Math.clz32?Math.clz32:GD,zD=Math.log,YD=Math.LN2;function GD(e){return e>>>=0,e===0?32:31-(zD(e)/YD|0)|0}var Hf=64,zf=4194304;function Tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function e0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Tc(o):(s&=i,s!==0&&(n=Tc(s)))}else i=r&~a,i!==0?n=Tc(i):s!==0&&(n=Tc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Jn(t),a=1<<r,n|=e[r],t&=~a;return n}function KD(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qD(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Jn(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=KD(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function nv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gS(){var e=Hf;return Hf<<=1,!(Hf&4194240)&&(Hf=64),e}function Rp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function af(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Jn(t),e[t]=r}function XD(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Jn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function qg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Jn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Xe=0;function xS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var yS,Xg,_S,wS,bS,av=!1,Yf=[],Hs=null,zs=null,Ys=null,fu=new Map,du=new Map,Ds=[],JD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jy(e,t){switch(e){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":zs=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":fu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":du.delete(t.pointerId)}}function fc(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=of(t),t!==null&&Xg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function QD(e,t,r,n,a){switch(t){case"focusin":return Hs=fc(Hs,e,t,r,n,a),!0;case"dragenter":return zs=fc(zs,e,t,r,n,a),!0;case"mouseover":return Ys=fc(Ys,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return fu.set(s,fc(fu.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,du.set(s,fc(du.get(s)||null,e,t,r,n,a)),!0}return!1}function ES(e){var t=Ai(e.target);if(t!==null){var r=uo(t);if(r!==null){if(t=r.tag,t===13){if(t=fS(r),t!==null){e.blockedOn=t,bS(e.priority,function(){_S(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ad(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=sv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Zm=n,r.target.dispatchEvent(n),Zm=null}else return t=of(r),t!==null&&Xg(t),e.blockedOn=r,!1;t.shift()}return!0}function Qy(e,t,r){Ad(e)&&r.delete(t)}function ZD(){av=!1,Hs!==null&&Ad(Hs)&&(Hs=null),zs!==null&&Ad(zs)&&(zs=null),Ys!==null&&Ad(Ys)&&(Ys=null),fu.forEach(Qy),du.forEach(Qy)}function dc(e,t){e.blockedOn===t&&(e.blockedOn=null,av||(av=!0,sn.unstable_scheduleCallback(sn.unstable_NormalPriority,ZD)))}function hu(e){function t(a){return dc(a,e)}if(0<Yf.length){dc(Yf[0],e);for(var r=1;r<Yf.length;r++){var n=Yf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Hs!==null&&dc(Hs,e),zs!==null&&dc(zs,e),Ys!==null&&dc(Ys,e),fu.forEach(t),du.forEach(t),r=0;r<Ds.length;r++)n=Ds[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ds.length&&(r=Ds[0],r.blockedOn===null);)ES(r),r.blockedOn===null&&Ds.shift()}var rl=vs.ReactCurrentBatchConfig,t0=!0;function ej(e,t,r,n){var a=Xe,s=rl.transition;rl.transition=null;try{Xe=1,Jg(e,t,r,n)}finally{Xe=a,rl.transition=s}}function tj(e,t,r,n){var a=Xe,s=rl.transition;rl.transition=null;try{Xe=4,Jg(e,t,r,n)}finally{Xe=a,rl.transition=s}}function Jg(e,t,r,n){if(t0){var a=sv(e,t,r,n);if(a===null)zp(e,t,n,r0,r),Jy(e,n);else if(QD(a,e,t,r,n))n.stopPropagation();else if(Jy(e,n),t&4&&-1<JD.indexOf(e)){for(;a!==null;){var s=of(a);if(s!==null&&yS(s),s=sv(e,t,r,n),s===null&&zp(e,t,n,r0,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else zp(e,t,n,null,r)}}var r0=null;function sv(e,t,r,n){if(r0=null,e=Gg(n),e=Ai(e),e!==null)if(t=uo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return r0=e,null}function SS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WD()){case Kg:return 1;case mS:return 4;case Zd:case VD:return 16;case vS:return 536870912;default:return 16}default:return 16}}var Ms=null,Qg=null,Od=null;function kS(){if(Od)return Od;var e,t=Qg,r=t.length,n,a="value"in Ms?Ms.value:Ms.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Od=a.slice(e,1<n?1-n:void 0)}function Dd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Gf(){return!0}function Zy(){return!1}function un(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Gf:Zy,this.isPropagationStopped=Zy,this}return Et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Gf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Gf)},persist:function(){},isPersistent:Gf}),t}var jl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zg=un(jl),sf=Et({},jl,{view:0,detail:0}),rj=un(sf),Mp,Ip,hc,uh=Et({},sf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ex,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hc&&(hc&&e.type==="mousemove"?(Mp=e.screenX-hc.screenX,Ip=e.screenY-hc.screenY):Ip=Mp=0,hc=e),Mp)},movementY:function(e){return"movementY"in e?e.movementY:Ip}}),e_=un(uh),nj=Et({},uh,{dataTransfer:0}),aj=un(nj),sj=Et({},sf,{relatedTarget:0}),Lp=un(sj),ij=Et({},jl,{animationName:0,elapsedTime:0,pseudoElement:0}),oj=un(ij),lj=Et({},jl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cj=un(lj),uj=Et({},jl,{data:0}),t_=un(uj),fj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hj[e])?!!t[e]:!1}function ex(){return pj}var mj=Et({},sf,{key:function(e){if(e.key){var t=fj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Dd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?dj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ex,charCode:function(e){return e.type==="keypress"?Dd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),vj=un(mj),gj=Et({},uh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),r_=un(gj),xj=Et({},sf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ex}),yj=un(xj),_j=Et({},jl,{propertyName:0,elapsedTime:0,pseudoElement:0}),wj=un(_j),bj=Et({},uh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ej=un(bj),Sj=[9,13,27,32],tx=is&&"CompositionEvent"in window,Mc=null;is&&"documentMode"in document&&(Mc=document.documentMode);var kj=is&&"TextEvent"in window&&!Mc,TS=is&&(!tx||Mc&&8<Mc&&11>=Mc),n_=" ",a_=!1;function CS(e,t){switch(e){case"keyup":return Sj.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function NS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Lo=!1;function Tj(e,t){switch(e){case"compositionend":return NS(t);case"keypress":return t.which!==32?null:(a_=!0,n_);case"textInput":return e=t.data,e===n_&&a_?null:e;default:return null}}function Cj(e,t){if(Lo)return e==="compositionend"||!tx&&CS(e,t)?(e=kS(),Od=Qg=Ms=null,Lo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return TS&&t.locale!=="ko"?null:t.data;default:return null}}var Nj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function s_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Nj[e.type]:t==="textarea"}function AS(e,t,r,n){iS(n),t=n0(t,"onChange"),0<t.length&&(r=new Zg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ic=null,pu=null;function Aj(e){BS(e,0)}function fh(e){var t=Uo(e);if(ZE(t))return e}function Oj(e,t){if(e==="change")return t}var OS=!1;if(is){var $p;if(is){var Bp="oninput"in document;if(!Bp){var i_=document.createElement("div");i_.setAttribute("oninput","return;"),Bp=typeof i_.oninput=="function"}$p=Bp}else $p=!1;OS=$p&&(!document.documentMode||9<document.documentMode)}function o_(){Ic&&(Ic.detachEvent("onpropertychange",DS),pu=Ic=null)}function DS(e){if(e.propertyName==="value"&&fh(pu)){var t=[];AS(t,pu,e,Gg(e)),uS(Aj,t)}}function Dj(e,t,r){e==="focusin"?(o_(),Ic=t,pu=r,Ic.attachEvent("onpropertychange",DS)):e==="focusout"&&o_()}function jj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fh(pu)}function Pj(e,t){if(e==="click")return fh(t)}function Fj(e,t){if(e==="input"||e==="change")return fh(t)}function Rj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ra=typeof Object.is=="function"?Object.is:Rj;function mu(e,t){if(ra(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Um.call(t,a)||!ra(e[a],t[a]))return!1}return!0}function l_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function c_(e,t){var r=l_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=l_(r)}}function jS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?jS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function PS(){for(var e=window,t=Xd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Xd(e.document)}return t}function rx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Mj(e){var t=PS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&jS(r.ownerDocument.documentElement,r)){if(n!==null&&rx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=c_(r,s);var i=c_(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ij=is&&"documentMode"in document&&11>=document.documentMode,$o=null,iv=null,Lc=null,ov=!1;function u_(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ov||$o==null||$o!==Xd(n)||(n=$o,"selectionStart"in n&&rx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Lc&&mu(Lc,n)||(Lc=n,n=n0(iv,"onSelect"),0<n.length&&(t=new Zg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=$o)))}function Kf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Bo={animationend:Kf("Animation","AnimationEnd"),animationiteration:Kf("Animation","AnimationIteration"),animationstart:Kf("Animation","AnimationStart"),transitionend:Kf("Transition","TransitionEnd")},Up={},FS={};is&&(FS=document.createElement("div").style,"AnimationEvent"in window||(delete Bo.animationend.animation,delete Bo.animationiteration.animation,delete Bo.animationstart.animation),"TransitionEvent"in window||delete Bo.transitionend.transition);function dh(e){if(Up[e])return Up[e];if(!Bo[e])return e;var t=Bo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in FS)return Up[e]=t[r];return e}var RS=dh("animationend"),MS=dh("animationiteration"),IS=dh("animationstart"),LS=dh("transitionend"),$S=new Map,f_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function li(e,t){$S.set(e,t),co(t,[e])}for(var Wp=0;Wp<f_.length;Wp++){var Vp=f_[Wp],Lj=Vp.toLowerCase(),$j=Vp[0].toUpperCase()+Vp.slice(1);li(Lj,"on"+$j)}li(RS,"onAnimationEnd");li(MS,"onAnimationIteration");li(IS,"onAnimationStart");li("dblclick","onDoubleClick");li("focusin","onFocus");li("focusout","onBlur");li(LS,"onTransitionEnd");dl("onMouseEnter",["mouseout","mouseover"]);dl("onMouseLeave",["mouseout","mouseover"]);dl("onPointerEnter",["pointerout","pointerover"]);dl("onPointerLeave",["pointerout","pointerover"]);co("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));co("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));co("onBeforeInput",["compositionend","keypress","textInput","paste"]);co("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));co("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));co("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cc));function d_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,LD(n,t,void 0,e),e.currentTarget=null}function BS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;d_(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;d_(a,o,c),s=l}}}if(Qd)throw e=rv,Qd=!1,rv=null,e}function ot(e,t){var r=t[dv];r===void 0&&(r=t[dv]=new Set);var n=e+"__bubble";r.has(n)||(US(t,e,2,!1),r.add(n))}function Hp(e,t,r){var n=0;t&&(n|=4),US(r,e,n,t)}var qf="_reactListening"+Math.random().toString(36).slice(2);function vu(e){if(!e[qf]){e[qf]=!0,KE.forEach(function(r){r!=="selectionchange"&&(Bj.has(r)||Hp(r,!1,e),Hp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[qf]||(t[qf]=!0,Hp("selectionchange",!1,t))}}function US(e,t,r,n){switch(SS(t)){case 1:var a=ej;break;case 4:a=tj;break;default:a=Jg}r=a.bind(null,t,r,e),a=void 0,!tv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function zp(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Ai(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}uS(function(){var c=s,f=Gg(r),d=[];e:{var h=$S.get(e);if(h!==void 0){var m=Zg,v=e;switch(e){case"keypress":if(Dd(r)===0)break e;case"keydown":case"keyup":m=vj;break;case"focusin":v="focus",m=Lp;break;case"focusout":v="blur",m=Lp;break;case"beforeblur":case"afterblur":m=Lp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=e_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=aj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=yj;break;case RS:case MS:case IS:m=oj;break;case LS:m=wj;break;case"scroll":m=rj;break;case"wheel":m=Ej;break;case"copy":case"cut":case"paste":m=cj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=r_}var p=(t&4)!==0,_=!p&&e==="scroll",y=p?h!==null?h+"Capture":null:h;p=[];for(var x=c,g;x!==null;){g=x;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,y!==null&&(w=uu(x,y),w!=null&&p.push(gu(x,w,g)))),_)break;x=x.return}0<p.length&&(h=new m(h,v,null,r,f),d.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==Zm&&(v=r.relatedTarget||r.fromElement)&&(Ai(v)||v[os]))break e;if((m||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=c,v=v?Ai(v):null,v!==null&&(_=uo(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=c),m!==v)){if(p=e_,w="onMouseLeave",y="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(p=r_,w="onPointerLeave",y="onPointerEnter",x="pointer"),_=m==null?h:Uo(m),g=v==null?h:Uo(v),h=new p(w,x+"leave",m,r,f),h.target=_,h.relatedTarget=g,w=null,Ai(f)===c&&(p=new p(y,x+"enter",v,r,f),p.target=g,p.relatedTarget=_,w=p),_=w,m&&v)t:{for(p=m,y=v,x=0,g=p;g;g=ko(g))x++;for(g=0,w=y;w;w=ko(w))g++;for(;0<x-g;)p=ko(p),x--;for(;0<g-x;)y=ko(y),g--;for(;x--;){if(p===y||y!==null&&p===y.alternate)break t;p=ko(p),y=ko(y)}p=null}else p=null;m!==null&&h_(d,h,m,p,!1),v!==null&&_!==null&&h_(d,_,v,p,!0)}}e:{if(h=c?Uo(c):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var b=Oj;else if(s_(h))if(OS)b=Fj;else{b=jj;var k=Dj}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=Pj);if(b&&(b=b(e,c))){AS(d,b,r,f);break e}k&&k(e,h,c),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Km(h,"number",h.value)}switch(k=c?Uo(c):window,e){case"focusin":(s_(k)||k.contentEditable==="true")&&($o=k,iv=c,Lc=null);break;case"focusout":Lc=iv=$o=null;break;case"mousedown":ov=!0;break;case"contextmenu":case"mouseup":case"dragend":ov=!1,u_(d,r,f);break;case"selectionchange":if(Ij)break;case"keydown":case"keyup":u_(d,r,f)}var E;if(tx)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Lo?CS(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(TS&&r.locale!=="ko"&&(Lo||S!=="onCompositionStart"?S==="onCompositionEnd"&&Lo&&(E=kS()):(Ms=f,Qg="value"in Ms?Ms.value:Ms.textContent,Lo=!0)),k=n0(c,S),0<k.length&&(S=new t_(S,e,null,r,f),d.push({event:S,listeners:k}),E?S.data=E:(E=NS(r),E!==null&&(S.data=E)))),(E=kj?Tj(e,r):Cj(e,r))&&(c=n0(c,"onBeforeInput"),0<c.length&&(f=new t_("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=E))}BS(d,t)})}function gu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function n0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=uu(e,r),s!=null&&n.unshift(gu(e,s,a)),s=uu(e,t),s!=null&&n.push(gu(e,s,a))),e=e.return}return n}function ko(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function h_(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=uu(r,s),l!=null&&i.unshift(gu(r,l,o))):a||(l=uu(r,s),l!=null&&i.push(gu(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Uj=/\r\n?/g,Wj=/\u0000|\uFFFD/g;function p_(e){return(typeof e=="string"?e:""+e).replace(Uj,`
`).replace(Wj,"")}function Xf(e,t,r){if(t=p_(t),p_(e)!==t&&r)throw Error(de(425))}function a0(){}var lv=null,cv=null;function uv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var fv=typeof setTimeout=="function"?setTimeout:void 0,Vj=typeof clearTimeout=="function"?clearTimeout:void 0,m_=typeof Promise=="function"?Promise:void 0,Hj=typeof queueMicrotask=="function"?queueMicrotask:typeof m_<"u"?function(e){return m_.resolve(null).then(e).catch(zj)}:fv;function zj(e){setTimeout(function(){throw e})}function Yp(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),hu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);hu(t)}function Gs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function v_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Pl=Math.random().toString(36).slice(2),ga="__reactFiber$"+Pl,xu="__reactProps$"+Pl,os="__reactContainer$"+Pl,dv="__reactEvents$"+Pl,Yj="__reactListeners$"+Pl,Gj="__reactHandles$"+Pl;function Ai(e){var t=e[ga];if(t)return t;for(var r=e.parentNode;r;){if(t=r[os]||r[ga]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=v_(e);e!==null;){if(r=e[ga])return r;e=v_(e)}return t}e=r,r=e.parentNode}return null}function of(e){return e=e[ga]||e[os],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Uo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(de(33))}function hh(e){return e[xu]||null}var hv=[],Wo=-1;function ci(e){return{current:e}}function ut(e){0>Wo||(e.current=hv[Wo],hv[Wo]=null,Wo--)}function at(e,t){Wo++,hv[Wo]=e.current,e.current=t}var ri={},wr=ci(ri),Hr=ci(!1),Wi=ri;function hl(e,t){var r=e.type.contextTypes;if(!r)return ri;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function zr(e){return e=e.childContextTypes,e!=null}function s0(){ut(Hr),ut(wr)}function g_(e,t,r){if(wr.current!==ri)throw Error(de(168));at(wr,t),at(Hr,r)}function WS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(de(108,DD(e)||"Unknown",a));return Et({},r,n)}function i0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ri,Wi=wr.current,at(wr,e),at(Hr,Hr.current),!0}function x_(e,t,r){var n=e.stateNode;if(!n)throw Error(de(169));r?(e=WS(e,t,Wi),n.__reactInternalMemoizedMergedChildContext=e,ut(Hr),ut(wr),at(wr,e)):ut(Hr),at(Hr,r)}var za=null,ph=!1,Gp=!1;function VS(e){za===null?za=[e]:za.push(e)}function Kj(e){ph=!0,VS(e)}function ui(){if(!Gp&&za!==null){Gp=!0;var e=0,t=Xe;try{var r=za;for(Xe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}za=null,ph=!1}catch(a){throw za!==null&&(za=za.slice(e+1)),pS(Kg,ui),a}finally{Xe=t,Gp=!1}}return null}var Vo=[],Ho=0,o0=null,l0=0,xn=[],yn=0,Vi=null,Ka=1,qa="";function bi(e,t){Vo[Ho++]=l0,Vo[Ho++]=o0,o0=e,l0=t}function HS(e,t,r){xn[yn++]=Ka,xn[yn++]=qa,xn[yn++]=Vi,Vi=e;var n=Ka;e=qa;var a=32-Jn(n)-1;n&=~(1<<a),r+=1;var s=32-Jn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Ka=1<<32-Jn(t)+a|r<<a|n,qa=s+e}else Ka=1<<s|r<<a|n,qa=e}function nx(e){e.return!==null&&(bi(e,1),HS(e,1,0))}function ax(e){for(;e===o0;)o0=Vo[--Ho],Vo[Ho]=null,l0=Vo[--Ho],Vo[Ho]=null;for(;e===Vi;)Vi=xn[--yn],xn[yn]=null,qa=xn[--yn],xn[yn]=null,Ka=xn[--yn],xn[yn]=null}var an=null,nn=null,vt=!1,Yn=null;function zS(e,t){var r=Sn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function y_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,an=e,nn=Gs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,an=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Vi!==null?{id:Ka,overflow:qa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Sn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,an=e,nn=null,!0):!1;default:return!1}}function pv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function mv(e){if(vt){var t=nn;if(t){var r=t;if(!y_(e,t)){if(pv(e))throw Error(de(418));t=Gs(r.nextSibling);var n=an;t&&y_(e,t)?zS(n,r):(e.flags=e.flags&-4097|2,vt=!1,an=e)}}else{if(pv(e))throw Error(de(418));e.flags=e.flags&-4097|2,vt=!1,an=e}}}function __(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;an=e}function Jf(e){if(e!==an)return!1;if(!vt)return __(e),vt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!uv(e.type,e.memoizedProps)),t&&(t=nn)){if(pv(e))throw YS(),Error(de(418));for(;t;)zS(e,t),t=Gs(t.nextSibling)}if(__(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(de(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){nn=Gs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=an?Gs(e.stateNode.nextSibling):null;return!0}function YS(){for(var e=nn;e;)e=Gs(e.nextSibling)}function pl(){nn=an=null,vt=!1}function sx(e){Yn===null?Yn=[e]:Yn.push(e)}var qj=vs.ReactCurrentBatchConfig;function pc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(de(309));var n=r.stateNode}if(!n)throw Error(de(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(de(284));if(!r._owner)throw Error(de(290,e))}return e}function Qf(e,t){throw e=Object.prototype.toString.call(t),Error(de(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function w_(e){var t=e._init;return t(e._payload)}function GS(e){function t(y,x){if(e){var g=y.deletions;g===null?(y.deletions=[x],y.flags|=16):g.push(x)}}function r(y,x){if(!e)return null;for(;x!==null;)t(y,x),x=x.sibling;return null}function n(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function a(y,x){return y=Js(y,x),y.index=0,y.sibling=null,y}function s(y,x,g){return y.index=g,e?(g=y.alternate,g!==null?(g=g.index,g<x?(y.flags|=2,x):g):(y.flags|=2,x)):(y.flags|=1048576,x)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,x,g,w){return x===null||x.tag!==6?(x=em(g,y.mode,w),x.return=y,x):(x=a(x,g),x.return=y,x)}function l(y,x,g,w){var b=g.type;return b===Io?f(y,x,g.props.children,w,g.key):x!==null&&(x.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ns&&w_(b)===x.type)?(w=a(x,g.props),w.ref=pc(y,x,g),w.return=y,w):(w=Ld(g.type,g.key,g.props,null,y.mode,w),w.ref=pc(y,x,g),w.return=y,w)}function c(y,x,g,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==g.containerInfo||x.stateNode.implementation!==g.implementation?(x=tm(g,y.mode,w),x.return=y,x):(x=a(x,g.children||[]),x.return=y,x)}function f(y,x,g,w,b){return x===null||x.tag!==7?(x=Ri(g,y.mode,w,b),x.return=y,x):(x=a(x,g),x.return=y,x)}function d(y,x,g){if(typeof x=="string"&&x!==""||typeof x=="number")return x=em(""+x,y.mode,g),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Uf:return g=Ld(x.type,x.key,x.props,null,y.mode,g),g.ref=pc(y,null,x),g.return=y,g;case Mo:return x=tm(x,y.mode,g),x.return=y,x;case Ns:var w=x._init;return d(y,w(x._payload),g)}if(kc(x)||cc(x))return x=Ri(x,y.mode,g,null),x.return=y,x;Qf(y,x)}return null}function h(y,x,g,w){var b=x!==null?x.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return b!==null?null:o(y,x,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Uf:return g.key===b?l(y,x,g,w):null;case Mo:return g.key===b?c(y,x,g,w):null;case Ns:return b=g._init,h(y,x,b(g._payload),w)}if(kc(g)||cc(g))return b!==null?null:f(y,x,g,w,null);Qf(y,g)}return null}function m(y,x,g,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(g)||null,o(x,y,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Uf:return y=y.get(w.key===null?g:w.key)||null,l(x,y,w,b);case Mo:return y=y.get(w.key===null?g:w.key)||null,c(x,y,w,b);case Ns:var k=w._init;return m(y,x,g,k(w._payload),b)}if(kc(w)||cc(w))return y=y.get(g)||null,f(x,y,w,b,null);Qf(x,w)}return null}function v(y,x,g,w){for(var b=null,k=null,E=x,S=x=0,T=null;E!==null&&S<g.length;S++){E.index>S?(T=E,E=null):T=E.sibling;var P=h(y,E,g[S],w);if(P===null){E===null&&(E=T);break}e&&E&&P.alternate===null&&t(y,E),x=s(P,x,S),k===null?b=P:k.sibling=P,k=P,E=T}if(S===g.length)return r(y,E),vt&&bi(y,S),b;if(E===null){for(;S<g.length;S++)E=d(y,g[S],w),E!==null&&(x=s(E,x,S),k===null?b=E:k.sibling=E,k=E);return vt&&bi(y,S),b}for(E=n(y,E);S<g.length;S++)T=m(E,y,S,g[S],w),T!==null&&(e&&T.alternate!==null&&E.delete(T.key===null?S:T.key),x=s(T,x,S),k===null?b=T:k.sibling=T,k=T);return e&&E.forEach(function(M){return t(y,M)}),vt&&bi(y,S),b}function p(y,x,g,w){var b=cc(g);if(typeof b!="function")throw Error(de(150));if(g=b.call(g),g==null)throw Error(de(151));for(var k=b=null,E=x,S=x=0,T=null,P=g.next();E!==null&&!P.done;S++,P=g.next()){E.index>S?(T=E,E=null):T=E.sibling;var M=h(y,E,P.value,w);if(M===null){E===null&&(E=T);break}e&&E&&M.alternate===null&&t(y,E),x=s(M,x,S),k===null?b=M:k.sibling=M,k=M,E=T}if(P.done)return r(y,E),vt&&bi(y,S),b;if(E===null){for(;!P.done;S++,P=g.next())P=d(y,P.value,w),P!==null&&(x=s(P,x,S),k===null?b=P:k.sibling=P,k=P);return vt&&bi(y,S),b}for(E=n(y,E);!P.done;S++,P=g.next())P=m(E,y,S,P.value,w),P!==null&&(e&&P.alternate!==null&&E.delete(P.key===null?S:P.key),x=s(P,x,S),k===null?b=P:k.sibling=P,k=P);return e&&E.forEach(function(L){return t(y,L)}),vt&&bi(y,S),b}function _(y,x,g,w){if(typeof g=="object"&&g!==null&&g.type===Io&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Uf:e:{for(var b=g.key,k=x;k!==null;){if(k.key===b){if(b=g.type,b===Io){if(k.tag===7){r(y,k.sibling),x=a(k,g.props.children),x.return=y,y=x;break e}}else if(k.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ns&&w_(b)===k.type){r(y,k.sibling),x=a(k,g.props),x.ref=pc(y,k,g),x.return=y,y=x;break e}r(y,k);break}else t(y,k);k=k.sibling}g.type===Io?(x=Ri(g.props.children,y.mode,w,g.key),x.return=y,y=x):(w=Ld(g.type,g.key,g.props,null,y.mode,w),w.ref=pc(y,x,g),w.return=y,y=w)}return i(y);case Mo:e:{for(k=g.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===g.containerInfo&&x.stateNode.implementation===g.implementation){r(y,x.sibling),x=a(x,g.children||[]),x.return=y,y=x;break e}else{r(y,x);break}else t(y,x);x=x.sibling}x=tm(g,y.mode,w),x.return=y,y=x}return i(y);case Ns:return k=g._init,_(y,x,k(g._payload),w)}if(kc(g))return v(y,x,g,w);if(cc(g))return p(y,x,g,w);Qf(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,x!==null&&x.tag===6?(r(y,x.sibling),x=a(x,g),x.return=y,y=x):(r(y,x),x=em(g,y.mode,w),x.return=y,y=x),i(y)):r(y,x)}return _}var ml=GS(!0),KS=GS(!1),c0=ci(null),u0=null,zo=null,ix=null;function ox(){ix=zo=u0=null}function lx(e){var t=c0.current;ut(c0),e._currentValue=t}function vv(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function nl(e,t){u0=e,ix=zo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vr=!0),e.firstContext=null)}function Nn(e){var t=e._currentValue;if(ix!==e)if(e={context:e,memoizedValue:t,next:null},zo===null){if(u0===null)throw Error(de(308));zo=e,u0.dependencies={lanes:0,firstContext:e}}else zo=zo.next=e;return t}var Oi=null;function cx(e){Oi===null?Oi=[e]:Oi.push(e)}function qS(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,cx(t)):(r.next=a.next,a.next=r),t.interleaved=r,ls(e,n)}function ls(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var As=!1;function ux(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function XS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Za(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ks(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ve&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ls(e,r)}return a=n.interleaved,a===null?(t.next=t,cx(n)):(t.next=a.next,a.next=t),n.interleaved=t,ls(e,r)}function jd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qg(e,r)}}function b_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function f0(e,t,r,n){var a=e.updateQueue;As=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=c=l=null,o=s;do{var h=o.lane,m=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,p=o;switch(h=t,m=r,p.tag){case 1:if(v=p.payload,typeof v=="function"){d=v.call(m,d,h);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=p.payload,h=typeof v=="function"?v.call(m,d,h):v,h==null)break e;d=Et({},d,h);break e;case 2:As=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=m,l=d):f=f.next=m,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);zi|=i,e.lanes=i,e.memoizedState=d}}function E_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(de(191,a));a.call(n)}}}var lf={},Ea=ci(lf),yu=ci(lf),_u=ci(lf);function Di(e){if(e===lf)throw Error(de(174));return e}function fx(e,t){switch(at(_u,t),at(yu,e),at(Ea,lf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Xm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Xm(t,e)}ut(Ea),at(Ea,t)}function vl(){ut(Ea),ut(yu),ut(_u)}function JS(e){Di(_u.current);var t=Di(Ea.current),r=Xm(t,e.type);t!==r&&(at(yu,e),at(Ea,r))}function dx(e){yu.current===e&&(ut(Ea),ut(yu))}var _t=ci(0);function d0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Kp=[];function hx(){for(var e=0;e<Kp.length;e++)Kp[e]._workInProgressVersionPrimary=null;Kp.length=0}var Pd=vs.ReactCurrentDispatcher,qp=vs.ReactCurrentBatchConfig,Hi=0,bt=null,Ut=null,Jt=null,h0=!1,$c=!1,wu=0,Xj=0;function fr(){throw Error(de(321))}function px(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ra(e[r],t[r]))return!1;return!0}function mx(e,t,r,n,a,s){if(Hi=s,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Pd.current=e===null||e.memoizedState===null?e3:t3,e=r(n,a),$c){s=0;do{if($c=!1,wu=0,25<=s)throw Error(de(301));s+=1,Jt=Ut=null,t.updateQueue=null,Pd.current=r3,e=r(n,a)}while($c)}if(Pd.current=p0,t=Ut!==null&&Ut.next!==null,Hi=0,Jt=Ut=bt=null,h0=!1,t)throw Error(de(300));return e}function vx(){var e=wu!==0;return wu=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e,Jt}function An(){if(Ut===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Ut.next;var t=Jt===null?bt.memoizedState:Jt.next;if(t!==null)Jt=t,Ut=e;else{if(e===null)throw Error(de(310));Ut=e,e={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e}return Jt}function bu(e,t){return typeof t=="function"?t(e):t}function Xp(e){var t=An(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=Ut,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var f=c.lane;if((Hi&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,bt.lanes|=f,zi|=f}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,ra(n,t.memoizedState)||(Vr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,bt.lanes|=s,zi|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Jp(e){var t=An(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);ra(s,t.memoizedState)||(Vr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function QS(){}function ZS(e,t){var r=bt,n=An(),a=t(),s=!ra(n.memoizedState,a);if(s&&(n.memoizedState=a,Vr=!0),n=n.queue,gx(rk.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Jt!==null&&Jt.memoizedState.tag&1){if(r.flags|=2048,Eu(9,tk.bind(null,r,n,a,t),void 0,null),Qt===null)throw Error(de(349));Hi&30||ek(r,t,a)}return a}function ek(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function tk(e,t,r,n){t.value=r,t.getSnapshot=n,nk(t)&&ak(e)}function rk(e,t,r){return r(function(){nk(t)&&ak(e)})}function nk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ra(e,r)}catch{return!0}}function ak(e){var t=ls(e,1);t!==null&&Qn(t,e,1,-1)}function S_(e){var t=va();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:e},t.queue=e,e=e.dispatch=Zj.bind(null,bt,e),[t.memoizedState,e]}function Eu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function sk(){return An().memoizedState}function Fd(e,t,r,n){var a=va();bt.flags|=e,a.memoizedState=Eu(1|t,r,void 0,n===void 0?null:n)}function mh(e,t,r,n){var a=An();n=n===void 0?null:n;var s=void 0;if(Ut!==null){var i=Ut.memoizedState;if(s=i.destroy,n!==null&&px(n,i.deps)){a.memoizedState=Eu(t,r,s,n);return}}bt.flags|=e,a.memoizedState=Eu(1|t,r,s,n)}function k_(e,t){return Fd(8390656,8,e,t)}function gx(e,t){return mh(2048,8,e,t)}function ik(e,t){return mh(4,2,e,t)}function ok(e,t){return mh(4,4,e,t)}function lk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ck(e,t,r){return r=r!=null?r.concat([e]):null,mh(4,4,lk.bind(null,t,e),r)}function xx(){}function uk(e,t){var r=An();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&px(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function fk(e,t){var r=An();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&px(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function dk(e,t,r){return Hi&21?(ra(r,t)||(r=gS(),bt.lanes|=r,zi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vr=!0),e.memoizedState=r)}function Jj(e,t){var r=Xe;Xe=r!==0&&4>r?r:4,e(!0);var n=qp.transition;qp.transition={};try{e(!1),t()}finally{Xe=r,qp.transition=n}}function hk(){return An().memoizedState}function Qj(e,t,r){var n=Xs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},pk(e))mk(t,r);else if(r=qS(e,t,r,n),r!==null){var a=jr();Qn(r,e,n,a),vk(r,t,n)}}function Zj(e,t,r){var n=Xs(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(pk(e))mk(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,ra(o,i)){var l=t.interleaved;l===null?(a.next=a,cx(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=qS(e,t,a,n),r!==null&&(a=jr(),Qn(r,e,n,a),vk(r,t,n))}}function pk(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function mk(e,t){$c=h0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function vk(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qg(e,r)}}var p0={readContext:Nn,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useInsertionEffect:fr,useLayoutEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useMutableSource:fr,useSyncExternalStore:fr,useId:fr,unstable_isNewReconciler:!1},e3={readContext:Nn,useCallback:function(e,t){return va().memoizedState=[e,t===void 0?null:t],e},useContext:Nn,useEffect:k_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Fd(4194308,4,lk.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Fd(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fd(4,2,e,t)},useMemo:function(e,t){var r=va();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=va();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Qj.bind(null,bt,e),[n.memoizedState,e]},useRef:function(e){var t=va();return e={current:e},t.memoizedState=e},useState:S_,useDebugValue:xx,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=S_(!1),t=e[0];return e=Jj.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=bt,a=va();if(vt){if(r===void 0)throw Error(de(407));r=r()}else{if(r=t(),Qt===null)throw Error(de(349));Hi&30||ek(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,k_(rk.bind(null,n,s,e),[e]),n.flags|=2048,Eu(9,tk.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=va(),t=Qt.identifierPrefix;if(vt){var r=qa,n=Ka;r=(n&~(1<<32-Jn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=wu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Xj++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},t3={readContext:Nn,useCallback:uk,useContext:Nn,useEffect:gx,useImperativeHandle:ck,useInsertionEffect:ik,useLayoutEffect:ok,useMemo:fk,useReducer:Xp,useRef:sk,useState:function(){return Xp(bu)},useDebugValue:xx,useDeferredValue:function(e){var t=An();return dk(t,Ut.memoizedState,e)},useTransition:function(){var e=Xp(bu)[0],t=An().memoizedState;return[e,t]},useMutableSource:QS,useSyncExternalStore:ZS,useId:hk,unstable_isNewReconciler:!1},r3={readContext:Nn,useCallback:uk,useContext:Nn,useEffect:gx,useImperativeHandle:ck,useInsertionEffect:ik,useLayoutEffect:ok,useMemo:fk,useReducer:Jp,useRef:sk,useState:function(){return Jp(bu)},useDebugValue:xx,useDeferredValue:function(e){var t=An();return Ut===null?t.memoizedState=e:dk(t,Ut.memoizedState,e)},useTransition:function(){var e=Jp(bu)[0],t=An().memoizedState;return[e,t]},useMutableSource:QS,useSyncExternalStore:ZS,useId:hk,unstable_isNewReconciler:!1};function Vn(e,t){if(e&&e.defaultProps){t=Et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function gv(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var vh={isMounted:function(e){return(e=e._reactInternals)?uo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=jr(),a=Xs(e),s=Za(n,a);s.payload=t,r!=null&&(s.callback=r),t=Ks(e,s,a),t!==null&&(Qn(t,e,a,n),jd(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=jr(),a=Xs(e),s=Za(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ks(e,s,a),t!==null&&(Qn(t,e,a,n),jd(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=jr(),n=Xs(e),a=Za(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ks(e,a,n),t!==null&&(Qn(t,e,n,r),jd(t,e,n))}};function T_(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!mu(r,n)||!mu(a,s):!0}function gk(e,t,r){var n=!1,a=ri,s=t.contextType;return typeof s=="object"&&s!==null?s=Nn(s):(a=zr(t)?Wi:wr.current,n=t.contextTypes,s=(n=n!=null)?hl(e,a):ri),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=vh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function C_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&vh.enqueueReplaceState(t,t.state,null)}function xv(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},ux(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Nn(s):(s=zr(t)?Wi:wr.current,a.context=hl(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(gv(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&vh.enqueueReplaceState(a,a.state,null),f0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function gl(e,t){try{var r="",n=t;do r+=OD(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Qp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function yv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var n3=typeof WeakMap=="function"?WeakMap:Map;function xk(e,t,r){r=Za(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){v0||(v0=!0,Av=n),yv(e,t)},r}function yk(e,t,r){r=Za(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){yv(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){yv(e,t),typeof n!="function"&&(qs===null?qs=new Set([this]):qs.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function N_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new n3;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=g3.bind(null,e,t,r),t.then(e,e))}function A_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function O_(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Za(-1,1),t.tag=2,Ks(r,t,1))),r.lanes|=1),e)}var a3=vs.ReactCurrentOwner,Vr=!1;function Nr(e,t,r,n){t.child=e===null?KS(t,null,r,n):ml(t,e.child,r,n)}function D_(e,t,r,n,a){r=r.render;var s=t.ref;return nl(t,a),n=mx(e,t,r,n,s,a),r=vx(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,cs(e,t,a)):(vt&&r&&nx(t),t.flags|=1,Nr(e,t,n,a),t.child)}function j_(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Tx(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,_k(e,t,s,n,a)):(e=Ld(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:mu,r(i,n)&&e.ref===t.ref)return cs(e,t,a)}return t.flags|=1,e=Js(s,n),e.ref=t.ref,e.return=t,t.child=e}function _k(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(mu(s,n)&&e.ref===t.ref)if(Vr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Vr=!0);else return t.lanes=e.lanes,cs(e,t,a)}return _v(e,t,r,n,a)}function wk(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(Go,Qr),Qr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,at(Go,Qr),Qr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,at(Go,Qr),Qr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,at(Go,Qr),Qr|=n;return Nr(e,t,a,r),t.child}function bk(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function _v(e,t,r,n,a){var s=zr(r)?Wi:wr.current;return s=hl(t,s),nl(t,a),r=mx(e,t,r,n,s,a),n=vx(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,cs(e,t,a)):(vt&&n&&nx(t),t.flags|=1,Nr(e,t,r,a),t.child)}function P_(e,t,r,n,a){if(zr(r)){var s=!0;i0(t)}else s=!1;if(nl(t,a),t.stateNode===null)Rd(e,t),gk(t,r,n),xv(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Nn(c):(c=zr(r)?Wi:wr.current,c=hl(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&C_(t,i,n,c),As=!1;var h=t.memoizedState;i.state=h,f0(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Hr.current||As?(typeof f=="function"&&(gv(t,r,f,n),l=t.memoizedState),(o=As||T_(t,r,o,n,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,XS(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Vn(t.type,o),i.props=c,d=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Nn(l):(l=zr(r)?Wi:wr.current,l=hl(t,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&C_(t,i,n,l),As=!1,h=t.memoizedState,i.state=h,f0(t,n,i,a);var v=t.memoizedState;o!==d||h!==v||Hr.current||As?(typeof m=="function"&&(gv(t,r,m,n),v=t.memoizedState),(c=As||T_(t,r,c,n,h,v,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return wv(e,t,r,n,s,a)}function wv(e,t,r,n,a,s){bk(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&x_(t,r,!1),cs(e,t,s);n=t.stateNode,a3.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=ml(t,e.child,null,s),t.child=ml(t,null,o,s)):Nr(e,t,o,s),t.memoizedState=n.state,a&&x_(t,r,!0),t.child}function Ek(e){var t=e.stateNode;t.pendingContext?g_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&g_(e,t.context,!1),fx(e,t.containerInfo)}function F_(e,t,r,n,a){return pl(),sx(a),t.flags|=256,Nr(e,t,r,n),t.child}var bv={dehydrated:null,treeContext:null,retryLane:0};function Ev(e){return{baseLanes:e,cachePool:null,transitions:null}}function Sk(e,t,r){var n=t.pendingProps,a=_t.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),at(_t,a&1),e===null)return mv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=yh(i,n,0,null),e=Ri(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ev(r),t.memoizedState=bv,e):yx(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return s3(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Js(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Js(o,s):(s=Ri(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?Ev(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=bv,n}return s=e.child,e=s.sibling,n=Js(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function yx(e,t){return t=yh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Zf(e,t,r,n){return n!==null&&sx(n),ml(t,e.child,null,r),e=yx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function s3(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Qp(Error(de(422))),Zf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=yh({mode:"visible",children:n.children},a,0,null),s=Ri(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ml(t,e.child,null,i),t.child.memoizedState=Ev(i),t.memoizedState=bv,s);if(!(t.mode&1))return Zf(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(de(419)),n=Qp(s,n,void 0),Zf(e,t,i,n)}if(o=(i&e.childLanes)!==0,Vr||o){if(n=Qt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ls(e,a),Qn(n,e,a,-1))}return kx(),n=Qp(Error(de(421))),Zf(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=x3.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,nn=Gs(a.nextSibling),an=t,vt=!0,Yn=null,e!==null&&(xn[yn++]=Ka,xn[yn++]=qa,xn[yn++]=Vi,Ka=e.id,qa=e.overflow,Vi=t),t=yx(t,n.children),t.flags|=4096,t)}function R_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),vv(e.return,t,r)}function Zp(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function kk(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Nr(e,t,n.children,r),n=_t.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&R_(e,r,t);else if(e.tag===19)R_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(at(_t,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&d0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Zp(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&d0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Zp(t,!0,r,null,s);break;case"together":Zp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Rd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),zi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(de(153));if(t.child!==null){for(e=t.child,r=Js(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Js(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function i3(e,t,r){switch(t.tag){case 3:Ek(t),pl();break;case 5:JS(t);break;case 1:zr(t.type)&&i0(t);break;case 4:fx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;at(c0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(at(_t,_t.current&1),t.flags|=128,null):r&t.child.childLanes?Sk(e,t,r):(at(_t,_t.current&1),e=cs(e,t,r),e!==null?e.sibling:null);at(_t,_t.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return kk(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),at(_t,_t.current),n)break;return null;case 22:case 23:return t.lanes=0,wk(e,t,r)}return cs(e,t,r)}var Tk,Sv,Ck,Nk;Tk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Sv=function(){};Ck=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Di(Ea.current);var s=null;switch(r){case"input":a=Ym(e,a),n=Ym(e,n),s=[];break;case"select":a=Et({},a,{value:void 0}),n=Et({},n,{value:void 0}),s=[];break;case"textarea":a=qm(e,a),n=qm(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=a0)}Jm(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(lu.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(lu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ot("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Nk=function(e,t,r,n){r!==n&&(t.flags|=4)};function mc(e,t){if(!vt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function o3(e,t,r){var n=t.pendingProps;switch(ax(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(t),null;case 1:return zr(t.type)&&s0(),dr(t),null;case 3:return n=t.stateNode,vl(),ut(Hr),ut(wr),hx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Jf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Yn!==null&&(jv(Yn),Yn=null))),Sv(e,t),dr(t),null;case 5:dx(t);var a=Di(_u.current);if(r=t.type,e!==null&&t.stateNode!=null)Ck(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(de(166));return dr(t),null}if(e=Di(Ea.current),Jf(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ga]=t,n[xu]=s,e=(t.mode&1)!==0,r){case"dialog":ot("cancel",n),ot("close",n);break;case"iframe":case"object":case"embed":ot("load",n);break;case"video":case"audio":for(a=0;a<Cc.length;a++)ot(Cc[a],n);break;case"source":ot("error",n);break;case"img":case"image":case"link":ot("error",n),ot("load",n);break;case"details":ot("toggle",n);break;case"input":Hy(n,s),ot("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ot("invalid",n);break;case"textarea":Yy(n,s),ot("invalid",n)}Jm(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Xf(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Xf(n.textContent,o,e),a=["children",""+o]):lu.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ot("scroll",n)}switch(r){case"input":Wf(n),zy(n,s,!0);break;case"textarea":Wf(n),Gy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=a0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ga]=t,e[xu]=n,Tk(e,t,!1,!1),t.stateNode=e;e:{switch(i=Qm(r,n),r){case"dialog":ot("cancel",e),ot("close",e),a=n;break;case"iframe":case"object":case"embed":ot("load",e),a=n;break;case"video":case"audio":for(a=0;a<Cc.length;a++)ot(Cc[a],e);a=n;break;case"source":ot("error",e),a=n;break;case"img":case"image":case"link":ot("error",e),ot("load",e),a=n;break;case"details":ot("toggle",e),a=n;break;case"input":Hy(e,n),a=Ym(e,n),ot("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Et({},n,{value:void 0}),ot("invalid",e);break;case"textarea":Yy(e,n),a=qm(e,n),ot("invalid",e);break;default:a=n}Jm(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?sS(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&nS(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&cu(e,l):typeof l=="number"&&cu(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(lu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ot("scroll",e):l!=null&&Vg(e,s,l,i))}switch(r){case"input":Wf(e),zy(e,n,!1);break;case"textarea":Wf(e),Gy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ti(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Zo(e,!!n.multiple,s,!1):n.defaultValue!=null&&Zo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=a0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dr(t),null;case 6:if(e&&t.stateNode!=null)Nk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(de(166));if(r=Di(_u.current),Di(Ea.current),Jf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ga]=t,(s=n.nodeValue!==r)&&(e=an,e!==null))switch(e.tag){case 3:Xf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ga]=t,t.stateNode=n}return dr(t),null;case 13:if(ut(_t),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(vt&&nn!==null&&t.mode&1&&!(t.flags&128))YS(),pl(),t.flags|=98560,s=!1;else if(s=Jf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(de(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(de(317));s[ga]=t}else pl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dr(t),s=!1}else Yn!==null&&(jv(Yn),Yn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?Wt===0&&(Wt=3):kx())),t.updateQueue!==null&&(t.flags|=4),dr(t),null);case 4:return vl(),Sv(e,t),e===null&&vu(t.stateNode.containerInfo),dr(t),null;case 10:return lx(t.type._context),dr(t),null;case 17:return zr(t.type)&&s0(),dr(t),null;case 19:if(ut(_t),s=t.memoizedState,s===null)return dr(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)mc(s,!1);else{if(Wt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=d0(e),i!==null){for(t.flags|=128,mc(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return at(_t,_t.current&1|2),t.child}e=e.sibling}s.tail!==null&&jt()>xl&&(t.flags|=128,n=!0,mc(s,!1),t.lanes=4194304)}else{if(!n)if(e=d0(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),mc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!vt)return dr(t),null}else 2*jt()-s.renderingStartTime>xl&&r!==1073741824&&(t.flags|=128,n=!0,mc(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=jt(),t.sibling=null,r=_t.current,at(_t,n?r&1|2:r&1),t):(dr(t),null);case 22:case 23:return Sx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Qr&1073741824&&(dr(t),t.subtreeFlags&6&&(t.flags|=8192)):dr(t),null;case 24:return null;case 25:return null}throw Error(de(156,t.tag))}function l3(e,t){switch(ax(t),t.tag){case 1:return zr(t.type)&&s0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return vl(),ut(Hr),ut(wr),hx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return dx(t),null;case 13:if(ut(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(de(340));pl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(_t),null;case 4:return vl(),null;case 10:return lx(t.type._context),null;case 22:case 23:return Sx(),null;case 24:return null;default:return null}}var ed=!1,vr=!1,c3=typeof WeakSet=="function"?WeakSet:Set,be=null;function Yo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){St(e,t,n)}else r.current=null}function kv(e,t,r){try{r()}catch(n){St(e,t,n)}}var M_=!1;function u3(e,t){if(lv=t0,e=PS(),rx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,d=e,h=null;t:for(;;){for(var m;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(m=d.firstChild)!==null;)h=d,d=m;for(;;){if(d===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++f===n&&(l=i),(m=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(cv={focusedElem:e,selectionRange:r},t0=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var p=v.memoizedProps,_=v.memoizedState,y=t.stateNode,x=y.getSnapshotBeforeUpdate(t.elementType===t.type?p:Vn(t.type,p),_);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(w){St(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return v=M_,M_=!1,v}function Bc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&kv(t,r,s)}a=a.next}while(a!==n)}}function gh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Tv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ak(e){var t=e.alternate;t!==null&&(e.alternate=null,Ak(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ga],delete t[xu],delete t[dv],delete t[Yj],delete t[Gj])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ok(e){return e.tag===5||e.tag===3||e.tag===4}function I_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ok(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Cv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=a0));else if(n!==4&&(e=e.child,e!==null))for(Cv(e,t,r),e=e.sibling;e!==null;)Cv(e,t,r),e=e.sibling}function Nv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Nv(e,t,r),e=e.sibling;e!==null;)Nv(e,t,r),e=e.sibling}var tr=null,Hn=!1;function Es(e,t,r){for(r=r.child;r!==null;)Dk(e,t,r),r=r.sibling}function Dk(e,t,r){if(ba&&typeof ba.onCommitFiberUnmount=="function")try{ba.onCommitFiberUnmount(ch,r)}catch{}switch(r.tag){case 5:vr||Yo(r,t);case 6:var n=tr,a=Hn;tr=null,Es(e,t,r),tr=n,Hn=a,tr!==null&&(Hn?(e=tr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):tr.removeChild(r.stateNode));break;case 18:tr!==null&&(Hn?(e=tr,r=r.stateNode,e.nodeType===8?Yp(e.parentNode,r):e.nodeType===1&&Yp(e,r),hu(e)):Yp(tr,r.stateNode));break;case 4:n=tr,a=Hn,tr=r.stateNode.containerInfo,Hn=!0,Es(e,t,r),tr=n,Hn=a;break;case 0:case 11:case 14:case 15:if(!vr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&kv(r,t,i),a=a.next}while(a!==n)}Es(e,t,r);break;case 1:if(!vr&&(Yo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){St(r,t,o)}Es(e,t,r);break;case 21:Es(e,t,r);break;case 22:r.mode&1?(vr=(n=vr)||r.memoizedState!==null,Es(e,t,r),vr=n):Es(e,t,r);break;default:Es(e,t,r)}}function L_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new c3),t.forEach(function(n){var a=y3.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Bn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:tr=o.stateNode,Hn=!1;break e;case 3:tr=o.stateNode.containerInfo,Hn=!0;break e;case 4:tr=o.stateNode.containerInfo,Hn=!0;break e}o=o.return}if(tr===null)throw Error(de(160));Dk(s,i,a),tr=null,Hn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){St(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)jk(t,e),t=t.sibling}function jk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bn(t,e),da(e),n&4){try{Bc(3,e,e.return),gh(3,e)}catch(p){St(e,e.return,p)}try{Bc(5,e,e.return)}catch(p){St(e,e.return,p)}}break;case 1:Bn(t,e),da(e),n&512&&r!==null&&Yo(r,r.return);break;case 5:if(Bn(t,e),da(e),n&512&&r!==null&&Yo(r,r.return),e.flags&32){var a=e.stateNode;try{cu(a,"")}catch(p){St(e,e.return,p)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&eS(a,s),Qm(o,i);var c=Qm(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?sS(a,d):f==="dangerouslySetInnerHTML"?nS(a,d):f==="children"?cu(a,d):Vg(a,f,d,c)}switch(o){case"input":Gm(a,s);break;case"textarea":tS(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Zo(a,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?Zo(a,!!s.multiple,s.defaultValue,!0):Zo(a,!!s.multiple,s.multiple?[]:"",!1))}a[xu]=s}catch(p){St(e,e.return,p)}}break;case 6:if(Bn(t,e),da(e),n&4){if(e.stateNode===null)throw Error(de(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(p){St(e,e.return,p)}}break;case 3:if(Bn(t,e),da(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{hu(t.containerInfo)}catch(p){St(e,e.return,p)}break;case 4:Bn(t,e),da(e);break;case 13:Bn(t,e),da(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(bx=jt())),n&4&&L_(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(vr=(c=vr)||f,Bn(t,e),vr=c):Bn(t,e),da(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(be=e,f=e.child;f!==null;){for(d=be=f;be!==null;){switch(h=be,m=h.child,h.tag){case 0:case 11:case 14:case 15:Bc(4,h,h.return);break;case 1:Yo(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(p){St(n,r,p)}}break;case 5:Yo(h,h.return);break;case 22:if(h.memoizedState!==null){B_(d);continue}}m!==null?(m.return=h,be=m):B_(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=aS("display",i))}catch(p){St(e,e.return,p)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(p){St(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Bn(t,e),da(e),n&4&&L_(e);break;case 21:break;default:Bn(t,e),da(e)}}function da(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ok(r)){var n=r;break e}r=r.return}throw Error(de(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(cu(a,""),n.flags&=-33);var s=I_(e);Nv(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=I_(e);Cv(e,o,i);break;default:throw Error(de(161))}}catch(l){St(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function f3(e,t,r){be=e,Pk(e)}function Pk(e,t,r){for(var n=(e.mode&1)!==0;be!==null;){var a=be,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||ed;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||vr;o=ed;var c=vr;if(ed=i,(vr=l)&&!c)for(be=a;be!==null;)i=be,l=i.child,i.tag===22&&i.memoizedState!==null?U_(a):l!==null?(l.return=i,be=l):U_(a);for(;s!==null;)be=s,Pk(s),s=s.sibling;be=a,ed=o,vr=c}$_(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,be=s):$_(e)}}function $_(e){for(;be!==null;){var t=be;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vr||gh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!vr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Vn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&E_(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}E_(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&hu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}vr||t.flags&512&&Tv(t)}catch(h){St(t,t.return,h)}}if(t===e){be=null;break}if(r=t.sibling,r!==null){r.return=t.return,be=r;break}be=t.return}}function B_(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var r=t.sibling;if(r!==null){r.return=t.return,be=r;break}be=t.return}}function U_(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{gh(4,t)}catch(l){St(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){St(t,a,l)}}var s=t.return;try{Tv(t)}catch(l){St(t,s,l)}break;case 5:var i=t.return;try{Tv(t)}catch(l){St(t,i,l)}}}catch(l){St(t,t.return,l)}if(t===e){be=null;break}var o=t.sibling;if(o!==null){o.return=t.return,be=o;break}be=t.return}}var d3=Math.ceil,m0=vs.ReactCurrentDispatcher,_x=vs.ReactCurrentOwner,Cn=vs.ReactCurrentBatchConfig,Ve=0,Qt=null,Lt=null,ar=0,Qr=0,Go=ci(0),Wt=0,Su=null,zi=0,xh=0,wx=0,Uc=null,Ur=null,bx=0,xl=1/0,Ua=null,v0=!1,Av=null,qs=null,td=!1,Is=null,g0=0,Wc=0,Ov=null,Md=-1,Id=0;function jr(){return Ve&6?jt():Md!==-1?Md:Md=jt()}function Xs(e){return e.mode&1?Ve&2&&ar!==0?ar&-ar:qj.transition!==null?(Id===0&&(Id=gS()),Id):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:SS(e.type)),e):1}function Qn(e,t,r,n){if(50<Wc)throw Wc=0,Ov=null,Error(de(185));af(e,r,n),(!(Ve&2)||e!==Qt)&&(e===Qt&&(!(Ve&2)&&(xh|=r),Wt===4&&js(e,ar)),Yr(e,n),r===1&&Ve===0&&!(t.mode&1)&&(xl=jt()+500,ph&&ui()))}function Yr(e,t){var r=e.callbackNode;qD(e,t);var n=e0(e,e===Qt?ar:0);if(n===0)r!==null&&Xy(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Xy(r),t===1)e.tag===0?Kj(W_.bind(null,e)):VS(W_.bind(null,e)),Hj(function(){!(Ve&6)&&ui()}),r=null;else{switch(xS(n)){case 1:r=Kg;break;case 4:r=mS;break;case 16:r=Zd;break;case 536870912:r=vS;break;default:r=Zd}r=Uk(r,Fk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Fk(e,t){if(Md=-1,Id=0,Ve&6)throw Error(de(327));var r=e.callbackNode;if(al()&&e.callbackNode!==r)return null;var n=e0(e,e===Qt?ar:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=x0(e,n);else{t=n;var a=Ve;Ve|=2;var s=Mk();(Qt!==e||ar!==t)&&(Ua=null,xl=jt()+500,Fi(e,t));do try{m3();break}catch(o){Rk(e,o)}while(!0);ox(),m0.current=s,Ve=a,Lt!==null?t=0:(Qt=null,ar=0,t=Wt)}if(t!==0){if(t===2&&(a=nv(e),a!==0&&(n=a,t=Dv(e,a))),t===1)throw r=Su,Fi(e,0),js(e,n),Yr(e,jt()),r;if(t===6)js(e,n);else{if(a=e.current.alternate,!(n&30)&&!h3(a)&&(t=x0(e,n),t===2&&(s=nv(e),s!==0&&(n=s,t=Dv(e,s))),t===1))throw r=Su,Fi(e,0),js(e,n),Yr(e,jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(de(345));case 2:Ei(e,Ur,Ua);break;case 3:if(js(e,n),(n&130023424)===n&&(t=bx+500-jt(),10<t)){if(e0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){jr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=fv(Ei.bind(null,e,Ur,Ua),t);break}Ei(e,Ur,Ua);break;case 4:if(js(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Jn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*d3(n/1960))-n,10<n){e.timeoutHandle=fv(Ei.bind(null,e,Ur,Ua),n);break}Ei(e,Ur,Ua);break;case 5:Ei(e,Ur,Ua);break;default:throw Error(de(329))}}}return Yr(e,jt()),e.callbackNode===r?Fk.bind(null,e):null}function Dv(e,t){var r=Uc;return e.current.memoizedState.isDehydrated&&(Fi(e,t).flags|=256),e=x0(e,t),e!==2&&(t=Ur,Ur=r,t!==null&&jv(t)),e}function jv(e){Ur===null?Ur=e:Ur.push.apply(Ur,e)}function h3(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!ra(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function js(e,t){for(t&=~wx,t&=~xh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Jn(t),n=1<<r;e[r]=-1,t&=~n}}function W_(e){if(Ve&6)throw Error(de(327));al();var t=e0(e,0);if(!(t&1))return Yr(e,jt()),null;var r=x0(e,t);if(e.tag!==0&&r===2){var n=nv(e);n!==0&&(t=n,r=Dv(e,n))}if(r===1)throw r=Su,Fi(e,0),js(e,t),Yr(e,jt()),r;if(r===6)throw Error(de(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ei(e,Ur,Ua),Yr(e,jt()),null}function Ex(e,t){var r=Ve;Ve|=1;try{return e(t)}finally{Ve=r,Ve===0&&(xl=jt()+500,ph&&ui())}}function Yi(e){Is!==null&&Is.tag===0&&!(Ve&6)&&al();var t=Ve;Ve|=1;var r=Cn.transition,n=Xe;try{if(Cn.transition=null,Xe=1,e)return e()}finally{Xe=n,Cn.transition=r,Ve=t,!(Ve&6)&&ui()}}function Sx(){Qr=Go.current,ut(Go)}function Fi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Vj(r)),Lt!==null)for(r=Lt.return;r!==null;){var n=r;switch(ax(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&s0();break;case 3:vl(),ut(Hr),ut(wr),hx();break;case 5:dx(n);break;case 4:vl();break;case 13:ut(_t);break;case 19:ut(_t);break;case 10:lx(n.type._context);break;case 22:case 23:Sx()}r=r.return}if(Qt=e,Lt=e=Js(e.current,null),ar=Qr=t,Wt=0,Su=null,wx=xh=zi=0,Ur=Uc=null,Oi!==null){for(t=0;t<Oi.length;t++)if(r=Oi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Oi=null}return e}function Rk(e,t){do{var r=Lt;try{if(ox(),Pd.current=p0,h0){for(var n=bt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}h0=!1}if(Hi=0,Jt=Ut=bt=null,$c=!1,wu=0,_x.current=null,r===null||r.return===null){Wt=1,Su=t,Lt=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=ar,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=A_(i);if(m!==null){m.flags&=-257,O_(m,i,o,s,t),m.mode&1&&N_(s,c,t),t=m,l=c;var v=t.updateQueue;if(v===null){var p=new Set;p.add(l),t.updateQueue=p}else v.add(l);break e}else{if(!(t&1)){N_(s,c,t),kx();break e}l=Error(de(426))}}else if(vt&&o.mode&1){var _=A_(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),O_(_,i,o,s,t),sx(gl(l,o));break e}}s=l=gl(l,o),Wt!==4&&(Wt=2),Uc===null?Uc=[s]:Uc.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=xk(s,l,t);b_(s,y);break e;case 1:o=l;var x=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(qs===null||!qs.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=yk(s,o,t);b_(s,w);break e}}s=s.return}while(s!==null)}Lk(r)}catch(b){t=b,Lt===r&&r!==null&&(Lt=r=r.return);continue}break}while(!0)}function Mk(){var e=m0.current;return m0.current=p0,e===null?p0:e}function kx(){(Wt===0||Wt===3||Wt===2)&&(Wt=4),Qt===null||!(zi&268435455)&&!(xh&268435455)||js(Qt,ar)}function x0(e,t){var r=Ve;Ve|=2;var n=Mk();(Qt!==e||ar!==t)&&(Ua=null,Fi(e,t));do try{p3();break}catch(a){Rk(e,a)}while(!0);if(ox(),Ve=r,m0.current=n,Lt!==null)throw Error(de(261));return Qt=null,ar=0,Wt}function p3(){for(;Lt!==null;)Ik(Lt)}function m3(){for(;Lt!==null&&!BD();)Ik(Lt)}function Ik(e){var t=Bk(e.alternate,e,Qr);e.memoizedProps=e.pendingProps,t===null?Lk(e):Lt=t,_x.current=null}function Lk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=l3(r,t),r!==null){r.flags&=32767,Lt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Wt=6,Lt=null;return}}else if(r=o3(r,t,Qr),r!==null){Lt=r;return}if(t=t.sibling,t!==null){Lt=t;return}Lt=t=e}while(t!==null);Wt===0&&(Wt=5)}function Ei(e,t,r){var n=Xe,a=Cn.transition;try{Cn.transition=null,Xe=1,v3(e,t,r,n)}finally{Cn.transition=a,Xe=n}return null}function v3(e,t,r,n){do al();while(Is!==null);if(Ve&6)throw Error(de(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(de(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(XD(e,s),e===Qt&&(Lt=Qt=null,ar=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||td||(td=!0,Uk(Zd,function(){return al(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Cn.transition,Cn.transition=null;var i=Xe;Xe=1;var o=Ve;Ve|=4,_x.current=null,u3(e,r),jk(r,e),Mj(cv),t0=!!lv,cv=lv=null,e.current=r,f3(r),UD(),Ve=o,Xe=i,Cn.transition=s}else e.current=r;if(td&&(td=!1,Is=e,g0=a),s=e.pendingLanes,s===0&&(qs=null),HD(r.stateNode),Yr(e,jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(v0)throw v0=!1,e=Av,Av=null,e;return g0&1&&e.tag!==0&&al(),s=e.pendingLanes,s&1?e===Ov?Wc++:(Wc=0,Ov=e):Wc=0,ui(),null}function al(){if(Is!==null){var e=xS(g0),t=Cn.transition,r=Xe;try{if(Cn.transition=null,Xe=16>e?16:e,Is===null)var n=!1;else{if(e=Is,Is=null,g0=0,Ve&6)throw Error(de(331));var a=Ve;for(Ve|=4,be=e.current;be!==null;){var s=be,i=s.child;if(be.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(be=c;be!==null;){var f=be;switch(f.tag){case 0:case 11:case 15:Bc(8,f,s)}var d=f.child;if(d!==null)d.return=f,be=d;else for(;be!==null;){f=be;var h=f.sibling,m=f.return;if(Ak(f),f===c){be=null;break}if(h!==null){h.return=m,be=h;break}be=m}}}var v=s.alternate;if(v!==null){var p=v.child;if(p!==null){v.child=null;do{var _=p.sibling;p.sibling=null,p=_}while(p!==null)}}be=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,be=i;else e:for(;be!==null;){if(s=be,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Bc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,be=y;break e}be=s.return}}var x=e.current;for(be=x;be!==null;){i=be;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,be=g;else e:for(i=x;be!==null;){if(o=be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:gh(9,o)}}catch(b){St(o,o.return,b)}if(o===i){be=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,be=w;break e}be=o.return}}if(Ve=a,ui(),ba&&typeof ba.onPostCommitFiberRoot=="function")try{ba.onPostCommitFiberRoot(ch,e)}catch{}n=!0}return n}finally{Xe=r,Cn.transition=t}}return!1}function V_(e,t,r){t=gl(r,t),t=xk(e,t,1),e=Ks(e,t,1),t=jr(),e!==null&&(af(e,1,t),Yr(e,t))}function St(e,t,r){if(e.tag===3)V_(e,e,r);else for(;t!==null;){if(t.tag===3){V_(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qs===null||!qs.has(n))){e=gl(r,e),e=yk(t,e,1),t=Ks(t,e,1),e=jr(),t!==null&&(af(t,1,e),Yr(t,e));break}}t=t.return}}function g3(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=jr(),e.pingedLanes|=e.suspendedLanes&r,Qt===e&&(ar&r)===r&&(Wt===4||Wt===3&&(ar&130023424)===ar&&500>jt()-bx?Fi(e,0):wx|=r),Yr(e,t)}function $k(e,t){t===0&&(e.mode&1?(t=zf,zf<<=1,!(zf&130023424)&&(zf=4194304)):t=1);var r=jr();e=ls(e,t),e!==null&&(af(e,t,r),Yr(e,r))}function x3(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),$k(e,r)}function y3(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(de(314))}n!==null&&n.delete(t),$k(e,r)}var Bk;Bk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Hr.current)Vr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vr=!1,i3(e,t,r);Vr=!!(e.flags&131072)}else Vr=!1,vt&&t.flags&1048576&&HS(t,l0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Rd(e,t),e=t.pendingProps;var a=hl(t,wr.current);nl(t,r),a=mx(null,t,n,e,a,r);var s=vx();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zr(n)?(s=!0,i0(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,ux(t),a.updater=vh,t.stateNode=a,a._reactInternals=t,xv(t,n,e,r),t=wv(null,t,n,!0,s,r)):(t.tag=0,vt&&s&&nx(t),Nr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Rd(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=w3(n),e=Vn(n,e),a){case 0:t=_v(null,t,n,e,r);break e;case 1:t=P_(null,t,n,e,r);break e;case 11:t=D_(null,t,n,e,r);break e;case 14:t=j_(null,t,n,Vn(n.type,e),r);break e}throw Error(de(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),_v(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),P_(e,t,n,a,r);case 3:e:{if(Ek(t),e===null)throw Error(de(387));n=t.pendingProps,s=t.memoizedState,a=s.element,XS(e,t),f0(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=gl(Error(de(423)),t),t=F_(e,t,n,r,a);break e}else if(n!==a){a=gl(Error(de(424)),t),t=F_(e,t,n,r,a);break e}else for(nn=Gs(t.stateNode.containerInfo.firstChild),an=t,vt=!0,Yn=null,r=KS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(pl(),n===a){t=cs(e,t,r);break e}Nr(e,t,n,r)}t=t.child}return t;case 5:return JS(t),e===null&&mv(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,uv(n,a)?i=null:s!==null&&uv(n,s)&&(t.flags|=32),bk(e,t),Nr(e,t,i,r),t.child;case 6:return e===null&&mv(t),null;case 13:return Sk(e,t,r);case 4:return fx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ml(t,null,n,r):Nr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),D_(e,t,n,a,r);case 7:return Nr(e,t,t.pendingProps,r),t.child;case 8:return Nr(e,t,t.pendingProps.children,r),t.child;case 12:return Nr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,at(c0,n._currentValue),n._currentValue=i,s!==null)if(ra(s.value,i)){if(s.children===a.children&&!Hr.current){t=cs(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Za(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),vv(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(de(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),vv(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Nr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,nl(t,r),a=Nn(a),n=n(a),t.flags|=1,Nr(e,t,n,r),t.child;case 14:return n=t.type,a=Vn(n,t.pendingProps),a=Vn(n.type,a),j_(e,t,n,a,r);case 15:return _k(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),Rd(e,t),t.tag=1,zr(n)?(e=!0,i0(t)):e=!1,nl(t,r),gk(t,n,a),xv(t,n,a,r),wv(null,t,n,!0,e,r);case 19:return kk(e,t,r);case 22:return wk(e,t,r)}throw Error(de(156,t.tag))};function Uk(e,t){return pS(e,t)}function _3(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(e,t,r,n){return new _3(e,t,r,n)}function Tx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function w3(e){if(typeof e=="function")return Tx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zg)return 11;if(e===Yg)return 14}return 2}function Js(e,t){var r=e.alternate;return r===null?(r=Sn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ld(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")Tx(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Io:return Ri(r.children,a,s,t);case Hg:i=8,a|=8;break;case Wm:return e=Sn(12,r,t,a|2),e.elementType=Wm,e.lanes=s,e;case Vm:return e=Sn(13,r,t,a),e.elementType=Vm,e.lanes=s,e;case Hm:return e=Sn(19,r,t,a),e.elementType=Hm,e.lanes=s,e;case JE:return yh(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case qE:i=10;break e;case XE:i=9;break e;case zg:i=11;break e;case Yg:i=14;break e;case Ns:i=16,n=null;break e}throw Error(de(130,e==null?e:typeof e,""))}return t=Sn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Ri(e,t,r,n){return e=Sn(7,e,n,t),e.lanes=r,e}function yh(e,t,r,n){return e=Sn(22,e,n,t),e.elementType=JE,e.lanes=r,e.stateNode={isHidden:!1},e}function em(e,t,r){return e=Sn(6,e,null,t),e.lanes=r,e}function tm(e,t,r){return t=Sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function b3(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rp(0),this.expirationTimes=Rp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rp(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Cx(e,t,r,n,a,s,i,o,l){return e=new b3(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Sn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ux(s),e}function E3(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Wk(e){if(!e)return ri;e=e._reactInternals;e:{if(uo(e)!==e||e.tag!==1)throw Error(de(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(de(171))}if(e.tag===1){var r=e.type;if(zr(r))return WS(e,r,t)}return t}function Vk(e,t,r,n,a,s,i,o,l){return e=Cx(r,n,!0,e,a,s,i,o,l),e.context=Wk(null),r=e.current,n=jr(),a=Xs(r),s=Za(n,a),s.callback=t??null,Ks(r,s,a),e.current.lanes=a,af(e,a,n),Yr(e,n),e}function _h(e,t,r,n){var a=t.current,s=jr(),i=Xs(a);return r=Wk(r),t.context===null?t.context=r:t.pendingContext=r,t=Za(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ks(a,t,i),e!==null&&(Qn(e,a,i,s),jd(e,a,i)),i}function y0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function H_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Nx(e,t){H_(e,t),(e=e.alternate)&&H_(e,t)}function S3(){return null}var Hk=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ax(e){this._internalRoot=e}wh.prototype.render=Ax.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(de(409));_h(e,t,null,null)};wh.prototype.unmount=Ax.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Yi(function(){_h(null,e,null,null)}),t[os]=null}};function wh(e){this._internalRoot=e}wh.prototype.unstable_scheduleHydration=function(e){if(e){var t=wS();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ds.length&&t!==0&&t<Ds[r].priority;r++);Ds.splice(r,0,e),r===0&&ES(e)}};function Ox(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function bh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function z_(){}function k3(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=y0(i);s.call(c)}}var i=Vk(t,n,e,0,null,!1,!1,"",z_);return e._reactRootContainer=i,e[os]=i.current,vu(e.nodeType===8?e.parentNode:e),Yi(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=y0(l);o.call(c)}}var l=Cx(e,0,!1,null,null,!1,!1,"",z_);return e._reactRootContainer=l,e[os]=l.current,vu(e.nodeType===8?e.parentNode:e),Yi(function(){_h(t,l,r,n)}),l}function Eh(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=y0(i);o.call(l)}}_h(t,i,e,a)}else i=k3(r,t,e,a,n);return y0(i)}yS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Tc(t.pendingLanes);r!==0&&(qg(t,r|1),Yr(t,jt()),!(Ve&6)&&(xl=jt()+500,ui()))}break;case 13:Yi(function(){var n=ls(e,1);if(n!==null){var a=jr();Qn(n,e,1,a)}}),Nx(e,1)}};Xg=function(e){if(e.tag===13){var t=ls(e,134217728);if(t!==null){var r=jr();Qn(t,e,134217728,r)}Nx(e,134217728)}};_S=function(e){if(e.tag===13){var t=Xs(e),r=ls(e,t);if(r!==null){var n=jr();Qn(r,e,t,n)}Nx(e,t)}};wS=function(){return Xe};bS=function(e,t){var r=Xe;try{return Xe=e,t()}finally{Xe=r}};ev=function(e,t,r){switch(t){case"input":if(Gm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=hh(n);if(!a)throw Error(de(90));ZE(n),Gm(n,a)}}}break;case"textarea":tS(e,r);break;case"select":t=r.value,t!=null&&Zo(e,!!r.multiple,t,!1)}};lS=Ex;cS=Yi;var T3={usingClientEntryPoint:!1,Events:[of,Uo,hh,iS,oS,Ex]},vc={findFiberByHostInstance:Ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},C3={bundleType:vc.bundleType,version:vc.version,rendererPackageName:vc.rendererPackageName,rendererConfig:vc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dS(e),e===null?null:e.stateNode},findFiberByHostInstance:vc.findFiberByHostInstance||S3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{ch=rd.inject(C3),ba=rd}catch{}}cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T3;cn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ox(t))throw Error(de(200));return E3(e,t,null,r)};cn.createRoot=function(e,t){if(!Ox(e))throw Error(de(299));var r=!1,n="",a=Hk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Cx(e,1,!1,null,null,r,!1,n,a),e[os]=t.current,vu(e.nodeType===8?e.parentNode:e),new Ax(t)};cn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(de(188)):(e=Object.keys(e).join(","),Error(de(268,e)));return e=dS(t),e=e===null?null:e.stateNode,e};cn.flushSync=function(e){return Yi(e)};cn.hydrate=function(e,t,r){if(!bh(t))throw Error(de(200));return Eh(null,e,t,!0,r)};cn.hydrateRoot=function(e,t,r){if(!Ox(e))throw Error(de(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=Hk;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Vk(t,null,e,1,r??null,a,!1,s,i),e[os]=t.current,vu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new wh(t)};cn.render=function(e,t,r){if(!bh(t))throw Error(de(200));return Eh(null,e,t,!1,r)};cn.unmountComponentAtNode=function(e){if(!bh(e))throw Error(de(40));return e._reactRootContainer?(Yi(function(){Eh(null,null,e,!1,function(){e._reactRootContainer=null,e[os]=null})}),!0):!1};cn.unstable_batchedUpdates=Ex;cn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!bh(r))throw Error(de(200));if(e==null||e._reactInternals===void 0)throw Error(de(38));return Eh(e,t,r,!1,n)};cn.version="18.3.1-next-f1338f8080-20240426";function zk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zk)}catch(e){console.error(e)}}zk(),zE.exports=cn;var Dx=zE.exports;const Yk=Er(Dx);var Gk,Y_=Dx;Gk=Y_.createRoot,Y_.hydrateRoot;/**
 * @remix-run/router v1.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ku.apply(this,arguments)}var Ls;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ls||(Ls={}));const G_="popstate";function N3(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return Pv("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:_0(a)}return O3(t,r,null,e)}function Ft(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Kk(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function A3(){return Math.random().toString(36).substr(2,8)}function K_(e,t){return{usr:e.state,key:e.key,idx:t}}function Pv(e,t,r,n){return r===void 0&&(r=null),ku({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Fl(t):t,{state:r,key:t&&t.key||n||A3()})}function _0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Fl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function O3(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o=Ls.Pop,l=null,c=f();c==null&&(c=0,i.replaceState(ku({},i.state,{idx:c}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=Ls.Pop;let _=f(),y=_==null?null:_-c;c=_,l&&l({action:o,location:p.location,delta:y})}function h(_,y){o=Ls.Push;let x=Pv(p.location,_,y);c=f()+1;let g=K_(x,c),w=p.createHref(x);try{i.pushState(g,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;a.location.assign(w)}s&&l&&l({action:o,location:p.location,delta:1})}function m(_,y){o=Ls.Replace;let x=Pv(p.location,_,y);c=f();let g=K_(x,c),w=p.createHref(x);i.replaceState(g,"",w),s&&l&&l({action:o,location:p.location,delta:0})}function v(_){let y=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof _=="string"?_:_0(_);return x=x.replace(/ $/,"%20"),Ft(y,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,y)}let p={get action(){return o},get location(){return e(a,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(G_,d),l=_,()=>{a.removeEventListener(G_,d),l=null}},createHref(_){return t(a,_)},createURL:v,encodeLocation(_){let y=v(_);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:m,go(_){return i.go(_)}};return p}var q_;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(q_||(q_={}));function D3(e,t,r){return r===void 0&&(r="/"),j3(e,t,r,!1)}function j3(e,t,r,n){let a=typeof t=="string"?Fl(t):t,s=jx(a.pathname||"/",r);if(s==null)return null;let i=qk(e);P3(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=H3(s);o=W3(i[l],c,n)}return o}function qk(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(Ft(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Qs([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(Ft(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),qk(s.children,t,f,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:B3(c,s.index),routesMeta:f})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of Xk(s.path))a(s,i,l)}),t}function Xk(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=Xk(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function P3(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:U3(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const F3=/^:[\w-]+$/,R3=3,M3=2,I3=1,L3=10,$3=-2,X_=e=>e==="*";function B3(e,t){let r=e.split("/"),n=r.length;return r.some(X_)&&(n+=$3),t&&(n+=M3),r.filter(a=>!X_(a)).reduce((a,s)=>a+(F3.test(s)?R3:s===""?I3:L3),n)}function U3(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function W3(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=J_({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),h=l.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=J_({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Qs([s,d.pathname]),pathnameBase:K3(Qs([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Qs([s,d.pathnameBase]))}return i}function J_(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=V3(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,f,d)=>{let{paramName:h,isOptional:m}=f;if(h==="*"){let p=o[d]||"";i=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const v=o[d];return m&&!v?c[h]=void 0:c[h]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function V3(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Kk(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function H3(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Kk(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function jx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function z3(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Fl(e):e;return{pathname:r?r.startsWith("/")?r:Y3(r,t):t,search:q3(n),hash:X3(a)}}function Y3(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function rm(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function G3(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Px(e,t){let r=G3(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Fx(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Fl(e):(a=ku({},e),Ft(!a.pathname||!a.pathname.includes("?"),rm("?","pathname","search",a)),Ft(!a.pathname||!a.pathname.includes("#"),rm("#","pathname","hash",a)),Ft(!a.search||!a.search.includes("#"),rm("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}o=d>=0?t[d]:"/"}let l=z3(a,o),c=i&&i!=="/"&&i.endsWith("/"),f=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}const Qs=e=>e.join("/").replace(/\/\/+/g,"/"),K3=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q3=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,X3=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function J3(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Jk=["post","put","patch","delete"];new Set(Jk);const Q3=["get",...Jk];new Set(Q3);/**
 * React Router v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tu(){return Tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tu.apply(this,arguments)}const Rx=O.createContext(null),Z3=O.createContext(null),fi=O.createContext(null),Sh=O.createContext(null),ja=O.createContext({outlet:null,matches:[],isDataRoute:!1}),Qk=O.createContext(null);function eP(e,t){let{relative:r}=t===void 0?{}:t;Rl()||Ft(!1);let{basename:n,navigator:a}=O.useContext(fi),{hash:s,pathname:i,search:o}=eT(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:Qs([n,i])),a.createHref({pathname:l,search:o,hash:s})}function Rl(){return O.useContext(Sh)!=null}function Ml(){return Rl()||Ft(!1),O.useContext(Sh).location}function Zk(e){O.useContext(fi).static||O.useLayoutEffect(e)}function Pn(){let{isDataRoute:e}=O.useContext(ja);return e?mP():tP()}function tP(){Rl()||Ft(!1);let e=O.useContext(Rx),{basename:t,future:r,navigator:n}=O.useContext(fi),{matches:a}=O.useContext(ja),{pathname:s}=Ml(),i=JSON.stringify(Px(a,r.v7_relativeSplatPath)),o=O.useRef(!1);return Zk(()=>{o.current=!0}),O.useCallback(function(c,f){if(f===void 0&&(f={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=Fx(c,JSON.parse(i),s,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Qs([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,s,e])}const rP=O.createContext(null);function nP(e){let t=O.useContext(ja).outlet;return t&&O.createElement(rP.Provider,{value:e},t)}function Il(){let{matches:e}=O.useContext(ja),t=e[e.length-1];return t?t.params:{}}function eT(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=O.useContext(fi),{matches:a}=O.useContext(ja),{pathname:s}=Ml(),i=JSON.stringify(Px(a,n.v7_relativeSplatPath));return O.useMemo(()=>Fx(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function aP(e,t){return sP(e,t)}function sP(e,t,r,n){Rl()||Ft(!1);let{navigator:a,static:s}=O.useContext(fi),{matches:i}=O.useContext(ja),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let f=Ml(),d;if(t){var h;let y=typeof t=="string"?Fl(t):t;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||Ft(!1),d=y}else d=f;let m=d.pathname||"/",v=m;if(c!=="/"){let y=c.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=!s&&r&&r.matches&&r.matches.length>0?r.matches:D3(e,{pathname:v}),_=uP(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Qs([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Qs([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return t&&_?O.createElement(Sh.Provider,{value:{location:Tu({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ls.Pop}},_):_}function iP(){let e=pP(),t=J3(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},t),r?O.createElement("pre",{style:a},r):null,null)}const oP=O.createElement(iP,null);class lP extends O.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?O.createElement(ja.Provider,{value:this.props.routeContext},O.createElement(Qk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cP(e){let{routeContext:t,match:r,children:n}=e,a=O.useContext(Rx);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),O.createElement(ja.Provider,{value:t},n)}function uP(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||Ft(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:h,errors:m}=r,v=d.route.loader&&h[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||v){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((f,d,h)=>{let m,v=!1,p=null,_=null;r&&(m=o&&d.route.id?o[d.route.id]:void 0,p=d.route.errorElement||oP,l&&(c<0&&h===0?(v=!0,_=null):c===h&&(v=!0,_=d.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,h+1)),x=()=>{let g;return m?g=p:v?g=_:d.route.Component?g=O.createElement(d.route.Component,null):d.route.element?g=d.route.element:g=f,O.createElement(cP,{match:d,routeContext:{outlet:f,matches:y,isDataRoute:r!=null},children:g})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?O.createElement(lP,{location:r.location,revalidation:r.revalidation,component:p,error:m,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}var tT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(tT||{}),w0=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(w0||{});function fP(e){let t=O.useContext(Rx);return t||Ft(!1),t}function dP(e){let t=O.useContext(Z3);return t||Ft(!1),t}function hP(e){let t=O.useContext(ja);return t||Ft(!1),t}function rT(e){let t=hP(),r=t.matches[t.matches.length-1];return r.route.id||Ft(!1),r.route.id}function pP(){var e;let t=O.useContext(Qk),r=dP(w0.UseRouteError),n=rT(w0.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function mP(){let{router:e}=fP(tT.UseNavigateStable),t=rT(w0.UseNavigateStable),r=O.useRef(!1);return Zk(()=>{r.current=!0}),O.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Tu({fromRouteId:t},s)))},[e,t])}function vP(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function b0(e){let{to:t,replace:r,state:n,relative:a}=e;Rl()||Ft(!1);let{future:s,static:i}=O.useContext(fi),{matches:o}=O.useContext(ja),{pathname:l}=Ml(),c=Pn(),f=Fx(t,Px(o,s.v7_relativeSplatPath),l,a==="path"),d=JSON.stringify(f);return O.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:a}),[c,d,a,r,n]),null}function gP(e){return nP(e.context)}function ht(e){Ft(!1)}function xP(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Ls.Pop,navigator:s,static:i=!1,future:o}=e;Rl()&&Ft(!1);let l=t.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:l,navigator:s,static:i,future:Tu({v7_relativeSplatPath:!1},o)}),[l,o,s,i]);typeof n=="string"&&(n=Fl(n));let{pathname:f="/",search:d="",hash:h="",state:m=null,key:v="default"}=n,p=O.useMemo(()=>{let _=jx(f,l);return _==null?null:{location:{pathname:_,search:d,hash:h,state:m,key:v},navigationType:a}},[l,f,d,h,m,v,a]);return p==null?null:O.createElement(fi.Provider,{value:c},O.createElement(Sh.Provider,{children:r,value:p}))}function yP(e){let{children:t,location:r}=e;return aP(Fv(t),r)}new Promise(()=>{});function Fv(e,t){t===void 0&&(t=[]);let r=[];return O.Children.forEach(e,(n,a)=>{if(!O.isValidElement(n))return;let s=[...t,a];if(n.type===O.Fragment){r.push.apply(r,Fv(n.props.children,s));return}n.type!==ht&&Ft(!1),!n.props.index||!n.props.children||Ft(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Fv(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rv(){return Rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rv.apply(this,arguments)}function _P(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function wP(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bP(e,t){return e.button===0&&(!t||t==="_self")&&!wP(e)}const EP=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],SP="6";try{window.__reactRouterVersion=SP}catch{}const kP="startTransition",Q_=gD[kP];function TP(e){let{basename:t,children:r,future:n,window:a}=e,s=O.useRef();s.current==null&&(s.current=N3({window:a,v5Compat:!0}));let i=s.current,[o,l]=O.useState({action:i.action,location:i.location}),{v7_startTransition:c}=n||{},f=O.useCallback(d=>{c&&Q_?Q_(()=>l(d)):l(d)},[l,c]);return O.useLayoutEffect(()=>i.listen(f),[i,f]),O.useEffect(()=>vP(n),[n]),O.createElement(xP,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const CP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",NP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xr=O.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:f,viewTransition:d}=t,h=_P(t,EP),{basename:m}=O.useContext(fi),v,p=!1;if(typeof c=="string"&&NP.test(c)&&(v=c,CP))try{let g=new URL(window.location.href),w=c.startsWith("//")?new URL(g.protocol+c):new URL(c),b=jx(w.pathname,m);w.origin===g.origin&&b!=null?c=b+w.search+w.hash:p=!0}catch{}let _=eP(c,{relative:a}),y=AP(c,{replace:i,state:o,target:l,preventScrollReset:f,relative:a,viewTransition:d});function x(g){n&&n(g),g.defaultPrevented||y(g)}return O.createElement("a",Rv({},h,{href:v||_,onClick:p||s?n:x,ref:r,target:l}))});var Z_;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Z_||(Z_={}));var ew;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ew||(ew={}));function AP(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:i,viewTransition:o}=t===void 0?{}:t,l=Pn(),c=Ml(),f=eT(e,{relative:i});return O.useCallback(d=>{if(bP(d,r)){d.preventDefault();let h=n!==void 0?n:_0(c)===_0(f);l(e,{replace:h,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,f,n,a,r,e,s,i,o])}const OP={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnZXdyZWNhcXdocHludWt0dXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg2MTI2NzMsImV4cCI6MjA1NDE4ODY3M30.xsi-rH3yossZT99w9JcLVE_FUpMs7lN6jKQUOadIV-Y",VITE_SUPABASE_URL:"https://wgewrecaqwhpynuktuxp.supabase.co"},tw=e=>{let t;const r=new Set,n=(f,d)=>{const h=typeof f=="function"?f(t):f;if(!Object.is(h,t)){const m=t;t=d??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(v=>v(t,m))}},a=()=>t,l={setState:n,getState:a,getInitialState:()=>c,subscribe:f=>(r.add(f),()=>r.delete(f)),destroy:()=>{(OP?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,a,l);return l},DP=e=>e?tw(e):tw;var nT={exports:{}},aT={},sT={exports:{}},iT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yl=O;function jP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var PP=typeof Object.is=="function"?Object.is:jP,FP=yl.useState,RP=yl.useEffect,MP=yl.useLayoutEffect,IP=yl.useDebugValue;function LP(e,t){var r=t(),n=FP({inst:{value:r,getSnapshot:t}}),a=n[0].inst,s=n[1];return MP(function(){a.value=r,a.getSnapshot=t,nm(a)&&s({inst:a})},[e,r,t]),RP(function(){return nm(a)&&s({inst:a}),e(function(){nm(a)&&s({inst:a})})},[e]),IP(r),r}function nm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!PP(e,r)}catch{return!0}}function $P(e,t){return t()}var BP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$P:LP;iT.useSyncExternalStore=yl.useSyncExternalStore!==void 0?yl.useSyncExternalStore:BP;sT.exports=iT;var oT=sT.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kh=O,UP=oT;function WP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var VP=typeof Object.is=="function"?Object.is:WP,HP=UP.useSyncExternalStore,zP=kh.useRef,YP=kh.useEffect,GP=kh.useMemo,KP=kh.useDebugValue;aT.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var s=zP(null);if(s.current===null){var i={hasValue:!1,value:null};s.current=i}else i=s.current;s=GP(function(){function l(m){if(!c){if(c=!0,f=m,m=n(m),a!==void 0&&i.hasValue){var v=i.value;if(a(v,m))return d=v}return d=m}if(v=d,VP(f,m))return v;var p=n(m);return a!==void 0&&a(v,p)?(f=m,v):(f=m,d=p)}var c=!1,f,d,h=r===void 0?null:r;return[function(){return l(t())},h===null?void 0:function(){return l(h())}]},[t,r,n,a]);var o=HP(e,s[0],s[1]);return YP(function(){i.hasValue=!0,i.value=o},[o]),KP(o),o};nT.exports=aT;var qP=nT.exports;const XP=Er(qP),lT={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnZXdyZWNhcXdocHludWt0dXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg2MTI2NzMsImV4cCI6MjA1NDE4ODY3M30.xsi-rH3yossZT99w9JcLVE_FUpMs7lN6jKQUOadIV-Y",VITE_SUPABASE_URL:"https://wgewrecaqwhpynuktuxp.supabase.co"},{useDebugValue:JP}=J,{useSyncExternalStoreWithSelector:QP}=XP;let rw=!1;const ZP=e=>e;function eF(e,t=ZP,r){(lT?"production":void 0)!=="production"&&r&&!rw&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),rw=!0);const n=QP(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return JP(n),n}const nw=e=>{(lT?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?DP(e):e,r=(n,a)=>eF(t,n,a);return Object.assign(r,t),r},tF=e=>e?nw(e):nw,rF="modulepreload",nF=function(e){return"/"+e},aw={},_l=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=nF(l),l in aw)return;aw[l]=!0;const c=l.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":rF,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,m)=>{d.addEventListener("load",h),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},aF=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>_l(async()=>{const{default:n}=await Promise.resolve().then(()=>Ll);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Mx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class sF extends Mx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class iF extends Mx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class oF extends Mx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Mv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Mv||(Mv={}));var lF=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class cF{constructor(t,{headers:r={},customFetch:n,region:a=Mv.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=aF(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return lF(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=i):typeof i=="string"?(o["Content-Type"]="text/plain",c=i):typeof FormData<"u"&&i instanceof FormData?c=i:(o["Content-Type"]="application/json",c=JSON.stringify(i)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:c}).catch(v=>{throw new sF(v)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new iF(f);if(!f.ok)throw new oF(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return h==="application/json"?m=yield f.json():h==="application/octet-stream"?m=yield f.blob():h==="text/event-stream"?m=f:h==="multipart/form-data"?m=yield f.formData():m=yield f.text(),{data:m,error:null}}catch(a){return{data:null,error:a}}})}}var Wr={},Ix={},Th={},cf={},Ch={},Nh={},uF=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},wl=uF();const fF=wl.fetch,cT=wl.fetch.bind(wl),uT=wl.Headers,dF=wl.Request,hF=wl.Response,Ll=Object.freeze(Object.defineProperty({__proto__:null,Headers:uT,Request:dF,Response:hF,default:cT,fetch:fF},Symbol.toStringTag,{value:"Module"})),pF=tD(Ll);var Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});let mF=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Ah.default=mF;var fT=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nh,"__esModule",{value:!0});const vF=fT(pF),gF=fT(Ah);let xF=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=vF.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l;let c=null,f=null,d=null,h=s.status,m=s.statusText;if(s.ok){if(this.method!=="HEAD"){const y=await s.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=y:f=JSON.parse(y))}const p=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),_=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");p&&_&&_.length>1&&(d=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(c={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,d=null,h=406,m="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const p=await s.text();try{c=JSON.parse(p),Array.isArray(c)&&s.status===404&&(f=[],c=null,h=200,m="OK")}catch{s.status===404&&p===""?(h=204,m="No Content"):c={message:p}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,m="OK"),c&&this.shouldThrowOnError)throw new gF.default(c)}return{error:c,data:f,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Nh.default=xF;var yF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ch,"__esModule",{value:!0});const _F=yF(Nh);let wF=class extends _F.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ch.default=wF;var bF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(cf,"__esModule",{value:!0});const EF=bF(Ch);let SF=class extends EF.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};cf.default=SF;var kF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Th,"__esModule",{value:!0});const gc=kF(cf);let TF=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new gc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new gc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,f)=>c.concat(Object.keys(f)),[]);if(l.length>0){const c=[...new Set(l)].map(f=>`"${f}"`);this.url.searchParams.set("columns",c.join(","))}}return new gc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new gc.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new gc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Th.default=TF;var Oh={},Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});Dh.version=void 0;Dh.version="0.0.0-automated";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.DEFAULT_HEADERS=void 0;const CF=Dh;Oh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${CF.version}`};var dT=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ix,"__esModule",{value:!0});const NF=dT(Th),AF=dT(cf),OF=Oh;let DF=class hT{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},OF.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new NF.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new hT(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(i=n?"HEAD":"GET",Object.entries(r).filter(([f,d])=>d!==void 0).map(([f,d])=>[f,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([f,d])=>{o.searchParams.append(f,d)})):(i="POST",l=r);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new AF.default({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Ix.default=DF;var $l=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.PostgrestError=Wr.PostgrestBuilder=Wr.PostgrestTransformBuilder=Wr.PostgrestFilterBuilder=Wr.PostgrestQueryBuilder=Wr.PostgrestClient=void 0;const pT=$l(Ix);Wr.PostgrestClient=pT.default;const mT=$l(Th);Wr.PostgrestQueryBuilder=mT.default;const vT=$l(cf);Wr.PostgrestFilterBuilder=vT.default;const gT=$l(Ch);Wr.PostgrestTransformBuilder=gT.default;const xT=$l(Nh);Wr.PostgrestBuilder=xT.default;const yT=$l(Ah);Wr.PostgrestError=yT.default;var jF=Wr.default={PostgrestClient:pT.default,PostgrestQueryBuilder:mT.default,PostgrestFilterBuilder:vT.default,PostgrestTransformBuilder:gT.default,PostgrestBuilder:xT.default,PostgrestError:yT.default};const{PostgrestClient:PF,PostgrestQueryBuilder:Mde,PostgrestFilterBuilder:Ide,PostgrestTransformBuilder:Lde,PostgrestBuilder:$de,PostgrestError:Bde}=jF,FF="2.11.2",RF={"X-Client-Info":`realtime-js/${FF}`},MF="1.0.0",_T=1e4,IF=1e3;var sl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(sl||(sl={}));var Jr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Jr||(Jr={}));var zn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(zn||(zn={}));var Iv;(function(e){e.websocket="websocket"})(Iv||(Iv={}));var Ti;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ti||(Ti={}));class LF{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class wT{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(rt||(rt={}));const sw=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=$F(i,e,t,a),s),{})},$F=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?bT(s,i):Lv(i)},bT=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return VF(t,r)}switch(e){case rt.bool:return BF(t);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return UF(t);case rt.json:case rt.jsonb:return WF(t);case rt.timestamp:return HF(t);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return Lv(t);default:return Lv(t)}},Lv=e=>e,BF=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},UF=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},WF=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},VF=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>bT(t,o))}return e},HF=e=>typeof e=="string"?e.replace(" ","T"):e,ET=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class am{constructor(t,r,n={},a=_T){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var iw;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(iw||(iw={}));class Vc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vc.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=Vc.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Vc.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,f)=>{i[c]||(l[c]=f)}),this.map(i,(c,f)=>{const d=s[c];if(d){const h=f.map(_=>_.presence_ref),m=d.map(_=>_.presence_ref),v=f.filter(_=>m.indexOf(_.presence_ref)<0),p=d.filter(_=>h.indexOf(_.presence_ref)<0);v.length>0&&(o[c]=v),p.length>0&&(l[c]=p)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),f.length>0){const d=t[o].map(m=>m.presence_ref),h=f.filter(m=>d.indexOf(m.presence_ref)<0);t[o].unshift(...h)}n(o,f,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const f=l.map(d=>d.presence_ref);c=c.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ow;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ow||(ow={}));var lw;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(lw||(lw={}));var Wa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Wa||(Wa={}));class Lx{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Jr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new am(this,zn.join,this.params,this.timeout),this.rejoinTimer=new wT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Jr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Jr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Jr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Jr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zn.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new Vc(this),this.broadcastEndpointURL=ET(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(f=>t==null?void 0:t(Wa.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(Wa.CLOSED));const l={},c={broadcast:s,presence:i,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var d;if(this.socket.setAuth(),f===void 0){t==null||t(Wa.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,m=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,v=[];for(let p=0;p<m;p++){const _=h[p],{filter:{event:y,schema:x,table:g,filter:w}}=_,b=f&&f[p];if(b&&b.event===y&&b.schema===x&&b.table===g&&b.filter===w)v.push(Object.assign(Object.assign({},_),{id:b.id}));else{this.unsubscribe(),t==null||t(Wa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Wa.SUBSCRIBED);return}}).receive("error",f=>{t==null||t(Wa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Wa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Jr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const a=new am(this,zn.leave,{},t);a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new am(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:f}=zn;if(n&&[o,l,c,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var v,p,_;return((v=m.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(p=m.filter)===null||p===void 0?void 0:p.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(m=>{var v,p,_,y,x,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const w=m.id,b=(v=m.filter)===null||v===void 0?void 0:v.event;return w&&((p=r.ids)===null||p===void 0?void 0:p.includes(w))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const w=(x=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return w==="*"||w===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:p,table:_,commit_timestamp:y,type:x,errors:g}=v;h=Object.assign(Object.assign({},{schema:p,table:_,commit_timestamp:y,eventType:x,new:{},old:{},errors:g}),this._getPayloadRecords(v))}m.callback(h,n)})}_isClosed(){return this.state===Jr.closed}_isJoined(){return this.state===Jr.joined}_isJoining(){return this.state===Jr.joining}_isLeaving(){return this.state===Jr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Lx.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(zn.close,{},t)}_onError(t){this._on(zn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Jr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=sw(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=sw(t.columns,t.old_record)),r}}const zF=()=>{},YF=typeof WebSocket<"u",GF=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class KF{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=RF,this.params={},this.timeout=_T,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=zF,this.conn=null,this.sendBuffer=[],this.serializer=new LF,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>_l(async()=>{const{default:l}=await Promise.resolve().then(()=>Ll);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${t}/${Iv.websocket}`,this.httpEndpoint=ET(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,i)=>i(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new wT(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(YF){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new qF(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),_l(async()=>{const{default:t}=await import("./browser-De9aToAF.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:MF}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case sl.connecting:return Ti.Connecting;case sl.open:return Ti.Open;case sl.closing:return Ti.Closing;default:return Ti.Closed}}isConnected(){return this.connectionState()===Ti.Open}channel(t,r={config:{}}){const n=new Lx(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(zn.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(IF,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:s,ref:i}=r;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${a} ${i&&"("+i+")"||""}`,s),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(zn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([GF],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class qF{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=sl.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class $x extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function qt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class XF extends $x{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class $v extends $x{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var JF=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const ST=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>_l(async()=>{const{default:n}=await Promise.resolve().then(()=>Ll);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},QF=()=>JF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield _l(()=>Promise.resolve().then(()=>Ll),void 0)).Response:Response}),Bv=e=>{if(Array.isArray(e))return e.map(r=>Bv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Bv(n)}),t};var fo=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const sm=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ZF=(e,t,r)=>fo(void 0,void 0,void 0,function*(){const n=yield QF();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new XF(sm(a),e.status||500))}).catch(a=>{t(new $v(sm(a),a))}):t(new $v(sm(e),e))}),eR=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function uf(e,t,r,n,a,s){return fo(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,eR(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>ZF(l,o,n))})})}function E0(e,t,r,n){return fo(this,void 0,void 0,function*(){return uf(e,"GET",t,r,n)})}function Os(e,t,r,n,a){return fo(this,void 0,void 0,function*(){return uf(e,"POST",t,n,a,r)})}function tR(e,t,r,n,a){return fo(this,void 0,void 0,function*(){return uf(e,"PUT",t,n,a,r)})}function rR(e,t,r,n){return fo(this,void 0,void 0,function*(){return uf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function kT(e,t,r,n,a){return fo(this,void 0,void 0,function*(){return uf(e,"DELETE",t,n,a,r)})}var Lr=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const nR={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class aR{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=ST(a)}uploadOrUpdate(t,r,n,a){return Lr(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},cw),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),f=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(qt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Lr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:cw.upsert},a),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:f}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(qt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Lr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Os(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new $x("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Lr(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Lr(this,void 0,void 0,function*(){try{return{data:{path:(yield Os(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Lr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Os(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Lr(this,void 0,void 0,function*(){try{const a=yield Os(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}download(t,r){return Lr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield E0(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(qt(o))return{data:null,error:o};throw o}})}info(t){return Lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield E0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Bv(n),error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}exists(t){return Lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield rR(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(qt(n)&&n instanceof $v){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Lr(this,void 0,void 0,function*(){try{return{data:yield kT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Lr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},nR),r),{prefix:t||""});return{data:yield Os(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(qt(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const sR="2.7.1",iR={"X-Client-Info":`storage-js/${sR}`};var To=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class oR{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},iR),r),this.fetch=ST(n)}listBuckets(){return To(this,void 0,void 0,function*(){try{return{data:yield E0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(qt(t))return{data:null,error:t};throw t}})}getBucket(t){return To(this,void 0,void 0,function*(){try{return{data:yield E0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return To(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return To(this,void 0,void 0,function*(){try{return{data:yield tR(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return To(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return To(this,void 0,void 0,function*(){try{return{data:yield kT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}})}}class lR extends oR{constructor(t,r={},n){super(t,r,n)}from(t){return new aR(this.url,this.headers,t,this.fetch)}}const cR="2.49.3";let Nc="";typeof Deno<"u"?Nc="deno":typeof document<"u"?Nc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Nc="react-native":Nc="node";const uR={"X-Client-Info":`supabase-js-${Nc}/${cR}`},fR={headers:uR},dR={schema:"public"},hR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},pR={};var mR=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const vR=e=>{let t;return e?t=e:typeof fetch>"u"?t=cT:t=fetch,(...r)=>t(...r)},gR=()=>typeof Headers>"u"?uT:Headers,xR=(e,t,r)=>{const n=vR(r),a=gR();return(s,i)=>mR(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var yR=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function _R(e){return e.replace(/\/$/,"")}function wR(e,t){const{db:r,auth:n,realtime:a,global:s}=e,{db:i,auth:o,realtime:l,global:c}=t,f={db:Object.assign(Object.assign({},i),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),s),accessToken:()=>yR(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const TT="2.69.1",jo=30*1e3,Uv=3,im=Uv*jo,bR="http://localhost:9999",ER="supabase.auth.token",SR={"X-Client-Info":`gotrue-js/${TT}`},Wv="X-Supabase-Api-Version",CT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},kR=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,TR=6e5;class Bx extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Pe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class CR extends Bx{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function NR(e){return Pe(e)&&e.name==="AuthApiError"}class NT extends Bx{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class di extends Bx{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Ts extends di{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function AR(e){return Pe(e)&&e.name==="AuthSessionMissingError"}class om extends di{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class nd extends di{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ad extends di{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function OR(e){return Pe(e)&&e.name==="AuthImplicitGrantRedirectError"}class uw extends di{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vv extends di{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function lm(e){return Pe(e)&&e.name==="AuthRetryableFetchError"}class fw extends di{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Hc extends di{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const dw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),hw=` 	
\r=`.split(""),DR=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<hw.length;t+=1)e[hw[t].charCodeAt(0)]=-2;for(let t=0;t<dw.length;t+=1)e[dw[t].charCodeAt(0)]=t;return e})();function AT(e,t,r){const n=DR[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function pw(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{FR(i,n,r)};for(let i=0;i<e.length;i+=1)AT(e.charCodeAt(i),a,s);return t.join("")}function jR(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function PR(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}jR(n,t)}}function FR(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function RR(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)AT(e.charCodeAt(a),r,n);return new Uint8Array(t)}function MR(e){const t=[];return PR(e,r=>t.push(r)),new Uint8Array(t)}function IR(e){return Math.round(Date.now()/1e3)+e}function LR(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const pa=()=>typeof window<"u"&&typeof document<"u",_i={tested:!1,writable:!1},zc=()=>{if(!pa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_i.tested)return _i.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),_i.tested=!0,_i.writable=!0}catch{_i.tested=!0,_i.writable=!1}return _i.writable};function $R(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const OT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>_l(async()=>{const{default:n}=await Promise.resolve().then(()=>Ll);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},BR=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",DT=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},sd=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},id=async(e,t)=>{await e.removeItem(t)};class jh{constructor(){this.promise=new jh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}jh.promiseConstructor=Promise;function cm(e){const t=e.split(".");if(t.length!==3)throw new Hc("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!kR.test(t[n]))throw new Hc("JWT not in base64url format");return{header:JSON.parse(pw(t[0])),payload:JSON.parse(pw(t[1])),signature:RR(t[2]),raw:{header:t[0],payload:t[1]}}}async function UR(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function WR(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function VR(e){return("0"+e.toString(16)).substr(-2)}function HR(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,VR).join("")}async function zR(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function YR(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await zR(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Co(e,t,r=!1){const n=HR();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await DT(e,`${t}-code-verifier`,a);const s=await YR(n);return[s,n===s?"plain":"s256"]}const GR=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function KR(e){const t=e.headers.get(Wv);if(!t||!t.match(GR))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function qR(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function XR(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var JR=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Si=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),QR=[502,503,504];async function mw(e){var t;if(!BR(e))throw new Vv(Si(e),0);if(QR.includes(e.status))throw new Vv(Si(e),e.status);let r;try{r=await e.json()}catch(s){throw new NT(Si(s),s)}let n;const a=KR(e);if(a&&a.getTime()>=CT["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new fw(Si(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ts}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new fw(Si(r),e.status,r.weak_password.reasons);throw new CR(Si(r),e.status||500,n)}const ZR=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ie(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[Wv]||(s[Wv]=CT["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await e6(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function e6(e,t,r,n,a,s){const i=ZR(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new Vv(Si(l),0)}if(o.ok||await mw(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await mw(l)}}function Cs(e){var t;let r=null;a6(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=IR(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function vw(e){const t=Cs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ps(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function t6(e){return{data:e,error:null}}function r6(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=JR(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function n6(e){return e}function a6(e){return e.access_token&&e.refresh_token&&e.expires_in}var s6=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class i6{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=OT(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Ie(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ps})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=s6(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:r6,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ps})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},f=await Ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:n6});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(v=>{const p=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);c[`${_}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Pe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Ie(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ps})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Ie(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ps})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ps})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Ie(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}}const o6={getItem:e=>zc()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{zc()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{zc()&&globalThis.localStorage.removeItem(e)}};function gw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function l6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const No={debug:!!(globalThis&&zc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class jT extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class c6 extends jT{}async function u6(e,t,r){No.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),No.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){No.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{No.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw No.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new c6(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(No.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}l6();const f6={url:bR,storageKey:ER,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:SR,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function xw(e,t,r){return await r()}class Cu{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Cu.nextInstanceID,Cu.nextInstanceID+=1,this.instanceID>0&&pa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},f6),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new i6({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=OT(a.fetch),this.lock=a.lock||xw,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:pa()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=u6:this.lock=xw,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:zc()?this.storage=o6:(this.memoryStorage={},this.storage=gw(this.memoryStorage)):(this.memoryStorage={},this.storage=gw(this.memoryStorage)),pa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${TT}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=$R(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),pa()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),OR(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pe(r)?{error:r}:{error:new NT("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Cs}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:f,password:d,options:h}=t;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Co(this.storage,this.storageKey)),s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:v},xform:Cs})}else if("phone"in t){const{phone:f,password:d,options:h}=t;s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Cs})}else throw new nd("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:vw})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:vw})}else throw new nd("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new om}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await sd(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Cs});if(await id(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new om}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Pe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Cs}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new om}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await Co(this.storage,this.storageKey));const{error:d}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:f}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new nd("You must provide either an email or phone number.")}catch(o){if(Pe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Cs});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Pe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Co(this.storage,this.storageKey)),await Ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:t6})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ts;const{error:a}=await Ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Pe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new nd("You must provide either an email or phone number and a type")}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await sd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<im:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,f)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,f))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ps}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ts}:await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Ps})})}catch(r){if(Pe(r))return AR(r)&&(await this._removeSession(),await id(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Ts;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Co(this.storage,this.storageKey));const{data:c,error:f}=await Ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Ps});if(f)throw f;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ts;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=cm(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Pe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ts;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!pa())throw new ad("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ad(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new uw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ad("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new uw("No code detected.");const{data:x,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new ad("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;l&&(h=parseInt(l));const m=h-f;m*1e3<=jo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const v=h-d;f-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,f):f-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,f);const{data:p,error:_}=await this._getUser(s);if(_)throw _;const y={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(Pe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await sd(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(NR(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await id(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=LR(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Co(this.storage,this.storageKey,!0));try{return await Ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,f;const{data:d,error:h}=s;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ie(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return pa()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Pe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Ie(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await WR(async a=>(a>0&&await UR(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Cs})),(a,s)=>{const i=200*Math.pow(2,a);return s&&lm(s)&&Date.now()+i-n<jo})}catch(n){if(this._debug(r,"error",n),Pe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),pa()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await sd(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<im;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${im}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),lm(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ts;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new jh;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Ts;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Pe(s)){const i={session:null,error:s};return lm(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await DT(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await id(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&pa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),jo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/jo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${jo}ms, refresh threshold is ${Uv} ticks`),a<=Uv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof jT)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Co(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Ie(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Ie(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=cm(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(i=>i.kid===t);if(n||(n=this.jwks.keys.find(i=>i.kid===t),n&&this.jwks_cached_at+TR>Date.now()))return n;const{data:a,error:s}=await Ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!a.keys||a.keys.length===0)throw new Hc("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(i=>i.kid===t),!n)throw new Hc("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:m,error:v}=await this.getSession();if(v||!m.session)return{data:null,error:v};n=m.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=cm(n);if(qR(s.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:a,signature:i},error:null}}const c=XR(a.alg),f=await this.fetchJwk(a.kid,r),d=await crypto.subtle.importKey("jwk",f,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,i,MR(`${o}.${l}`)))throw new Hc("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}}Cu.nextInstanceID=0;const d6=Cu;class h6 extends d6{constructor(t){super(t)}}var p6=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class m6{constructor(t,r,n){var a,s,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=_R(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:dR,realtime:pR,auth:Object.assign(Object.assign({},hR),{storageKey:l}),global:fR},f=wR(n??{},c);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=xR(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new PF(`${o}/rest/v1`,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new cF(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new lR(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return p6(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:i,lock:o,debug:l},c,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new h6({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:i,lock:o,debug:l,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new KF(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const v6=(e,t,r)=>new m6(e,t,r),g6="https://wgewrecaqwhpynuktuxp.supabase.co",x6="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnZXdyZWNhcXdocHludWt0dXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg2MTI2NzMsImV4cCI6MjA1NDE4ODY3M30.xsi-rH3yossZT99w9JcLVE_FUpMs7lN6jKQUOadIV-Y",se=v6(g6,x6),Je=tF(e=>({user:null,role:null,setUser:t=>e({user:t}),setRole:t=>e({role:t}),logout:async()=>{await se.auth.signOut(),e({user:null,role:null})}}));/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var y6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Qe=(e,t)=>{const r=O.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},f)=>O.createElement("svg",{ref:f,...y6,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${_6(e)}`,o].join(" "),...c},[...t.map(([d,h])=>O.createElement(d,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=Qe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hv=Qe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=Qe("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=Qe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=Qe("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=Qe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=Qe("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=Qe("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=Qe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=Qe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PT=Qe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=Qe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=Qe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bl=Qe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=Qe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=Qe("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FT=Qe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=Qe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=Qe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=Qe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=Qe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=Qe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=Qe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=Qe("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=Qe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ux=Qe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=Qe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=Qe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=Qe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function k6(){const[e,t]=O.useState(""),[r,n]=O.useState(""),[a,s]=O.useState(!1),[i,o]=O.useState(""),l=Pn(),{setUser:c,setRole:f}=Je(),[d,h]=O.useState(!1);O.useEffect(()=>{(async()=>{const{data:{session:p}}=await se.auth.getSession();if(p){const{data:_,error:y}=await se.from("employees").select("*").eq("id",p.user.id).single();y||(c(p.user),f(_.role),l("/dashboard"))}else t(""),n("")})()},[l,c,f]);async function m(v){v.preventDefault(),s(!0),o("");try{const{data:p,error:_}=await se.auth.signInWithPassword({email:e,password:r});if(_)throw _;const{data:y,error:x}=await se.from("employees").select("*").eq("id",p.user.id).single();if(x)throw x;c(p.user),f(y.role),l("/dashboard")}catch(p){o(p.message)}finally{s(!1)}}return u.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx(Yc,{className:"w-12 h-12 text-blue-600"})}),u.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-8",children:"Login"}),i&&u.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:i}),u.jsxs("form",{onSubmit:m,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:e,onChange:v=>t(v.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:d?"text":"password",value:r,onChange:v=>n(v.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),u.jsx("button",{type:"button",className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",onClick:()=>h(!d),children:d?"Hide":"Show"})]})]}),u.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:a?"Logging in...":"Login"})]})]})})}function fs(e){"@babel/helpers - typeof";return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(e)}function T6(e,t){if(fs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MT(e){var t=T6(e,"string");return fs(t)=="symbol"?t:t+""}function Ci(e,t,r){return(t=MT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tw(Object(r),!0).forEach(function(n){Ci(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fh(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Aa(e,t){if(e==null)return{};var r,n,a=Fh(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Yt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MT(n.key),n)}}function Gt(e,t,r){return t&&Cw(e.prototype,t),r&&Cw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T0(e){return T0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T0(e)}function IT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IT=function(){return!!e})()}function C6(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N6(e,t){if(t&&(fs(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C6(e)}function Sr(e,t,r){return t=T0(t),N6(e,IT()?Reflect.construct(t,r||[],T0(e).constructor):t.apply(e,r))}function C0(e,t){return C0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},C0(e,t)}function kr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C0(e,t)}function LT(e){if(Array.isArray(e))return e}function A6(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,a=f}finally{try{if(!l&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}function Yv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Wx(e,t){if(e){if(typeof e=="string")return Yv(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yv(e,t):void 0}}function $T(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wn(e,t){return LT(e)||A6(e,t)||Wx(e,t)||$T()}function BT(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=BT(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Ct(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=BT(e))&&(n&&(n+=" "),n+=t);return n}function kt(){return kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kt.apply(null,arguments)}var O6=function(e,t,r,n,a,s,i,o){if(!e){var l;if(t===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,a,s,i,o],f=0;l=new Error(t.replace(/%s/g,function(){return c[f++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},D6=O6;const Nu=Er(D6);var j6=function(){};function P6(e,t){var r={};return Object.keys(e).forEach(function(n){r[$d(n)]=j6}),r}function Nw(e,t){return e[t]!==void 0}function $d(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function F6(e){return!!e&&(typeof e!="function"||e.prototype&&e.prototype.isReactComponent)}function R6(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,C0(e,t)}function UT(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function WT(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function VT(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}UT.__suppressDeprecationWarning=!0;WT.__suppressDeprecationWarning=!0;VT.__suppressDeprecationWarning=!0;function M6(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,a=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),r!==null||n!==null||a!==null){var s=e.displayName||e.name,i=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+i+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=UT,t.componentWillReceiveProps=WT),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=VT;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,f,d){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:d;o.call(this,c,f,h)}}return e}var I6="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function HT(e,t,r){r===void 0&&(r=[]);var n=e.displayName||e.name||"Component",a=F6(e),s=Object.keys(t),i=s.map($d);a||!r.length||Nu(!1);var o=function(c){R6(f,c);function f(){for(var h,m=arguments.length,v=new Array(m),p=0;p<m;p++)v[p]=arguments[p];h=c.call.apply(c,[this].concat(v))||this,h.handlers=Object.create(null),s.forEach(function(y){var x=t[y],g=function(b){if(h.props[x]){var k;h._notifying=!0;for(var E=arguments.length,S=new Array(E>1?E-1:0),T=1;T<E;T++)S[T-1]=arguments[T];(k=h.props)[x].apply(k,[b].concat(S)),h._notifying=!1}h.unmounted||h.setState(function(P){var M,L=P.values;return{values:kt(Object.create(null),L,(M={},M[y]=b,M))}})};h.handlers[x]=g}),r.length&&(h.attachRef=function(y){h.inner=y});var _=Object.create(null);return s.forEach(function(y){_[y]=h.props[$d(y)]}),h.state={values:_,prevProps:{}},h}var d=f.prototype;return d.shouldComponentUpdate=function(){return!this._notifying},f.getDerivedStateFromProps=function(m,v){var p=v.values,_=v.prevProps,y={values:kt(Object.create(null),p),prevProps:{}};return s.forEach(function(x){y.prevProps[x]=m[x],!Nw(m,x)&&Nw(_,x)&&(y.values[x]=m[$d(x)])}),y},d.componentWillUnmount=function(){this.unmounted=!0},d.render=function(){var m=this,v=this.props,p=v.innerRef,_=Fh(v,["innerRef"]);i.forEach(function(x){delete _[x]});var y={};return s.forEach(function(x){var g=m.props[x];y[x]=g!==void 0?g:m.state.values[x]}),J.createElement(e,kt({},_,y,this.handlers,{ref:p||this.attachRef}))},f}(J.Component);M6(o),o.displayName="Uncontrolled("+n+")",o.propTypes=kt({innerRef:function(){}},P6(t)),r.forEach(function(c){o.prototype[c]=function(){var d;return(d=this.inner)[c].apply(d,arguments)}});var l=o;return J.forwardRef&&(l=J.forwardRef(function(c,f){return J.createElement(o,kt({},c,{innerRef:f,__source:{fileName:I6,lineNumber:128},__self:this}))}),l.propTypes=o.propTypes),l.ControlledComponent=e,l.deferControlTo=function(c,f,d){return f===void 0&&(f={}),HT(c,kt({},t,f),d)},l}var zT={exports:{}},L6="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$6=L6,B6=$6;function YT(){}function GT(){}GT.resetWarningCache=YT;var U6=function(){function e(n,a,s,i,o,l){if(l!==B6){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:GT,resetWarningCache:YT};return r.PropTypes=r,r};zT.exports=U6();var W6=zT.exports;const ue=Er(W6);var N0="milliseconds",Au="seconds",Ou="minutes",Du="hours",qi="day",bl="week",ju="month",Xi="year",Ji="decade",Qi="century",KT={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},V6={month:1,year:12,decade:10*12,century:100*12};function H6(e){return[31,z6(e),31,30,31,30,31,31,30,31,30,31]}function z6(e){return e%4===0&&e%100!==0||e%400===0?29:28}function aa(e,t,r){switch(e=new Date(e),r){case N0:case Au:case Ou:case Du:case qi:case bl:return Y6(e,t*KT[r]);case ju:case Xi:case Ji:case Qi:return G6(e,t*V6[r])}throw new TypeError('Invalid units: "'+r+'"')}function Y6(e,t){var r=new Date(+e+t);return K6(e,r)}function G6(e,t){var r=e.getFullYear(),n=e.getMonth(),a=e.getDate(),s=r*12+n+t,i=Math.trunc(s/12),o=s%12,l=Math.min(a,H6(i)[o]),c=new Date(e);return c.setFullYear(i),c.setDate(1),c.setMonth(o),c.setDate(l),c}function K6(e,t){var r=e.getTimezoneOffset(),n=t.getTimezoneOffset(),a=n-r;return new Date(+t+a*KT.minutes)}function Pu(e,t,r){return aa(e,-t,r)}function lr(e,t,r){switch(e=new Date(e),t){case Qi:case Ji:case Xi:e=O0(e,0);case ju:e=ZT(e,1);case bl:case qi:e=Mu(e,0);case Du:e=El(e,0);case Ou:e=Ru(e,0);case Au:e=Fu(e,0)}return t===Ji&&(e=Pu(e,Zi(e)%10,"year")),t===Qi&&(e=Pu(e,Zi(e)%100,"year")),t===bl&&(e=eC(e,0,r)),e}function A0(e,t,r){switch(e=new Date(e),e=lr(e,t,r),t){case Qi:case Ji:case Xi:case ju:case bl:e=aa(e,1,t),e=Pu(e,1,qi),e.setHours(23,59,59,999);break;case qi:e.setHours(23,59,59,999);break;case Du:case Ou:case Au:e=aa(e,1,t),e=Pu(e,1,N0)}return e}var df=Wl(function(e,t){return e===t}),Vx=Wl(function(e,t){return e!==t}),Rh=Wl(function(e,t){return e>t}),hf=Wl(function(e,t){return e>=t}),Hx=Wl(function(e,t){return e<t}),Ul=Wl(function(e,t){return e<=t});function qT(){return new Date(Math.min.apply(Math,arguments))}function XT(){return new Date(Math.max.apply(Math,arguments))}function JT(e,t,r,n){return n=n||"day",(!t||hf(e,t,n))&&(!r||Ul(e,r,n))}var Fu=hi("Milliseconds"),Ru=hi("Seconds"),El=hi("Minutes"),Mu=hi("Hours"),QT=hi("Day"),ZT=hi("Date"),O0=hi("Month"),Zi=hi("FullYear");function q6(e,t){return t===void 0?Zi(lr(e,Ji)):aa(e,t+10,Xi)}function X6(e,t){return t===void 0?Zi(lr(e,Qi)):aa(e,t+100,Xi)}function eC(e,t,r){var n=(QT(e)+7-(r||0))%7;return t===void 0?n:aa(e,t-n,qi)}function J6(e,t,r,n){var a,s,i;switch(r){case N0:case Au:case Ou:case Du:case qi:case bl:a=t.getTime()-e.getTime();break;case ju:case Xi:case Ji:case Qi:a=(Zi(t)-Zi(e))*12+O0(t)-O0(e);break;default:throw new TypeError('Invalid units: "'+r+'"')}switch(r){case N0:s=1;break;case Au:s=1e3;break;case Ou:s=1e3*60;break;case Du:s=1e3*60*60;break;case qi:s=1e3*60*60*24;break;case bl:s=1e3*60*60*24*7;break;case ju:s=1;break;case Xi:s=12;break;case Ji:s=120;break;case Qi:s=1200;break;default:throw new TypeError('Invalid units: "'+r+'"')}return i=a/s,n?i:Math.round(i)}function hi(e){var t=function(r){switch(r){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(e);return function(r,n){if(n===void 0)return r["get"+e]();var a=new Date(r);return a["set"+e](n),t&&a["get"+e]()!=n&&(e==="Hours"||n>=t&&a.getHours()-r.getHours()<Math.floor(n/t))&&a["set"+e](n+t),a}}function Wl(e){return function(t,r,n){return e(+lr(t,n),+lr(r,n))}}const Aw=Object.freeze(Object.defineProperty({__proto__:null,add:aa,century:X6,date:ZT,day:QT,decade:q6,diff:J6,endOf:A0,eq:df,gt:Rh,gte:hf,hours:Mu,inRange:JT,lt:Hx,lte:Ul,max:XT,milliseconds:Fu,min:qT,minutes:El,month:O0,neq:Vx,seconds:Ru,startOf:lr,subtract:Pu,weekday:eC,year:Zi},Symbol.toStringTag,{value:"Module"}));function Q6(e){if(Array.isArray(e))return Yv(e)}function tC(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Z6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bd(e){return Q6(e)||tC(e)||Wx(e)||Z6()}function eM(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(a);++n<a;)s[n]=e[n+t];return s}var rC=eM;function tM(e,t){return e===t||e!==e&&t!==t}var pf=tM,rM=typeof wt=="object"&&wt&&wt.Object===Object&&wt,nC=rM,nM=nC,aM=typeof self=="object"&&self&&self.Object===Object&&self,sM=nM||aM||Function("return this")(),Pa=sM,iM=Pa,oM=iM.Symbol,Vl=oM,Ow=Vl,aC=Object.prototype,lM=aC.hasOwnProperty,cM=aC.toString,xc=Ow?Ow.toStringTag:void 0;function uM(e){var t=lM.call(e,xc),r=e[xc];try{e[xc]=void 0;var n=!0}catch{}var a=cM.call(e);return n&&(t?e[xc]=r:delete e[xc]),a}var fM=uM,dM=Object.prototype,hM=dM.toString;function pM(e){return hM.call(e)}var mM=pM,Dw=Vl,vM=fM,gM=mM,xM="[object Null]",yM="[object Undefined]",jw=Dw?Dw.toStringTag:void 0;function _M(e){return e==null?e===void 0?yM:xM:jw&&jw in Object(e)?vM(e):gM(e)}var Hl=_M;function wM(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var gs=wM,bM=Hl,EM=gs,SM="[object AsyncFunction]",kM="[object Function]",TM="[object GeneratorFunction]",CM="[object Proxy]";function NM(e){if(!EM(e))return!1;var t=bM(e);return t==kM||t==TM||t==SM||t==CM}var zx=NM,AM=9007199254740991;function OM(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=AM}var Yx=OM,DM=zx,jM=Yx;function PM(e){return e!=null&&jM(e.length)&&!DM(e)}var mf=PM,FM=9007199254740991,RM=/^(?:0|[1-9]\d*)$/;function MM(e,t){var r=typeof e;return t=t??FM,!!t&&(r=="number"||r!="symbol"&&RM.test(e))&&e>-1&&e%1==0&&e<t}var Gx=MM,IM=pf,LM=mf,$M=Gx,BM=gs;function UM(e,t,r){if(!BM(r))return!1;var n=typeof t;return(n=="number"?LM(r)&&$M(t,r.length):n=="string"&&t in r)?IM(r[t],e):!1}var Mh=UM,WM=/\s/;function VM(e){for(var t=e.length;t--&&WM.test(e.charAt(t)););return t}var HM=VM,zM=HM,YM=/^\s+/;function GM(e){return e&&e.slice(0,zM(e)+1).replace(YM,"")}var KM=GM;function qM(e){return e!=null&&typeof e=="object"}var pi=qM,XM=Hl,JM=pi,QM="[object Symbol]";function ZM(e){return typeof e=="symbol"||JM(e)&&XM(e)==QM}var vf=ZM,eI=KM,Pw=gs,tI=vf,Fw=NaN,rI=/^[-+]0x[0-9a-f]+$/i,nI=/^0b[01]+$/i,aI=/^0o[0-7]+$/i,sI=parseInt;function iI(e){if(typeof e=="number")return e;if(tI(e))return Fw;if(Pw(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Pw(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=eI(e);var r=nI.test(e);return r||aI.test(e)?sI(e.slice(2),r?2:8):rI.test(e)?Fw:+e}var oI=iI,lI=oI,Rw=1/0,cI=17976931348623157e292;function uI(e){if(!e)return e===0?e:0;if(e=lI(e),e===Rw||e===-Rw){var t=e<0?-1:1;return t*cI}return e===e?e:0}var sC=uI,fI=sC;function dI(e){var t=fI(e),r=t%1;return t===t?r?t-r:t:0}var iC=dI,hI=rC,pI=Mh,mI=iC,vI=Math.ceil,gI=Math.max;function xI(e,t,r){(r?pI(e,t,r):t===void 0)?t=1:t=gI(mI(t),0);var n=e==null?0:e.length;if(!n||t<1)return[];for(var a=0,s=0,i=Array(vI(n/t));a<n;)i[s++]=hI(e,a,a+=t);return i}var yI=xI;const _I=Er(yI);function gf(e){return e&&e.ownerDocument||document}function wI(e){var t=gf(e);return t&&t.defaultView||window}function bI(e,t){return wI(e).getComputedStyle(e,t)}var EI=/([A-Z])/g;function SI(e){return e.replace(EI,"-$1").toLowerCase()}var kI=/^ms-/;function ld(e){return SI(e).replace(kI,"-ms-")}var TI=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function CI(e){return!!(e&&TI.test(e))}function Po(e,t){var r="",n="";if(typeof t=="string")return e.style.getPropertyValue(ld(t))||bI(e).getPropertyValue(ld(t));Object.keys(t).forEach(function(a){var s=t[a];!s&&s!==0?e.style.removeProperty(ld(a)):CI(a)?n+=a+"("+s+") ":r+=ld(a)+": "+s+";"}),n&&(r+="transform: "+n+";"),e.style.cssText+=";"+r}function Iu(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function NI(e){return"nodeType"in e&&e.nodeType===document.DOCUMENT_NODE}function Kx(e){return"window"in e&&e.window===e?e:NI(e)&&e.defaultView||!1}function oC(e){var t=e==="pageXOffset"?"scrollLeft":"scrollTop";function r(n,a){var s=Kx(n);if(a===void 0)return s?s[e]:n[t];s?s.scrollTo(s[e],a):n[t]=a}return r}const lC=oC("pageXOffset"),cC=oC("pageYOffset");function Mi(e){var t=gf(e),r={top:0,left:0,height:0,width:0},n=t&&t.documentElement;return!n||!Iu(n,e)||(e.getBoundingClientRect!==void 0&&(r=e.getBoundingClientRect()),r={top:r.top+cC(n)-(n.clientTop||0),left:r.left+lC(n)-(n.clientLeft||0),width:r.width,height:r.height}),r}var AI=function(t){return!!t&&"offsetParent"in t};function OI(e){for(var t=gf(e),r=e&&e.offsetParent;AI(r)&&r.nodeName!=="HTML"&&Po(r,"position")==="static";)r=r.offsetParent;return r||t.documentElement}var DI=function(t){return t.nodeName&&t.nodeName.toLowerCase()};function uC(e,t){var r={top:0,left:0},n;if(Po(e,"position")==="fixed")n=e.getBoundingClientRect();else{var a=t||OI(e);n=Mi(e),DI(a)!=="html"&&(r=Mi(a));var s=String(Po(a,"borderTopWidth")||0);r.top+=parseInt(s,10)-cC(a)||0;var i=String(Po(a,"borderLeftWidth")||0);r.left+=parseInt(i,10)-lC(a)||0}var o=String(Po(e,"marginTop")||0),l=String(Po(e,"marginLeft")||0);return kt({},n,{top:n.top-r.top-(parseInt(o,10)||0),left:n.left-r.left-(parseInt(l,10)||0)})}const qx=!!(typeof window<"u"&&window.document&&window.document.createElement);var Mw=new Date().getTime();function jI(e){var t=new Date().getTime(),r=Math.max(0,16-(t-Mw)),n=setTimeout(e,r);return Mw=t,n}var PI=["","webkit","moz","o","ms"],Gv="clearTimeout",Kv=jI,Iw=function(t,r){return t+(t?r[0].toUpperCase()+r.substr(1):r)+"AnimationFrame"};qx&&PI.some(function(e){var t=Iw(e,"request");return t in window&&(Gv=Iw(e,"cancel"),Kv=function(n){return window[t](n)}),!!Kv});var Lw=function(t){typeof window[Gv]=="function"&&window[Gv](t)},fC=Kv,um;function FI(e,t){if(!um){var r=document.body,n=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;um=function(s,i){return n.call(s,i)}}return um(e,t)}var RI=Function.prototype.bind.call(Function.prototype.call,[].slice);function MI(e,t){return RI(e.querySelectorAll(t))}var qv=!1,Xv=!1;try{var fm={get passive(){return qv=!0},get once(){return Xv=qv=!0}};qx&&(window.addEventListener("test",fm,fm),window.removeEventListener("test",fm,!0))}catch{}function II(e,t,r,n){if(n&&typeof n!="boolean"&&!Xv){var a=n.once,s=n.capture,i=r;!Xv&&a&&(i=r.__once||function o(l){this.removeEventListener(t,o,s),r.call(this,l)},r.__once=i),e.addEventListener(t,i,qv?n:s)}e.addEventListener(t,r,n)}function LI(e){const t=O.useRef(e);return O.useEffect(()=>{t.current=e},[e]),t}function $w(e){const t=LI(e);return O.useCallback(function(...r){return t.current&&t.current(...r)},[t])}function Bw(){return O.useState(null)}function $I(){const e=O.useRef(!0),t=O.useRef(()=>e.current);return O.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function BI(e){const t=$I();return[e[0],O.useCallback(r=>{if(t())return e[1](r)},[t,e[1]])]}var Gr="top",On="bottom",Dn="right",Kr="left",Xx="auto",xf=[Gr,On,Dn,Kr],Sl="start",Lu="end",UI="clippingParents",dC="viewport",yc="popper",WI="reference",Uw=xf.reduce(function(e,t){return e.concat([t+"-"+Sl,t+"-"+Lu])},[]),Jx=[].concat(xf,[Xx]).reduce(function(e,t){return e.concat([t,t+"-"+Sl,t+"-"+Lu])},[]),VI="beforeRead",HI="read",zI="afterRead",YI="beforeMain",GI="main",KI="afterMain",qI="beforeWrite",XI="write",JI="afterWrite",QI=[VI,HI,zI,YI,GI,KI,qI,XI,JI];function Sa(e){return e.split("-")[0]}function on(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function eo(e){var t=on(e).Element;return e instanceof t||e instanceof Element}function ka(e){var t=on(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function Qx(e){if(typeof ShadowRoot>"u")return!1;var t=on(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var Ii=Math.max,D0=Math.min,kl=Math.round;function Jv(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function hC(){return!/^((?!chrome|android).)*safari/i.test(Jv())}function Tl(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,s=1;t&&ka(e)&&(a=e.offsetWidth>0&&kl(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&kl(n.height)/e.offsetHeight||1);var i=eo(e)?on(e):window,o=i.visualViewport,l=!hC()&&r,c=(n.left+(l&&o?o.offsetLeft:0))/a,f=(n.top+(l&&o?o.offsetTop:0))/s,d=n.width/a,h=n.height/s;return{width:d,height:h,top:f,right:c+d,bottom:f+h,left:c,x:c,y:f}}function Zx(e){var t=Tl(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function pC(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Qx(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ni(e){return e?(e.nodeName||"").toLowerCase():null}function ds(e){return on(e).getComputedStyle(e)}function ZI(e){return["table","td","th"].indexOf(ni(e))>=0}function mi(e){return((eo(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ih(e){return ni(e)==="html"?e:e.assignedSlot||e.parentNode||(Qx(e)?e.host:null)||mi(e)}function Ww(e){return!ka(e)||ds(e).position==="fixed"?null:e.offsetParent}function e8(e){var t=/firefox/i.test(Jv()),r=/Trident/i.test(Jv());if(r&&ka(e)){var n=ds(e);if(n.position==="fixed")return null}var a=Ih(e);for(Qx(a)&&(a=a.host);ka(a)&&["html","body"].indexOf(ni(a))<0;){var s=ds(a);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return a;a=a.parentNode}return null}function yf(e){for(var t=on(e),r=Ww(e);r&&ZI(r)&&ds(r).position==="static";)r=Ww(r);return r&&(ni(r)==="html"||ni(r)==="body"&&ds(r).position==="static")?t:r||e8(e)||t}function e1(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Kc(e,t,r){return Ii(e,D0(t,r))}function t8(e,t,r){var n=Kc(e,t,r);return n>r?r:n}function mC(){return{top:0,right:0,bottom:0,left:0}}function vC(e){return Object.assign({},mC(),e)}function gC(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var r8=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,vC(typeof t!="number"?t:gC(t,xf))};function n8(e){var t,r=e.state,n=e.name,a=e.options,s=r.elements.arrow,i=r.modifiersData.popperOffsets,o=Sa(r.placement),l=e1(o),c=[Kr,Dn].indexOf(o)>=0,f=c?"height":"width";if(!(!s||!i)){var d=r8(a.padding,r),h=Zx(s),m=l==="y"?Gr:Kr,v=l==="y"?On:Dn,p=r.rects.reference[f]+r.rects.reference[l]-i[l]-r.rects.popper[f],_=i[l]-r.rects.reference[l],y=yf(s),x=y?l==="y"?y.clientHeight||0:y.clientWidth||0:0,g=p/2-_/2,w=d[m],b=x-h[f]-d[v],k=x/2-h[f]/2+g,E=Kc(w,k,b),S=l;r.modifiersData[n]=(t={},t[S]=E,t.centerOffset=E-k,t)}}function a8(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||pC(t.elements.popper,a)&&(t.elements.arrow=a))}const s8={name:"arrow",enabled:!0,phase:"main",fn:n8,effect:a8,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Cl(e){return e.split("-")[1]}var i8={top:"auto",right:"auto",bottom:"auto",left:"auto"};function o8(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:kl(r*a)/a||0,y:kl(n*a)/a||0}}function Vw(e){var t,r=e.popper,n=e.popperRect,a=e.placement,s=e.variation,i=e.offsets,o=e.position,l=e.gpuAcceleration,c=e.adaptive,f=e.roundOffsets,d=e.isFixed,h=i.x,m=h===void 0?0:h,v=i.y,p=v===void 0?0:v,_=typeof f=="function"?f({x:m,y:p}):{x:m,y:p};m=_.x,p=_.y;var y=i.hasOwnProperty("x"),x=i.hasOwnProperty("y"),g=Kr,w=Gr,b=window;if(c){var k=yf(r),E="clientHeight",S="clientWidth";if(k===on(r)&&(k=mi(r),ds(k).position!=="static"&&o==="absolute"&&(E="scrollHeight",S="scrollWidth")),k=k,a===Gr||(a===Kr||a===Dn)&&s===Lu){w=On;var T=d&&k===b&&b.visualViewport?b.visualViewport.height:k[E];p-=T-n.height,p*=l?1:-1}if(a===Kr||(a===Gr||a===On)&&s===Lu){g=Dn;var P=d&&k===b&&b.visualViewport?b.visualViewport.width:k[S];m-=P-n.width,m*=l?1:-1}}var M=Object.assign({position:o},c&&i8),L=f===!0?o8({x:m,y:p},on(r)):{x:m,y:p};if(m=L.x,p=L.y,l){var D;return Object.assign({},M,(D={},D[w]=x?"0":"",D[g]=y?"0":"",D.transform=(b.devicePixelRatio||1)<=1?"translate("+m+"px, "+p+"px)":"translate3d("+m+"px, "+p+"px, 0)",D))}return Object.assign({},M,(t={},t[w]=x?p+"px":"",t[g]=y?m+"px":"",t.transform="",t))}function l8(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,s=r.adaptive,i=s===void 0?!0:s,o=r.roundOffsets,l=o===void 0?!0:o,c={placement:Sa(t.placement),variation:Cl(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Vw(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Vw(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const c8={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:l8,data:{}};var cd={passive:!0};function u8(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,s=a===void 0?!0:a,i=n.resize,o=i===void 0?!0:i,l=on(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(f){f.addEventListener("scroll",r.update,cd)}),o&&l.addEventListener("resize",r.update,cd),function(){s&&c.forEach(function(f){f.removeEventListener("scroll",r.update,cd)}),o&&l.removeEventListener("resize",r.update,cd)}}const f8={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:u8,data:{}};var d8={left:"right",right:"left",bottom:"top",top:"bottom"};function Ud(e){return e.replace(/left|right|bottom|top/g,function(t){return d8[t]})}var h8={start:"end",end:"start"};function Hw(e){return e.replace(/start|end/g,function(t){return h8[t]})}function t1(e){var t=on(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function r1(e){return Tl(mi(e)).left+t1(e).scrollLeft}function p8(e,t){var r=on(e),n=mi(e),a=r.visualViewport,s=n.clientWidth,i=n.clientHeight,o=0,l=0;if(a){s=a.width,i=a.height;var c=hC();(c||!c&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:s,height:i,x:o+r1(e),y:l}}function m8(e){var t,r=mi(e),n=t1(e),a=(t=e.ownerDocument)==null?void 0:t.body,s=Ii(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),i=Ii(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),o=-n.scrollLeft+r1(e),l=-n.scrollTop;return ds(a||r).direction==="rtl"&&(o+=Ii(r.clientWidth,a?a.clientWidth:0)-s),{width:s,height:i,x:o,y:l}}function n1(e){var t=ds(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function xC(e){return["html","body","#document"].indexOf(ni(e))>=0?e.ownerDocument.body:ka(e)&&n1(e)?e:xC(Ih(e))}function qc(e,t){var r;t===void 0&&(t=[]);var n=xC(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),s=on(n),i=a?[s].concat(s.visualViewport||[],n1(n)?n:[]):n,o=t.concat(i);return a?o:o.concat(qc(Ih(i)))}function Qv(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function v8(e,t){var r=Tl(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function zw(e,t,r){return t===dC?Qv(p8(e,r)):eo(t)?v8(t,r):Qv(m8(mi(e)))}function g8(e){var t=qc(Ih(e)),r=["absolute","fixed"].indexOf(ds(e).position)>=0,n=r&&ka(e)?yf(e):e;return eo(n)?t.filter(function(a){return eo(a)&&pC(a,n)&&ni(a)!=="body"}):[]}function x8(e,t,r,n){var a=t==="clippingParents"?g8(e):[].concat(t),s=[].concat(a,[r]),i=s[0],o=s.reduce(function(l,c){var f=zw(e,c,n);return l.top=Ii(f.top,l.top),l.right=D0(f.right,l.right),l.bottom=D0(f.bottom,l.bottom),l.left=Ii(f.left,l.left),l},zw(e,i,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function yC(e){var t=e.reference,r=e.element,n=e.placement,a=n?Sa(n):null,s=n?Cl(n):null,i=t.x+t.width/2-r.width/2,o=t.y+t.height/2-r.height/2,l;switch(a){case Gr:l={x:i,y:t.y-r.height};break;case On:l={x:i,y:t.y+t.height};break;case Dn:l={x:t.x+t.width,y:o};break;case Kr:l={x:t.x-r.width,y:o};break;default:l={x:t.x,y:t.y}}var c=a?e1(a):null;if(c!=null){var f=c==="y"?"height":"width";switch(s){case Sl:l[c]=l[c]-(t[f]/2-r[f]/2);break;case Lu:l[c]=l[c]+(t[f]/2-r[f]/2);break}}return l}function $u(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,s=r.strategy,i=s===void 0?e.strategy:s,o=r.boundary,l=o===void 0?UI:o,c=r.rootBoundary,f=c===void 0?dC:c,d=r.elementContext,h=d===void 0?yc:d,m=r.altBoundary,v=m===void 0?!1:m,p=r.padding,_=p===void 0?0:p,y=vC(typeof _!="number"?_:gC(_,xf)),x=h===yc?WI:yc,g=e.rects.popper,w=e.elements[v?x:h],b=x8(eo(w)?w:w.contextElement||mi(e.elements.popper),l,f,i),k=Tl(e.elements.reference),E=yC({reference:k,element:g,strategy:"absolute",placement:a}),S=Qv(Object.assign({},g,E)),T=h===yc?S:k,P={top:b.top-T.top+y.top,bottom:T.bottom-b.bottom+y.bottom,left:b.left-T.left+y.left,right:T.right-b.right+y.right},M=e.modifiersData.offset;if(h===yc&&M){var L=M[a];Object.keys(P).forEach(function(D){var Q=[Dn,On].indexOf(D)>=0?1:-1,ee=[Gr,On].indexOf(D)>=0?"y":"x";P[D]+=L[ee]*Q})}return P}function y8(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,s=r.rootBoundary,i=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,c=l===void 0?Jx:l,f=Cl(n),d=f?o?Uw:Uw.filter(function(v){return Cl(v)===f}):xf,h=d.filter(function(v){return c.indexOf(v)>=0});h.length===0&&(h=d);var m=h.reduce(function(v,p){return v[p]=$u(e,{placement:p,boundary:a,rootBoundary:s,padding:i})[Sa(p)],v},{});return Object.keys(m).sort(function(v,p){return m[v]-m[p]})}function _8(e){if(Sa(e)===Xx)return[];var t=Ud(e);return[Hw(e),t,Hw(t)]}function w8(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,o=i===void 0?!0:i,l=r.fallbackPlacements,c=r.padding,f=r.boundary,d=r.rootBoundary,h=r.altBoundary,m=r.flipVariations,v=m===void 0?!0:m,p=r.allowedAutoPlacements,_=t.options.placement,y=Sa(_),x=y===_,g=l||(x||!v?[Ud(_)]:_8(_)),w=[_].concat(g).reduce(function(N,j){return N.concat(Sa(j)===Xx?y8(t,{placement:j,boundary:f,rootBoundary:d,padding:c,flipVariations:v,allowedAutoPlacements:p}):j)},[]),b=t.rects.reference,k=t.rects.popper,E=new Map,S=!0,T=w[0],P=0;P<w.length;P++){var M=w[P],L=Sa(M),D=Cl(M)===Sl,Q=[Gr,On].indexOf(L)>=0,ee=Q?"width":"height",Y=$u(t,{placement:M,boundary:f,rootBoundary:d,altBoundary:h,padding:c}),q=Q?D?Dn:Kr:D?On:Gr;b[ee]>k[ee]&&(q=Ud(q));var G=Ud(q),V=[];if(s&&V.push(Y[L]<=0),o&&V.push(Y[q]<=0,Y[G]<=0),V.every(function(N){return N})){T=M,S=!1;break}E.set(M,V)}if(S)for(var ae=v?3:1,B=function(j){var K=w.find(function(ie){var X=E.get(ie);if(X)return X.slice(0,j).every(function(le){return le})});if(K)return T=K,"break"},C=ae;C>0;C--){var I=B(C);if(I==="break")break}t.placement!==T&&(t.modifiersData[n]._skip=!0,t.placement=T,t.reset=!0)}}const b8={name:"flip",enabled:!0,phase:"main",fn:w8,requiresIfExists:["offset"],data:{_skip:!1}};function Yw(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Gw(e){return[Gr,Dn,On,Kr].some(function(t){return e[t]>=0})}function E8(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,s=t.modifiersData.preventOverflow,i=$u(t,{elementContext:"reference"}),o=$u(t,{altBoundary:!0}),l=Yw(i,n),c=Yw(o,a,s),f=Gw(l),d=Gw(c);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:f,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":d})}const S8={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:E8};function k8(e,t,r){var n=Sa(e),a=[Kr,Gr].indexOf(n)>=0?-1:1,s=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,i=s[0],o=s[1];return i=i||0,o=(o||0)*a,[Kr,Dn].indexOf(n)>=0?{x:o,y:i}:{x:i,y:o}}function T8(e){var t=e.state,r=e.options,n=e.name,a=r.offset,s=a===void 0?[0,0]:a,i=Jx.reduce(function(f,d){return f[d]=k8(d,t.rects,s),f},{}),o=i[t.placement],l=o.x,c=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=i}const C8={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:T8};function N8(e){var t=e.state,r=e.name;t.modifiersData[r]=yC({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const A8={name:"popperOffsets",enabled:!0,phase:"read",fn:N8,data:{}};function O8(e){return e==="x"?"y":"x"}function D8(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,o=i===void 0?!1:i,l=r.boundary,c=r.rootBoundary,f=r.altBoundary,d=r.padding,h=r.tether,m=h===void 0?!0:h,v=r.tetherOffset,p=v===void 0?0:v,_=$u(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:f}),y=Sa(t.placement),x=Cl(t.placement),g=!x,w=e1(y),b=O8(w),k=t.modifiersData.popperOffsets,E=t.rects.reference,S=t.rects.popper,T=typeof p=="function"?p(Object.assign({},t.rects,{placement:t.placement})):p,P=typeof T=="number"?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),M=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,L={x:0,y:0};if(k){if(s){var D,Q=w==="y"?Gr:Kr,ee=w==="y"?On:Dn,Y=w==="y"?"height":"width",q=k[w],G=q+_[Q],V=q-_[ee],ae=m?-S[Y]/2:0,B=x===Sl?E[Y]:S[Y],C=x===Sl?-S[Y]:-E[Y],I=t.elements.arrow,N=m&&I?Zx(I):{width:0,height:0},j=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:mC(),K=j[Q],ie=j[ee],X=Kc(0,E[Y],N[Y]),le=g?E[Y]/2-ae-X-K-P.mainAxis:B-X-K-P.mainAxis,oe=g?-E[Y]/2+ae+X+ie+P.mainAxis:C+X+ie+P.mainAxis,Ee=t.elements.arrow&&yf(t.elements.arrow),z=Ee?w==="y"?Ee.clientTop||0:Ee.clientLeft||0:0,je=(D=M==null?void 0:M[w])!=null?D:0,ke=q+le-je-z,qe=q+oe-je,Ae=Kc(m?D0(G,ke):G,q,m?Ii(V,qe):V);k[w]=Ae,L[w]=Ae-q}if(o){var me,tt=w==="x"?Gr:Kr,cr=w==="x"?On:Dn,gt=k[b],Ir=b==="y"?"height":"width",ws=gt+_[tt],Ln=gt-_[cr],er=[Gr,Kr].indexOf(y)!==-1,hn=(me=M==null?void 0:M[b])!=null?me:0,$n=er?ws:gt-E[Ir]-S[Ir]-hn+P.altAxis,bs=er?gt+E[Ir]+S[Ir]-hn-P.altAxis:Ln,Kt=m&&er?t8($n,gt,bs):Kc(m?$n:ws,gt,m?bs:Ln);k[b]=Kt,L[b]=Kt-gt}t.modifiersData[n]=L}}const j8={name:"preventOverflow",enabled:!0,phase:"main",fn:D8,requiresIfExists:["offset"]};function P8(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function F8(e){return e===on(e)||!ka(e)?t1(e):P8(e)}function R8(e){var t=e.getBoundingClientRect(),r=kl(t.width)/e.offsetWidth||1,n=kl(t.height)/e.offsetHeight||1;return r!==1||n!==1}function M8(e,t,r){r===void 0&&(r=!1);var n=ka(t),a=ka(t)&&R8(t),s=mi(t),i=Tl(e,a,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((ni(t)!=="body"||n1(s))&&(o=F8(t)),ka(t)?(l=Tl(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=r1(s))),{x:i.left+o.scrollLeft-l.x,y:i.top+o.scrollTop-l.y,width:i.width,height:i.height}}function I8(e){var t=new Map,r=new Set,n=[];e.forEach(function(s){t.set(s.name,s)});function a(s){r.add(s.name);var i=[].concat(s.requires||[],s.requiresIfExists||[]);i.forEach(function(o){if(!r.has(o)){var l=t.get(o);l&&a(l)}}),n.push(s)}return e.forEach(function(s){r.has(s.name)||a(s)}),n}function L8(e){var t=I8(e);return QI.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function $8(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function B8(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var Kw={placement:"bottom",modifiers:[],strategy:"absolute"};function qw(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function U8(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,s=a===void 0?Kw:a;return function(o,l,c){c===void 0&&(c=s);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},Kw,s),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},d=[],h=!1,m={state:f,setOptions:function(y){var x=typeof y=="function"?y(f.options):y;p(),f.options=Object.assign({},s,f.options,x),f.scrollParents={reference:eo(o)?qc(o):o.contextElement?qc(o.contextElement):[],popper:qc(l)};var g=L8(B8([].concat(n,f.options.modifiers)));return f.orderedModifiers=g.filter(function(w){return w.enabled}),v(),m.update()},forceUpdate:function(){if(!h){var y=f.elements,x=y.reference,g=y.popper;if(qw(x,g)){f.rects={reference:M8(x,yf(g),f.options.strategy==="fixed"),popper:Zx(g)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(P){return f.modifiersData[P.name]=Object.assign({},P.data)});for(var w=0;w<f.orderedModifiers.length;w++){if(f.reset===!0){f.reset=!1,w=-1;continue}var b=f.orderedModifiers[w],k=b.fn,E=b.options,S=E===void 0?{}:E,T=b.name;typeof k=="function"&&(f=k({state:f,options:S,name:T,instance:m})||f)}}}},update:$8(function(){return new Promise(function(_){m.forceUpdate(),_(f)})}),destroy:function(){p(),h=!0}};if(!qw(o,l))return m;m.setOptions(c).then(function(_){!h&&c.onFirstUpdate&&c.onFirstUpdate(_)});function v(){f.orderedModifiers.forEach(function(_){var y=_.name,x=_.options,g=x===void 0?{}:x,w=_.effect;if(typeof w=="function"){var b=w({state:f,name:y,instance:m,options:g}),k=function(){};d.push(b||k)}})}function p(){d.forEach(function(_){return _()}),d=[]}return m}}var W8=U8({defaultModifiers:[S8,A8,c8,f8,C8,b8,j8,s8]}),Xw=function(t){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},V8={name:"applyStyles",enabled:!1},H8={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(t){var r=t.state;return function(){var n=r.elements,a=n.reference,s=n.popper;if("removeAttribute"in a){var i=(a.getAttribute("aria-describedby")||"").split(",").filter(function(o){return o.trim()!==s.id});i.length?a.setAttribute("aria-describedby",i.join(",")):a.removeAttribute("aria-describedby")}}},fn:function(t){var r,n=t.state,a=n.elements,s=a.popper,i=a.reference,o=(r=s.getAttribute("role"))==null?void 0:r.toLowerCase();if(s.id&&o==="tooltip"&&"setAttribute"in i){var l=i.getAttribute("aria-describedby");if(l&&l.split(",").indexOf(s.id)!==-1)return;i.setAttribute("aria-describedby",l?l+","+s.id:s.id)}}},z8=[];function Y8(e,t,r){var n=r===void 0?{}:r,a=n.enabled,s=a===void 0?!0:a,i=n.placement,o=i===void 0?"bottom":i,l=n.strategy,c=l===void 0?"absolute":l,f=n.modifiers,d=f===void 0?z8:f,h=Fh(n,["enabled","placement","strategy","modifiers"]),m=O.useRef(),v=O.useCallback(function(){var w;(w=m.current)==null||w.update()},[]),p=O.useCallback(function(){var w;(w=m.current)==null||w.forceUpdate()},[]),_=BI(O.useState({placement:o,update:v,forceUpdate:p,attributes:{},styles:{popper:Xw(c),arrow:{}}})),y=_[0],x=_[1],g=O.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(b){var k=b.state,E={},S={};Object.keys(k.elements).forEach(function(T){E[T]=k.styles[T],S[T]=k.attributes[T]}),x({state:k,styles:E,attributes:S,update:v,forceUpdate:p,placement:k.placement})}}},[v,p,x]);return O.useEffect(function(){!m.current||!s||m.current.setOptions({placement:o,strategy:c,modifiers:[].concat(d,[g,V8])})},[c,o,g,s]),O.useEffect(function(){if(!(!s||e==null||t==null))return m.current=W8(e,t,kt({},h,{placement:o,strategy:c,modifiers:[].concat(d,[H8,g])})),function(){m.current!=null&&(m.current.destroy(),m.current=void 0,x(function(w){return kt({},w,{attributes:{},styles:{popper:Xw(c)}})}))}},[s,e,t]),y}function G8(e,t,r,n){var a=n&&typeof n!="boolean"?n.capture:n;e.removeEventListener(t,r,a),r.__once&&e.removeEventListener(t,r.__once,a)}function Ac(e,t,r,n){return II(e,t,r,n),function(){G8(e,t,r,n)}}var K8=function(){},q8=K8;const X8=Er(q8);function J8(e){return e&&"setState"in e?Yk.findDOMNode(e):e??null}const Q8=function(e){return gf(J8(e))};var Z8=27,Jw=function(){};function eL(e){return e.button===0}function tL(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var Qw=function(t){return t&&("current"in t?t.current:t)};function rL(e,t,r){var n=r===void 0?{}:r,a=n.disabled,s=n.clickTrigger,i=s===void 0?"click":s,o=O.useRef(!1),l=t||Jw,c=O.useCallback(function(h){var m,v=Qw(e);X8(!!v,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),o.current=!v||tL(h)||!eL(h)||!!Iu(v,(m=h.composedPath==null?void 0:h.composedPath()[0])!=null?m:h.target)},[e]),f=$w(function(h){o.current||l(h)}),d=$w(function(h){h.keyCode===Z8&&l(h)});O.useEffect(function(){if(!(a||e==null)){var h=window.event,m=Q8(Qw(e)),v=Ac(m,i,c,!0),p=Ac(m,i,function(x){if(x===h){h=void 0;return}f(x)}),_=Ac(m,"keyup",function(x){if(x===h){h=void 0;return}d(x)}),y=[];return"ontouchstart"in m.documentElement&&(y=[].slice.call(m.body.children).map(function(x){return Ac(x,"mousemove",Jw)})),function(){v(),p(),_(),y.forEach(function(x){return x()})}}},[e,a,i,c,f,d])}function nL(e){var t={};return Array.isArray(e)?(e==null||e.forEach(function(r){t[r.name]=r}),t):e||t}function aL(e){return e===void 0&&(e={}),Array.isArray(e)?e:Object.keys(e).map(function(t){return e[t].name=t,e[t]})}function sL(e){var t,r,n,a,s=e.enabled,i=e.enableEvents,o=e.placement,l=e.flip,c=e.offset,f=e.fixed,d=e.containerPadding,h=e.arrowElement,m=e.popperConfig,v=m===void 0?{}:m,p=nL(v.modifiers);return kt({},v,{placement:o,enabled:s,strategy:f?"fixed":v.strategy,modifiers:aL(kt({},p,{eventListeners:{enabled:i},preventOverflow:kt({},p.preventOverflow,{options:d?kt({padding:d},(t=p.preventOverflow)==null?void 0:t.options):(r=p.preventOverflow)==null?void 0:r.options}),offset:{options:kt({offset:c},(n=p.offset)==null?void 0:n.options)},arrow:kt({},p.arrow,{enabled:!!h,options:kt({},(a=p.arrow)==null?void 0:a.options,{element:h})}),flip:kt({enabled:!!l},p.flip)}))})}function iL(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function oL(e,t){e.classList?e.classList.add(t):iL(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}function Zw(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function lL(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=Zw(e.className,t):e.setAttribute("class",Zw(e.className&&e.className.baseVal||"",t))}var ud;function a1(e){if((!ud&&ud!==0||e)&&qx){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),ud=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return ud}var dm=function(t){var r;return typeof document>"u"?null:t==null?gf().body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),(r=t)!=null&&r.nodeType&&t||null)};function e2(e,t){var r=O.useState(function(){return dm(e)}),n=r[0],a=r[1];if(!n){var s=dm(e);s&&a(s)}return O.useEffect(function(){},[t,n]),O.useEffect(function(){var i=dm(e);i!==n&&a(i)},[e,n]),n}const t2=e=>!e||typeof e=="function"?e:t=>{e.current=t};function cL(e,t){const r=t2(e),n=t2(t);return a=>{r&&r(a),n&&n(a)}}function uL(e,t){return O.useMemo(()=>cL(e,t),[e,t])}var s1=J.forwardRef(function(e,t){var r=e.flip,n=e.offset,a=e.placement,s=e.containerPadding,i=s===void 0?5:s,o=e.popperConfig,l=o===void 0?{}:o,c=e.transition,f=Bw(),d=f[0],h=f[1],m=Bw(),v=m[0],p=m[1],_=uL(h,t),y=e2(e.container),x=e2(e.target),g=O.useState(!e.show),w=g[0],b=g[1],k=Y8(x,d,sL({placement:a,enableEvents:!!e.show,containerPadding:i||5,flip:r,offset:n,arrowElement:v,popperConfig:l})),E=k.styles,S=k.attributes,T=Fh(k,["styles","attributes"]);e.show?w&&b(!1):!e.transition&&!w&&b(!0);var P=function(){b(!0),e.onExited&&e.onExited.apply(e,arguments)},M=e.show||c&&!w;if(rL(d,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!M)return null;var L=e.children(kt({},T,{show:!!e.show,props:kt({},S.popper,{style:E.popper,ref:_}),arrowProps:kt({},S.arrow,{style:E.arrow,ref:p})}));if(c){var D=e.onExit,Q=e.onExiting,ee=e.onEnter,Y=e.onEntering,q=e.onEntered;L=J.createElement(c,{in:e.show,appear:!0,onExit:D,onExiting:Q,onExited:P,onEnter:ee,onEntering:Y,onEntered:q},L)}return y?Yk.createPortal(L,y):null});s1.displayName="Overlay";s1.propTypes={show:ue.bool,placement:ue.oneOf(Jx),target:ue.any,container:ue.any,flip:ue.bool,children:ue.func.isRequired,containerPadding:ue.number,popperConfig:ue.object,rootClose:ue.bool,rootCloseEvent:ue.oneOf(["click","mousedown"]),rootCloseDisabled:ue.bool,onHide:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];if(t.rootClose){var s;return(s=ue.func).isRequired.apply(s,[t].concat(n))}return ue.func.apply(ue,[t].concat(n))},transition:ue.elementType,onEnter:ue.func,onEntering:ue.func,onEntered:ue.func,onExit:ue.func,onExiting:ue.func,onExited:ue.func};function fL(){this.__data__=[],this.size=0}var dL=fL,hL=pf;function pL(e,t){for(var r=e.length;r--;)if(hL(e[r][0],t))return r;return-1}var Lh=pL,mL=Lh,vL=Array.prototype,gL=vL.splice;function xL(e){var t=this.__data__,r=mL(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():gL.call(t,r,1),--this.size,!0}var yL=xL,_L=Lh;function wL(e){var t=this.__data__,r=_L(t,e);return r<0?void 0:t[r][1]}var bL=wL,EL=Lh;function SL(e){return EL(this.__data__,e)>-1}var kL=SL,TL=Lh;function CL(e,t){var r=this.__data__,n=TL(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var NL=CL,AL=dL,OL=yL,DL=bL,jL=kL,PL=NL;function zl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zl.prototype.clear=AL;zl.prototype.delete=OL;zl.prototype.get=DL;zl.prototype.has=jL;zl.prototype.set=PL;var $h=zl,FL=$h;function RL(){this.__data__=new FL,this.size=0}var ML=RL;function IL(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var LL=IL;function $L(e){return this.__data__.get(e)}var BL=$L;function UL(e){return this.__data__.has(e)}var WL=UL,VL=Pa,HL=VL["__core-js_shared__"],zL=HL,hm=zL,r2=function(){var e=/[^.]+$/.exec(hm&&hm.keys&&hm.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function YL(e){return!!r2&&r2 in e}var GL=YL,KL=Function.prototype,qL=KL.toString;function XL(e){if(e!=null){try{return qL.call(e)}catch{}try{return e+""}catch{}}return""}var _C=XL,JL=zx,QL=GL,ZL=gs,e5=_C,t5=/[\\^$.*+?()[\]{}|]/g,r5=/^\[object .+?Constructor\]$/,n5=Function.prototype,a5=Object.prototype,s5=n5.toString,i5=a5.hasOwnProperty,o5=RegExp("^"+s5.call(i5).replace(t5,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function l5(e){if(!ZL(e)||QL(e))return!1;var t=JL(e)?o5:r5;return t.test(e5(e))}var c5=l5;function u5(e,t){return e==null?void 0:e[t]}var f5=u5,d5=c5,h5=f5;function p5(e,t){var r=h5(e,t);return d5(r)?r:void 0}var ho=p5,m5=ho,v5=Pa,g5=m5(v5,"Map"),i1=g5,x5=ho,y5=x5(Object,"create"),Bh=y5,n2=Bh;function _5(){this.__data__=n2?n2(null):{},this.size=0}var w5=_5;function b5(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var E5=b5,S5=Bh,k5="__lodash_hash_undefined__",T5=Object.prototype,C5=T5.hasOwnProperty;function N5(e){var t=this.__data__;if(S5){var r=t[e];return r===k5?void 0:r}return C5.call(t,e)?t[e]:void 0}var A5=N5,O5=Bh,D5=Object.prototype,j5=D5.hasOwnProperty;function P5(e){var t=this.__data__;return O5?t[e]!==void 0:j5.call(t,e)}var F5=P5,R5=Bh,M5="__lodash_hash_undefined__";function I5(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=R5&&t===void 0?M5:t,this}var L5=I5,$5=w5,B5=E5,U5=A5,W5=F5,V5=L5;function Yl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Yl.prototype.clear=$5;Yl.prototype.delete=B5;Yl.prototype.get=U5;Yl.prototype.has=W5;Yl.prototype.set=V5;var H5=Yl,a2=H5,z5=$h,Y5=i1;function G5(){this.size=0,this.__data__={hash:new a2,map:new(Y5||z5),string:new a2}}var K5=G5;function q5(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var X5=q5,J5=X5;function Q5(e,t){var r=e.__data__;return J5(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Uh=Q5,Z5=Uh;function e$(e){var t=Z5(this,e).delete(e);return this.size-=t?1:0,t}var t$=e$,r$=Uh;function n$(e){return r$(this,e).get(e)}var a$=n$,s$=Uh;function i$(e){return s$(this,e).has(e)}var o$=i$,l$=Uh;function c$(e,t){var r=l$(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var u$=c$,f$=K5,d$=t$,h$=a$,p$=o$,m$=u$;function Gl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gl.prototype.clear=f$;Gl.prototype.delete=d$;Gl.prototype.get=h$;Gl.prototype.has=p$;Gl.prototype.set=m$;var o1=Gl,v$=$h,g$=i1,x$=o1,y$=200;function _$(e,t){var r=this.__data__;if(r instanceof v$){var n=r.__data__;if(!g$||n.length<y$-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new x$(n)}return r.set(e,t),this.size=r.size,this}var w$=_$,b$=$h,E$=ML,S$=LL,k$=BL,T$=WL,C$=w$;function Kl(e){var t=this.__data__=new b$(e);this.size=t.size}Kl.prototype.clear=E$;Kl.prototype.delete=S$;Kl.prototype.get=k$;Kl.prototype.has=T$;Kl.prototype.set=C$;var l1=Kl,N$="__lodash_hash_undefined__";function A$(e){return this.__data__.set(e,N$),this}var O$=A$;function D$(e){return this.__data__.has(e)}var j$=D$,P$=o1,F$=O$,R$=j$;function j0(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new P$;++t<r;)this.add(e[t])}j0.prototype.add=j0.prototype.push=F$;j0.prototype.has=R$;var M$=j0;function I$(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var L$=I$;function $$(e,t){return e.has(t)}var B$=$$,U$=M$,W$=L$,V$=B$,H$=1,z$=2;function Y$(e,t,r,n,a,s){var i=r&H$,o=e.length,l=t.length;if(o!=l&&!(i&&l>o))return!1;var c=s.get(e),f=s.get(t);if(c&&f)return c==t&&f==e;var d=-1,h=!0,m=r&z$?new U$:void 0;for(s.set(e,t),s.set(t,e);++d<o;){var v=e[d],p=t[d];if(n)var _=i?n(p,v,d,t,e,s):n(v,p,d,e,t,s);if(_!==void 0){if(_)continue;h=!1;break}if(m){if(!W$(t,function(y,x){if(!V$(m,x)&&(v===y||a(v,y,r,n,s)))return m.push(x)})){h=!1;break}}else if(!(v===p||a(v,p,r,n,s))){h=!1;break}}return s.delete(e),s.delete(t),h}var wC=Y$,G$=Pa,K$=G$.Uint8Array,bC=K$;function q$(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var X$=q$;function J$(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Q$=J$,s2=Vl,i2=bC,Z$=pf,e7=wC,t7=X$,r7=Q$,n7=1,a7=2,s7="[object Boolean]",i7="[object Date]",o7="[object Error]",l7="[object Map]",c7="[object Number]",u7="[object RegExp]",f7="[object Set]",d7="[object String]",h7="[object Symbol]",p7="[object ArrayBuffer]",m7="[object DataView]",o2=s2?s2.prototype:void 0,pm=o2?o2.valueOf:void 0;function v7(e,t,r,n,a,s,i){switch(r){case m7:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case p7:return!(e.byteLength!=t.byteLength||!s(new i2(e),new i2(t)));case s7:case i7:case c7:return Z$(+e,+t);case o7:return e.name==t.name&&e.message==t.message;case u7:case d7:return e==t+"";case l7:var o=t7;case f7:var l=n&n7;if(o||(o=r7),e.size!=t.size&&!l)return!1;var c=i.get(e);if(c)return c==t;n|=a7,i.set(e,t);var f=e7(o(e),o(t),n,a,s,i);return i.delete(e),f;case h7:if(pm)return pm.call(e)==pm.call(t)}return!1}var g7=v7;function x7(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var c1=x7,y7=Array.isArray,Fn=y7,_7=c1,w7=Fn;function b7(e,t,r){var n=t(e);return w7(e)?n:_7(n,r(e))}var EC=b7;function E7(e,t){for(var r=-1,n=e==null?0:e.length,a=0,s=[];++r<n;){var i=e[r];t(i,r,e)&&(s[a++]=i)}return s}var S7=E7;function k7(){return[]}var SC=k7,T7=S7,C7=SC,N7=Object.prototype,A7=N7.propertyIsEnumerable,l2=Object.getOwnPropertySymbols,O7=l2?function(e){return e==null?[]:(e=Object(e),T7(l2(e),function(t){return A7.call(e,t)}))}:C7,u1=O7;function D7(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var j7=D7,P7=Hl,F7=pi,R7="[object Arguments]";function M7(e){return F7(e)&&P7(e)==R7}var I7=M7,c2=I7,L7=pi,kC=Object.prototype,$7=kC.hasOwnProperty,B7=kC.propertyIsEnumerable,U7=c2(function(){return arguments}())?c2:function(e){return L7(e)&&$7.call(e,"callee")&&!B7.call(e,"callee")},f1=U7,P0={exports:{}};function W7(){return!1}var V7=W7;P0.exports;(function(e,t){var r=Pa,n=V7,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,o=i?r.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||n;e.exports=c})(P0,P0.exports);var Wh=P0.exports,H7=Hl,z7=Yx,Y7=pi,G7="[object Arguments]",K7="[object Array]",q7="[object Boolean]",X7="[object Date]",J7="[object Error]",Q7="[object Function]",Z7="[object Map]",eB="[object Number]",tB="[object Object]",rB="[object RegExp]",nB="[object Set]",aB="[object String]",sB="[object WeakMap]",iB="[object ArrayBuffer]",oB="[object DataView]",lB="[object Float32Array]",cB="[object Float64Array]",uB="[object Int8Array]",fB="[object Int16Array]",dB="[object Int32Array]",hB="[object Uint8Array]",pB="[object Uint8ClampedArray]",mB="[object Uint16Array]",vB="[object Uint32Array]",lt={};lt[lB]=lt[cB]=lt[uB]=lt[fB]=lt[dB]=lt[hB]=lt[pB]=lt[mB]=lt[vB]=!0;lt[G7]=lt[K7]=lt[iB]=lt[q7]=lt[oB]=lt[X7]=lt[J7]=lt[Q7]=lt[Z7]=lt[eB]=lt[tB]=lt[rB]=lt[nB]=lt[aB]=lt[sB]=!1;function gB(e){return Y7(e)&&z7(e.length)&&!!lt[H7(e)]}var xB=gB;function yB(e){return function(t){return e(t)}}var Vh=yB,F0={exports:{}};F0.exports;(function(e,t){var r=nC,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,i=s&&r.process,o=function(){try{var l=a&&a.require&&a.require("util").types;return l||i&&i.binding&&i.binding("util")}catch{}}();e.exports=o})(F0,F0.exports);var d1=F0.exports,_B=xB,wB=Vh,u2=d1,f2=u2&&u2.isTypedArray,bB=f2?wB(f2):_B,h1=bB,EB=j7,SB=f1,kB=Fn,TB=Wh,CB=Gx,NB=h1,AB=Object.prototype,OB=AB.hasOwnProperty;function DB(e,t){var r=kB(e),n=!r&&SB(e),a=!r&&!n&&TB(e),s=!r&&!n&&!a&&NB(e),i=r||n||a||s,o=i?EB(e.length,String):[],l=o.length;for(var c in e)(t||OB.call(e,c))&&!(i&&(c=="length"||a&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||CB(c,l)))&&o.push(c);return o}var TC=DB,jB=Object.prototype;function PB(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||jB;return e===r}var p1=PB;function FB(e,t){return function(r){return e(t(r))}}var CC=FB,RB=CC,MB=RB(Object.keys,Object),IB=MB,LB=p1,$B=IB,BB=Object.prototype,UB=BB.hasOwnProperty;function WB(e){if(!LB(e))return $B(e);var t=[];for(var r in Object(e))UB.call(e,r)&&r!="constructor"&&t.push(r);return t}var VB=WB,HB=TC,zB=VB,YB=mf;function GB(e){return YB(e)?HB(e):zB(e)}var _f=GB,KB=EC,qB=u1,XB=_f;function JB(e){return KB(e,XB,qB)}var NC=JB,d2=NC,QB=1,ZB=Object.prototype,eU=ZB.hasOwnProperty;function tU(e,t,r,n,a,s){var i=r&QB,o=d2(e),l=o.length,c=d2(t),f=c.length;if(l!=f&&!i)return!1;for(var d=l;d--;){var h=o[d];if(!(i?h in t:eU.call(t,h)))return!1}var m=s.get(e),v=s.get(t);if(m&&v)return m==t&&v==e;var p=!0;s.set(e,t),s.set(t,e);for(var _=i;++d<l;){h=o[d];var y=e[h],x=t[h];if(n)var g=i?n(x,y,h,t,e,s):n(y,x,h,e,t,s);if(!(g===void 0?y===x||a(y,x,r,n,s):g)){p=!1;break}_||(_=h=="constructor")}if(p&&!_){var w=e.constructor,b=t.constructor;w!=b&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof b=="function"&&b instanceof b)&&(p=!1)}return s.delete(e),s.delete(t),p}var rU=tU,nU=ho,aU=Pa,sU=nU(aU,"DataView"),iU=sU,oU=ho,lU=Pa,cU=oU(lU,"Promise"),uU=cU,fU=ho,dU=Pa,hU=fU(dU,"Set"),pU=hU,mU=ho,vU=Pa,gU=mU(vU,"WeakMap"),xU=gU,Zv=iU,eg=i1,tg=uU,rg=pU,ng=xU,AC=Hl,ql=_C,h2="[object Map]",yU="[object Object]",p2="[object Promise]",m2="[object Set]",v2="[object WeakMap]",g2="[object DataView]",_U=ql(Zv),wU=ql(eg),bU=ql(tg),EU=ql(rg),SU=ql(ng),ki=AC;(Zv&&ki(new Zv(new ArrayBuffer(1)))!=g2||eg&&ki(new eg)!=h2||tg&&ki(tg.resolve())!=p2||rg&&ki(new rg)!=m2||ng&&ki(new ng)!=v2)&&(ki=function(e){var t=AC(e),r=t==yU?e.constructor:void 0,n=r?ql(r):"";if(n)switch(n){case _U:return g2;case wU:return h2;case bU:return p2;case EU:return m2;case SU:return v2}return t});var Hh=ki,mm=l1,kU=wC,TU=g7,CU=rU,x2=Hh,y2=Fn,_2=Wh,NU=h1,AU=1,w2="[object Arguments]",b2="[object Array]",fd="[object Object]",OU=Object.prototype,E2=OU.hasOwnProperty;function DU(e,t,r,n,a,s){var i=y2(e),o=y2(t),l=i?b2:x2(e),c=o?b2:x2(t);l=l==w2?fd:l,c=c==w2?fd:c;var f=l==fd,d=c==fd,h=l==c;if(h&&_2(e)){if(!_2(t))return!1;i=!0,f=!1}if(h&&!f)return s||(s=new mm),i||NU(e)?kU(e,t,r,n,a,s):TU(e,t,l,r,n,a,s);if(!(r&AU)){var m=f&&E2.call(e,"__wrapped__"),v=d&&E2.call(t,"__wrapped__");if(m||v){var p=m?e.value():e,_=v?t.value():t;return s||(s=new mm),a(p,_,r,n,s)}}return h?(s||(s=new mm),CU(e,t,r,n,a,s)):!1}var jU=DU,PU=jU,S2=pi;function OC(e,t,r,n,a){return e===t?!0:e==null||t==null||!S2(e)&&!S2(t)?e!==e&&t!==t:PU(e,t,r,n,OC,a)}var m1=OC,FU=m1;function RU(e,t){return FU(e,t)}var MU=RU;const IU=Er(MU);function vm(e,t){var r=Kx(e);return r?r.innerHeight:Mi(e).height}function DC(e,t,r){e.closest&&!r&&e.closest(t);var n=e;do{if(FI(n,t))return n;n=n.parentElement}while(n&&n!==r&&n.nodeType===document.ELEMENT_NODE);return null}function LU(e,t,r,n){for(var a=e.length,s=r+(n?1:-1);n?s--:++s<a;)if(t(e[s],s,e))return s;return-1}var $U=LU,BU=l1,UU=m1,WU=1,VU=2;function HU(e,t,r,n){var a=r.length,s=a,i=!n;if(e==null)return!s;for(e=Object(e);a--;){var o=r[a];if(i&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<s;){o=r[a];var l=o[0],c=e[l],f=o[1];if(i&&o[2]){if(c===void 0&&!(l in e))return!1}else{var d=new BU;if(n)var h=n(c,f,l,e,t,d);if(!(h===void 0?UU(f,c,WU|VU,n,d):h))return!1}}return!0}var zU=HU,YU=gs;function GU(e){return e===e&&!YU(e)}var jC=GU,KU=jC,qU=_f;function XU(e){for(var t=qU(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,KU(a)]}return t}var JU=XU;function QU(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var PC=QU,ZU=zU,e9=JU,t9=PC;function r9(e){var t=e9(e);return t.length==1&&t[0][2]?t9(t[0][0],t[0][1]):function(r){return r===e||ZU(r,e,t)}}var n9=r9,a9=Fn,s9=vf,i9=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o9=/^\w*$/;function l9(e,t){if(a9(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||s9(e)?!0:o9.test(e)||!i9.test(e)||t!=null&&e in Object(t)}var v1=l9,FC=o1,c9="Expected a function";function g1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(c9);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var i=e.apply(this,n);return r.cache=s.set(a,i)||s,i};return r.cache=new(g1.Cache||FC),r}g1.Cache=FC;var u9=g1,f9=u9,d9=500;function h9(e){var t=f9(e,function(n){return r.size===d9&&r.clear(),n}),r=t.cache;return t}var p9=h9,m9=p9,v9=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g9=/\\(\\)?/g,x9=m9(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(v9,function(r,n,a,s){t.push(a?s.replace(g9,"$1"):n||r)}),t}),y9=x9;function _9(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var x1=_9,k2=Vl,w9=x1,b9=Fn,E9=vf,S9=1/0,T2=k2?k2.prototype:void 0,C2=T2?T2.toString:void 0;function RC(e){if(typeof e=="string")return e;if(b9(e))return w9(e,RC)+"";if(E9(e))return C2?C2.call(e):"";var t=e+"";return t=="0"&&1/e==-S9?"-0":t}var k9=RC,T9=k9;function C9(e){return e==null?"":T9(e)}var N9=C9,A9=Fn,O9=v1,D9=y9,j9=N9;function P9(e,t){return A9(e)?e:O9(e,t)?[e]:D9(j9(e))}var zh=P9,F9=vf,R9=1/0;function M9(e){if(typeof e=="string"||F9(e))return e;var t=e+"";return t=="0"&&1/e==-R9?"-0":t}var wf=M9,I9=zh,L9=wf;function $9(e,t){t=I9(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[L9(t[r++])];return r&&r==n?e:void 0}var Yh=$9,B9=Yh;function U9(e,t,r){var n=e==null?void 0:B9(e,t);return n===void 0?r:n}var W9=U9;function V9(e,t){return e!=null&&t in Object(e)}var H9=V9,z9=zh,Y9=f1,G9=Fn,K9=Gx,q9=Yx,X9=wf;function J9(e,t,r){t=z9(t,e);for(var n=-1,a=t.length,s=!1;++n<a;){var i=X9(t[n]);if(!(s=e!=null&&r(e,i)))break;e=e[i]}return s||++n!=a?s:(a=e==null?0:e.length,!!a&&q9(a)&&K9(i,a)&&(G9(e)||Y9(e)))}var Q9=J9,Z9=H9,eW=Q9;function tW(e,t){return e!=null&&eW(e,t,Z9)}var rW=tW,nW=m1,aW=W9,sW=rW,iW=v1,oW=jC,lW=PC,cW=wf,uW=1,fW=2;function dW(e,t){return iW(e)&&oW(t)?lW(cW(e),t):function(r){var n=aW(r,e);return n===void 0&&n===t?sW(r,e):nW(t,n,uW|fW)}}var hW=dW;function pW(e){return e}var Gh=pW;function mW(e){return function(t){return t==null?void 0:t[e]}}var vW=mW,gW=Yh;function xW(e){return function(t){return gW(t,e)}}var yW=xW,_W=vW,wW=yW,bW=v1,EW=wf;function SW(e){return bW(e)?_W(EW(e)):wW(e)}var kW=SW,TW=n9,CW=hW,NW=Gh,AW=Fn,OW=kW;function DW(e){return typeof e=="function"?e:e==null?NW:typeof e=="object"?AW(e)?CW(e[0],e[1]):TW(e):OW(e)}var Kh=DW,jW=$U,PW=Kh,FW=iC,RW=Math.max;function MW(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:FW(r);return a<0&&(a=RW(n+a,0)),jW(e,PW(t),a)}var IW=MW;const LW=Er(IW);var $W=Math.ceil,BW=Math.max;function UW(e,t,r,n){for(var a=-1,s=BW($W((t-e)/(r||1)),0),i=Array(s);s--;)i[n?s:++a]=e,e+=r;return i}var WW=UW,VW=WW,HW=Mh,gm=sC;function zW(e){return function(t,r,n){return n&&typeof n!="number"&&HW(t,r,n)&&(r=n=void 0),t=gm(t),r===void 0?(r=t,t=0):r=gm(r),n=n===void 0?t<r?1:-1:gm(n),VW(t,r,n,e)}}var YW=zW,GW=YW,KW=GW(),qW=KW;const XW=Er(qW);var N2=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function JW(e,t){return!!(e===t||N2(e)&&N2(t))}function QW(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!JW(e[r],t[r]))return!1;return!0}function MC(e,t){t===void 0&&(t=QW);var r=null;function n(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var i=e.apply(this,a);return r={lastResult:i,lastArgs:a,lastThis:this},i}return n.clear=function(){r=null},n}function ag(e,t){var r=Kx(e);return r?r.innerWidth:Mi(e).width}var A2=Vl,ZW=f1,eV=Fn,O2=A2?A2.isConcatSpreadable:void 0;function tV(e){return eV(e)||ZW(e)||!!(O2&&e&&e[O2])}var rV=tV,nV=c1,aV=rV;function IC(e,t,r,n,a){var s=-1,i=e.length;for(r||(r=aV),a||(a=[]);++s<i;){var o=e[s];t>0&&r(o)?t>1?IC(o,t-1,r,n,a):nV(a,o):n||(a[a.length]=o)}return a}var LC=IC;function sV(e){return function(t,r,n){for(var a=-1,s=Object(t),i=n(t),o=i.length;o--;){var l=i[e?o:++a];if(r(s[l],l,s)===!1)break}return t}}var iV=sV,oV=iV,lV=oV(),cV=lV,uV=cV,fV=_f;function dV(e,t){return e&&uV(e,t,fV)}var y1=dV,hV=mf;function pV(e,t){return function(r,n){if(r==null)return r;if(!hV(r))return e(r,n);for(var a=r.length,s=t?a:-1,i=Object(r);(t?s--:++s<a)&&n(i[s],s,i)!==!1;);return r}}var mV=pV,vV=y1,gV=mV,xV=gV(vV),yV=xV,_V=yV,wV=mf;function bV(e,t){var r=-1,n=wV(e)?Array(e.length):[];return _V(e,function(a,s,i){n[++r]=t(a,s,i)}),n}var EV=bV;function SV(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var kV=SV,D2=vf;function TV(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,s=D2(e),i=t!==void 0,o=t===null,l=t===t,c=D2(t);if(!o&&!c&&!s&&e>t||s&&i&&l&&!o&&!c||n&&i&&l||!r&&l||!a)return 1;if(!n&&!s&&!c&&e<t||c&&r&&a&&!n&&!s||o&&r&&a||!i&&a||!l)return-1}return 0}var CV=TV,NV=CV;function AV(e,t,r){for(var n=-1,a=e.criteria,s=t.criteria,i=a.length,o=r.length;++n<i;){var l=NV(a[n],s[n]);if(l){if(n>=o)return l;var c=r[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}var OV=AV,xm=x1,DV=Yh,jV=Kh,PV=EV,FV=kV,RV=Vh,MV=OV,IV=Gh,LV=Fn;function $V(e,t,r){t.length?t=xm(t,function(s){return LV(s)?function(i){return DV(i,s.length===1?s[0]:s)}:s}):t=[IV];var n=-1;t=xm(t,RV(jV));var a=PV(e,function(s,i,o){var l=xm(t,function(c){return c(s)});return{criteria:l,index:++n,value:s}});return FV(a,function(s,i){return MV(s,i,r)})}var BV=$V;function UV(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var WV=UV,VV=WV,j2=Math.max;function HV(e,t,r){return t=j2(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,s=j2(n.length-t,0),i=Array(s);++a<s;)i[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(i),VV(e,this,o)}}var $C=HV;function zV(e){return function(){return e}}var YV=zV,GV=ho,KV=function(){try{var e=GV(Object,"defineProperty");return e({},"",{}),e}catch{}}(),BC=KV,qV=YV,P2=BC,XV=Gh,JV=P2?function(e,t){return P2(e,"toString",{configurable:!0,enumerable:!1,value:qV(t),writable:!0})}:XV,QV=JV,ZV=800,eH=16,tH=Date.now;function rH(e){var t=0,r=0;return function(){var n=tH(),a=eH-(n-r);if(r=n,a>0){if(++t>=ZV)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var nH=rH,aH=QV,sH=nH,iH=sH(aH),UC=iH,oH=Gh,lH=$C,cH=UC;function uH(e,t){return cH(lH(e,t,oH),e+"")}var WC=uH,fH=LC,dH=BV,hH=WC,F2=Mh,pH=hH(function(e,t){if(e==null)return[];var r=t.length;return r>1&&F2(e,t[0],t[1])?t=[]:r>2&&F2(t[0],t[1],t[2])&&(t=[t[0]]),dH(e,fH(t,1),[])}),mH=pH;const vH=Er(mH);function VC(e){return LT(e)||tC(e)||Wx(e)||$T()}function gH(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var xH=gH,yH=gs,_H=p1,wH=xH,bH=Object.prototype,EH=bH.hasOwnProperty;function SH(e){if(!yH(e))return wH(e);var t=_H(e),r=[];for(var n in e)n=="constructor"&&(t||!EH.call(e,n))||r.push(n);return r}var kH=SH,TH=TC,CH=kH,NH=mf;function AH(e){return NH(e)?TH(e,!0):CH(e)}var qh=AH,OH=WC,DH=pf,jH=Mh,PH=qh,HC=Object.prototype,FH=HC.hasOwnProperty,RH=OH(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&jH(t[0],t[1],a)&&(n=1);++r<n;)for(var s=t[r],i=PH(s),o=-1,l=i.length;++o<l;){var c=i[o],f=e[c];(f===void 0||DH(f,HC[c])&&!FH.call(e,c))&&(e[c]=s[c])}return e}),MH=RH;const IH=Er(MH);var R2=BC;function LH(e,t,r){t=="__proto__"&&R2?R2(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var _1=LH,$H=_1,BH=y1,UH=Kh;function WH(e,t){var r={};return t=UH(t),BH(e,function(n,a,s){$H(r,a,t(n,a,s))}),r}var VH=WH;const HH=Er(VH);function zH(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var zC=zH,YH=_1,GH=pf,KH=Object.prototype,qH=KH.hasOwnProperty;function XH(e,t,r){var n=e[t];(!(qH.call(e,t)&&GH(n,r))||r===void 0&&!(t in e))&&YH(e,t,r)}var YC=XH,JH=YC,QH=_1;function ZH(e,t,r,n){var a=!r;r||(r={});for(var s=-1,i=t.length;++s<i;){var o=t[s],l=n?n(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),a?QH(r,o,l):JH(r,o,l)}return r}var bf=ZH,ez=bf,tz=_f;function rz(e,t){return e&&ez(t,tz(t),e)}var nz=rz,az=bf,sz=qh;function iz(e,t){return e&&az(t,sz(t),e)}var oz=iz,R0={exports:{}};R0.exports;(function(e,t){var r=Pa,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,i=s?r.Buffer:void 0,o=i?i.allocUnsafe:void 0;function l(c,f){if(f)return c.slice();var d=c.length,h=o?o(d):new c.constructor(d);return c.copy(h),h}e.exports=l})(R0,R0.exports);var lz=R0.exports;function cz(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var uz=cz,fz=bf,dz=u1;function hz(e,t){return fz(e,dz(e),t)}var pz=hz,mz=CC,vz=mz(Object.getPrototypeOf,Object),Xh=vz,gz=c1,xz=Xh,yz=u1,_z=SC,wz=Object.getOwnPropertySymbols,bz=wz?function(e){for(var t=[];e;)gz(t,yz(e)),e=xz(e);return t}:_z,GC=bz,Ez=bf,Sz=GC;function kz(e,t){return Ez(e,Sz(e),t)}var Tz=kz,Cz=EC,Nz=GC,Az=qh;function Oz(e){return Cz(e,Az,Nz)}var KC=Oz,Dz=Object.prototype,jz=Dz.hasOwnProperty;function Pz(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&jz.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Fz=Pz,M2=bC;function Rz(e){var t=new e.constructor(e.byteLength);return new M2(t).set(new M2(e)),t}var w1=Rz,Mz=w1;function Iz(e,t){var r=t?Mz(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var Lz=Iz,$z=/\w*$/;function Bz(e){var t=new e.constructor(e.source,$z.exec(e));return t.lastIndex=e.lastIndex,t}var Uz=Bz,I2=Vl,L2=I2?I2.prototype:void 0,$2=L2?L2.valueOf:void 0;function Wz(e){return $2?Object($2.call(e)):{}}var Vz=Wz,Hz=w1;function zz(e,t){var r=t?Hz(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Yz=zz,Gz=w1,Kz=Lz,qz=Uz,Xz=Vz,Jz=Yz,Qz="[object Boolean]",Zz="[object Date]",eY="[object Map]",tY="[object Number]",rY="[object RegExp]",nY="[object Set]",aY="[object String]",sY="[object Symbol]",iY="[object ArrayBuffer]",oY="[object DataView]",lY="[object Float32Array]",cY="[object Float64Array]",uY="[object Int8Array]",fY="[object Int16Array]",dY="[object Int32Array]",hY="[object Uint8Array]",pY="[object Uint8ClampedArray]",mY="[object Uint16Array]",vY="[object Uint32Array]";function gY(e,t,r){var n=e.constructor;switch(t){case iY:return Gz(e);case Qz:case Zz:return new n(+e);case oY:return Kz(e,r);case lY:case cY:case uY:case fY:case dY:case hY:case pY:case mY:case vY:return Jz(e,r);case eY:return new n;case tY:case aY:return new n(e);case rY:return qz(e);case nY:return new n;case sY:return Xz(e)}}var xY=gY,yY=gs,B2=Object.create,_Y=function(){function e(){}return function(t){if(!yY(t))return{};if(B2)return B2(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),qC=_Y,wY=qC,bY=Xh,EY=p1;function SY(e){return typeof e.constructor=="function"&&!EY(e)?wY(bY(e)):{}}var kY=SY,TY=Hh,CY=pi,NY="[object Map]";function AY(e){return CY(e)&&TY(e)==NY}var OY=AY,DY=OY,jY=Vh,U2=d1,W2=U2&&U2.isMap,PY=W2?jY(W2):DY,FY=PY,RY=Hh,MY=pi,IY="[object Set]";function LY(e){return MY(e)&&RY(e)==IY}var $Y=LY,BY=$Y,UY=Vh,V2=d1,H2=V2&&V2.isSet,WY=H2?UY(H2):BY,VY=WY,HY=l1,zY=zC,YY=YC,GY=nz,KY=oz,qY=lz,XY=uz,JY=pz,QY=Tz,ZY=NC,eG=KC,tG=Hh,rG=Fz,nG=xY,aG=kY,sG=Fn,iG=Wh,oG=FY,lG=gs,cG=VY,uG=_f,fG=qh,dG=1,hG=2,pG=4,XC="[object Arguments]",mG="[object Array]",vG="[object Boolean]",gG="[object Date]",xG="[object Error]",JC="[object Function]",yG="[object GeneratorFunction]",_G="[object Map]",wG="[object Number]",QC="[object Object]",bG="[object RegExp]",EG="[object Set]",SG="[object String]",kG="[object Symbol]",TG="[object WeakMap]",CG="[object ArrayBuffer]",NG="[object DataView]",AG="[object Float32Array]",OG="[object Float64Array]",DG="[object Int8Array]",jG="[object Int16Array]",PG="[object Int32Array]",FG="[object Uint8Array]",RG="[object Uint8ClampedArray]",MG="[object Uint16Array]",IG="[object Uint32Array]",nt={};nt[XC]=nt[mG]=nt[CG]=nt[NG]=nt[vG]=nt[gG]=nt[AG]=nt[OG]=nt[DG]=nt[jG]=nt[PG]=nt[_G]=nt[wG]=nt[QC]=nt[bG]=nt[EG]=nt[SG]=nt[kG]=nt[FG]=nt[RG]=nt[MG]=nt[IG]=!0;nt[xG]=nt[JC]=nt[TG]=!1;function Wd(e,t,r,n,a,s){var i,o=t&dG,l=t&hG,c=t&pG;if(r&&(i=a?r(e,n,a,s):r(e)),i!==void 0)return i;if(!lG(e))return e;var f=sG(e);if(f){if(i=rG(e),!o)return XY(e,i)}else{var d=tG(e),h=d==JC||d==yG;if(iG(e))return qY(e,o);if(d==QC||d==XC||h&&!a){if(i=l||h?{}:aG(e),!o)return l?QY(e,KY(i,e)):JY(e,GY(i,e))}else{if(!nt[d])return a?e:{};i=nG(e,d,o)}}s||(s=new HY);var m=s.get(e);if(m)return m;s.set(e,i),cG(e)?e.forEach(function(_){i.add(Wd(_,t,r,_,e,s))}):oG(e)&&e.forEach(function(_,y){i.set(y,Wd(_,t,r,y,e,s))});var v=c?l?eG:ZY:l?fG:uG,p=f?void 0:v(e);return zY(p||e,function(_,y){p&&(y=_,_=e[y]),YY(i,y,Wd(_,t,r,y,e,s))}),i}var LG=Wd;function $G(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var BG=$G,UG=Yh,WG=rC;function VG(e,t){return t.length<2?e:UG(e,WG(t,0,-1))}var HG=VG,zG=zh,YG=BG,GG=HG,KG=wf;function qG(e,t){return t=zG(t,e),e=GG(e,t),e==null||delete e[KG(YG(t))]}var XG=qG,JG=Hl,QG=Xh,ZG=pi,eK="[object Object]",tK=Function.prototype,rK=Object.prototype,ZC=tK.toString,nK=rK.hasOwnProperty,aK=ZC.call(Object);function sK(e){if(!ZG(e)||JG(e)!=eK)return!1;var t=QG(e);if(t===null)return!0;var r=nK.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&ZC.call(r)==aK}var iK=sK,oK=iK;function lK(e){return oK(e)?void 0:e}var cK=lK,uK=LC;function fK(e){var t=e==null?0:e.length;return t?uK(e,1):[]}var dK=fK,hK=dK,pK=$C,mK=UC;function vK(e){return mK(pK(e,void 0,hK),e+"")}var gK=vK,xK=x1,yK=LG,_K=XG,wK=zh,bK=bf,EK=cK,SK=gK,kK=KC,TK=1,CK=2,NK=4,AK=SK(function(e,t){var r={};if(e==null)return r;var n=!1;t=xK(t,function(s){return s=wK(s,e),n||(n=s.length>1),s}),bK(e,kK(e),r),n&&(r=yK(r,TK|CK|NK,EK));for(var a=t.length;a--;)_K(r,t[a]);return r}),OK=AK;const DK=Er(OK);var jK=zC,PK=qC,FK=y1,RK=Kh,MK=Xh,IK=Fn,LK=Wh,$K=zx,BK=gs,UK=h1;function WK(e,t,r){var n=IK(e),a=n||LK(e)||UK(e);if(t=RK(t),r==null){var s=e&&e.constructor;a?r=n?new s:[]:BK(e)?r=$K(s)?PK(MK(e)):{}:r={}}return(a?jK:FK)(e,function(i,o,l){return t(r,i,o,l)}),r}var VK=WK;const HK=Er(VK);var zK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){n.prototype.isBetween=function(s,i,o,l){var c=a(s),f=a(i),d=(l=l||"()")[0]==="(",h=l[1]===")";return(d?this.isAfter(c,o):!this.isBefore(c,o))&&(h?this.isBefore(f,o):!this.isAfter(f,o))||(d?this.isBefore(c,o):!this.isAfter(c,o))&&(h?this.isAfter(f,o):!this.isBefore(f,o))}}})})(zK);var YK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n){n.prototype.isSameOrAfter=function(a,s){return this.isSame(a,s)||this.isAfter(a,s)}}})})(YK);var GK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n){n.prototype.isSameOrBefore=function(a,s){return this.isSame(a,s)||this.isBefore(a,s)}}})})(GK);var KK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){var s=n.prototype,i=function(d){return d&&(d.indexOf?d:d.s)},o=function(d,h,m,v,p){var _=d.name?d:d.$locale(),y=i(_[h]),x=i(_[m]),g=y||x.map(function(b){return b.slice(0,v)});if(!p)return g;var w=_.weekStart;return g.map(function(b,k){return g[(k+(w||0))%7]})},l=function(){return a.Ls[a.locale()]},c=function(d,h){return d.formats[h]||function(m){return m.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(v,p,_){return p||_.slice(1)})}(d.formats[h.toUpperCase()])},f=function(){var d=this;return{months:function(h){return h?h.format("MMMM"):o(d,"months")},monthsShort:function(h){return h?h.format("MMM"):o(d,"monthsShort","months",3)},firstDayOfWeek:function(){return d.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):o(d,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):o(d,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):o(d,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return c(d.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};s.localeData=function(){return f.bind(this)()},a.localeData=function(){var d=l();return{firstDayOfWeek:function(){return d.weekStart||0},weekdays:function(){return a.weekdays()},weekdaysShort:function(){return a.weekdaysShort()},weekdaysMin:function(){return a.weekdaysMin()},months:function(){return a.months()},monthsShort:function(){return a.monthsShort()},longDateFormat:function(h){return c(d,h)},meridiem:d.meridiem,ordinal:d.ordinal}},a.months=function(){return o(l(),"months")},a.monthsShort=function(){return o(l(),"monthsShort","months",3)},a.weekdays=function(d){return o(l(),"weekdays",null,null,d)},a.weekdaysShort=function(d){return o(l(),"weekdaysShort","weekdays",3,d)},a.weekdaysMin=function(d){return o(l(),"weekdaysMin","weekdays",2,d)}}})})(KK);var qK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,a,s){var i=a.prototype,o=i.format;s.en.formats=r,i.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var c=this.$locale().formats,f=function(d,h){return d.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(m,v,p){var _=p&&p.toUpperCase();return v||h[p]||r[p]||h[_].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(y,x,g){return x||g.slice(1)})})}(l,c===void 0?{}:c);return o.call(this,f)}}})})(qK);var XK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){var s=function(i,o){if(!o||!o.length||o.length===1&&!o[0]||o.length===1&&Array.isArray(o[0])&&!o[0].length)return null;var l;o.length===1&&o[0].length>0&&(o=o[0]),l=(o=o.filter(function(f){return f}))[0];for(var c=1;c<o.length;c+=1)o[c].isValid()&&!o[c][i](l)||(l=o[c]);return l};a.max=function(){var i=[].slice.call(arguments,0);return s("isAfter",i)},a.min=function(){var i=[].slice.call(arguments,0);return s("isBefore",i)}}})})(XK);var JK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(s,i,o){var l=i.prototype;o.utc=function(p){var _={date:p,utc:!0,args:arguments};return new i(_)},l.utc=function(p){var _=o(this.toDate(),{locale:this.$L,utc:!0});return p?_.add(this.utcOffset(),r):_},l.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var c=l.parse;l.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),c.call(this,p)};var f=l.init;l.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else f.call(this)};var d=l.utcOffset;l.utcOffset=function(p,_){var y=this.$utils().u;if(y(p))return this.$u?0:y(this.$offset)?d.call(this):this.$offset;if(typeof p=="string"&&(p=function(b){b===void 0&&(b="");var k=b.match(n);if(!k)return null;var E=(""+k[0]).match(a)||["-",0,0],S=E[0],T=60*+E[1]+ +E[2];return T===0?0:S==="+"?T:-T}(p),p===null))return this;var x=Math.abs(p)<=16?60*p:p,g=this;if(_)return g.$offset=x,g.$u=p===0,g;if(p!==0){var w=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(g=this.local().add(x+w,r)).$offset=x,g.$x.$localOffset=w}else g=this.utc();return g};var h=l.format;l.format=function(p){var _=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,_)},l.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var m=l.toDate;l.toDate=function(p){return p==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var v=l.diff;l.diff=function(p,_,y){if(p&&this.$u===p.$u)return v.call(this,p,_,y);var x=this.local(),g=o(p).local();return v.call(x,g,_,y)}}})})(JK);function Va(e){return e.children}var qr={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},Pt={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},z2=Object.keys(Pt).map(function(e){return Pt[e]});ue.oneOfType([ue.string,ue.func]);ue.any;ue.func;ue.oneOfType([ue.arrayOf(ue.oneOf(z2)),ue.objectOf(function(e,t){var r=z2.indexOf(t)!==-1&&typeof e[t]=="boolean";if(r)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];return ue.elementType.apply(ue,[e,t].concat(a))})]);ue.oneOfType([ue.oneOf(["overlap","no-overlap"]),ue.func]);var Y2={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function eN(e,t){var r=lr(e,"month");return lr(r,"week",t.startOfWeek())}function tN(e,t){var r=A0(e,"month");return A0(r,"week",t.startOfWeek())}function QK(e,t){for(var r=eN(e,t),n=tN(e,t),a=[];Ul(r,n,"day");)a.push(r),r=aa(r,1,"day");return a}function ZK(e,t){var r=lr(e,t);return df(r,e)?r:aa(r,1,t)}function eq(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",n=e,a=[];Ul(n,t,r);)a.push(n),n=aa(n,1,r);return a}function tq(e,t){return t==null&&e==null?null:(t==null&&(t=new Date),e==null&&(e=new Date),e=lr(e,"day"),e=Mu(e,Mu(t)),e=El(e,El(t)),e=Ru(e,Ru(t)),Fu(e,Fu(t)))}function G2(e){return Mu(e)===0&&El(e)===0&&Ru(e)===0&&Fu(e)===0}function rq(e,t,r,n){return r==="day"&&(r="date"),Math.abs(Aw[r](e,void 0,n)-Aw[r](t,void 0,n))}function b1(e,t,r){return!r||r==="milliseconds"?Math.abs(+e-+t):Math.round(Math.abs(+lr(e,r)/Y2[r]-+lr(t,r)/Y2[r]))}var nq=ue.oneOfType([ue.string,ue.func]);function aq(e,t,r,n,a){var s=typeof n=="function"?n(r,a,e):t.call(e,r,n,a);return Nu(s==null||typeof s=="string","`localizer format(..)` must return a string, null, or undefined"),s}function sq(e,t,r){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,t+r,0,0)}function E1(e,t){return e.getTimezoneOffset()-t.getTimezoneOffset()}function iq(e,t){return b1(e,t,"minutes")+E1(e,t)}function oq(e){var t=lr(e,"day");return b1(t,e,"minutes")+E1(t,e)}function lq(e,t){return Hx(e,t,"day")}function cq(e,t,r){var n=df(e,t,"minutes");return n?hf(t,r,"minutes"):Rh(t,r,"minutes")}function sg(e,t){return rq(e,t,"day")}function uq(e){var t=e.evtA,r=t.start,n=t.end,a=t.allDay,s=e.evtB,i=s.start,o=s.end,l=s.allDay,c=+lr(r,"day")-+lr(i,"day"),f=sg(r,n),d=sg(i,o);return c||d-f||!!l-!!a||+r-+i||+n-+o}function fq(e){var t=e.event,r=t.start,n=t.end,a=e.range,s=a.start,i=a.end,o=lr(r,"day"),l=Ul(o,i,"day"),c=Vx(o,n,"minutes"),f=c?Rh(n,s,"minutes"):hf(n,s,"minutes");return l&&f}function dq(e,t){return df(e,t,"day")}function hq(e,t){return G2(e)&&G2(t)}var pq=Gt(function e(t){var r=this;Yt(this,e),Nu(typeof t.format=="function","date localizer `format(..)` must be a function"),Nu(typeof t.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=t.propType||nq,this.formats=t.formats,this.format=function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return aq.apply(void 0,[r,t.format].concat(a))},this.startOfWeek=t.firstOfWeek,this.merge=t.merge||tq,this.inRange=t.inRange||JT,this.lt=t.lt||Hx,this.lte=t.lte||Ul,this.gt=t.gt||Rh,this.gte=t.gte||hf,this.eq=t.eq||df,this.neq=t.neq||Vx,this.startOf=t.startOf||lr,this.endOf=t.endOf||A0,this.add=t.add||aa,this.range=t.range||eq,this.diff=t.diff||b1,this.ceil=t.ceil||ZK,this.min=t.min||qT,this.max=t.max||XT,this.minutes=t.minutes||El,this.daySpan=t.daySpan||sg,this.firstVisibleDay=t.firstVisibleDay||eN,this.lastVisibleDay=t.lastVisibleDay||tN,this.visibleDays=t.visibleDays||QK,this.getSlotDate=t.getSlotDate||sq,this.getTimezoneOffset=t.getTimezoneOffset||function(n){return n.getTimezoneOffset()},this.getDstOffset=t.getDstOffset||E1,this.getTotalMin=t.getTotalMin||iq,this.getMinutesFromMidnight=t.getMinutesFromMidnight||oq,this.continuesPrior=t.continuesPrior||lq,this.continuesAfter=t.continuesAfter||cq,this.sortEvents=t.sortEvents||uq,this.inEventRange=t.inEventRange||fq,this.isSameDate=t.isSameDate||dq,this.startAndEndAreDateOnly=t.startAndEndAreDateOnly||hq,this.segmentOffset=t.browserTZOffset?t.browserTZOffset():0});function mq(e,t,r,n){var a=et(et({},e.formats),r);return et(et({},e),{},{messages:n,startOfWeek:function(){return e.startOfWeek(t)},format:function(i,o){return e.format(i,a[o]||o,t)}})}var vq=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.navigate=function(i){r.props.onNavigate(i)},r.view=function(i){r.props.onView(i)},r}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.localizer.messages,s=n.label;return J.createElement("div",{className:"rbc-toolbar"},J.createElement("span",{className:"rbc-btn-group"},J.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.TODAY)},a.today),J.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.PREVIOUS)},a.previous),J.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.NEXT)},a.next)),J.createElement("span",{className:"rbc-toolbar-label"},s),J.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(a)))}},{key:"viewNamesGroup",value:function(n){var a=this,s=this.props.views,i=this.props.view;if(s.length>1)return s.map(function(o){return J.createElement("button",{type:"button",key:o,className:Ct({"rbc-active":i===o}),onClick:a.view.bind(null,o)},n[o])})}}])}(J.Component);function ct(e,t){e&&e.apply(null,[].concat(t))}var gq={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(t){return"+".concat(t," more")}};function xq(e){return et(et({},gq),e)}function yq(e){var t=e.ref,r=e.callback;O.useEffect(function(){var n=function(s){t.current&&!t.current.contains(s.target)&&r()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[t,r])}var _q=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],rN=function(e){function t(){return Yt(this,t),Sr(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.style,s=n.className,i=n.event,o=n.selected,l=n.isAllDay,c=n.onSelect,f=n.onDoubleClick,d=n.onKeyPress,h=n.localizer,m=n.continuesPrior,v=n.continuesAfter,p=n.accessors,_=n.getters,y=n.children,x=n.components,g=x.event,w=x.eventWrapper,b=n.slotStart,k=n.slotEnd,E=Aa(n,_q);delete E.resizable;var S=p.title(i),T=p.tooltip(i),P=p.end(i),M=p.start(i),L=p.allDay(i),D=l||L||h.diff(M,h.ceil(P,"day"),"day")>1,Q=_.eventProp(i,M,P,o),ee=J.createElement("div",{className:"rbc-event-content",title:T||void 0},g?J.createElement(g,{event:i,continuesPrior:m,continuesAfter:v,title:S,isAllDay:L,localizer:h,slotStart:b,slotEnd:k}):S);return J.createElement(w,Object.assign({},this.props,{type:"date"}),J.createElement("div",Object.assign({},E,{style:et(et({},Q.style),a),className:Ct("rbc-event",s,Q.className,{"rbc-selected":o,"rbc-event-allday":D,"rbc-event-continues-prior":m,"rbc-event-continues-after":v}),onClick:function(q){return c&&c(i,q)},onDoubleClick:function(q){return f&&f(i,q)},onKeyDown:function(q){return d&&d(i,q)}}),typeof y=="function"?y(ee):ee))}}])}(J.Component);function Jh(e,t){return!e||t==null?!1:IU(e,t)}function nN(e,t){var r=e.right-e.left,n=r/t;return n}function aN(e,t,r,n){var a=nN(e,n);return r?n-1-Math.floor((t-e.left)/a):Math.floor((t-e.left)/a)}function wq(e,t){var r=t.x,n=t.y;return n>=e.top&&n<=e.bottom&&r>=e.left&&r<=e.right}function bq(e,t,r,n,a){var s=-1,i=-1,o=n-1,l=nN(t,n),c=aN(t,r.x,a,n),f=t.top<r.y&&t.bottom>r.y,d=t.top<e.y&&t.bottom>e.y,h=e.y>t.bottom,m=t.top>e.y,v=r.top<t.top&&r.bottom>t.bottom;return v&&(s=0,i=o),f&&(m?(s=0,i=c):h&&(s=c,i=o)),d&&(s=i=a?o-Math.floor((e.x-t.left)/l):Math.floor((e.x-t.left)/l),f?c<s?s=c:i=c:e.y<r.y?i=o:s=0),{startIdx:s,endIdx:i}}function Eq(e){var t=e.target,r=e.offset,n=e.container,a=e.box,s=Mi(t),i=s.top,o=s.left,l=s.width,c=s.height,f=Mi(n),d=f.top,h=f.left,m=f.width,v=f.height,p=Mi(a),_=p.width,y=p.height,x=d+v,g=h+m,w=i+y,b=o+_,k=r.x,E=r.y,S=w>x?i-y-E:i+E+c,T=b>g?o+k-_+l:o+k;return{topOffset:S,leftOffset:T}}function Sq(e){var t=e.containerRef,r=e.accessors,n=e.getters,a=e.selected,s=e.components,i=e.localizer,o=e.position,l=e.show,c=e.events,f=e.slotStart,d=e.slotEnd,h=e.onSelect,m=e.onDoubleClick,v=e.onKeyPress,p=e.handleDragStart,_=e.popperRef,y=e.target,x=e.offset;yq({ref:_,callback:l}),O.useLayoutEffect(function(){var b=Eq({target:y,offset:x,container:t.current,box:_.current}),k=b.topOffset,E=b.leftOffset;_.current.style.top="".concat(k,"px"),_.current.style.left="".concat(E,"px")},[x.x,x.y,y]);var g=o.width,w={minWidth:g+g/2};return J.createElement("div",{style:w,className:"rbc-overlay",ref:_},J.createElement("div",{className:"rbc-overlay-header"},i.format(f,"dayHeaderFormat")),c.map(function(b,k){return J.createElement(rN,{key:k,type:"popup",localizer:i,event:b,getters:n,onSelect:h,accessors:r,components:s,onDoubleClick:m,onKeyPress:v,continuesPrior:i.lt(r.end(b),f,"day"),continuesAfter:i.gte(r.start(b),d,"day"),slotStart:f,slotEnd:d,selected:Jh(b,a),draggable:!0,onDragStart:function(){return p(b)},onDragEnd:function(){return l()}})}))}var sN=J.forwardRef(function(e,t){return J.createElement(Sq,Object.assign({},e,{popperRef:t}))});sN.propTypes={accessors:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,components:ue.object.isRequired,localizer:ue.object.isRequired,position:ue.object.isRequired,show:ue.func.isRequired,events:ue.array.isRequired,slotStart:ue.instanceOf(Date).isRequired,slotEnd:ue.instanceOf(Date),onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func,handleDragStart:ue.func,style:ue.object,offset:ue.shape({x:ue.number,y:ue.number})};function kq(e){var t=e.containerRef,r=e.popupOffset,n=r===void 0?5:r,a=e.overlay,s=e.accessors,i=e.localizer,o=e.components,l=e.getters,c=e.selected,f=e.handleSelectEvent,d=e.handleDoubleClickEvent,h=e.handleKeyPressEvent,m=e.handleDragStart,v=e.onHide,p=e.overlayDisplay,_=O.useRef(null);if(!a.position)return null;var y=n;isNaN(n)||(y={x:n,y:n});var x=a.position,g=a.events,w=a.date,b=a.end;return J.createElement(s1,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:v,target:a.target},function(k){var E=k.props;return J.createElement(sN,Object.assign({},E,{containerRef:t,ref:_,target:a.target,offset:y,accessors:s,getters:l,selected:c,components:o,localizer:i,position:x,show:p,events:g,slotStart:w,slotEnd:b,onSelect:f,onDoubleClick:d,onKeyPress:h,handleDragStart:m}))})}var S1=J.forwardRef(function(e,t){return J.createElement(kq,Object.assign({},e,{containerRef:t}))});S1.propTypes={popupOffset:ue.oneOfType([ue.number,ue.shape({x:ue.number,y:ue.number})]),overlay:ue.shape({position:ue.object,events:ue.array,date:ue.instanceOf(Date),end:ue.instanceOf(Date)}),accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,handleSelectEvent:ue.func,handleDoubleClickEvent:ue.func,handleKeyPressEvent:ue.func,handleDragStart:ue.func,onHide:ue.func,overlayDisplay:ue.func};function hr(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return Ac(r,e,t,{passive:!1})}function Tq(e,t,r){return!e||Iu(e,document.elementFromPoint(t,r))}function Cq(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return DC(a,".rbc-event",e)}function Nq(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return DC(a,".rbc-show-more",e)}function M0(e,t){return!!Cq(e,t)}function Aq(e,t){return!!Nq(e,t)}function _c(e){var t=e;return e.touches&&e.touches.length&&(t=e.touches[0]),{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var K2=5,Oq=250,iN=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.global,a=n===void 0?!1:n,s=r.longPressThreshold,i=s===void 0?250:s,o=r.validContainers,l=o===void 0?[]:o;Yt(this,e),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=t,this.globalMouse=!t||a,this.longPressThreshold=i,this.validContainers=l,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=hr("touchmove",function(){},window),this._removeKeyDownListener=hr("keydown",this._keyListener),this._removeKeyUpListener=hr("keyup",this._keyListener),this._removeDropFromOutsideListener=hr("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=hr("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return Gt(e,[{key:"on",value:function(r,n){var a=this._listeners[r]||(this._listeners[r]=[]);return a.push(n),{remove:function(){var i=a.indexOf(n);i!==-1&&a.splice(i,1)}}}},{key:"emit",value:function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];var i,o=this._listeners[r]||[];return o.forEach(function(l){i===void 0&&(i=l.apply(void 0,a))}),i}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(r){var n=this._selectRect;return!n||!this.selecting?!1:q2(n,to(r))}},{key:"filter",value:function(r){var n=this._selectRect;return!n||!this.selecting?[]:r.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(r,n){var a=this,s=null,i=null,o=null,l=function(h){s=setTimeout(function(){f(),r(h)},a.longPressThreshold),i=hr("touchmove",function(){return f()}),o=hr("touchend",function(){return f()})},c=hr("touchstart",l),f=function(){s&&clearTimeout(s),i&&i(),o&&o(),s=null,i=null,o=null};return n&&l(n),function(){f(),c()}}},{key:"_addInitialEventListener",value:function(){var r=this,n=hr("mousedown",function(s){r._removeInitialEventListener(),r._handleInitialEvent(s),r._removeInitialEventListener=hr("mousedown",r._handleInitialEvent)}),a=hr("touchstart",function(s){r._removeInitialEventListener(),r._removeInitialEventListener=r._addLongPressListener(r._handleInitialEvent,s)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(r){var n=_c(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY;this.emit("dropFromOutside",{x:a,y:s,clientX:i,clientY:o}),r.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(r){var n=_c(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY;this.emit("dragOverFromOutside",{x:a,y:s,clientX:i,clientY:o}),r.preventDefault()}},{key:"_handleInitialEvent",value:function(r){if(this._initialEvent=r,!this.isDetached){var n=_c(r),a=n.clientX,s=n.clientY,i=n.pageX,o=n.pageY,l=this.container(),c,f;if(!(r.which===3||r.button===2||!Tq(l,a,s))){if(!this.globalMouse&&l&&!Iu(l,r.target)){var d=Dq(0),h=d.top,m=d.left,v=d.bottom,p=d.right;if(f=to(l),c=q2({top:f.top-h,left:f.left-m,bottom:f.bottom+v,right:f.right+p},{top:o,left:i}),!c)return}var _=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(r.type),x:i,y:o,clientX:a,clientY:s});if(_!==!1)switch(r.type){case"mousedown":this._removeEndListener=hr("mouseup",this._handleTerminatingEvent),this._onEscListener=hr("keydown",this._handleTerminatingEvent),this._removeMoveListener=hr("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(r),this._removeEndListener=hr("touchend",this._handleTerminatingEvent),this._removeMoveListener=hr("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(r){var n=r.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(s){return!!n.closest(s)})}},{key:"_handleTerminatingEvent",value:function(r){var n=this.selecting,a=this._selectRect;if(!n&&r.type.includes("key")&&(r=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!r){var s=!this.container||Iu(this.container(),r.target),i=this._isWithinValidContainer(r);return r.key==="Escape"||!i?this.emit("reset"):!n&&s?this._handleClickEvent(r):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(r){var n=_c(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY,l=new Date().getTime();return this._lastClickData&&l-this._lastClickData.timestamp<Oq?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:s,clientX:i,clientY:o})):(this._lastClickData={timestamp:l},this.emit("click",{x:a,y:s,clientX:i,clientY:o}))}},{key:"_handleMoveEvent",value:function(r){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,s=n.y,i=_c(r),o=i.pageX,l=i.pageY,c=Math.abs(a-o),f=Math.abs(s-l),d=Math.min(o,a),h=Math.min(l,s),m=this.selecting,v=this.isClick(o,l);v&&!m&&!(c||f)||(!m&&!v&&this.emit("selectStart",this._initialEventData),v||(this.selecting=!0,this._selectRect={top:h,left:d,x:o,y:l,right:d+c,bottom:h+f},this.emit("selecting",this._selectRect)),r.preventDefault())}}},{key:"_keyListener",value:function(r){this.ctrl=r.metaKey||r.ctrlKey}},{key:"isClick",value:function(r,n){var a=this._initialEventData,s=a.x,i=a.y,o=a.isTouch;return!o&&Math.abs(r-s)<=K2&&Math.abs(n-i)<=K2}}])}();function Dq(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return fs(e)!=="object"&&(e={top:e,left:e,right:e,bottom:e}),e}function q2(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=to(e),a=n.top,s=n.left,i=n.right,o=i===void 0?s:i,l=n.bottom,c=l===void 0?a:l,f=to(t),d=f.top,h=f.left,m=f.right,v=m===void 0?h:m,p=f.bottom,_=p===void 0?d:p;return!(c-r<d||a+r>_||o-r<h||s+r>v)}function to(e){if(!e.getBoundingClientRect)return e;var t=e.getBoundingClientRect(),r=t.left+X2("left"),n=t.top+X2("top");return{top:n,left:r,right:(e.offsetWidth||0)+r,bottom:(e.offsetHeight||0)+n}}function X2(e){if(e==="left")return window.pageXOffset||document.body.scrollLeft||0;if(e==="top")return window.pageYOffset||document.body.scrollTop||0}var jq=function(e){function t(r,n){var a;return Yt(this,t),a=Sr(this,t,[r,n]),a.state={selecting:!1},a.containerRef=O.createRef(),a}return kr(t,e),Gt(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(n){!n.selectable&&this.props.selectable&&this._selectable(),n.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var n=this.props,a=n.range,s=n.getNow,i=n.getters,o=n.date,l=n.components.dateCellWrapper,c=n.localizer,f=this.state,d=f.selecting,h=f.startIdx,m=f.endIdx,v=s();return J.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},a.map(function(p,_){var y=d&&_>=h&&_<=m,x=i.dayProp(p),g=x.className,w=x.style;return J.createElement(l,{key:_,value:p,range:a},J.createElement("div",{style:w,className:Ct("rbc-day-bg",g,y&&"rbc-selected-cell",c.isSameDate(p,v)&&"rbc-today",o&&c.neq(o,p,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var n=this,a=this.containerRef.current,s=this._selector=new iN(this.props.container,{longPressThreshold:this.props.longPressThreshold}),i=function(l,c){if(!M0(a,l)&&!Aq(a,l)){var f=to(a),d=n.props,h=d.range,m=d.rtl;if(wq(f,l)){var v=aN(f,l.x,m,h.length);n._selectSlot({startIdx:v,endIdx:v,action:c,box:l})}}n._initial={},n.setState({selecting:!1})};s.on("selecting",function(o){var l=n.props,c=l.range,f=l.rtl,d=-1,h=-1;if(n.state.selecting||(ct(n.props.onSelectStart,[o]),n._initial={x:o.x,y:o.y}),s.isSelected(a)){var m=to(a),v=bq(n._initial,m,o,c.length,f);d=v.startIdx,h=v.endIdx}n.setState({selecting:!0,startIdx:d,endIdx:h})}),s.on("beforeSelect",function(o){if(n.props.selectable==="ignoreEvents")return!M0(n.containerRef.current,o)}),s.on("click",function(o){return i(o,"click")}),s.on("doubleClick",function(o){return i(o,"doubleClick")}),s.on("select",function(o){n._selectSlot(et(et({},n.state),{},{action:"select",bounds:o})),n._initial={},n.setState({selecting:!1}),ct(n.props.onSelectEnd,[n.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(n){var a=n.endIdx,s=n.startIdx,i=n.action,o=n.bounds,l=n.box;a!==-1&&s!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:s,end:a,action:i,bounds:o,box:l,resourceId:this.props.resourceId})}}])}(J.Component),xa={propTypes:{slotMetrics:ue.object.isRequired,selected:ue.object,isAllDay:ue.bool,accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func},defaultProps:{segments:[],selected:{}},renderEvent:function(t,r){var n=t.selected;t.isAllDay;var a=t.accessors,s=t.getters,i=t.onSelect,o=t.onDoubleClick,l=t.onKeyPress,c=t.localizer,f=t.slotMetrics,d=t.components,h=t.resizable,m=f.continuesPrior(r),v=f.continuesAfter(r);return J.createElement(rN,{event:r,getters:s,localizer:c,accessors:a,components:d,onSelect:i,onDoubleClick:o,onKeyPress:l,continuesPrior:m,continuesAfter:v,slotStart:f.first,slotEnd:f.last,selected:Jh(r,n),resizable:h})},renderSpan:function(t,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",s=Math.abs(r)/t*100+"%";return J.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:s,flexBasis:s,maxWidth:s}},a)}},oN=function(e){function t(){return Yt(this,t),Sr(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this,a=this.props,s=a.segments,i=a.slotMetrics.slots,o=a.className,l=1;return J.createElement("div",{className:Ct(o,"rbc-row")},s.reduce(function(c,f,d){var h=f.event,m=f.left,v=f.right,p=f.span,_="_lvl_"+d,y=m-l,x=xa.renderEvent(n.props,h);return y&&c.push(xa.renderSpan(i,y,"".concat(_,"_gap"))),c.push(xa.renderSpan(i,p,_,x)),l=v+1,c},[]))}}])}(J.Component);oN.defaultProps=et({},xa.defaultProps);function lN(e){var t=e.dateRange,r=e.unit,n=r===void 0?"day":r,a=e.localizer;return{first:t[0],last:a.add(t[t.length-1],1,n)}}function Pq(e,t,r,n){var a=lN({dateRange:t,localizer:n}),s=a.first,i=a.last,o=n.diff(s,i,"day"),l=n.max(n.startOf(r.start(e),"day"),s),c=n.min(n.ceil(r.end(e),"day"),i),f=LW(t,function(h){return n.isSameDate(h,l)}),d=n.diff(l,c,"day");return d=Math.min(d,o),d=Math.max(d-n.segmentOffset,1),{event:e,span:d,left:f+1,right:Math.max(f+d,1)}}function cN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r,n,a,s=[],i=[];for(r=0;r<e.length;r++){for(a=e[r],n=0;n<s.length&&Fq(a,s[n]);n++);n>=t?i.push(a):(s[n]||(s[n]=[])).push(a)}for(r=0;r<s.length;r++)s[r].sort(function(o,l){return o.left-l.left});return{levels:s,extra:i}}function Bu(e,t,r,n,a){var s={start:n.start(e),end:n.end(e)},i={start:t,end:r};return a.inEventRange({event:s,range:i})}function Fq(e,t){return t.some(function(r){return r.left<=e.right&&r.right>=e.left})}function Rq(e,t,r){var n=Bd(e),a=[],s=[];n.forEach(function(l){var c=t.start(l),f=t.end(l);r.daySpan(c,f)>1?a.push(l):s.push(l)});var i=a.sort(function(l,c){return ig(l,c,t,r)}),o=s.sort(function(l,c){return ig(l,c,t,r)});return[].concat(Bd(i),Bd(o))}function ig(e,t,r,n){var a={start:r.start(e),end:r.end(e),allDay:r.allDay(e)},s={start:r.start(t),end:r.end(t),allDay:r.allDay(t)};return n.sortEvents({evtA:a,evtB:s})}var uN=function(t,r){return t.left<=r&&t.right>=r},J2=function(t,r){return t.filter(function(n){return uN(n,r)}).map(function(n){return n.event})},fN=function(e){function t(){return Yt(this,t),Sr(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){for(var n=this.props,a=n.segments,s=n.slotMetrics.slots,i=cN(a).levels[0],o=1,l=1,c=[];o<=s;){var f="_lvl_"+o,d=i.filter(function(x){return uN(x,o)})[0]||{},h=d.event,m=d.left,v=d.right,p=d.span;if(!h){o++;continue}var _=Math.max(0,m-l);if(this.canRenderSlotEvent(m,p)){var y=xa.renderEvent(this.props,h);_&&c.push(xa.renderSpan(s,_,f+"_gap")),c.push(xa.renderSpan(s,p,f,y)),l=o=v+1}else _&&c.push(xa.renderSpan(s,_,f+"_gap")),c.push(xa.renderSpan(s,1,f,this.renderShowMore(a,o))),l=o=o+1}return J.createElement("div",{className:"rbc-row"},c)}},{key:"canRenderSlotEvent",value:function(n,a){var s=this.props.segments;return XW(n,n+a).every(function(i){var o=J2(s,i).length;return o===1})}},{key:"renderShowMore",value:function(n,a){var s=this,i=this.props,o=i.localizer,l=i.slotMetrics,c=i.components,f=l.getEventsForSlot(a),d=J2(n,a),h=d.length;if(c!=null&&c.showMore){var m=c.showMore,v=l.getDateForSlot(a-1);return h?J.createElement(m,{localizer:o,slotDate:v,slot:a,count:h,events:f,remainingEvents:d}):!1}return h?J.createElement("button",{type:"button",key:"sm_"+a,className:Ct("rbc-button-link","rbc-show-more"),onClick:function(_){return s.showMore(a,_)}},o.messages.showMore(h,d,f)):!1}},{key:"showMore",value:function(n,a){a.preventDefault(),a.stopPropagation(),this.props.onShowMore(n,a.target)}}])}(J.Component);fN.defaultProps=et({},xa.defaultProps);var Mq=function(t){var r=t.children;return J.createElement("div",{className:"rbc-row-content-scroll-container"},r)},Iq=function(t,r){return t.left<=r&&t.right>=r},Lq=function(t,r){return t[0].range===r[0].range&&t[0].events===r[0].events};function dN(){return MC(function(e){for(var t=e.range,r=e.events,n=e.maxRows,a=e.minRows,s=e.accessors,i=e.localizer,o=lN({dateRange:t,localizer:i}),l=o.first,c=o.last,f=r.map(function(p){return Pq(p,t,s,i)}),d=cN(f,Math.max(n-1,1)),h=d.levels,m=d.extra,v=m.length>0?a-1:a;h.length<v;)h.push([]);return{first:l,last:c,levels:h,extra:m,range:t,slots:t.length,clone:function(_){var y=dN();return y(et(et({},e),_))},getDateForSlot:function(_){return t[_]},getSlotForDate:function(_){return t.find(function(y){return i.isSameDate(y,_)})},getEventsForSlot:function(_){return f.filter(function(y){return Iq(y,_)}).map(function(y){return y.event})},continuesPrior:function(_){return i.continuesPrior(s.start(_),l)},continuesAfter:function(_){var y=s.start(_),x=s.end(_);return i.continuesAfter(y,x,c)}}},Lq)}var Uu=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.handleSelectSlot=function(i){var o=r.props,l=o.range,c=o.onSelectSlot;c(l.slice(i.start,i.end+1),i)},r.handleShowMore=function(i,o){var l=r.props,c=l.range,f=l.onShowMore,d=r.slotMetrics(r.props),h=MI(r.containerRef.current,".rbc-row-bg")[0],m;h&&(m=h.children[i-1]);var v=d.getEventsForSlot(i);f(v,c[i-1],m,i,o)},r.getContainer=function(){var i=r.props.container;return i?i():r.containerRef.current},r.renderHeadingCell=function(i,o){var l=r.props,c=l.renderHeader,f=l.getNow,d=l.localizer;return c({date:i,key:"header_".concat(o),className:Ct("rbc-date-cell",d.isSameDate(i,f())&&"rbc-now")})},r.renderDummy=function(){var i=r.props,o=i.className,l=i.range,c=i.renderHeader,f=i.showAllEvents;return J.createElement("div",{className:o,ref:r.containerRef},J.createElement("div",{className:Ct("rbc-row-content",f&&"rbc-row-content-scrollable")},c&&J.createElement("div",{className:"rbc-row",ref:r.headingRowRef},l.map(r.renderHeadingCell)),J.createElement("div",{className:"rbc-row",ref:r.eventRowRef},J.createElement("div",{className:"rbc-row-segment"},J.createElement("div",{className:"rbc-event"},J.createElement("div",{className:"rbc-event-content"},""))))))},r.containerRef=O.createRef(),r.headingRowRef=O.createRef(),r.eventRowRef=O.createRef(),r.slotMetrics=dN(),r}return kr(t,e),Gt(t,[{key:"getRowLimit",value:function(){var n,a=vm(this.eventRowRef.current),s=(n=this.headingRowRef)!==null&&n!==void 0&&n.current?vm(this.headingRowRef.current):0,i=vm(this.containerRef.current)-s;return Math.max(Math.floor(i/a),1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.rtl,i=n.range,o=n.className,l=n.selected,c=n.selectable,f=n.renderForMeasure,d=n.accessors,h=n.getters,m=n.components,v=n.getNow,p=n.renderHeader,_=n.onSelect,y=n.localizer,x=n.onSelectStart,g=n.onSelectEnd,w=n.onDoubleClick,b=n.onKeyPress,k=n.resourceId,E=n.longPressThreshold,S=n.isAllDay,T=n.resizable,P=n.showAllEvents;if(f)return this.renderDummy();var M=this.slotMetrics(this.props),L=M.levels,D=M.extra,Q=P?Mq:Va,ee=m.weekWrapper,Y={selected:l,accessors:d,getters:h,localizer:y,components:m,onSelect:_,onDoubleClick:w,onKeyPress:b,resourceId:k,slotMetrics:M,resizable:T};return J.createElement("div",{className:o,role:"rowgroup",ref:this.containerRef},J.createElement(jq,{localizer:y,date:a,getNow:v,rtl:s,range:i,selectable:c,container:this.getContainer,getters:h,onSelectStart:x,onSelectEnd:g,onSelectSlot:this.handleSelectSlot,components:m,longPressThreshold:E,resourceId:k}),J.createElement("div",{className:Ct("rbc-row-content",P&&"rbc-row-content-scrollable"),role:"row"},p&&J.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},i.map(this.renderHeadingCell)),J.createElement(Q,null,J.createElement(ee,Object.assign({isAllDay:S},Y,{rtl:this.props.rtl}),L.map(function(q,G){return J.createElement(oN,Object.assign({key:G,segments:q},Y))}),!!D.length&&J.createElement(fN,Object.assign({segments:D,onShowMore:this.handleShowMore},Y))))))}}])}(J.Component);Uu.defaultProps={minRows:0,maxRows:1/0};var k1=function(t){var r=t.label;return J.createElement("span",{role:"columnheader","aria-sort":"none"},r)},$q=function(t){var r=t.label,n=t.drilldownView,a=t.onDrillDown;return n?J.createElement("button",{type:"button",className:"rbc-button-link",onClick:a},r):J.createElement("span",null,r)},Bq=["date","className"],Uq=function(t,r,n,a,s){return t.filter(function(i){return Bu(i,r,n,a,s)})},Qh=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.getContainer=function(){return r.containerRef.current},r.renderWeek=function(i,o){var l=r.props,c=l.events,f=l.components,d=l.selectable,h=l.getNow,m=l.selected,v=l.date,p=l.localizer,_=l.longPressThreshold,y=l.accessors,x=l.getters,g=l.showAllEvents,w=r.state,b=w.needLimitMeasure,k=w.rowLimit,E=Uq(Bd(c),i[0],i[i.length-1],y,p),S=Rq(E,y,p);return J.createElement(Uu,{key:o,ref:o===0?r.slotRowRef:void 0,container:r.getContainer,className:"rbc-month-row",getNow:h,date:v,range:i,events:S,maxRows:g?1/0:k,selected:m,selectable:d,components:f,accessors:y,getters:x,localizer:p,renderHeader:r.readerDateHeading,renderForMeasure:b,onShowMore:r.handleShowMore,onSelect:r.handleSelectEvent,onDoubleClick:r.handleDoubleClickEvent,onKeyPress:r.handleKeyPressEvent,onSelectSlot:r.handleSelectSlot,longPressThreshold:_,rtl:r.props.rtl,resizable:r.props.resizable,showAllEvents:g})},r.readerDateHeading=function(i){var o=i.date,l=i.className,c=Aa(i,Bq),f=r.props,d=f.date,h=f.getDrilldownView,m=f.localizer,v=m.neq(o,d,"month"),p=m.isSameDate(o,d),_=h(o),y=m.format(o,"dateFormat"),x=r.props.components.dateHeader||$q;return J.createElement("div",Object.assign({},c,{className:Ct(l,v&&"rbc-off-range",p&&"rbc-current"),role:"cell"}),J.createElement(x,{label:y,date:o,drilldownView:_,isOffRange:v,onDrillDown:function(w){return r.handleHeadingClick(o,_,w)}}))},r.handleSelectSlot=function(i,o){r._pendingSelection=r._pendingSelection.concat(i),clearTimeout(r._selectTimer),r._selectTimer=setTimeout(function(){return r.selectDates(o)})},r.handleHeadingClick=function(i,o,l){l.preventDefault(),r.clearSelection(),ct(r.props.onDrillDown,[i,o])},r.handleSelectEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r.handleDoubleClickEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r.handleKeyPressEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.handleShowMore=function(i,o,l,c,f){var d=r.props,h=d.popup,m=d.onDrillDown,v=d.onShowMore,p=d.getDrilldownView,_=d.doShowMoreDrillDown;if(r.clearSelection(),h){var y=uC(l,r.containerRef.current);r.setState({overlay:{date:o,events:i,position:y,target:f}})}else _&&ct(m,[o,p(o)||Pt.DAY]);ct(v,[i,o,c])},r.overlayDisplay=function(){r.setState({overlay:null})},r.state={rowLimit:5,needLimitMeasure:!0,date:null},r.containerRef=O.createRef(),r.slotRowRef=O.createRef(),r._bgRows=[],r._pendingSelection=[],r}return kr(t,e),Gt(t,[{key:"componentDidMount",value:function(){var n=this,a;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){a||fC(function(){a=!1,n.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.className,o=s.visibleDays(a,s),l=_I(o,7);return this._weekCount=l.length,J.createElement("div",{className:Ct("rbc-month-view",i),role:"table","aria-label":"Month View",ref:this.containerRef},J.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(l[0])),l.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(n){var a=this.props,s=a.localizer,i=a.components,o=n[0],l=n[n.length-1],c=i.header||k1;return s.range(o,l,"day").map(function(f,d){return J.createElement("div",{key:"header_"+d,className:"rbc-header"},J.createElement(c,{date:f,localizer:s,label:s.format(f,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var n,a,s=this,i=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},o=this.props,l=o.accessors,c=o.localizer,f=o.components,d=o.getters,h=o.selected,m=o.popupOffset,v=o.handleDragStart,p=function(){return s.setState({overlay:null})};return J.createElement(S1,{overlay:i,accessors:l,localizer:c,components:f,getters:d,selected:h,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!i.position,overlayDisplay:this.overlayDisplay,onHide:p})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(n){var a=this._pendingSelection.slice();this._pendingSelection=[],a.sort(function(o,l){return+o-+l});var s=new Date(a[0]),i=new Date(a[a.length-1]);i.setDate(a[a.length-1].getDate()+1),ct(this.props.onSelectSlot,{slots:a,start:s,end:i,action:n.action,bounds:n.bounds,box:n.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(n,a){var s=n.date,i=n.localizer;return{date:s,needLimitMeasure:i.neq(s,a.date,"month")}}}])}(J.Component);Qh.range=function(e,t){var r=t.localizer,n=r.firstVisibleDay(e,r),a=r.lastVisibleDay(e,r);return{start:n,end:a}};Qh.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"month");case qr.NEXT:return n.add(e,1,"month");default:return e}};Qh.title=function(e,t){var r=t.localizer;return r.format(e,"monthHeaderFormat")};var Q2=function(t){var r=t.min,n=t.max,a=t.step,s=t.slots,i=t.localizer;return"".concat(+i.startOf(r,"minutes"))+"".concat(+i.startOf(n,"minutes"))+"".concat(a,"-").concat(s)};function T1(e){for(var t=e.min,r=e.max,n=e.step,a=e.timeslots,s=e.localizer,i=Q2({start:t,end:r,step:n,timeslots:a,localizer:s}),o=1+s.getTotalMin(t,r),l=s.getMinutesFromMidnight(t),c=Math.ceil((o-1)/(n*a)),f=c*a,d=new Array(c),h=new Array(f),m=0;m<c;m++){d[m]=new Array(a);for(var v=0;v<a;v++){var p=m*a+v,_=p*n;h[p]=d[m][v]=s.getSlotDate(t,l,_)}}var y=h.length*n;h.push(s.getSlotDate(t,l,y));function x(g){var w=s.diff(t,g,"minutes")+s.getDstOffset(t,g);return Math.min(w,o)}return{groups:d,update:function(w){return Q2(w)!==i?T1(w):this},dateIsInGroup:function(w,b){var k=d[b+1];return s.inRange(w,d[b][0],k?k[0]:r,"minutes")},nextSlot:function(w){var b=h[Math.min(h.findIndex(function(k){return k===w||s.eq(k,w)})+1,h.length-1)];return s.eq(b,w)&&(b=s.add(w,n,"minutes")),b},closestSlotToPosition:function(w){var b=Math.min(h.length-1,Math.max(0,Math.floor(w*f)));return h[b]},closestSlotFromPoint:function(w,b){var k=Math.abs(b.top-b.bottom);return this.closestSlotToPosition((w.y-b.top)/k)},closestSlotFromDate:function(w){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(s.lt(w,t,"minutes"))return h[0];if(s.gt(w,r,"minutes"))return h[h.length-1];var k=s.diff(t,w,"minutes");return h[(k-k%n)/n+b]},startsBeforeDay:function(w){return s.lt(w,t,"day")},startsAfterDay:function(w){return s.gt(w,r,"day")},startsBefore:function(w){return s.lt(s.merge(t,w),t,"minutes")},startsAfter:function(w){return s.gt(s.merge(r,w),r,"minutes")},getRange:function(w,b,k,E){k||(w=s.min(r,s.max(t,w))),E||(b=s.min(r,s.max(t,b)));var S=x(w),T=x(b),P=T>n*f&&!s.eq(r,b)?(S-n)/(n*f)*100:S/(n*f)*100;return{top:P,height:T/(n*f)*100-P,start:x(w),startDate:w,end:x(b),endDate:b}},getCurrentTimePosition:function(w){var b=x(w),k=b/(n*f)*100;return k}}}var Wq=function(){function e(t,r){var n=r.accessors,a=r.slotMetrics;Yt(this,e);var s=a.getRange(n.start(t),n.end(t)),i=s.start,o=s.startDate,l=s.end,c=s.endDate,f=s.top,d=s.height;this.start=i,this.end=l,this.startMs=+o,this.endMs=+c,this.top=f,this.height=d,this.data=t}return Gt(e,[{key:"_width",get:function(){if(this.rows){var r=this.rows.reduce(function(a,s){return Math.max(a,s.leaves.length+1)},0)+1;return 100/r}if(this.leaves){var n=100-this.container._width;return n/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var r=this._width,n=Math.min(100,this._width*1.7);if(this.rows)return n;if(this.leaves)return this.leaves.length>0?n:r;var a=this.row.leaves,s=a.indexOf(this);return s===a.length-1?r:n}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var r=this.row,n=r.leaves,a=r.xOffset,s=r._width,i=n.indexOf(this)+1;return a+i*s}}])}();function Vq(e,t,r){return Math.abs(t.start-e.start)<r||t.start>e.start&&t.start<e.end}function Hq(e){for(var t=vH(e,["startMs",function(o){return-o.endMs}]),r=[];t.length>0;){var n=t.shift();r.push(n);for(var a=0;a<t.length;a++){var s=t[a];if(!(n.endMs>s.startMs)){if(a>0){var i=t.splice(a,1)[0];r.push(i)}break}}}return r}function hN(e){for(var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=t.map(function(f){return new Wq(f,{slotMetrics:n,accessors:a})}),i=Hq(s),o=[],l=function(){var d=i[c],h=o.find(function(p){return p.end>d.start||Math.abs(d.start-p.start)<r});if(!h)return d.rows=[],o.push(d),1;d.container=h;for(var m=null,v=h.rows.length-1;!m&&v>=0;v--)Vq(h.rows[v],d,r)&&(m=h.rows[v]);m?(m.leaves.push(d),d.row=m):(d.leaves=[],h.rows.push(d))},c=0;c<i.length;c++)l();return i.map(function(f){return{event:f.data,style:{top:f.top,height:f.height,width:f.width,xOffset:Math.max(0,f.xOffset)}}})}function pN(e,t,r){for(var n=0;n<e.friends.length;++n)if(!(r.indexOf(e.friends[n])>-1)){t=t>e.friends[n].idx?t:e.friends[n].idx,r.push(e.friends[n]);var a=pN(e.friends[n],t,r);t=t>a?t:a}return t}function zq(e){var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=hN({events:t,minimumStartDifference:r,slotMetrics:n,accessors:a});s.sort(function(ee,Y){return ee=ee.style,Y=Y.style,ee.top!==Y.top?ee.top>Y.top?1:-1:ee.height!==Y.height?ee.top+ee.height<Y.top+Y.height?1:-1:0});for(var i=0;i<s.length;++i)s[i].friends=[],delete s[i].style.left,delete s[i].style.left,delete s[i].idx,delete s[i].size;for(var o=0;o<s.length-1;++o)for(var l=s[o],c=l.style.top,f=l.style.top+l.style.height,d=o+1;d<s.length;++d){var h=s[d],m=h.style.top,v=h.style.top+h.style.height;(m>=c&&v<=f||v>c&&v<=f||m>=c&&m<f)&&(l.friends.push(h),h.friends.push(l))}for(var p=0;p<s.length;++p){for(var _=s[p],y=[],x=0;x<100;++x)y.push(1);for(var g=0;g<_.friends.length;++g)_.friends[g].idx!==void 0&&(y[_.friends[g].idx]=0);_.idx=y.indexOf(1)}for(var w=0;w<s.length;++w){var b=0;if(!s[w].size){var k=[],E=pN(s[w],0,k);b=100/(E+1),s[w].size=b;for(var S=0;S<k.length;++S)k[S].size=b}}for(var T=0;T<s.length;++T){var P=s[T];P.style.left=P.idx*P.size;for(var M=0,L=0;L<P.friends.length;++L){var D=P.friends[L].idx;M=M>D?M:D}M<=P.idx&&(P.size=100-P.idx*P.size);var Q=P.idx===0?0:3;P.style.width="calc(".concat(P.size,"% - ").concat(Q,"px)"),P.style.height="calc(".concat(P.style.height,"% - 2px)"),P.style.xOffset="calc(".concat(P.style.left,"% + ").concat(Q,"px)")}return s}var Z2={overlap:hN,"no-overlap":zq};function Yq(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Gq(e){e.events,e.minimumStartDifference,e.slotMetrics,e.accessors;var t=e.dayLayoutAlgorithm,r=t;return t in Z2&&(r=Z2[t]),Yq(r)?r.apply(this,arguments):[]}var mN=function(e){function t(){return Yt(this,t),Sr(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.renderSlot,s=n.resource,i=n.group,o=n.getters,l=n.components,c=l===void 0?{}:l,f=c.timeSlotWrapper,d=f===void 0?Va:f,h=o?o.slotGroupProp(i):{};return J.createElement("div",Object.assign({className:"rbc-timeslot-group"},h),i.map(function(m,v){var p=o?o.slotProp(m,s):{};return J.createElement(d,{key:v,value:m,resource:s},J.createElement("div",Object.assign({},p,{className:Ct("rbc-time-slot",p.className)}),a&&a(m,v)))}))}}])}(O.Component);function dd(e){return typeof e=="string"?e:e+"%"}function Kq(e){var t=e.style,r=e.className,n=e.event,a=e.accessors,s=e.rtl,i=e.selected,o=e.label,l=e.continuesPrior,c=e.continuesAfter,f=e.getters,d=e.onClick,h=e.onDoubleClick,m=e.isBackgroundEvent,v=e.onKeyPress,p=e.components,_=p.event,y=p.eventWrapper,x=a.title(n),g=a.tooltip(n),w=a.end(n),b=a.start(n),k=f.eventProp(n,b,w,i),E=[J.createElement("div",{key:"1",className:"rbc-event-label"},o),J.createElement("div",{key:"2",className:"rbc-event-content"},_?J.createElement(_,{event:n,title:x}):x)],S=t.height,T=t.top,P=t.width,M=t.xOffset,L=et(et({},k.style),{},Ci({top:dd(T),height:dd(S),width:dd(P)},s?"right":"left",dd(M)));return J.createElement(y,Object.assign({type:"time"},e),J.createElement("div",{role:"button",tabIndex:0,onClick:d,onDoubleClick:h,style:L,onKeyDown:v,title:g?(typeof o=="string"?o+": ":"")+g:void 0,className:Ct(m?"rbc-background-event":"rbc-event",r,k.className,{"rbc-selected":i,"rbc-event-continues-earlier":l,"rbc-event-continues-later":c})},E))}var qq=function(t){var r=t.children,n=t.className,a=t.style,s=t.innerRef;return J.createElement("div",{className:n,style:a,ref:s},r)},Xq=J.forwardRef(function(e,t){return J.createElement(qq,Object.assign({},e,{innerRef:t}))}),Jq=["dayProp"],Qq=["eventContainerWrapper"],vN=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.state={selecting:!1,timeIndicatorPosition:null},r.intervalTriggered=!1,r.renderEvents=function(i){var o=i.events,l=i.isBackgroundEvent,c=r.props,f=c.rtl,d=c.selected,h=c.accessors,m=c.localizer,v=c.getters,p=c.components,_=c.step,y=c.timeslots,x=c.dayLayoutAlgorithm,g=c.resizable,w=r,b=w.slotMetrics,k=m.messages,E=Gq({events:o,accessors:h,slotMetrics:b,minimumStartDifference:Math.ceil(_*y/2),dayLayoutAlgorithm:x});return E.map(function(S,T){var P,M=S.event,L=S.style,D=h.end(M),Q=h.start(M),ee=(P=h.eventId(M))!==null&&P!==void 0?P:"evt_"+T,Y="eventTimeRangeFormat",q,G=b.startsBeforeDay(Q),V=b.startsAfterDay(D);G?Y="eventTimeRangeEndFormat":V&&(Y="eventTimeRangeStartFormat"),G&&V?q=k.allDay:q=m.format({start:Q,end:D},Y);var ae=G||b.startsBefore(Q),B=V||b.startsAfter(D);return J.createElement(Kq,{style:L,event:M,label:q,key:ee,getters:v,rtl:f,components:p,continuesPrior:ae,continuesAfter:B,accessors:h,resource:r.props.resource,selected:Jh(M,d),onClick:function(I){return r._select(et(et(et({},M),r.props.resource&&{sourceResource:r.props.resource}),l&&{isBackgroundEvent:!0}),I)},onDoubleClick:function(I){return r._doubleClick(M,I)},isBackgroundEvent:l,onKeyPress:function(I){return r._keyPress(M,I)},resizable:g})})},r._selectable=function(){var i=r.containerRef.current,o=r.props,l=o.longPressThreshold,c=o.localizer,f=r._selector=new iN(function(){return i},{longPressThreshold:l}),d=function(p){var _=r.props.onSelecting,y=r.state||{},x=h(p),g=x.startDate,w=x.endDate;_&&(c.eq(y.startDate,g,"minutes")&&c.eq(y.endDate,w,"minutes")||_({start:g,end:w,resourceId:r.props.resource})===!1)||(r.state.start!==x.start||r.state.end!==x.end||r.state.selecting!==x.selecting)&&r.setState(x)},h=function(p){var _=r.slotMetrics.closestSlotFromPoint(p,to(i));r.state.selecting||(r._initialSlot=_);var y=r._initialSlot;c.lte(y,_)?_=r.slotMetrics.nextSlot(_):c.gt(y,_)&&(y=r.slotMetrics.nextSlot(y));var x=r.slotMetrics.getRange(c.min(y,_),c.max(y,_));return et(et({},x),{},{selecting:!0,top:"".concat(x.top,"%"),height:"".concat(x.height,"%")})},m=function(p,_){if(!M0(r.containerRef.current,p)){var y=h(p),x=y.startDate,g=y.endDate;r._selectSlot({startDate:x,endDate:g,action:_,box:p})}r.setState({selecting:!1})};f.on("selecting",d),f.on("selectStart",d),f.on("beforeSelect",function(v){if(r.props.selectable==="ignoreEvents")return!M0(r.containerRef.current,v)}),f.on("click",function(v){return m(v,"click")}),f.on("doubleClick",function(v){return m(v,"doubleClick")}),f.on("select",function(v){r.state.selecting&&(r._selectSlot(et(et({},r.state),{},{action:"select",bounds:v})),r.setState({selecting:!1}))}),f.on("reset",function(){r.state.selecting&&r.setState({selecting:!1})})},r._teardownSelectable=function(){r._selector&&(r._selector.teardown(),r._selector=null)},r._selectSlot=function(i){for(var o=i.startDate,l=i.endDate,c=i.action,f=i.bounds,d=i.box,h=o,m=[];r.props.localizer.lte(h,l);)m.push(h),h=new Date(+h+r.props.step*60*1e3);ct(r.props.onSelectSlot,{slots:m,start:o,end:l,resourceId:r.props.resource,action:c,bounds:f,box:d})},r._select=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r._doubleClick=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r._keyPress=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.slotMetrics=T1(r.props),r.containerRef=O.createRef(),r}return kr(t,e),Gt(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(n,a){this.props.selectable&&!n.selectable&&this._selectable(),!this.props.selectable&&n.selectable&&this._teardownSelectable();var s=this.props,i=s.getNow,o=s.isNow,l=s.localizer,c=s.date,f=s.min,d=s.max,h=l.neq(n.getNow(),i(),"minutes");if(n.isNow!==o||h){if(this.clearTimeIndicatorInterval(),o){var m=!h&&l.eq(n.date,c,"minutes")&&a.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(m)}}else o&&(l.neq(n.min,f,"minutes")||l.neq(n.max,d,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!a&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){n.intervalTriggered=!0,n.positionTimeIndicator(),n.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var n=this.props,a=n.min,s=n.max,i=n.getNow,o=i();if(o>=a&&o<=s){var l=this.slotMetrics.getCurrentTimePosition(o);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:l})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.max,i=n.rtl,o=n.isNow,l=n.resource,c=n.accessors,f=n.localizer,d=n.getters,h=d.dayProp,m=Aa(d,Jq),v=n.components,p=v.eventContainerWrapper,_=Aa(v,Qq);this.slotMetrics=this.slotMetrics.update(this.props);var y=this.slotMetrics,x=this.state,g=x.selecting,w=x.top,b=x.height,k=x.startDate,E=x.endDate,S={start:k,end:E},T=h(s,l),P=T.className,M=T.style,L=_.dayColumnWrapper||Xq;return J.createElement(L,{ref:this.containerRef,date:a,style:M,className:Ct(P,"rbc-day-slot","rbc-time-column",o&&"rbc-now",o&&"rbc-today",g&&"rbc-slot-selecting"),slotMetrics:y,resource:l},y.groups.map(function(D,Q){return J.createElement(mN,{key:Q,group:D,resource:l,getters:m,components:_})}),J.createElement(p,{localizer:f,resource:l,accessors:c,getters:m,components:_,slotMetrics:y},J.createElement("div",{className:Ct("rbc-events-container",i&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),g&&J.createElement("div",{className:"rbc-slot-selection",style:{top:w,height:b}},J.createElement("span",null,f.format(S,"selectRangeFormat"))),o&&this.intervalTriggered&&J.createElement("div",{className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}}))}}])}(J.Component);vN.defaultProps={dragThroughEvents:!0,timeslots:2};var gN=function(t){var r=t.label;return J.createElement(J.Fragment,null,r)},Zq=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.handleHeaderClick=function(i,o,l){l.preventDefault(),ct(r.props.onDrillDown,[i,o])},r.renderRow=function(i){var o=r.props,l=o.events,c=o.rtl,f=o.selectable,d=o.getNow,h=o.range,m=o.getters,v=o.localizer,p=o.accessors,_=o.components,y=o.resizable,x=p.resourceId(i),g=i?l.filter(function(w){return p.resource(w)===x}):l;return J.createElement(Uu,{isAllDay:!0,rtl:c,getNow:d,minRows:2,maxRows:r.props.allDayMaxRows+1,range:h,events:g,resourceId:x,className:"rbc-allday-cell",selectable:f,selected:r.props.selected,components:_,accessors:p,getters:m,localizer:v,onSelect:r.props.onSelectEvent,onShowMore:r.props.onShowMore,onDoubleClick:r.props.onDoubleClickEvent,onKeyPress:r.props.onKeyPressEvent,onSelectSlot:r.props.onSelectSlot,longPressThreshold:r.props.longPressThreshold,resizable:y})},r}return kr(t,e),Gt(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,i=s.localizer,o=s.getDrilldownView,l=s.getNow,c=s.getters.dayProp,f=s.components.header,d=f===void 0?k1:f,h=l();return n.map(function(m,v){var p=o(m),_=i.format(m,"dayFormat"),y=c(m),x=y.className,g=y.style,w=J.createElement(d,{date:m,label:_,localizer:i});return J.createElement("div",{key:v,style:g,className:Ct("rbc-header",x,i.isSameDate(m,h)&&"rbc-today")},p?J.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(k){return a.handleHeaderClick(m,p,k)}},w):J.createElement("span",null,w))})}},{key:"render",value:function(){var n=this,a=this.props,s=a.width,i=a.rtl,o=a.resources,l=a.range,c=a.events,f=a.getNow,d=a.accessors,h=a.selectable,m=a.components,v=a.getters,p=a.scrollRef,_=a.localizer,y=a.isOverflowing,x=a.components,g=x.timeGutterHeader,w=x.resourceHeader,b=w===void 0?gN:w,k=a.resizable,E={};y&&(E[i?"marginLeft":"marginRight"]="".concat(a1()-1,"px"));var S=o.groupEvents(c);return J.createElement("div",{style:E,ref:p,className:Ct("rbc-time-header",y&&"rbc-overflowing")},J.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:s,minWidth:s,maxWidth:s}},g&&J.createElement(g,null)),o.map(function(T,P){var M=wn(T,2),L=M[0],D=M[1];return J.createElement("div",{className:"rbc-time-header-content",key:L||P},D&&J.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(P)},J.createElement("div",{className:"rbc-header"},J.createElement(b,{index:P,label:d.resourceTitle(D),resource:D}))),J.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(l.length<=1?" rbc-time-header-cell-single-day":"")},n.renderHeaderCells(l)),J.createElement(Uu,{isAllDay:!0,rtl:i,getNow:f,minRows:2,maxRows:n.props.allDayMaxRows+1,range:l,events:S.get(L)||[],resourceId:D&&L,className:"rbc-allday-cell",selectable:h,selected:n.props.selected,components:m,accessors:d,getters:v,localizer:_,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:k}))}))}}])}(J.Component),eX=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.handleHeaderClick=function(i,o,l){l.preventDefault(),ct(r.props.onDrillDown,[i,o])},r}return kr(t,e),Gt(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,i=s.localizer,o=s.getDrilldownView,l=s.getNow,c=s.getters.dayProp,f=s.components,d=f.header,h=d===void 0?k1:d,m=f.resourceHeader,v=m===void 0?gN:m,p=s.resources,_=s.accessors,y=s.events,x=s.rtl,g=s.selectable,w=s.components,b=s.getters,k=s.resizable,E=l(),S=p.groupEvents(y);return n.map(function(T,P){var M=o(T),L=i.format(T,"dayFormat"),D=c(T),Q=D.className,ee=D.style,Y=J.createElement(h,{date:T,label:L,localizer:i});return J.createElement("div",{key:P,className:"rbc-time-header-content rbc-resource-grouping"},J.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(n.length<=1?" rbc-time-header-cell-single-day":"")},J.createElement("div",{style:ee,className:Ct("rbc-header",Q,i.isSameDate(T,E)&&"rbc-today")},M?J.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(G){return a.handleHeaderClick(T,M,G)}},Y):J.createElement("span",null,Y))),J.createElement("div",{className:"rbc-row"},p.map(function(q,G){var V=wn(q,2),ae=V[0],B=V[1];return J.createElement("div",{key:"resource_".concat(ae,"_").concat(G),className:Ct("rbc-header",Q,i.isSameDate(T,E)&&"rbc-today")},J.createElement(v,{index:G,label:_.resourceTitle(B),resource:B}))})),J.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},p.map(function(q,G){var V=wn(q,2),ae=V[0],B=V[1],C=(S.get(ae)||[]).filter(function(I){return i.isSameDate(I.start,T)||i.isSameDate(I.end,T)});return J.createElement(Uu,{key:"resource_".concat(ae,"_").concat(G),isAllDay:!0,rtl:x,getNow:l,minRows:2,maxRows:a.props.allDayMaxRows+1,range:[T],events:C,resourceId:B&&ae,className:"rbc-allday-cell",selectable:g,selected:a.props.selected,components:w,accessors:_,getters:b,localizer:i,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:k})})))})}},{key:"render",value:function(){var n=this.props,a=n.width,s=n.rtl,i=n.range,o=n.scrollRef,l=n.isOverflowing,c=n.components.timeGutterHeader,f={};return l&&(f[s?"marginLeft":"marginRight"]="".concat(a1()-1,"px")),J.createElement("div",{style:f,ref:o,className:Ct("rbc-time-header",l&&"rbc-overflowing")},J.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:a,minWidth:a,maxWidth:a}},c&&J.createElement(c,null)),this.renderHeaderCells(i))}}])}(J.Component);function tX(e){var t=e.min,r=e.max,n=e.localizer;return n.getTimezoneOffset(t)!==n.getTimezoneOffset(r)?{start:n.add(t,-1,"day"),end:n.add(r,-1,"day")}:{start:t,end:r}}var rX=function(t){var r=t.min,n=t.max,a=t.timeslots,s=t.step,i=t.localizer,o=t.getNow,l=t.resource,c=t.components,f=t.getters,d=t.gutterRef,h=c.timeGutterWrapper,m=O.useMemo(function(){return tX({min:r,max:n,localizer:i})},[r==null?void 0:r.toISOString(),n==null?void 0:n.toISOString(),i]),v=m.start,p=m.end,_=O.useState(T1({min:v,max:p,timeslots:a,step:s,localizer:i})),y=wn(_,2),x=y[0],g=y[1];O.useEffect(function(){x&&g(x.update({min:v,max:p,timeslots:a,step:s,localizer:i}))},[v==null?void 0:v.toISOString(),p==null?void 0:p.toISOString(),a,s]);var w=O.useCallback(function(b,k){if(k)return null;var E=x.dateIsInGroup(o(),k);return J.createElement("span",{className:Ct("rbc-label",E&&"rbc-now")},i.format(b,"timeGutterFormat"))},[x,i,o]);return J.createElement(h,{slotMetrics:x},J.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:d},x.groups.map(function(b,k){return J.createElement(mN,{key:k,group:b,resource:l,components:c,renderSlot:w,getters:f})})))},nX=J.forwardRef(function(e,t){return J.createElement(rX,Object.assign({gutterRef:t},e))}),ym={};function aX(e,t){return{map:function(n){return e?e.map(function(a,s){return n([t.resourceId(a),a],s)}):[n([ym,null],0)]},groupEvents:function(n){var a=new Map;return e?(n.forEach(function(s){var i=t.resource(s)||ym;if(Array.isArray(i))i.forEach(function(l){var c=a.get(l)||[];c.push(s),a.set(l,c)});else{var o=a.get(i)||[];o.push(s),a.set(i,o)}}),a):(a.set(ym,n),a)}}}var Xl=function(e){function t(r){var n;return Yt(this,t),n=Sr(this,t,[r]),n.handleScroll=function(a){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=a.target.scrollLeft)},n.handleResize=function(){Lw(n.rafHandle),n.rafHandle=fC(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onKeyPressEvent,s)},n.handleSelectEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onSelectEvent,s)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onDoubleClickEvent,s)},n.handleShowMore=function(a,s,i,o,l){var c=n.props,f=c.popup,d=c.onDrillDown,h=c.onShowMore,m=c.getDrilldownView,v=c.doShowMoreDrillDown;if(n.clearSelection(),f){var p=uC(i,n.containerRef.current);n.setState({overlay:{date:s,events:a,position:et(et({},p),{},{width:"200px"}),target:l}})}else v&&ct(d,[s,m(s)||Pt.DAY]);ct(h,[a,s,o])},n.handleSelectAllDaySlot=function(a,s){var i=n.props.onSelectSlot,o=new Date(a[0]),l=new Date(a[a.length-1]);l.setDate(a[a.length-1].getDate()+1),ct(i,{slots:a,start:o,end:l,action:s.action,resourceId:s.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var a=n.contentRef.current;if(a!=null&&a.scrollHeight){var s=a.scrollHeight>a.clientHeight;n.state.isOverflowing!==s&&(n._updatingOverflow=!0,n.setState({isOverflowing:s},function(){n._updatingOverflow=!1}))}}},n.memoizedResources=MC(function(a,s){return aX(a,s)}),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=J.createRef(),n.contentRef=J.createRef(),n.containerRef=J.createRef(),n._scrollRatio=null,n.gutterRef=O.createRef(),n}return kr(t,e),Gt(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),Lw(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(n,a,s,i,o,l,c,f,d,h){var m=this.props,v=m.min,p=m.max,_=(i.get(a)||[]).filter(function(x){return l.inRange(n,c.start(x),c.end(x),"day")}),y=(o.get(a)||[]).filter(function(x){return l.inRange(n,c.start(x),c.end(x),"day")});return J.createElement(vN,Object.assign({},this.props,{localizer:l,min:l.merge(n,v),max:l.merge(n,p),resource:s&&a,components:f,isNow:l.isSameDate(n,h),key:"".concat(a,"-").concat(n),date:n,events:_,backgroundEvents:y,dayLayoutAlgorithm:d}))}},{key:"renderResourcesFirst",value:function(n,a,s,i,o,l,c,f,d){var h=this;return a.map(function(m){var v=wn(m,2),p=v[0],_=v[1];return n.map(function(y){return h.renderDayColumn(y,p,_,s,i,o,l,f,d,c)})})}},{key:"renderRangeFirst",value:function(n,a,s,i,o,l,c,f,d){var h=this;return n.map(function(m){return J.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:m},a.map(function(v){var p=wn(v,2),_=p[0],y=p[1];return J.createElement("div",{style:{flex:1},key:l.resourceId(y)},h.renderDayColumn(m,_,y,s,i,o,l,f,d,c))}))})}},{key:"renderEvents",value:function(n,a,s,i){var o=this.props,l=o.accessors,c=o.localizer,f=o.resourceGroupingLayout,d=o.components,h=o.dayLayoutAlgorithm,m=this.memoizedResources(this.props.resources,l),v=m.groupEvents(a),p=m.groupEvents(s);return f?this.renderRangeFirst(n,m,v,p,c,l,i,d,h):this.renderResourcesFirst(n,m,v,p,c,l,i,d,h)}},{key:"render",value:function(){var n,a=this.props,s=a.events,i=a.backgroundEvents,o=a.range,l=a.width,c=a.rtl,f=a.selected,d=a.getNow,h=a.resources,m=a.components,v=a.accessors,p=a.getters,_=a.localizer,y=a.min,x=a.max,g=a.showMultiDayTimes,w=a.longPressThreshold,b=a.resizable,k=a.resourceGroupingLayout;l=l||this.state.gutterWidth;var E=o[0],S=o[o.length-1];this.slots=o.length;var T=[],P=[],M=[];s.forEach(function(D){if(Bu(D,E,S,v,_)){var Q=v.start(D),ee=v.end(D);v.allDay(D)||_.startAndEndAreDateOnly(Q,ee)||!g&&!_.isSameDate(Q,ee)?T.push(D):P.push(D)}}),i.forEach(function(D){Bu(D,E,S,v,_)&&M.push(D)}),T.sort(function(D,Q){return ig(D,Q,v,_)});var L={range:o,events:T,width:l,rtl:c,getNow:d,localizer:_,selected:f,allDayMaxRows:this.props.showAllEvents?1/0:(n=this.props.allDayMaxRows)!==null&&n!==void 0?n:1/0,resources:this.memoizedResources(h,v),selectable:this.props.selectable,accessors:v,getters:p,components:m,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:w,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:b};return J.createElement("div",{className:Ct("rbc-time-view",h&&"rbc-time-view-resources"),ref:this.containerRef},h&&h.length>1&&k?J.createElement(eX,L):J.createElement(Zq,L),this.props.popup&&this.renderOverlay(),J.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},J.createElement(nX,{date:E,ref:this.gutterRef,localizer:_,min:_.merge(E,y),max:_.merge(E,x),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:m,className:"rbc-time-gutter",getters:p}),this.renderEvents(o,P,M,d())))}},{key:"renderOverlay",value:function(){var n,a,s=this,i=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},o=this.props,l=o.accessors,c=o.localizer,f=o.components,d=o.getters,h=o.selected,m=o.popupOffset,v=o.handleDragStart,p=function(){return s.setState({overlay:null})};return J.createElement(S1,{overlay:i,accessors:l,localizer:c,components:f,getters:d,selected:h,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!i.position,overlayDisplay:this.overlayDisplay,onHide:p})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var n=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var a,s=(a=n.gutterRef)!==null&&a!==void 0&&a.current?ag(n.gutterRef.current):void 0;s&&n.state.gutterWidth!==s&&n.setState({gutterWidth:s})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var n=this.contentRef.current;n.scrollTop=n.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,a=n.min,s=n.max,i=n.scrollToTime,o=n.localizer,l=o.diff(o.merge(i,a),i,"milliseconds"),c=o.diff(a,s,"milliseconds");this._scrollRatio=l/c}}])}(O.Component);Xl.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var sX=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Zh=function(e){function t(){return Yt(this,t),Sr(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,m=h===void 0?!0:h,v=Aa(n,sX),p=t.range(a,{localizer:s});return J.createElement(Xl,Object.assign({},v,{range:p,eventOffset:10,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:m}))}}])}(J.Component);Zh.range=function(e,t){var r=t.localizer;return[r.startOf(e,"day")]};Zh.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"day");case qr.NEXT:return n.add(e,1,"day");default:return e}};Zh.title=function(e,t){var r=t.localizer;return r.format(e,"dayHeaderFormat")};var iX=["date","localizer","min","max","scrollToTime","enableAutoScroll"],ai=function(e){function t(){return Yt(this,t),Sr(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,m=h===void 0?!0:h,v=Aa(n,iX),p=t.range(a,this.props);return J.createElement(Xl,Object.assign({},v,{range:p,eventOffset:15,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:m}))}}])}(J.Component);ai.defaultProps=Xl.defaultProps;ai.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"week");case qr.NEXT:return n.add(e,1,"week");default:return e}};ai.range=function(e,t){var r=t.localizer,n=r.startOfWeek(),a=r.startOf(e,"week",n),s=r.endOf(e,"week",n);return r.range(a,s)};ai.title=function(e,t){var r=t.localizer,n=ai.range(e,{localizer:r}),a=VC(n),s=a[0],i=a.slice(1);return r.format({start:s,end:i.pop()},"dayRangeHeaderFormat")};var oX=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function C1(e,t){return ai.range(e,t).filter(function(r){return[6,0].indexOf(r.getDay())===-1})}var Ef=function(e){function t(){return Yt(this,t),Sr(this,t,arguments)}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,m=h===void 0?!0:h,v=Aa(n,oX),p=C1(a,this.props);return J.createElement(Xl,Object.assign({},v,{range:p,eventOffset:15,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:m}))}}])}(J.Component);Ef.defaultProps=Xl.defaultProps;Ef.range=C1;Ef.navigate=ai.navigate;Ef.title=function(e,t){var r=t.localizer,n=C1(e,{localizer:r}),a=VC(n),s=a[0],i=a.slice(1);return r.format({start:s,end:i.pop()},"dayRangeHeaderFormat")};var ep=30;function tp(e){var t=e.accessors,r=e.components,n=e.date,a=e.events,s=e.getters,i=e.length,o=i===void 0?ep:i,l=e.localizer,c=e.onDoubleClickEvent,f=e.onSelectEvent,d=e.selected,h=O.useRef(null),m=O.useRef(null),v=O.useRef(null),p=O.useRef(null),_=O.useRef(null);O.useEffect(function(){g()});var y=function(S,T,P){var M=r.event,L=r.date;return T=T.filter(function(D){return Bu(D,l.startOf(S,"day"),l.endOf(S,"day"),t,l)}),T.map(function(D,Q){var ee=t.title(D),Y=t.end(D),q=t.start(D),G=s.eventProp(D,q,Y,Jh(D,d)),V=Q===0&&l.format(S,"agendaDateFormat"),ae=Q===0?J.createElement("td",{rowSpan:T.length,className:"rbc-agenda-date-cell"},L?J.createElement(L,{day:S,label:V}):V):!1;return J.createElement("tr",{key:P+"_"+Q,className:G.className,style:G.style},ae,J.createElement("td",{className:"rbc-agenda-time-cell"},x(S,D)),J.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(C){return f&&f(D,C)},onDoubleClick:function(C){return c&&c(D,C)}},M?J.createElement(M,{event:D,title:ee}):ee))},[])},x=function(S,T){var P="",M=r.time,L=l.messages.allDay,D=t.end(T),Q=t.start(T);return t.allDay(T)||(l.eq(Q,D)?L=l.format(Q,"agendaTimeFormat"):l.isSameDate(Q,D)?L=l.format({start:Q,end:D},"agendaTimeRangeFormat"):l.isSameDate(S,Q)?L=l.format(Q,"agendaTimeFormat"):l.isSameDate(S,D)&&(L=l.format(D,"agendaTimeFormat"))),l.gt(S,Q,"day")&&(P="rbc-continues-prior"),l.lt(S,D,"day")&&(P+=" rbc-continues-after"),J.createElement("span",{className:P.trim()},M?J.createElement(M,{event:T,day:S,label:L}):L)},g=function(){if(_.current){var S=h.current,T=_.current.firstChild;if(T){var P=p.current.scrollHeight>p.current.clientHeight,M=[],L=M;M=[ag(T.children[0]),ag(T.children[1])],(L[0]!==M[0]||L[1]!==M[1])&&(m.current.style.width=M[0]+"px",v.current.style.width=M[1]+"px"),P?(oL(S,"rbc-header-overflowing"),S.style.marginRight=a1()+"px"):lL(S,"rbc-header-overflowing")}}},w=l.messages,b=l.add(n,o,"day"),k=l.range(n,b,"day");return a=a.filter(function(E){return Bu(E,l.startOf(n,"day"),l.endOf(b,"day"),t,l)}),a.sort(function(E,S){return+t.start(E)-+t.start(S)}),J.createElement("div",{className:"rbc-agenda-view"},a.length!==0?J.createElement(J.Fragment,null,J.createElement("table",{ref:h,className:"rbc-agenda-table"},J.createElement("thead",null,J.createElement("tr",null,J.createElement("th",{className:"rbc-header",ref:m},w.date),J.createElement("th",{className:"rbc-header",ref:v},w.time),J.createElement("th",{className:"rbc-header"},w.event)))),J.createElement("div",{className:"rbc-agenda-content",ref:p},J.createElement("table",{className:"rbc-agenda-table"},J.createElement("tbody",{ref:_},k.map(function(E,S){return y(E,a,S)}))))):J.createElement("span",{className:"rbc-agenda-empty"},w.noEventsInRange))}tp.range=function(e,t){var r=t.length,n=r===void 0?ep:r,a=t.localizer,s=a.add(e,n,"day");return{start:e,end:s}};tp.navigate=function(e,t,r){var n=r.length,a=n===void 0?ep:n,s=r.localizer;switch(t){case qr.PREVIOUS:return s.add(e,-a,"day");case qr.NEXT:return s.add(e,a,"day");default:return e}};tp.title=function(e,t){var r=t.length,n=r===void 0?ep:r,a=t.localizer,s=a.add(e,n,"day");return a.format({start:e,end:s},"agendaHeaderFormat")};var Vd=Ci(Ci(Ci(Ci(Ci({},Pt.MONTH,Qh),Pt.WEEK,ai),Pt.WORK_WEEK,Ef),Pt.DAY,Zh),Pt.AGENDA,tp),lX=["action","date","today"];function cX(e,t){var r=t.action,n=t.date,a=t.today,s=Aa(t,lX);switch(e=typeof e=="string"?Vd[e]:e,r){case qr.TODAY:n=a||new Date;break;case qr.DATE:break;default:Nu(e&&typeof e.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),n=e.navigate(n,r,s)}return n}function uX(e,t){var r=null;return typeof t=="function"?r=t(e):typeof t=="string"&&fs(e)==="object"&&e!=null&&t in e&&(r=e[t]),r}var $a=function(t){return function(r){return uX(r,t)}},fX=["view","date","getNow","onNavigate"],dX=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function xN(e){if(Array.isArray(e))return e;for(var t=[],r=0,n=Object.entries(e);r<n.length;r++){var a=wn(n[r],2),s=a[0],i=a[1];i&&t.push(s)}return t}function hX(e,t){var r=t.views,n=xN(r);return n.indexOf(e)!==-1}var yN=function(e){function t(){var r;Yt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.getViews=function(){var i=r.props.views;return Array.isArray(i)?HK(i,function(o,l){return o[l]=Vd[l]},{}):fs(i)==="object"?HH(i,function(o,l){return o===!0?Vd[l]:o}):Vd},r.getView=function(){var i=r.getViews();return i[r.props.view]},r.getDrilldownView=function(i){var o=r.props,l=o.view,c=o.drilldownView,f=o.getDrilldownView;return f?f(i,l,Object.keys(r.getViews())):c},r.handleRangeChange=function(i,o,l){var c=r.props,f=c.onRangeChange,d=c.localizer;f&&o.range&&f(o.range(i,{localizer:d}),l)},r.handleNavigate=function(i,o){var l=r.props,c=l.view,f=l.date,d=l.getNow,h=l.onNavigate,m=Aa(l,fX),v=r.getView(),p=d();f=cX(v,et(et({},m),{},{action:i,date:o||f||p,today:p})),h(f,c,i),r.handleRangeChange(f,v)},r.handleViewChange=function(i){i!==r.props.view&&hX(i,r.props)&&r.props.onView(i);var o=r.getViews();r.handleRangeChange(r.props.date||r.props.getNow(),o[i],i)},r.handleSelectEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r.handleDoubleClickEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r.handleKeyPressEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.handleSelectSlot=function(i){ct(r.props.onSelectSlot,i)},r.handleDrillDown=function(i,o){var l=r.props.onDrillDown;if(l){l(i,o,r.drilldownView);return}o&&r.handleViewChange(o),r.handleNavigate(qr.DATE,i)},r.state={context:t.getContext(r.props)},r}return kr(t,e),Gt(t,[{key:"render",value:function(){var n=this.props,a=n.view,s=n.toolbar,i=n.events,o=n.backgroundEvents,l=n.resourceGroupingLayout,c=n.style,f=n.className,d=n.elementProps,h=n.date,m=n.getNow,v=n.length,p=n.showMultiDayTimes,_=n.onShowMore,y=n.doShowMoreDrillDown;n.components,n.formats,n.messages,n.culture;var x=Aa(n,dX);h=h||m();var g=this.getView(),w=this.state.context,b=w.accessors,k=w.components,E=w.getters,S=w.localizer,T=w.viewNames,P=k.toolbar||vq,M=g.title(h,{localizer:S,length:v});return J.createElement("div",Object.assign({},d,{className:Ct(f,"rbc-calendar",x.rtl&&"rbc-rtl"),style:c}),s&&J.createElement(P,{date:h,view:a,views:T,label:M,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:S}),J.createElement(g,Object.assign({},x,{events:i,backgroundEvents:o,date:h,getNow:m,length:v,localizer:S,getters:E,components:k,accessors:b,showMultiDayTimes:p,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:_,doShowMoreDrillDown:y,resourceGroupingLayout:l})))}}],[{key:"getDerivedStateFromProps",value:function(n){return{context:t.getContext(n)}}},{key:"getContext",value:function(n){var a=n.startAccessor,s=n.endAccessor,i=n.allDayAccessor,o=n.tooltipAccessor,l=n.titleAccessor,c=n.resourceAccessor,f=n.resourceIdAccessor,d=n.resourceTitleAccessor,h=n.eventIdAccessor,m=n.eventPropGetter,v=n.backgroundEventPropGetter,p=n.slotPropGetter,_=n.slotGroupPropGetter,y=n.dayPropGetter,x=n.view,g=n.views,w=n.localizer,b=n.culture,k=n.messages,E=k===void 0?{}:k,S=n.components,T=S===void 0?{}:S,P=n.formats,M=P===void 0?{}:P,L=xN(g),D=xq(E);return{viewNames:L,localizer:mq(w,b,M,D),getters:{eventProp:function(){return m&&m.apply(void 0,arguments)||{}},backgroundEventProp:function(){return v&&v.apply(void 0,arguments)||{}},slotProp:function(){return p&&p.apply(void 0,arguments)||{}},slotGroupProp:function(){return _&&_.apply(void 0,arguments)||{}},dayProp:function(){return y&&y.apply(void 0,arguments)||{}}},components:IH(T[x]||{},DK(T,L),{eventWrapper:Va,backgroundEventWrapper:Va,eventContainerWrapper:Va,dateCellWrapper:Va,weekWrapper:Va,timeSlotWrapper:Va,timeGutterWrapper:Va}),accessors:{start:$a(a),end:$a(s),allDay:$a(i),tooltip:$a(o),title:$a(l),resource:$a(c),resourceId:$a(f),resourceTitle:$a(d),eventId:$a(h)}}}}])}(J.Component);yN.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:Pt.MONTH,views:[Pt.MONTH,Pt.WEEK,Pt.DAY,Pt.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:Pt.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var pX=HT(yN,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),mX=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"MMMM DD",r)+"  "+n.format(s,n.eq(a,s,"month")?"DD":"MMMM DD",r)},vX=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"L",r)+"  "+n.format(s,"L",r)},_m=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"LT",r)+"  "+n.format(s,"LT",r)},gX=function(t,r,n){var a=t.start;return n.format(a,"LT",r)+"  "},xX=function(t,r,n){var a=t.end;return"  "+n.format(a,"LT",r)},yX={dateFormat:"DD",dayFormat:"DD ddd",weekdayFormat:"ddd",selectRangeFormat:_m,eventTimeRangeFormat:_m,eventTimeRangeStartFormat:gX,eventTimeRangeEndFormat:xX,timeGutterFormat:"LT",monthHeaderFormat:"MMMM YYYY",dayHeaderFormat:"dddd MMM DD",dayRangeHeaderFormat:mX,agendaHeaderFormat:vX,agendaDateFormat:"ddd MMM DD",agendaTimeFormat:"LT",agendaTimeRangeFormat:_m};function Ss(e){var t=e&&e.toLowerCase();return t==="FullYear"?t="year":t||(t=void 0),t}function _X(e){var t=function(C,I){return I?C.locale(I):C};function r(B){return e(B).toDate().getTimezoneOffset()}function n(B,C){var I,N,j=e(B).local(),K=e(C).local();if(!e.tz)return j.toDate().getTimezoneOffset()-K.toDate().getTimezoneOffset();var ie=(I=j==null||(N=j._z)===null||N===void 0?void 0:N.name)!==null&&I!==void 0?I:e.tz.guess(),X=e.tz.zone(ie).utcOffset(+j),le=e.tz.zone(ie).utcOffset(+K);return X-le}function a(B){var C=e(B).startOf("day");return n(C,B)}function s(B,C,I){var N=Ss(I),j=N?e(B).startOf(N):e(B),K=N?e(C).startOf(N):e(C);return[j,K,N]}function i(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,C=arguments.length>1?arguments[1]:void 0,I=Ss(C);return I?e(B).startOf(I).toDate():e(B).toDate()}function o(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,C=arguments.length>1?arguments[1]:void 0,I=Ss(C);return I?e(B).endOf(I).toDate():e(B).toDate()}function l(B,C,I){var N=s(B,C,I),j=wn(N,3),K=j[0],ie=j[1],X=j[2];return K.isSame(ie,X)}function c(B,C,I){return!l(B,C,I)}function f(B,C,I){var N=s(B,C,I),j=wn(N,3),K=j[0],ie=j[1],X=j[2];return K.isAfter(ie,X)}function d(B,C,I){var N=s(B,C,I),j=wn(N,3),K=j[0],ie=j[1],X=j[2];return K.isBefore(ie,X)}function h(B,C,I){var N=s(B,C,I),j=wn(N,3),K=j[0],ie=j[1],X=j[2];return K.isSameOrBefore(ie,X)}function m(B,C,I){var N=s(B,C,I),j=wn(N,3),K=j[0],ie=j[1],X=j[2];return K.isSameOrBefore(ie,X)}function v(B,C,I){var N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"day",j=Ss(N),K=e(B),ie=e(C),X=e(I);return K.isBetween(ie,X,j,"[]")}function p(B,C){var I=e(B),N=e(C),j=e.min(I,N);return j.toDate()}function _(B,C){var I=e(B),N=e(C),j=e.max(I,N);return j.toDate()}function y(B,C){if(!B&&!C)return null;var I=e(C).format("HH:mm:ss"),N=e(B).startOf("day").format("MM/DD/YYYY");return e("".concat(N," ").concat(I),"MM/DD/YYYY HH:mm:ss").toDate()}function x(B,C,I){var N=Ss(I);return e(B).add(C,N).toDate()}function g(B,C){for(var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",N=Ss(I),j=e(B).toDate(),K=[];m(j,C);)K.push(j),j=x(j,1,N);return K}function w(B,C){var I=Ss(C),N=i(B,I);return l(N,B)?N:x(N,1,I)}function b(B,C){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",N=Ss(I),j=e(B),K=e(C);return K.diff(j,N)}function k(B){var C=e(B);return C.minutes()}function E(B){var C=B?e.localeData(B):e.localeData();return C?C.firstDayOfWeek():0}function S(B){return e(B).startOf("month").startOf("week").toDate()}function T(B){return e(B).endOf("month").endOf("week").toDate()}function P(B){for(var C=S(B),I=T(B),N=[];m(C,I);)N.push(C),C=x(C,1,"d");return N}function M(B,C,I){return e(B).startOf("day").minute(C+I).toDate()}function L(B,C){return b(B,C,"minutes")}function D(B){var C=e(B).startOf("day"),I=e(B);return I.diff(C,"minutes")+a(B)}function Q(B,C){var I=e(B),N=e(C);return I.isBefore(N,"day")}function ee(B,C,I){var N=e(C),j=e(I);return N.isSameOrAfter(j,"minutes")}function Y(B,C){var I=e(B),N=e(C),j=e.duration(N.diff(I));return j.days()}function q(B){var C=B.evtA,I=C.start,N=C.end,j=C.allDay,K=B.evtB,ie=K.start,X=K.end,le=K.allDay,oe=+i(I,"day")-+i(ie,"day"),Ee=Y(I,N),z=Y(ie,X);return oe||z-Ee||!!le-!!j||+I-+ie||+N-+X}function G(B){var C=B.event,I=C.start,N=C.end,j=B.range,K=j.start,ie=j.end,X=e(I).startOf("day"),le=e(N),oe=e(K),Ee=e(ie),z=X.isSameOrBefore(Ee,"day"),je=!X.isSame(le,"minutes"),ke=je?le.isAfter(oe,"minutes"):le.isSameOrAfter(oe,"minutes");return z&&ke}function V(B,C){var I=e(B),N=e(C);return I.isSame(N,"day")}function ae(){var B=new Date,C=/-/.test(B.toString())?"-":"",I=B.getTimezoneOffset(),N=Number("".concat(C).concat(Math.abs(I))),j=e().utcOffset();return j>N?1:0}return new pq({formats:yX,firstOfWeek:E,firstVisibleDay:S,lastVisibleDay:T,visibleDays:P,format:function(C,I,N){return t(e(C),N).format(I)},lt:d,lte:m,gt:f,gte:h,eq:l,neq:c,merge:y,inRange:v,startOf:i,endOf:o,range:g,add:x,diff:b,ceil:w,min:p,max:_,minutes:k,getSlotDate:M,getTimezoneOffset:r,getDstOffset:n,getTotalMin:L,getMinutesFromMidnight:D,continuesPrior:Q,continuesAfter:ee,sortEvents:q,inEventRange:G,isSameDate:V,daySpan:Y,browserTZOffset:ae})}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var _N;function xe(){return _N.apply(null,arguments)}function wX(e){_N=e}function sa(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Li(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Ge(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function N1(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Ge(e,t))return!1;return!0}function $r(e){return e===void 0}function hs(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Sf(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function wN(e,t){var r=[],n,a=e.length;for(n=0;n<a;++n)r.push(t(e[n],n));return r}function $s(e,t){for(var r in t)Ge(t,r)&&(e[r]=t[r]);return Ge(t,"toString")&&(e.toString=t.toString),Ge(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Fa(e,t,r,n){return HN(e,t,r,n,!0).utc()}function bX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Fe(e){return e._pf==null&&(e._pf=bX()),e._pf}var og;Array.prototype.some?og=Array.prototype.some:og=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function A1(e){var t=null,r=!1,n=e._d&&!isNaN(e._d.getTime());if(n&&(t=Fe(e),r=og.call(t.parsedDateParts,function(a){return a!=null}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function rp(e){var t=Fa(NaN);return e!=null?$s(Fe(t),e):Fe(t).userInvalidated=!0,t}var eb=xe.momentProperties=[],wm=!1;function O1(e,t){var r,n,a,s=eb.length;if($r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),$r(t._i)||(e._i=t._i),$r(t._f)||(e._f=t._f),$r(t._l)||(e._l=t._l),$r(t._strict)||(e._strict=t._strict),$r(t._tzm)||(e._tzm=t._tzm),$r(t._isUTC)||(e._isUTC=t._isUTC),$r(t._offset)||(e._offset=t._offset),$r(t._pf)||(e._pf=Fe(t)),$r(t._locale)||(e._locale=t._locale),s>0)for(r=0;r<s;r++)n=eb[r],a=t[n],$r(a)||(e[n]=a);return e}function kf(e){O1(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),wm===!1&&(wm=!0,xe.updateOffset(this),wm=!1)}function ia(e){return e instanceof kf||e!=null&&e._isAMomentObject!=null}function bN(e){xe.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Rn(e,t){var r=!0;return $s(function(){if(xe.deprecationHandler!=null&&xe.deprecationHandler(null,e),r){var n=[],a,s,i,o=arguments.length;for(s=0;s<o;s++){if(a="",typeof arguments[s]=="object"){a+=`
[`+s+"] ";for(i in arguments[0])Ge(arguments[0],i)&&(a+=i+": "+arguments[0][i]+", ");a=a.slice(0,-2)}else a=arguments[s];n.push(a)}bN(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var tb={};function EN(e,t){xe.deprecationHandler!=null&&xe.deprecationHandler(e,t),tb[e]||(bN(t),tb[e]=!0)}xe.suppressDeprecationWarnings=!1;xe.deprecationHandler=null;function Ra(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function EX(e){var t,r;for(r in e)Ge(e,r)&&(t=e[r],Ra(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function lg(e,t){var r=$s({},e),n;for(n in t)Ge(t,n)&&(Li(e[n])&&Li(t[n])?(r[n]={},$s(r[n],e[n]),$s(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Ge(e,n)&&!Ge(t,n)&&Li(e[n])&&(r[n]=$s({},r[n]));return r}function D1(e){e!=null&&this.set(e)}var cg;Object.keys?cg=Object.keys:cg=function(e){var t,r=[];for(t in e)Ge(e,t)&&r.push(t);return r};var SX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function kX(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Ra(n)?n.call(t,r):n}function Oa(e,t,r){var n=""+Math.abs(e),a=t-n.length,s=e>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+n}var j1=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,hd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,bm={},il={};function Se(e,t,r,n){var a=n;typeof n=="string"&&(a=function(){return this[n]()}),e&&(il[e]=a),t&&(il[t[0]]=function(){return Oa(a.apply(this,arguments),t[1],t[2])}),r&&(il[r]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function TX(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function CX(e){var t=e.match(j1),r,n;for(r=0,n=t.length;r<n;r++)il[t[r]]?t[r]=il[t[r]]:t[r]=TX(t[r]);return function(a){var s="",i;for(i=0;i<n;i++)s+=Ra(t[i])?t[i].call(a,e):t[i];return s}}function Hd(e,t){return e.isValid()?(t=SN(t,e.localeData()),bm[t]=bm[t]||CX(t),bm[t](e)):e.localeData().invalidDate()}function SN(e,t){var r=5;function n(a){return t.longDateFormat(a)||a}for(hd.lastIndex=0;r>=0&&hd.test(e);)e=e.replace(hd,n),hd.lastIndex=0,r-=1;return e}var NX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function AX(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(j1).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var OX="Invalid date";function DX(){return this._invalidDate}var jX="%d",PX=/\d{1,2}/;function FX(e){return this._ordinal.replace("%d",e)}var RX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function MX(e,t,r,n){var a=this._relativeTime[r];return Ra(a)?a(e,t,r,n):a.replace(/%d/i,e)}function IX(e,t){var r=this._relativeTime[e>0?"future":"past"];return Ra(r)?r(t):r.replace(/%s/i,t)}var rb={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Mn(e){return typeof e=="string"?rb[e]||rb[e.toLowerCase()]:void 0}function P1(e){var t={},r,n;for(n in e)Ge(e,n)&&(r=Mn(n),r&&(t[r]=e[n]));return t}var LX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function $X(e){var t=[],r;for(r in e)Ge(e,r)&&t.push({unit:r,priority:LX[r]});return t.sort(function(n,a){return n.priority-a.priority}),t}var kN=/\d/,fn=/\d\d/,TN=/\d{3}/,F1=/\d{4}/,np=/[+-]?\d{6}/,dt=/\d\d?/,CN=/\d\d\d\d?/,NN=/\d\d\d\d\d\d?/,ap=/\d{1,3}/,R1=/\d{1,4}/,sp=/[+-]?\d{1,6}/,Jl=/\d+/,ip=/[+-]?\d+/,BX=/Z|[+-]\d\d:?\d\d/gi,op=/Z|[+-]\d\d(?::?\d\d)?/gi,UX=/[+-]?\d+(\.\d{1,3})?/,Tf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ql=/^[1-9]\d?/,M1=/^([1-9]\d|\d)/,I0;I0={};function we(e,t,r){I0[e]=Ra(t)?t:function(n,a){return n&&r?r:t}}function WX(e,t){return Ge(I0,e)?I0[e](t._strict,t._locale):new RegExp(VX(e))}function VX(e){return es(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,a,s){return r||n||a||s}))}function es(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function _n(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Le(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=_n(t)),r}var ug={};function Ze(e,t){var r,n=t,a;for(typeof e=="string"&&(e=[e]),hs(t)&&(n=function(s,i){i[t]=Le(s)}),a=e.length,r=0;r<a;r++)ug[e[r]]=n}function Cf(e,t){Ze(e,function(r,n,a,s){a._w=a._w||{},t(r,a._w,a,s)})}function HX(e,t,r){t!=null&&Ge(ug,e)&&ug[e](t,r._a,r,e)}function lp(e){return e%4===0&&e%100!==0||e%400===0}var yr=0,Xa=1,ya=2,Vt=3,Kn=4,Ja=5,ji=6,zX=7,YX=8;Se("Y",0,0,function(){var e=this.year();return e<=9999?Oa(e,4):"+"+e});Se(0,["YY",2],0,function(){return this.year()%100});Se(0,["YYYY",4],0,"year");Se(0,["YYYYY",5],0,"year");Se(0,["YYYYYY",6,!0],0,"year");we("Y",ip);we("YY",dt,fn);we("YYYY",R1,F1);we("YYYYY",sp,np);we("YYYYYY",sp,np);Ze(["YYYYY","YYYYYY"],yr);Ze("YYYY",function(e,t){t[yr]=e.length===2?xe.parseTwoDigitYear(e):Le(e)});Ze("YY",function(e,t){t[yr]=xe.parseTwoDigitYear(e)});Ze("Y",function(e,t){t[yr]=parseInt(e,10)});function Xc(e){return lp(e)?366:365}xe.parseTwoDigitYear=function(e){return Le(e)+(Le(e)>68?1900:2e3)};var AN=Zl("FullYear",!0);function GX(){return lp(this.year())}function Zl(e,t){return function(r){return r!=null?(ON(this,e,r),xe.updateOffset(this,t),this):Wu(this,e)}}function Wu(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function ON(e,t,r){var n,a,s,i,o;if(!(!e.isValid()||isNaN(r))){switch(n=e._d,a=e._isUTC,t){case"Milliseconds":return void(a?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(a?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(a?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(a?n.setUTCHours(r):n.setHours(r));case"Date":return void(a?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,i=e.month(),o=e.date(),o=o===29&&i===1&&!lp(s)?28:o,a?n.setUTCFullYear(s,i,o):n.setFullYear(s,i,o)}}function KX(e){return e=Mn(e),Ra(this[e])?this[e]():this}function qX(e,t){if(typeof e=="object"){e=P1(e);var r=$X(e),n,a=r.length;for(n=0;n<a;n++)this[r[n].unit](e[r[n].unit])}else if(e=Mn(e),Ra(this[e]))return this[e](t);return this}function XX(e,t){return(e%t+t)%t}var Dt;Array.prototype.indexOf?Dt=Array.prototype.indexOf:Dt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function I1(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=XX(t,12);return e+=(t-r)/12,r===1?lp(e)?29:28:31-r%7%2}Se("M",["MM",2],"Mo",function(){return this.month()+1});Se("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Se("MMMM",0,0,function(e){return this.localeData().months(this,e)});we("M",dt,Ql);we("MM",dt,fn);we("MMM",function(e,t){return t.monthsShortRegex(e)});we("MMMM",function(e,t){return t.monthsRegex(e)});Ze(["M","MM"],function(e,t){t[Xa]=Le(e)-1});Ze(["MMM","MMMM"],function(e,t,r,n){var a=r._locale.monthsParse(e,n,r._strict);a!=null?t[Xa]=a:Fe(r).invalidMonth=e});var JX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),DN="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),jN=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,QX=Tf,ZX=Tf;function eJ(e,t){return e?sa(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||jN).test(t)?"format":"standalone"][e.month()]:sa(this._months)?this._months:this._months.standalone}function tJ(e,t){return e?sa(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[jN.test(t)?"format":"standalone"][e.month()]:sa(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function rJ(e,t,r){var n,a,s,i=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Fa([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?t==="MMM"?(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:null):(a=Dt.call(this._longMonthsParse,i),a!==-1?a:null):t==="MMM"?(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:(a=Dt.call(this._longMonthsParse,i),a!==-1?a:null)):(a=Dt.call(this._longMonthsParse,i),a!==-1?a:(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:null))}function nJ(e,t,r){var n,a,s;if(this._monthsParseExact)return rJ.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(a=Fa([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function PN(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Le(t);else if(t=e.localeData().monthsParse(t),!hs(t))return e}var r=t,n=e.date();return n=n<29?n:Math.min(n,I1(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function FN(e){return e!=null?(PN(this,e),xe.updateOffset(this,!0),this):Wu(this,"Month")}function aJ(){return I1(this.year(),this.month())}function sJ(e){return this._monthsParseExact?(Ge(this,"_monthsRegex")||RN.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Ge(this,"_monthsShortRegex")||(this._monthsShortRegex=QX),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function iJ(e){return this._monthsParseExact?(Ge(this,"_monthsRegex")||RN.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Ge(this,"_monthsRegex")||(this._monthsRegex=ZX),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function RN(){function e(l,c){return c.length-l.length}var t=[],r=[],n=[],a,s,i,o;for(a=0;a<12;a++)s=Fa([2e3,a]),i=es(this.monthsShort(s,"")),o=es(this.months(s,"")),t.push(i),r.push(o),n.push(o),n.push(i);t.sort(e),r.sort(e),n.sort(e),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function oJ(e,t,r,n,a,s,i){var o;return e<100&&e>=0?(o=new Date(e+400,t,r,n,a,s,i),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,r,n,a,s,i),o}function Vu(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function L0(e,t,r){var n=7+t-r,a=(7+Vu(e,0,n).getUTCDay()-t)%7;return-a+n-1}function MN(e,t,r,n,a){var s=(7+r-n)%7,i=L0(e,n,a),o=1+7*(t-1)+s+i,l,c;return o<=0?(l=e-1,c=Xc(l)+o):o>Xc(e)?(l=e+1,c=o-Xc(e)):(l=e,c=o),{year:l,dayOfYear:c}}function Hu(e,t,r){var n=L0(e.year(),t,r),a=Math.floor((e.dayOfYear()-n-1)/7)+1,s,i;return a<1?(i=e.year()-1,s=a+ts(i,t,r)):a>ts(e.year(),t,r)?(s=a-ts(e.year(),t,r),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function ts(e,t,r){var n=L0(e,t,r),a=L0(e+1,t,r);return(Xc(e)-n+a)/7}Se("w",["ww",2],"wo","week");Se("W",["WW",2],"Wo","isoWeek");we("w",dt,Ql);we("ww",dt,fn);we("W",dt,Ql);we("WW",dt,fn);Cf(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Le(e)});function lJ(e){return Hu(e,this._week.dow,this._week.doy).week}var cJ={dow:0,doy:6};function uJ(){return this._week.dow}function fJ(){return this._week.doy}function dJ(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function hJ(e){var t=Hu(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Se("d",0,"do","day");Se("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Se("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Se("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Se("e",0,0,"weekday");Se("E",0,0,"isoWeekday");we("d",dt);we("e",dt);we("E",dt);we("dd",function(e,t){return t.weekdaysMinRegex(e)});we("ddd",function(e,t){return t.weekdaysShortRegex(e)});we("dddd",function(e,t){return t.weekdaysRegex(e)});Cf(["dd","ddd","dddd"],function(e,t,r,n){var a=r._locale.weekdaysParse(e,n,r._strict);a!=null?t.d=a:Fe(r).invalidWeekday=e});Cf(["d","e","E"],function(e,t,r,n){t[n]=Le(e)});function pJ(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function mJ(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function L1(e,t){return e.slice(t,7).concat(e.slice(0,t))}var vJ="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),IN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),gJ="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),xJ=Tf,yJ=Tf,_J=Tf;function wJ(e,t){var r=sa(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?L1(r,this._week.dow):e?r[e.day()]:r}function bJ(e){return e===!0?L1(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function EJ(e){return e===!0?L1(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function SJ(e,t,r){var n,a,s,i=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Fa([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?t==="dddd"?(a=Dt.call(this._weekdaysParse,i),a!==-1?a:null):t==="ddd"?(a=Dt.call(this._shortWeekdaysParse,i),a!==-1?a:null):(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null):t==="dddd"?(a=Dt.call(this._weekdaysParse,i),a!==-1||(a=Dt.call(this._shortWeekdaysParse,i),a!==-1)?a:(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null)):t==="ddd"?(a=Dt.call(this._shortWeekdaysParse,i),a!==-1||(a=Dt.call(this._weekdaysParse,i),a!==-1)?a:(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null)):(a=Dt.call(this._minWeekdaysParse,i),a!==-1||(a=Dt.call(this._weekdaysParse,i),a!==-1)?a:(a=Dt.call(this._shortWeekdaysParse,i),a!==-1?a:null))}function kJ(e,t,r){var n,a,s;if(this._weekdaysParseExact)return SJ.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(a=Fa([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function TJ(e){if(!this.isValid())return e!=null?this:NaN;var t=Wu(this,"Day");return e!=null?(e=pJ(e,this.localeData()),this.add(e-t,"d")):t}function CJ(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function NJ(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=mJ(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function AJ(e){return this._weekdaysParseExact?(Ge(this,"_weekdaysRegex")||$1.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Ge(this,"_weekdaysRegex")||(this._weekdaysRegex=xJ),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function OJ(e){return this._weekdaysParseExact?(Ge(this,"_weekdaysRegex")||$1.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ge(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=yJ),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function DJ(e){return this._weekdaysParseExact?(Ge(this,"_weekdaysRegex")||$1.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ge(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=_J),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function $1(){function e(f,d){return d.length-f.length}var t=[],r=[],n=[],a=[],s,i,o,l,c;for(s=0;s<7;s++)i=Fa([2e3,1]).day(s),o=es(this.weekdaysMin(i,"")),l=es(this.weekdaysShort(i,"")),c=es(this.weekdays(i,"")),t.push(o),r.push(l),n.push(c),a.push(o),a.push(l),a.push(c);t.sort(e),r.sort(e),n.sort(e),a.sort(e),this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function B1(){return this.hours()%12||12}function jJ(){return this.hours()||24}Se("H",["HH",2],0,"hour");Se("h",["hh",2],0,B1);Se("k",["kk",2],0,jJ);Se("hmm",0,0,function(){return""+B1.apply(this)+Oa(this.minutes(),2)});Se("hmmss",0,0,function(){return""+B1.apply(this)+Oa(this.minutes(),2)+Oa(this.seconds(),2)});Se("Hmm",0,0,function(){return""+this.hours()+Oa(this.minutes(),2)});Se("Hmmss",0,0,function(){return""+this.hours()+Oa(this.minutes(),2)+Oa(this.seconds(),2)});function LN(e,t){Se(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}LN("a",!0);LN("A",!1);function $N(e,t){return t._meridiemParse}we("a",$N);we("A",$N);we("H",dt,M1);we("h",dt,Ql);we("k",dt,Ql);we("HH",dt,fn);we("hh",dt,fn);we("kk",dt,fn);we("hmm",CN);we("hmmss",NN);we("Hmm",CN);we("Hmmss",NN);Ze(["H","HH"],Vt);Ze(["k","kk"],function(e,t,r){var n=Le(e);t[Vt]=n===24?0:n});Ze(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});Ze(["h","hh"],function(e,t,r){t[Vt]=Le(e),Fe(r).bigHour=!0});Ze("hmm",function(e,t,r){var n=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n)),Fe(r).bigHour=!0});Ze("hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n,2)),t[Ja]=Le(e.substr(a)),Fe(r).bigHour=!0});Ze("Hmm",function(e,t,r){var n=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n))});Ze("Hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[Vt]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n,2)),t[Ja]=Le(e.substr(a))});function PJ(e){return(e+"").toLowerCase().charAt(0)==="p"}var FJ=/[ap]\.?m?\.?/i,RJ=Zl("Hours",!0);function MJ(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var BN={calendar:SX,longDateFormat:NX,invalidDate:OX,ordinal:jX,dayOfMonthOrdinalParse:PX,relativeTime:RX,months:JX,monthsShort:DN,week:cJ,weekdays:vJ,weekdaysMin:gJ,weekdaysShort:IN,meridiemParse:FJ},pt={},wc={},zu;function IJ(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function nb(e){return e&&e.toLowerCase().replace("_","-")}function LJ(e){for(var t=0,r,n,a,s;t<e.length;){for(s=nb(e[t]).split("-"),r=s.length,n=nb(e[t+1]),n=n?n.split("-"):null;r>0;){if(a=cp(s.slice(0,r).join("-")),a)return a;if(n&&n.length>=r&&IJ(s,n)>=r-1)break;r--}t++}return zu}function $J(e){return!!(e&&e.match("^[^/\\\\]*$"))}function cp(e){var t=null,r;if(pt[e]===void 0&&typeof module<"u"&&module&&module.exports&&$J(e))try{t=zu._abbr,r=require,r("./locale/"+e),Zs(t)}catch{pt[e]=null}return pt[e]}function Zs(e,t){var r;return e&&($r(t)?r=xs(e):r=U1(e,t),r?zu=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),zu._abbr}function U1(e,t){if(t!==null){var r,n=BN;if(t.abbr=e,pt[e]!=null)EN("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=pt[e]._config;else if(t.parentLocale!=null)if(pt[t.parentLocale]!=null)n=pt[t.parentLocale]._config;else if(r=cp(t.parentLocale),r!=null)n=r._config;else return wc[t.parentLocale]||(wc[t.parentLocale]=[]),wc[t.parentLocale].push({name:e,config:t}),null;return pt[e]=new D1(lg(n,t)),wc[e]&&wc[e].forEach(function(a){U1(a.name,a.config)}),Zs(e),pt[e]}else return delete pt[e],null}function BJ(e,t){if(t!=null){var r,n,a=BN;pt[e]!=null&&pt[e].parentLocale!=null?pt[e].set(lg(pt[e]._config,t)):(n=cp(e),n!=null&&(a=n._config),t=lg(a,t),n==null&&(t.abbr=e),r=new D1(t),r.parentLocale=pt[e],pt[e]=r),Zs(e)}else pt[e]!=null&&(pt[e].parentLocale!=null?(pt[e]=pt[e].parentLocale,e===Zs()&&Zs(e)):pt[e]!=null&&delete pt[e]);return pt[e]}function xs(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return zu;if(!sa(e)){if(t=cp(e),t)return t;e=[e]}return LJ(e)}function UJ(){return cg(pt)}function W1(e){var t,r=e._a;return r&&Fe(e).overflow===-2&&(t=r[Xa]<0||r[Xa]>11?Xa:r[ya]<1||r[ya]>I1(r[yr],r[Xa])?ya:r[Vt]<0||r[Vt]>24||r[Vt]===24&&(r[Kn]!==0||r[Ja]!==0||r[ji]!==0)?Vt:r[Kn]<0||r[Kn]>59?Kn:r[Ja]<0||r[Ja]>59?Ja:r[ji]<0||r[ji]>999?ji:-1,Fe(e)._overflowDayOfYear&&(t<yr||t>ya)&&(t=ya),Fe(e)._overflowWeeks&&t===-1&&(t=zX),Fe(e)._overflowWeekday&&t===-1&&(t=YX),Fe(e).overflow=t),e}var WJ=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,VJ=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,HJ=/Z|[+-]\d\d(?::?\d\d)?/,pd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Em=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],zJ=/^\/?Date\((-?\d+)/i,YJ=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,GJ={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function UN(e){var t,r,n=e._i,a=WJ.exec(n)||VJ.exec(n),s,i,o,l,c=pd.length,f=Em.length;if(a){for(Fe(e).iso=!0,t=0,r=c;t<r;t++)if(pd[t][1].exec(a[1])){i=pd[t][0],s=pd[t][2]!==!1;break}if(i==null){e._isValid=!1;return}if(a[3]){for(t=0,r=f;t<r;t++)if(Em[t][1].exec(a[3])){o=(a[2]||" ")+Em[t][0];break}if(o==null){e._isValid=!1;return}}if(!s&&o!=null){e._isValid=!1;return}if(a[4])if(HJ.exec(a[4]))l="Z";else{e._isValid=!1;return}e._f=i+(o||"")+(l||""),H1(e)}else e._isValid=!1}function KJ(e,t,r,n,a,s){var i=[qJ(e),DN.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(a,10)];return s&&i.push(parseInt(s,10)),i}function qJ(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function XJ(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function JJ(e,t,r){if(e){var n=IN.indexOf(e),a=new Date(t[0],t[1],t[2]).getDay();if(n!==a)return Fe(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function QJ(e,t,r){if(e)return GJ[e];if(t)return 0;var n=parseInt(r,10),a=n%100,s=(n-a)/100;return s*60+a}function WN(e){var t=YJ.exec(XJ(e._i)),r;if(t){if(r=KJ(t[4],t[3],t[2],t[5],t[6],t[7]),!JJ(t[1],r,e))return;e._a=r,e._tzm=QJ(t[8],t[9],t[10]),e._d=Vu.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Fe(e).rfc2822=!0}else e._isValid=!1}function ZJ(e){var t=zJ.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(UN(e),e._isValid===!1)delete e._isValid;else return;if(WN(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:xe.createFromInputFallback(e)}xe.createFromInputFallback=Rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Fo(e,t,r){return e??t??r}function eQ(e){var t=new Date(xe.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function V1(e){var t,r,n=[],a,s,i;if(!e._d){for(a=eQ(e),e._w&&e._a[ya]==null&&e._a[Xa]==null&&tQ(e),e._dayOfYear!=null&&(i=Fo(e._a[yr],a[yr]),(e._dayOfYear>Xc(i)||e._dayOfYear===0)&&(Fe(e)._overflowDayOfYear=!0),r=Vu(i,0,e._dayOfYear),e._a[Xa]=r.getUTCMonth(),e._a[ya]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=a[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Vt]===24&&e._a[Kn]===0&&e._a[Ja]===0&&e._a[ji]===0&&(e._nextDay=!0,e._a[Vt]=0),e._d=(e._useUTC?Vu:oJ).apply(null,n),s=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Vt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==s&&(Fe(e).weekdayMismatch=!0)}}function tQ(e){var t,r,n,a,s,i,o,l,c;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(s=1,i=4,r=Fo(t.GG,e._a[yr],Hu(ft(),1,4).year),n=Fo(t.W,1),a=Fo(t.E,1),(a<1||a>7)&&(l=!0)):(s=e._locale._week.dow,i=e._locale._week.doy,c=Hu(ft(),s,i),r=Fo(t.gg,e._a[yr],c.year),n=Fo(t.w,c.week),t.d!=null?(a=t.d,(a<0||a>6)&&(l=!0)):t.e!=null?(a=t.e+s,(t.e<0||t.e>6)&&(l=!0)):a=s),n<1||n>ts(r,s,i)?Fe(e)._overflowWeeks=!0:l!=null?Fe(e)._overflowWeekday=!0:(o=MN(r,n,a,s,i),e._a[yr]=o.year,e._dayOfYear=o.dayOfYear)}xe.ISO_8601=function(){};xe.RFC_2822=function(){};function H1(e){if(e._f===xe.ISO_8601){UN(e);return}if(e._f===xe.RFC_2822){WN(e);return}e._a=[],Fe(e).empty=!0;var t=""+e._i,r,n,a,s,i,o=t.length,l=0,c,f;for(a=SN(e._f,e._locale).match(j1)||[],f=a.length,r=0;r<f;r++)s=a[r],n=(t.match(WX(s,e))||[])[0],n&&(i=t.substr(0,t.indexOf(n)),i.length>0&&Fe(e).unusedInput.push(i),t=t.slice(t.indexOf(n)+n.length),l+=n.length),il[s]?(n?Fe(e).empty=!1:Fe(e).unusedTokens.push(s),HX(s,n,e)):e._strict&&!n&&Fe(e).unusedTokens.push(s);Fe(e).charsLeftOver=o-l,t.length>0&&Fe(e).unusedInput.push(t),e._a[Vt]<=12&&Fe(e).bigHour===!0&&e._a[Vt]>0&&(Fe(e).bigHour=void 0),Fe(e).parsedDateParts=e._a.slice(0),Fe(e).meridiem=e._meridiem,e._a[Vt]=rQ(e._locale,e._a[Vt],e._meridiem),c=Fe(e).era,c!==null&&(e._a[yr]=e._locale.erasConvertYear(c,e._a[yr])),V1(e),W1(e)}function rQ(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function nQ(e){var t,r,n,a,s,i,o=!1,l=e._f.length;if(l===0){Fe(e).invalidFormat=!0,e._d=new Date(NaN);return}for(a=0;a<l;a++)s=0,i=!1,t=O1({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[a],H1(t),A1(t)&&(i=!0),s+=Fe(t).charsLeftOver,s+=Fe(t).unusedTokens.length*10,Fe(t).score=s,o?s<n&&(n=s,r=t):(n==null||s<n||i)&&(n=s,r=t,i&&(o=!0));$s(e,r||t)}function aQ(e){if(!e._d){var t=P1(e._i),r=t.day===void 0?t.date:t.day;e._a=wN([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),V1(e)}}function sQ(e){var t=new kf(W1(VN(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function VN(e){var t=e._i,r=e._f;return e._locale=e._locale||xs(e._l),t===null||r===void 0&&t===""?rp({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),ia(t)?new kf(W1(t)):(Sf(t)?e._d=t:sa(r)?nQ(e):r?H1(e):iQ(e),A1(e)||(e._d=null),e))}function iQ(e){var t=e._i;$r(t)?e._d=new Date(xe.now()):Sf(t)?e._d=new Date(t.valueOf()):typeof t=="string"?ZJ(e):sa(t)?(e._a=wN(t.slice(0),function(r){return parseInt(r,10)}),V1(e)):Li(t)?aQ(e):hs(t)?e._d=new Date(t):xe.createFromInputFallback(e)}function HN(e,t,r,n,a){var s={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Li(e)&&N1(e)||sa(e)&&e.length===0)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=r,s._i=e,s._f=t,s._strict=n,sQ(s)}function ft(e,t,r,n){return HN(e,t,r,n,!1)}var oQ=Rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ft.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:rp()}),lQ=Rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ft.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:rp()});function zN(e,t){var r,n;if(t.length===1&&sa(t[0])&&(t=t[0]),!t.length)return ft();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function cQ(){var e=[].slice.call(arguments,0);return zN("isBefore",e)}function uQ(){var e=[].slice.call(arguments,0);return zN("isAfter",e)}var fQ=function(){return Date.now?Date.now():+new Date},bc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function dQ(e){var t,r=!1,n,a=bc.length;for(t in e)if(Ge(e,t)&&!(Dt.call(bc,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<a;++n)if(e[bc[n]]){if(r)return!1;parseFloat(e[bc[n]])!==Le(e[bc[n]])&&(r=!0)}return!0}function hQ(){return this._isValid}function pQ(){return ca(NaN)}function up(e){var t=P1(e),r=t.year||0,n=t.quarter||0,a=t.month||0,s=t.week||t.isoWeek||0,i=t.day||0,o=t.hour||0,l=t.minute||0,c=t.second||0,f=t.millisecond||0;this._isValid=dQ(t),this._milliseconds=+f+c*1e3+l*6e4+o*1e3*60*60,this._days=+i+s*7,this._months=+a+n*3+r*12,this._data={},this._locale=xs(),this._bubble()}function zd(e){return e instanceof up}function fg(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function mQ(e,t,r){var n=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0,i;for(i=0;i<n;i++)Le(e[i])!==Le(t[i])&&s++;return s+a}function YN(e,t){Se(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Oa(~~(r/60),2)+t+Oa(~~r%60,2)})}YN("Z",":");YN("ZZ","");we("Z",op);we("ZZ",op);Ze(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=z1(op,e)});var vQ=/([\+\-]|\d\d)/gi;function z1(e,t){var r=(t||"").match(e),n,a,s;return r===null?null:(n=r[r.length-1]||[],a=(n+"").match(vQ)||["-",0,0],s=+(a[1]*60)+Le(a[2]),s===0?0:a[0]==="+"?s:-s)}function Y1(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(ia(e)||Sf(e)?e.valueOf():ft(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),xe.updateOffset(r,!1),r):ft(e).local()}function dg(e){return-Math.round(e._d.getTimezoneOffset())}xe.updateOffset=function(){};function gQ(e,t,r){var n=this._offset||0,a;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=z1(op,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(a=dg(this)),this._offset=e,this._isUTC=!0,a!=null&&this.add(a,"m"),n!==e&&(!t||this._changeInProgress?qN(this,ca(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,xe.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:dg(this)}function xQ(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function yQ(e){return this.utcOffset(0,e)}function _Q(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(dg(this),"m")),this}function wQ(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=z1(BX,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function bQ(e){return this.isValid()?(e=e?ft(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function EQ(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function SQ(){if(!$r(this._isDSTShifted))return this._isDSTShifted;var e={},t;return O1(e,this),e=VN(e),e._a?(t=e._isUTC?Fa(e._a):ft(e._a),this._isDSTShifted=this.isValid()&&mQ(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function kQ(){return this.isValid()?!this._isUTC:!1}function TQ(){return this.isValid()?this._isUTC:!1}function GN(){return this.isValid()?this._isUTC&&this._offset===0:!1}var CQ=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,NQ=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ca(e,t){var r=e,n=null,a,s,i;return zd(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:hs(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=CQ.exec(e))?(a=n[1]==="-"?-1:1,r={y:0,d:Le(n[ya])*a,h:Le(n[Vt])*a,m:Le(n[Kn])*a,s:Le(n[Ja])*a,ms:Le(fg(n[ji]*1e3))*a}):(n=NQ.exec(e))?(a=n[1]==="-"?-1:1,r={y:wi(n[2],a),M:wi(n[3],a),w:wi(n[4],a),d:wi(n[5],a),h:wi(n[6],a),m:wi(n[7],a),s:wi(n[8],a)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(i=AQ(ft(r.from),ft(r.to)),r={},r.ms=i.milliseconds,r.M=i.months),s=new up(r),zd(e)&&Ge(e,"_locale")&&(s._locale=e._locale),zd(e)&&Ge(e,"_isValid")&&(s._isValid=e._isValid),s}ca.fn=up.prototype;ca.invalid=pQ;function wi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function ab(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function AQ(e,t){var r;return e.isValid()&&t.isValid()?(t=Y1(t,e),e.isBefore(t)?r=ab(e,t):(r=ab(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function KN(e,t){return function(r,n){var a,s;return n!==null&&!isNaN(+n)&&(EN(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),a=ca(r,n),qN(this,a,e),this}}function qN(e,t,r,n){var a=t._milliseconds,s=fg(t._days),i=fg(t._months);e.isValid()&&(n=n??!0,i&&PN(e,Wu(e,"Month")+i*r),s&&ON(e,"Date",Wu(e,"Date")+s*r),a&&e._d.setTime(e._d.valueOf()+a*r),n&&xe.updateOffset(e,s||i))}var OQ=KN(1,"add"),DQ=KN(-1,"subtract");function XN(e){return typeof e=="string"||e instanceof String}function jQ(e){return ia(e)||Sf(e)||XN(e)||hs(e)||FQ(e)||PQ(e)||e===null||e===void 0}function PQ(e){var t=Li(e)&&!N1(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],a,s,i=n.length;for(a=0;a<i;a+=1)s=n[a],r=r||Ge(e,s);return t&&r}function FQ(e){var t=sa(e),r=!1;return t&&(r=e.filter(function(n){return!hs(n)&&XN(e)}).length===0),t&&r}function RQ(e){var t=Li(e)&&!N1(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],a,s;for(a=0;a<n.length;a+=1)s=n[a],r=r||Ge(e,s);return t&&r}function MQ(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function IQ(e,t){arguments.length===1&&(arguments[0]?jQ(arguments[0])?(e=arguments[0],t=void 0):RQ(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||ft(),n=Y1(r,this).startOf("day"),a=xe.calendarFormat(this,n)||"sameElse",s=t&&(Ra(t[a])?t[a].call(this,r):t[a]);return this.format(s||this.localeData().calendar(a,this,ft(r)))}function LQ(){return new kf(this)}function $Q(e,t){var r=ia(e)?e:ft(e);return this.isValid()&&r.isValid()?(t=Mn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function BQ(e,t){var r=ia(e)?e:ft(e);return this.isValid()&&r.isValid()?(t=Mn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function UQ(e,t,r,n){var a=ia(e)?e:ft(e),s=ia(t)?t:ft(t);return this.isValid()&&a.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(a,r):!this.isBefore(a,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function WQ(e,t){var r=ia(e)?e:ft(e),n;return this.isValid()&&r.isValid()?(t=Mn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function VQ(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function HQ(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function zQ(e,t,r){var n,a,s;if(!this.isValid())return NaN;if(n=Y1(e,this),!n.isValid())return NaN;switch(a=(n.utcOffset()-this.utcOffset())*6e4,t=Mn(t),t){case"year":s=Yd(this,n)/12;break;case"month":s=Yd(this,n);break;case"quarter":s=Yd(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-a)/864e5;break;case"week":s=(this-n-a)/6048e5;break;default:s=this-n}return r?s:_n(s)}function Yd(e,t){if(e.date()<t.date())return-Yd(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),a,s;return t-n<0?(a=e.clone().add(r-1,"months"),s=(t-n)/(n-a)):(a=e.clone().add(r+1,"months"),s=(t-n)/(a-n)),-(r+s)||0}xe.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";xe.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function YQ(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function GQ(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Hd(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ra(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Hd(r,"Z")):Hd(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function KQ(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,a,s;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a="-MM-DD[T]HH:mm:ss.SSS",s=t+'[")]',this.format(r+n+a+s)}function qQ(e){e||(e=this.isUtc()?xe.defaultFormatUtc:xe.defaultFormat);var t=Hd(this,e);return this.localeData().postformat(t)}function XQ(e,t){return this.isValid()&&(ia(e)&&e.isValid()||ft(e).isValid())?ca({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function JQ(e){return this.from(ft(),e)}function QQ(e,t){return this.isValid()&&(ia(e)&&e.isValid()||ft(e).isValid())?ca({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ZQ(e){return this.to(ft(),e)}function JN(e){var t;return e===void 0?this._locale._abbr:(t=xs(e),t!=null&&(this._locale=t),this)}var QN=Rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function ZN(){return this._locale}var $0=1e3,ol=60*$0,B0=60*ol,e4=(365*400+97)*24*B0;function ll(e,t){return(e%t+t)%t}function t4(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-e4:new Date(e,t,r).valueOf()}function r4(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-e4:Date.UTC(e,t,r)}function eZ(e){var t,r;if(e=Mn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?r4:t4,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ll(t+(this._isUTC?0:this.utcOffset()*ol),B0);break;case"minute":t=this._d.valueOf(),t-=ll(t,ol);break;case"second":t=this._d.valueOf(),t-=ll(t,$0);break}return this._d.setTime(t),xe.updateOffset(this,!0),this}function tZ(e){var t,r;if(e=Mn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?r4:t4,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=B0-ll(t+(this._isUTC?0:this.utcOffset()*ol),B0)-1;break;case"minute":t=this._d.valueOf(),t+=ol-ll(t,ol)-1;break;case"second":t=this._d.valueOf(),t+=$0-ll(t,$0)-1;break}return this._d.setTime(t),xe.updateOffset(this,!0),this}function rZ(){return this._d.valueOf()-(this._offset||0)*6e4}function nZ(){return Math.floor(this.valueOf()/1e3)}function aZ(){return new Date(this.valueOf())}function sZ(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function iZ(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function oZ(){return this.isValid()?this.toISOString():null}function lZ(){return A1(this)}function cZ(){return $s({},Fe(this))}function uZ(){return Fe(this).overflow}function fZ(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Se("N",0,0,"eraAbbr");Se("NN",0,0,"eraAbbr");Se("NNN",0,0,"eraAbbr");Se("NNNN",0,0,"eraName");Se("NNNNN",0,0,"eraNarrow");Se("y",["y",1],"yo","eraYear");Se("y",["yy",2],0,"eraYear");Se("y",["yyy",3],0,"eraYear");Se("y",["yyyy",4],0,"eraYear");we("N",G1);we("NN",G1);we("NNN",G1);we("NNNN",bZ);we("NNNNN",EZ);Ze(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var a=r._locale.erasParse(e,n,r._strict);a?Fe(r).era=a:Fe(r).invalidEra=e});we("y",Jl);we("yy",Jl);we("yyy",Jl);we("yyyy",Jl);we("yo",SZ);Ze(["y","yy","yyy","yyyy"],yr);Ze(["yo"],function(e,t,r,n){var a;r._locale._eraYearOrdinalRegex&&(a=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[yr]=r._locale.eraYearOrdinalParse(e,a):t[yr]=parseInt(e,10)});function dZ(e,t){var r,n,a,s=this._eras||xs("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":a=xe(s[r].since).startOf("day"),s[r].since=a.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":a=xe(s[r].until).startOf("day").valueOf(),s[r].until=a.valueOf();break}}return s}function hZ(e,t,r){var n,a,s=this.eras(),i,o,l;for(e=e.toUpperCase(),n=0,a=s.length;n<a;++n)if(i=s[n].name.toUpperCase(),o=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(o===e)return s[n];break;case"NNNN":if(i===e)return s[n];break;case"NNNNN":if(l===e)return s[n];break}else if([i,o,l].indexOf(e)>=0)return s[n]}function pZ(e,t){var r=e.since<=e.until?1:-1;return t===void 0?xe(e.since).year():xe(e.since).year()+(t-e.offset)*r}function mZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function vZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function gZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function xZ(){var e,t,r,n,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(r=a[e].since<=a[e].until?1:-1,n=this.clone().startOf("day").valueOf(),a[e].since<=n&&n<=a[e].until||a[e].until<=n&&n<=a[e].since)return(this.year()-xe(a[e].since).year())*r+a[e].offset;return this.year()}function yZ(e){return Ge(this,"_erasNameRegex")||K1.call(this),e?this._erasNameRegex:this._erasRegex}function _Z(e){return Ge(this,"_erasAbbrRegex")||K1.call(this),e?this._erasAbbrRegex:this._erasRegex}function wZ(e){return Ge(this,"_erasNarrowRegex")||K1.call(this),e?this._erasNarrowRegex:this._erasRegex}function G1(e,t){return t.erasAbbrRegex(e)}function bZ(e,t){return t.erasNameRegex(e)}function EZ(e,t){return t.erasNarrowRegex(e)}function SZ(e,t){return t._eraYearOrdinalRegex||Jl}function K1(){var e=[],t=[],r=[],n=[],a,s,i,o,l,c=this.eras();for(a=0,s=c.length;a<s;++a)i=es(c[a].name),o=es(c[a].abbr),l=es(c[a].narrow),t.push(i),e.push(o),r.push(l),n.push(i),n.push(o),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Se(0,["gg",2],0,function(){return this.weekYear()%100});Se(0,["GG",2],0,function(){return this.isoWeekYear()%100});function fp(e,t){Se(0,[e,e.length],0,t)}fp("gggg","weekYear");fp("ggggg","weekYear");fp("GGGG","isoWeekYear");fp("GGGGG","isoWeekYear");we("G",ip);we("g",ip);we("GG",dt,fn);we("gg",dt,fn);we("GGGG",R1,F1);we("gggg",R1,F1);we("GGGGG",sp,np);we("ggggg",sp,np);Cf(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Le(e)});Cf(["gg","GG"],function(e,t,r,n){t[n]=xe.parseTwoDigitYear(e)});function kZ(e){return n4.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function TZ(e){return n4.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function CZ(){return ts(this.year(),1,4)}function NZ(){return ts(this.isoWeekYear(),1,4)}function AZ(){var e=this.localeData()._week;return ts(this.year(),e.dow,e.doy)}function OZ(){var e=this.localeData()._week;return ts(this.weekYear(),e.dow,e.doy)}function n4(e,t,r,n,a){var s;return e==null?Hu(this,n,a).year:(s=ts(e,n,a),t>s&&(t=s),DZ.call(this,e,t,r,n,a))}function DZ(e,t,r,n,a){var s=MN(e,t,r,n,a),i=Vu(s.year,0,s.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}Se("Q",0,"Qo","quarter");we("Q",kN);Ze("Q",function(e,t){t[Xa]=(Le(e)-1)*3});function jZ(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Se("D",["DD",2],"Do","date");we("D",dt,Ql);we("DD",dt,fn);we("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});Ze(["D","DD"],ya);Ze("Do",function(e,t){t[ya]=Le(e.match(dt)[0])});var a4=Zl("Date",!0);Se("DDD",["DDDD",3],"DDDo","dayOfYear");we("DDD",ap);we("DDDD",TN);Ze(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Le(e)});function PZ(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Se("m",["mm",2],0,"minute");we("m",dt,M1);we("mm",dt,fn);Ze(["m","mm"],Kn);var FZ=Zl("Minutes",!1);Se("s",["ss",2],0,"second");we("s",dt,M1);we("ss",dt,fn);Ze(["s","ss"],Ja);var RZ=Zl("Seconds",!1);Se("S",0,0,function(){return~~(this.millisecond()/100)});Se(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Se(0,["SSS",3],0,"millisecond");Se(0,["SSSS",4],0,function(){return this.millisecond()*10});Se(0,["SSSSS",5],0,function(){return this.millisecond()*100});Se(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Se(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Se(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Se(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});we("S",ap,kN);we("SS",ap,fn);we("SSS",ap,TN);var Bs,s4;for(Bs="SSSS";Bs.length<=9;Bs+="S")we(Bs,Jl);function MZ(e,t){t[ji]=Le(("0."+e)*1e3)}for(Bs="S";Bs.length<=9;Bs+="S")Ze(Bs,MZ);s4=Zl("Milliseconds",!1);Se("z",0,0,"zoneAbbr");Se("zz",0,0,"zoneName");function IZ(){return this._isUTC?"UTC":""}function LZ(){return this._isUTC?"Coordinated Universal Time":""}var he=kf.prototype;he.add=OQ;he.calendar=IQ;he.clone=LQ;he.diff=zQ;he.endOf=tZ;he.format=qQ;he.from=XQ;he.fromNow=JQ;he.to=QQ;he.toNow=ZQ;he.get=KX;he.invalidAt=uZ;he.isAfter=$Q;he.isBefore=BQ;he.isBetween=UQ;he.isSame=WQ;he.isSameOrAfter=VQ;he.isSameOrBefore=HQ;he.isValid=lZ;he.lang=QN;he.locale=JN;he.localeData=ZN;he.max=lQ;he.min=oQ;he.parsingFlags=cZ;he.set=qX;he.startOf=eZ;he.subtract=DQ;he.toArray=sZ;he.toObject=iZ;he.toDate=aZ;he.toISOString=GQ;he.inspect=KQ;typeof Symbol<"u"&&Symbol.for!=null&&(he[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});he.toJSON=oZ;he.toString=YQ;he.unix=nZ;he.valueOf=rZ;he.creationData=fZ;he.eraName=mZ;he.eraNarrow=vZ;he.eraAbbr=gZ;he.eraYear=xZ;he.year=AN;he.isLeapYear=GX;he.weekYear=kZ;he.isoWeekYear=TZ;he.quarter=he.quarters=jZ;he.month=FN;he.daysInMonth=aJ;he.week=he.weeks=dJ;he.isoWeek=he.isoWeeks=hJ;he.weeksInYear=AZ;he.weeksInWeekYear=OZ;he.isoWeeksInYear=CZ;he.isoWeeksInISOWeekYear=NZ;he.date=a4;he.day=he.days=TJ;he.weekday=CJ;he.isoWeekday=NJ;he.dayOfYear=PZ;he.hour=he.hours=RJ;he.minute=he.minutes=FZ;he.second=he.seconds=RZ;he.millisecond=he.milliseconds=s4;he.utcOffset=gQ;he.utc=yQ;he.local=_Q;he.parseZone=wQ;he.hasAlignedHourOffset=bQ;he.isDST=EQ;he.isLocal=kQ;he.isUtcOffset=TQ;he.isUtc=GN;he.isUTC=GN;he.zoneAbbr=IZ;he.zoneName=LZ;he.dates=Rn("dates accessor is deprecated. Use date instead.",a4);he.months=Rn("months accessor is deprecated. Use month instead",FN);he.years=Rn("years accessor is deprecated. Use year instead",AN);he.zone=Rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",xQ);he.isDSTShifted=Rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",SQ);function $Z(e){return ft(e*1e3)}function BZ(){return ft.apply(null,arguments).parseZone()}function i4(e){return e}var Ke=D1.prototype;Ke.calendar=kX;Ke.longDateFormat=AX;Ke.invalidDate=DX;Ke.ordinal=FX;Ke.preparse=i4;Ke.postformat=i4;Ke.relativeTime=MX;Ke.pastFuture=IX;Ke.set=EX;Ke.eras=dZ;Ke.erasParse=hZ;Ke.erasConvertYear=pZ;Ke.erasAbbrRegex=_Z;Ke.erasNameRegex=yZ;Ke.erasNarrowRegex=wZ;Ke.months=eJ;Ke.monthsShort=tJ;Ke.monthsParse=nJ;Ke.monthsRegex=iJ;Ke.monthsShortRegex=sJ;Ke.week=lJ;Ke.firstDayOfYear=fJ;Ke.firstDayOfWeek=uJ;Ke.weekdays=wJ;Ke.weekdaysMin=EJ;Ke.weekdaysShort=bJ;Ke.weekdaysParse=kJ;Ke.weekdaysRegex=AJ;Ke.weekdaysShortRegex=OJ;Ke.weekdaysMinRegex=DJ;Ke.isPM=PJ;Ke.meridiem=MJ;function U0(e,t,r,n){var a=xs(),s=Fa().set(n,t);return a[r](s,e)}function o4(e,t,r){if(hs(e)&&(t=e,e=void 0),e=e||"",t!=null)return U0(e,t,r,"month");var n,a=[];for(n=0;n<12;n++)a[n]=U0(e,n,r,"month");return a}function q1(e,t,r,n){typeof e=="boolean"?(hs(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,hs(t)&&(r=t,t=void 0),t=t||"");var a=xs(),s=e?a._week.dow:0,i,o=[];if(r!=null)return U0(t,(r+s)%7,n,"day");for(i=0;i<7;i++)o[i]=U0(t,(i+s)%7,n,"day");return o}function UZ(e,t){return o4(e,t,"months")}function WZ(e,t){return o4(e,t,"monthsShort")}function VZ(e,t,r){return q1(e,t,r,"weekdays")}function HZ(e,t,r){return q1(e,t,r,"weekdaysShort")}function zZ(e,t,r){return q1(e,t,r,"weekdaysMin")}Zs("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Le(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});xe.lang=Rn("moment.lang is deprecated. Use moment.locale instead.",Zs);xe.langData=Rn("moment.langData is deprecated. Use moment.localeData instead.",xs);var Ba=Math.abs;function YZ(){var e=this._data;return this._milliseconds=Ba(this._milliseconds),this._days=Ba(this._days),this._months=Ba(this._months),e.milliseconds=Ba(e.milliseconds),e.seconds=Ba(e.seconds),e.minutes=Ba(e.minutes),e.hours=Ba(e.hours),e.months=Ba(e.months),e.years=Ba(e.years),this}function l4(e,t,r,n){var a=ca(t,r);return e._milliseconds+=n*a._milliseconds,e._days+=n*a._days,e._months+=n*a._months,e._bubble()}function GZ(e,t){return l4(this,e,t,1)}function KZ(e,t){return l4(this,e,t,-1)}function sb(e){return e<0?Math.floor(e):Math.ceil(e)}function qZ(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,a,s,i,o,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=sb(hg(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,a=_n(e/1e3),n.seconds=a%60,s=_n(a/60),n.minutes=s%60,i=_n(s/60),n.hours=i%24,t+=_n(i/24),l=_n(c4(t)),r+=l,t-=sb(hg(l)),o=_n(r/12),r%=12,n.days=t,n.months=r,n.years=o,this}function c4(e){return e*4800/146097}function hg(e){return e*146097/4800}function XZ(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Mn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+c4(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(hg(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function ys(e){return function(){return this.as(e)}}var u4=ys("ms"),JZ=ys("s"),QZ=ys("m"),ZZ=ys("h"),eee=ys("d"),tee=ys("w"),ree=ys("M"),nee=ys("Q"),aee=ys("y"),see=u4;function iee(){return ca(this)}function oee(e){return e=Mn(e),this.isValid()?this[e+"s"]():NaN}function po(e){return function(){return this.isValid()?this._data[e]:NaN}}var lee=po("milliseconds"),cee=po("seconds"),uee=po("minutes"),fee=po("hours"),dee=po("days"),hee=po("months"),pee=po("years");function mee(){return _n(this.days()/7)}var Ha=Math.round,Ko={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function vee(e,t,r,n,a){return a.relativeTime(t||1,!!r,e,n)}function gee(e,t,r,n){var a=ca(e).abs(),s=Ha(a.as("s")),i=Ha(a.as("m")),o=Ha(a.as("h")),l=Ha(a.as("d")),c=Ha(a.as("M")),f=Ha(a.as("w")),d=Ha(a.as("y")),h=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||i<=1&&["m"]||i<r.m&&["mm",i]||o<=1&&["h"]||o<r.h&&["hh",o]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||c<=1&&["M"]||c<r.M&&["MM",c]||d<=1&&["y"]||["yy",d],h[2]=t,h[3]=+e>0,h[4]=n,vee.apply(null,h)}function xee(e){return e===void 0?Ha:typeof e=="function"?(Ha=e,!0):!1}function yee(e,t){return Ko[e]===void 0?!1:t===void 0?Ko[e]:(Ko[e]=t,e==="s"&&(Ko.ss=t-1),!0)}function _ee(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Ko,a,s;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Ko,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),a=this.localeData(),s=gee(this,!r,n,a),r&&(s=a.pastFuture(+this,s)),a.postformat(s)}var Sm=Math.abs;function Ao(e){return(e>0)-(e<0)||+e}function dp(){if(!this.isValid())return this.localeData().invalidDate();var e=Sm(this._milliseconds)/1e3,t=Sm(this._days),r=Sm(this._months),n,a,s,i,o=this.asSeconds(),l,c,f,d;return o?(n=_n(e/60),a=_n(n/60),e%=60,n%=60,s=_n(r/12),r%=12,i=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=o<0?"-":"",c=Ao(this._months)!==Ao(o)?"-":"",f=Ao(this._days)!==Ao(o)?"-":"",d=Ao(this._milliseconds)!==Ao(o)?"-":"",l+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(t?f+t+"D":"")+(a||n||e?"T":"")+(a?d+a+"H":"")+(n?d+n+"M":"")+(e?d+i+"S":"")):"P0D"}var We=up.prototype;We.isValid=hQ;We.abs=YZ;We.add=GZ;We.subtract=KZ;We.as=XZ;We.asMilliseconds=u4;We.asSeconds=JZ;We.asMinutes=QZ;We.asHours=ZZ;We.asDays=eee;We.asWeeks=tee;We.asMonths=ree;We.asQuarters=nee;We.asYears=aee;We.valueOf=see;We._bubble=qZ;We.clone=iee;We.get=oee;We.milliseconds=lee;We.seconds=cee;We.minutes=uee;We.hours=fee;We.days=dee;We.weeks=mee;We.months=hee;We.years=pee;We.humanize=_ee;We.toISOString=dp;We.toString=dp;We.toJSON=dp;We.locale=JN;We.localeData=ZN;We.toIsoString=Rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",dp);We.lang=QN;Se("X",0,0,"unix");Se("x",0,0,"valueOf");we("x",ip);we("X",UX);Ze("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});Ze("x",function(e,t,r){r._d=new Date(Le(e))});//! moment.js
xe.version="2.30.1";wX(ft);xe.fn=he;xe.min=cQ;xe.max=uQ;xe.now=fQ;xe.utc=Fa;xe.unix=$Z;xe.months=UZ;xe.isDate=Sf;xe.locale=Zs;xe.invalid=rp;xe.duration=ca;xe.isMoment=ia;xe.weekdays=VZ;xe.parseZone=BZ;xe.localeData=xs;xe.isDuration=zd;xe.monthsShort=WZ;xe.weekdaysMin=zZ;xe.defineLocale=U1;xe.updateLocale=BJ;xe.locales=UJ;xe.weekdaysShort=HZ;xe.normalizeUnits=Mn;xe.relativeTimeRounding=xee;xe.relativeTimeThreshold=yee;xe.calendarFormat=MQ;xe.prototype=he;xe.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var X1={};X1.match=Tee;X1.parse=f4;var wee=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,bee=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,Eee=/^(?:(min|max)-)?(.+)/,See=/(em|rem|px|cm|mm|in|pt|pc)?$/,kee=/(dpi|dpcm|dppx)?$/;function Tee(e,t){return f4(e).some(function(r){var n=r.inverse,a=r.type==="all"||t.type===r.type;if(a&&n||!(a||n))return!1;var s=r.expressions.every(function(i){var o=i.feature,l=i.modifier,c=i.value,f=t[o];if(!f)return!1;switch(o){case"orientation":case"scan":return f.toLowerCase()===c.toLowerCase();case"width":case"height":case"device-width":case"device-height":c=lb(c),f=lb(f);break;case"resolution":c=ob(c),f=ob(f);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":c=ib(c),f=ib(f);break;case"grid":case"color":case"color-index":case"monochrome":c=parseInt(c,10)||1,f=parseInt(f,10)||0;break}switch(l){case"min":return f>=c;case"max":return f<=c;default:return f===c}});return s&&!n||!s&&n})}function f4(e){return e.split(",").map(function(t){t=t.trim();var r=t.match(wee),n=r[1],a=r[2],s=r[3]||"",i={};return i.inverse=!!n&&n.toLowerCase()==="not",i.type=a?a.toLowerCase():"all",s=s.match(/\([^\)]+\)/g)||[],i.expressions=s.map(function(o){var l=o.match(bee),c=l[1].toLowerCase().match(Eee);return{modifier:c[1],feature:c[2],value:l[2]}}),i})}function ib(e){var t=Number(e),r;return t||(r=e.match(/^(\d+)\s*\/\s*(\d+)$/),t=r[1]/r[2]),t}function ob(e){var t=parseFloat(e),r=String(e).match(kee)[1];switch(r){case"dpcm":return t/2.54;case"dppx":return t*96;default:return t}}function lb(e){var t=parseFloat(e),r=String(e).match(See)[1];switch(r){case"em":return t*16;case"rem":return t*16;case"cm":return t*96/2.54;case"mm":return t*96/2.54/10;case"in":return t*96;case"pt":return t*72;case"pc":return t*72/12;default:return t}}var Cee=X1.match,cb=typeof window<"u"?window.matchMedia:null;function Nee(e,t,r){var n=this,a;cb&&!r&&(a=cb.call(window,e)),a?(this.matches=a.matches,this.media=a.media,a.addListener(o)):(this.matches=Cee(e,t),this.media=e),this.addListener=s,this.removeListener=i,this.dispose=l;function s(c){a&&a.addListener(c)}function i(c){a&&a.removeListener(c)}function o(c){n.matches=c.matches,n.media=c.media}function l(){a&&a.removeListener(o)}}function Aee(e,t,r){return new Nee(e,t,r)}var Oee=Aee;const Dee=Er(Oee);var jee=/[A-Z]/g,Pee=/^ms-/,km={};function Fee(e){return"-"+e.toLowerCase()}function d4(e){if(km.hasOwnProperty(e))return km[e];var t=e.replace(jee,Fee);return km[e]=Pee.test(t)?"-"+t:t}function Ree(e,t){if(e===t)return!0;if(!e||!t)return!1;const r=Object.keys(e),n=Object.keys(t),a=r.length;if(n.length!==a)return!1;for(let s=0;s<a;s++){const i=r[s];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}const Cr=ue.oneOfType([ue.string,ue.number]),J1={all:ue.bool,grid:ue.bool,aural:ue.bool,braille:ue.bool,handheld:ue.bool,print:ue.bool,projection:ue.bool,screen:ue.bool,tty:ue.bool,tv:ue.bool,embossed:ue.bool},h4={orientation:ue.oneOf(["portrait","landscape"]),scan:ue.oneOf(["progressive","interlace"]),aspectRatio:ue.string,deviceAspectRatio:ue.string,height:Cr,deviceHeight:Cr,width:Cr,deviceWidth:Cr,color:ue.bool,colorIndex:ue.bool,monochrome:ue.bool,resolution:Cr,type:Object.keys(J1)},{type:Ude,...Mee}=h4,p4={minAspectRatio:ue.string,maxAspectRatio:ue.string,minDeviceAspectRatio:ue.string,maxDeviceAspectRatio:ue.string,minHeight:Cr,maxHeight:Cr,minDeviceHeight:Cr,maxDeviceHeight:Cr,minWidth:Cr,maxWidth:Cr,minDeviceWidth:Cr,maxDeviceWidth:Cr,minColor:ue.number,maxColor:ue.number,minColorIndex:ue.number,maxColorIndex:ue.number,minMonochrome:ue.number,maxMonochrome:ue.number,minResolution:Cr,maxResolution:Cr,...Mee},Iee={...J1,...p4};var Lee={all:Iee,types:J1,matchers:h4,features:p4};const $ee=e=>`not ${e}`,Bee=(e,t)=>{const r=d4(e);return typeof t=="number"&&(t=`${t}px`),t===!0?r:t===!1?$ee(r):`(${r}: ${t})`},Uee=e=>e.join(" and "),Wee=e=>{const t=[];return Object.keys(Lee.all).forEach(r=>{const n=e[r];n!=null&&t.push(Bee(r,n))}),Uee(t)},Vee=O.createContext(void 0),Hee=e=>e.query||Wee(e),ub=e=>e?Object.keys(e).reduce((r,n)=>(r[d4(n)]=e[n],r),{}):void 0,m4=()=>{const e=O.useRef(!1);return O.useEffect(()=>{e.current=!0},[]),e.current},zee=e=>{const t=O.useContext(Vee),r=()=>ub(e)||ub(t),[n,a]=O.useState(r);return O.useEffect(()=>{const s=r();Ree(n,s)||a(s)},[e,t]),n},Yee=e=>{const t=()=>Hee(e),[r,n]=O.useState(t);return O.useEffect(()=>{const a=t();r!==a&&n(a)},[e]),r},Gee=(e,t)=>{const r=()=>Dee(e,t||{},!!t),[n,a]=O.useState(r),s=m4();return O.useEffect(()=>{if(s){const i=r();return a(i),()=>{i&&i.dispose()}}},[e,t]),n},Kee=e=>{const[t,r]=O.useState(e.matches);return O.useEffect(()=>{const n=a=>{r(a.matches)};return e.addListener(n),r(e.matches),()=>{e.removeListener(n)}},[e]),t},fb=(e,t,r)=>{const n=zee(t),a=Yee(e);if(!a)throw new Error("Invalid or missing MediaQuery!");const s=Gee(a,n),i=Kee(s),o=m4();return O.useEffect(()=>{o&&r&&r(i)},[i]),O.useEffect(()=>()=>{s&&s.dispose()},[]),i},qee=_X(xe);function Xee(){const[e,t]=O.useState({totalClients:0,totalEmployees:0,totalQuotations:0,totalSiteVisits:0,totalpos:0,pendingNotifications:0,totalInvoices:0,totalPayments:0,totalProjects:0}),[r,n]=O.useState([]),[a,s]=O.useState([]),[i,o]=O.useState([]),[l,c]=O.useState([]),[f,d]=O.useState([]),[h,m]=O.useState([]),[v,p]=O.useState("stats"),[_,y]=O.useState(!1),x=Je(D=>D.role),g=Je(D=>D.user),w=fb({maxWidth:767}),b=fb({minWidth:768,maxWidth:1023});O.useEffect(()=>{k()},[x,g==null?void 0:g.id]);async function k(){try{if(x==="head"||x==="admin"||x==="e.head"){const Y=[se.from("clients").select("*",{count:"exact",head:!0}),se.from("employees").select("*",{count:"exact",head:!0}),se.from("quotations").select("*",{count:"exact",head:!0}),se.from("site_visit").select("*",{count:"exact",head:!0}),se.from("quotations").select("*",{count:"exact",head:!0}).eq("status","approved"),se.from("notifications").select("*",{count:"exact",head:!0}).eq("is_delivered",!1)];x==="e.head"&&Y.push(se.from("projects").select("*",{count:"exact",head:!0}),se.from("invoices").select("*",{count:"exact",head:!0}),se.from("payments").select("*",{count:"exact",head:!0}));const[{count:q},{count:G},{count:V},{count:ae},{count:B},{count:C},{count:I},{count:N},{count:j}]=await Promise.all(Y);t(K=>({...K,totalClients:q||0,totalEmployees:G||0,totalQuotations:V||0,totalSiteVisits:ae||0,totalpos:B||0,pendingNotifications:C||0,totalProjects:I||0,totalInvoices:N||0,totalPayments:j||0}))}else if(x==="finance.employee"){const[{count:Y},{count:q},{count:G}]=await Promise.all([se.from("invoices").select("*",{count:"exact",head:!0}),se.from("payments").select("*",{count:"exact",head:!0}),se.from("notifications").select("*",{count:"exact",head:!0}).or(`assigned_to.eq.${g==null?void 0:g.id},target_role.eq.${x}`).eq("is_delivered",!1)]);t(V=>({...V,totalInvoices:Y||0,totalPayments:q||0,pendingNotifications:G||0}))}else{const[{count:Y},{count:q},{count:G},{count:V},{count:ae},{count:B}]=await Promise.all([se.from("client_assignments").select("*",{count:"exact",head:!0}).eq("employee_id",g==null?void 0:g.id),se.from("quotations").select("*",{count:"exact",head:!0}).eq("employee_id",g==null?void 0:g.id),se.from("site_visit").select("*",{count:"exact",head:!0}).eq("employee_id",g==null?void 0:g.id),se.from("quotations").select("*",{count:"exact",head:!0}).eq("employee_id",g==null?void 0:g.id).eq("status","approved"),se.from("notifications").select("*",{count:"exact",head:!0}).or(`assigned_to.eq.${g==null?void 0:g.id},target_role.eq.${x}`).eq("is_delivered",!1),x==="e.employee"?se.from("project_assignments").select("*",{count:"exact",head:!0}).eq("employee_id",g==null?void 0:g.id):Promise.resolve({count:0})]);t(C=>({...C,totalClients:Y||0,totalEmployees:0,totalQuotations:q||0,totalSiteVisits:G||0,totalpos:V||0,pendingNotifications:ae||0,totalProjects:B||0}))}if(x!=="finance.employee"){const{data:Y}=await se.from("quotations").select(`
            *,
            clients (
              name,
              company
            )
          `).order("created_at",{ascending:!1}).limit(5);n(Y||[]);const{data:q}=await se.from("site_visit").select(`
            *,
            clients (
              name,
              company
            ),
            employees (
              full_name
            ),
            address,
          `).order("created_at",{ascending:!1}).limit(5);s(q||[])}else{const{data:Y}=await se.from("invoices").select(`
            *,
            clients (
              name,
              company
            ),
            projects (
              name
            )
          `).order("created_at",{ascending:!1}).limit(5);c(Y||[]);const{data:q}=await se.from("payments").select(`
            *,
            invoices (
              invoice_number,
              clients (
                name,
                company
              )
            )
          `).order("created_at",{ascending:!1}).limit(5);d(q||[])}const D=x==="head"||x==="admin"||x==="e.head"?se.from("notifications").select("*").order("scheduled_at",{ascending:!1}).limit(5):se.from("notifications").select("*").or(`assigned_to.eq.${g==null?void 0:g.id},target_role.eq.${x}`).order("scheduled_at",{ascending:!1}).limit(5),{data:Q}=await D;o(Q||[]);const ee=(Q||[]).map(Y=>({id:Y.id,title:Y.title,start:new Date(Y.scheduled_at),end:new Date(new Date(Y.scheduled_at).getTime()+60*60*1e3),description:Y.description,assignedTo:Y.assigned_to,isDelivered:Y.is_delivered}));m(ee)}catch(D){console.error("Error loading dashboard data:",D)}}const E=D=>{let Q=D.isDelivered?"#d1fae5":"#fee2e2";return new Date(D.start)>new Date&&(Q="#bfdbfe"),{style:{backgroundColor:Q,borderRadius:"4px",opacity:.8,color:"#1f2937",border:"0px",display:"block"}}},S=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Invoices"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalInvoices})]}),u.jsx(_w,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Payments"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalPayments})]}),u.jsx(bw,{className:"w-6 h-6 md:w-8 md:h-8 text-green-600"})]})})]}),T=()=>u.jsx(u.Fragment,{children:u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Projects"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalProjects})]}),u.jsx(Sw,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})}),P=()=>u.jsx(u.Fragment,{children:u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Assigned Projects"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalProjects})]}),u.jsx(Sw,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})}),M=()=>u.jsxs("div",{className:"grid grid-cols-1 gap-4 md:gap-6 lg:grid-cols-2",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(_w,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-blue-600"}),"Recent Invoices"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:l.map(D=>{var Q,ee;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(Q=D.clients)==null?void 0:Q.name," - ",D.invoice_number]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",D.amount]}),((ee=D.projects)==null?void 0:ee.name)&&u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Project: ",D.projects.name]})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.status==="paid"?"bg-green-100 text-green-800":D.status==="overdue"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:D.status.charAt(0).toUpperCase()+D.status.slice(1)})]})},D.id)})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(bw,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-green-600"}),"Recent Payments"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:f.map(D=>{var Q,ee,Y;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(ee=(Q=D.invoices)==null?void 0:Q.clients)==null?void 0:ee.name," - ",(Y=D.invoices)==null?void 0:Y.invoice_number]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",D.amount]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Method: ",D.method]})]}),u.jsx("span",{className:"text-xs text-gray-400 mt-1",children:xe(D.payment_date).format("MMM D, YYYY")})]})},D.id)})})]})]}),L=()=>u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>{p("stats"),w&&y(!1)},className:`px-3 py-1 md:px-4 md:py-2 text-sm md:text-base rounded-md ${v==="stats"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Overview"}),u.jsx("button",{onClick:()=>{p("calendar"),w&&y(!1)},className:`px-3 py-1 md:px-4 md:py-2 text-sm md:text-base rounded-md ${v==="calendar"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Calendar"})]});return u.jsxs("div",{className:"space-y-4 md:space-y-6 p-2 md:p-4",children:[w&&u.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg shadow-md sticky top-0 z-10",children:[u.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Dashboard"}),u.jsx("button",{onClick:()=>y(!_),className:"p-1 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:_?u.jsx(Ki,{className:"w-6 h-6 text-gray-600"}):u.jsx(FT,{className:"w-6 h-6 text-gray-600"})})]}),!w&&u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),L()]}),w&&_&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:L()}),v==="stats"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:`grid ${w?"grid-cols-1 gap-3":b?"grid-cols-2 gap-4":"grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6"}`,children:[x!=="finance.employee"&&x!==null&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Clients"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalClients})]}),u.jsx(Yc,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})}),(x==="head"||x==="admin"||x==="e.head")&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Employees"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalEmployees})]}),u.jsx(Gi,{className:"w-6 h-6 md:w-8 md:h-8 text-green-600"})]})}),x!=="finance.employee"&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Quotations"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalQuotations})]}),u.jsx(Gc,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})]}),x==="finance.employee"&&S(),x==="e.head"&&T(),x==="e.employee"&&P(),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Pending Tasks"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.pendingNotifications})]}),u.jsx(Hv,{className:"w-6 h-6 md:w-8 md:h-8 text-orange-600"})]})}),(x==="e.employee"||x==="employee")&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Site Visits"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalSiteVisits})]}),u.jsx(yw,{className:"w-6 h-6 md:w-8 md:h-8 text-yellow-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total PO's"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalpos})]}),u.jsx(Gc,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})})]})]}),u.jsx("div",{className:`grid ${w?"grid-cols-1 gap-4":b?"grid-cols-1 lg:grid-cols-2 gap-4":"grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6"}`,children:x==="finance.employee"?M():u.jsxs(u.Fragment,{children:[x!=="finance.employee"&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(Gc,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-purple-600"}),"Recent Quotations"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:r.map(D=>{var Q,ee;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(Q=D.clients)==null?void 0:Q.name," - ",(ee=D.clients)==null?void 0:ee.company]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",D.amount]})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.status==="approved"?"bg-green-100 text-green-800":D.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:D.status.charAt(0).toUpperCase()+D.status.slice(1)})]})},D.id)})})]}),(x==="e.employee"||x==="employee")&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(yw,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-yellow-600"}),"Recent Site Visits"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:a.map(D=>{var Q,ee,Y;return u.jsxs("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(Q=D.clients)==null?void 0:Q.name," - ",(ee=D.clients)==null?void 0:ee.company]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["By: ",(Y=D.employees)==null?void 0:Y.full_name]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Location: ",D.address]})]},D.id)})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(Hv,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-orange-600"}),"Recent Tasks"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:i.map(D=>u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base font-medium text-gray-800",children:D.title}),u.jsx("p",{className:"text-xs md:text-sm text-gray-500",children:D.description}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:xe(D.scheduled_at).format("MMM D, h:mm A")})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.is_delivered?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:D.is_delivered?"Completed":"Pending"})]})},D.id))})]})]})})]}):u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 h-[70vh] min-h-[500px]",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(Ph,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-blue-600"}),"Task Calendar"]}),u.jsx(pX,{localizer:qee,events:h,startAccessor:"start",endAccessor:"end",style:{height:w?"60vh":"65vh"},views:[Pt.MONTH,Pt.WEEK,Pt.DAY,Pt.AGENDA],defaultView:w?Pt.AGENDA:Pt.MONTH,eventPropGetter:E,onSelectEvent:D=>{alert(`Task: ${D.title}

Description: ${D.description||"No description"}

Status: ${D.isDelivered?"Completed":"Pending"}

Time: ${xe(D.start).format("MMM D, h:mm A")}`)}})]})]})}function Jee(){const[e,t]=O.useState([]),[r,n]=O.useState(!1),[a,s]=O.useState({email:"",password:"",full_name:"",role:"employee"}),[i,o]=O.useState(!1),[l,c]=O.useState(""),[f,d]=O.useState(""),[h,m]=O.useState([]);O.useEffect(()=>{v()},[]),O.useEffect(()=>{_()},[e,f]);async function v(){const{data:y,error:x}=await se.from("employees").select("*").order("created_at",{ascending:!1});if(x){console.error("Error loading employees:",x);return}t(y||[]),m(y||[])}async function p(y){var x;y.preventDefault(),o(!0),c("");try{const{data:g,error:w}=await se.auth.signUp({email:a.email,password:a.password});if(w)throw w;const{error:b}=await se.from("employees").insert([{id:(x=g.user)==null?void 0:x.id,email:a.email,full_name:a.full_name,role:a.role}]);if(b)throw b;s({email:"",password:"",full_name:"",role:"employee"}),n(!1),v()}catch(g){c(g.message)}finally{o(!1)}}const _=()=>{if(!f){m(e);return}const y=e.filter(x=>x.full_name.toLowerCase().includes(f.toLowerCase()));m(y)};return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Employees"}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"text",placeholder:"Search employees...",className:"p-2 border rounded mr-2",value:f,onChange:y=>d(y.target.value)}),u.jsxs("button",{onClick:()=>n(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Employee"]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(y=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:y.full_name}),u.jsx("p",{className:"text-gray-500",children:y.role})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${y.role==="head"?"bg-purple-100 text-purple-800":y.role==="admin"?"bg-green-100 text-green-800":y.role==="e.head"?"bg-orange-100 text-orange-800":y.role==="e.employee"?"bg-yellow-100 text-yellow-800":y.role==="finance.employee"?"bg-teal-100 text-teal-800":"bg-blue-100 text-blue-800"}`,children:y.role})]}),u.jsxs("div",{className:"mt-4 space-y-2",children:[u.jsxs("div",{className:"flex items-center text-gray-600",children:[u.jsx(Bl,{className:"w-4 h-4 mr-2"}),y.email]}),u.jsxs("div",{className:"flex items-center text-gray-600",children:[u.jsx(Ph,{className:"w-4 h-4 mr-2"}),"Joined ",new Date(y.created_at).toLocaleDateString()]})]})]},y.id))}),r&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Employee"}),l&&u.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:l}),u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Full Name"}),u.jsx("input",{type:"text",value:a.full_name,onChange:y=>s({...a,full_name:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:a.email,onChange:y=>s({...a,email:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Password"}),u.jsx("input",{type:"password",value:a.password,onChange:y=>s({...a,password:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Role"}),u.jsxs("select",{value:a.role,onChange:y=>s({...a,role:y.target.value}),className:"w-full p-2 border rounded",children:[u.jsx("option",{value:"employee",children:"Employee"}),u.jsx("option",{value:"head",children:"Head"}),u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"e.employee",children:"E.Employee"}),u.jsx("option",{value:"e.head",children:"E.Head"}),u.jsx("option",{value:"finance.employee",children:"Finance Employee"})]})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:i?"Creating...":"Create"})]})]})]})})]})}function Qee(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]);O.useState(!1);const[i,o]=O.useState(!1),[l,c]=O.useState(null),[f,d]=O.useState([]),[h,m]=O.useState(""),[v,p]=O.useState([]),_=Pn(),y=Je(S=>S.role),x=Je(S=>S.user);O.useEffect(()=>{g(),(y==="head"||y==="admin"||y==="employee")&&b()},[y,x==null?void 0:x.id]),O.useEffect(()=>{w()},[e,r]);async function g(){try{if(y==="employee"&&(x!=null&&x.id)){const{data:S,error:T}=await se.from("client_assignments").select("client:clients(*, client_assignments(employee_id))").eq("employee_id",x.id).eq("client.status","ongoing");if(T)throw T;const P=(S==null?void 0:S.map(M=>M.client).filter(M=>M!==null))||[];t(P)}else if(y==="head"||y==="admin"){const{data:S,error:T}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","ongoing");if(T)throw T;t(S||[])}}catch(S){console.error("Error loading clients:",S)}}const w=()=>{if(!r){s(e);return}const S=e.filter(T=>{var P,M,L;return((P=T==null?void 0:T.name)==null?void 0:P.toLowerCase().includes(r.toLowerCase()))||((M=T==null?void 0:T.company)==null?void 0:M.toLowerCase().includes(r.toLowerCase()))||((L=T==null?void 0:T.address)==null?void 0:L.toLowerCase().includes(r.toLowerCase()))});s(S)};async function b(){const{data:S,error:T}=await se.from("employees").select("*").eq("role","employee");if(T){console.error("Error loading employees:",T);return}d(S||[])}async function k(){if(l)try{const S=v.map(P=>({client_id:l.id,employee_id:P}));await se.from("client_assignments").delete().eq("client_id",l.id);const{error:T}=await se.from("client_assignments").insert(S);if(T)throw T;o(!1),g()}catch(S){console.error("Error assigning employees:",S)}}const E=f.filter(S=>{var T;return(T=S==null?void 0:S.full_name)==null?void 0:T.toLowerCase().includes(h.toLowerCase())});return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Clients"}),u.jsx("div",{className:"flex items-center space-x-4",children:u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:S=>n(S.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]})})]}),a.length===0?u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No clients found"})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(S=>S&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:S.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:S.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:S.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>_(`/clients/${S.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),(y==="head"||y==="admin")&&u.jsxs("button",{onClick:()=>{var T;c(S),p(((T=S.client_assignments)==null?void 0:T.map(P=>P.employee_id))||[]),o(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Gi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},S.id))}),i&&l&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Assign Employees to ",l.name]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:h,onChange:S=>m(S.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:v,onChange:S=>{const T=Array.from(S.target.selectedOptions,P=>P.value);p(T)},className:"w-full p-2 border rounded h-40",size:5,children:E.map(S=>u.jsx("option",{value:S.id,children:S.full_name},S.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}function Zee(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]),[i,o]=O.useState(!1);O.useState(null);const[l,c]=O.useState([]),[f,d]=O.useState(""),[h,m]=O.useState({name:"",company:"",address:""});O.useState([]);const v=Pn(),p=Je(b=>b.role),_=Je(b=>b.user);O.useEffect(()=>{y(),(p==="head"||p==="employee"||p==="admin")&&g()},[p]),O.useEffect(()=>{x()},[e,r]);async function y(){const{data:b,error:k}=await se.from("clients").select("*, client_assignments(employee_id)");if(k){console.error("Error loading clients:",k);return}t(b||[])}const x=()=>{if(!r){s(e);return}const b=e.filter(k=>k.name.toLowerCase().includes(r.toLowerCase())||k.company.toLowerCase().includes(r.toLowerCase())||k.address.toLowerCase().includes(r.toLowerCase()));s(b)};async function g(){const{data:b,error:k}=await se.from("employees").select("*").eq("role","employee");if(k){console.error("Error loading employees:",k);return}c(b||[])}async function w(b){b.preventDefault();const{data:k,error:E}=await se.from("clients").insert([{...h,created_by:_==null?void 0:_.id,status:"ongoing"}]).select().single();if(E){console.error("Error creating client:",E);return}t([...e,k]),m({name:"",company:"",address:""}),o(!1)}return l.filter(b=>b.full_name.toLowerCase().includes(f.toLowerCase())),u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-white-800",children:"Clients"}),u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"relative mr-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:b=>n(b.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Client"]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(b=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:b.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:b.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:b.address}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("button",{onClick:()=>v(`/allclients/${b.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"})})]},b.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Client"}),u.jsxs("form",{onSubmit:w,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:h.name,onChange:b=>m({...h,name:b.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Company"}),u.jsx("input",{type:"text",value:h.company,onChange:b=>m({...h,company:b.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Address"}),u.jsx("input",{type:"text",value:h.address,onChange:b=>m({...h,address:b.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Create"})]})]})]})})]})}function ete(){const{id:e}=Il(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState(!1),[o,l]=O.useState(null),c=Je(x=>x.role);Je(x=>x.user);const[f,d]=O.useState(null),[h,m]=O.useState({name:"",position:"",email:"",phone:""});O.useEffect(()=>{e&&v()},[e]);async function v(){const{data:x}=await se.from("clients").select("*").eq("id",e).single();r(x);const{data:g}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(g||[]),x!=null&&x.created_by&&await p(x.created_by)}async function p(x){const{data:g}=await se.from("employees").select("full_name").eq("id",x).single();d(g)}async function _(x){x.preventDefault();const{error:g}=await se.from("contact_persons").insert([{...h,client_id:e}]);if(g){console.error("Error adding contact person:",g);return}m({name:"",position:"",email:"",phone:""}),i(!1),v()}async function y(x){x.preventDefault();const{error:g}=await se.from("contact_persons").update({name:o.name,position:o.position,email:o.email,phone:o.phone}).eq("id",o.id);if(g){console.error("Error updating contact person:",g);return}l(null),v()}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsx("div",{className:"flex gap-2",children:u.jsxs("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})})]})}),c==="head"&&t.created_by&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Client Created By"}),f?u.jsxs("p",{className:"text-gray-600",children:["Employee Name: ",f==null?void 0:f.full_name]}):u.jsxs("p",{className:"text-gray-600",children:["User ID: ",t.created_by]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(x=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:x.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:x.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Bl,{className:"w-4 h-4 mr-2"}),x.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(ff,{className:"w-4 h-4 mr-2"}),x.phone]})]}),c==="head"&&u.jsx("button",{onClick:()=>l(x),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},x.id))})]}),s&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:_,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:h.name,onChange:x=>m({...h,name:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:h.position,onChange:x=>m({...h,position:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:h.email,onChange:x=>m({...h,email:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:h.phone,onChange:x=>m({...h,phone:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add Contact"})]})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:y,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:o.name,onChange:x=>l({...o,name:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:o.position,onChange:x=>l({...o,position:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:o.email,onChange:x=>l({...o,email:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:o.phone,onChange:x=>l({...o,phone:x.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save Changes"})]})]})]})})]}):null}function tte(){const{id:e}=Il(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState([]),[c,f]=O.useState(!1),[d,h]=O.useState(!1),[m,v]=O.useState(!1),[p,_]=O.useState(!1),[y,x]=O.useState([]),[g,w]=O.useState(null),[b,k]=O.useState(!1),[E,S]=O.useState({contact:!1,quotation:!1,endClient:!1,poReceived:!1}),T=Je(N=>N.role),P=Je(N=>N.user),[M,L]=O.useState({name:"",position:"",email:"",phone:""}),[D,Q]=O.useState({amount:"",description:"",start_date:"",end_date:"",selectedAssets:[]}),ee=(N,j)=>{window.open(`https://www.google.com/maps?q=${N},${j}`,"_blank")},Y=(N,j)=>{const K=encodeURIComponent(`Quotation #${j.id} Details`),ie=encodeURIComponent(`Dear Client,

Please find below the quotation details:

Amount: ${j.amount}/-
Valid From: ${new Date(j.start_date).toLocaleDateString()}
Valid Until: ${new Date(j.end_date).toLocaleDateString()}
Description: ${j.description}

Assets Included:
${j.quotation_assets.map(X=>`- ${X.assets.item} (Qty: ${X.quantity})`).join(`
`)}

Best regards,
${(P==null?void 0:P.full_name)||"Your Representative"}
${(P==null?void 0:P.email)||""}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${N}&su=${K}&body=${ie}`)};O.useEffect(()=>{e&&(q(),G(),V())},[e,b]);async function q(){try{const{data:N}=await se.from("clients").select("*").eq("id",e).single();r(N);const{data:j}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(a(j||[]),T==="admin"||T==="head"||b){const{data:K}=await se.from("quotations").select(`
            *,
            employees (
              full_name
            ),
            quotation_assets (
              asset_id,
              quantity,
              assets (
                item
              )
            )
          `).eq("client_id",e).order("created_at",{ascending:!1});i(K||[]);const{data:ie}=await se.from("site_visit").select(`
            *,
            employees (
              full_name
            ),
            site_visit_form (
              address,
              contact_no,
              notes,
              exit_location,
              created_at
            ),
            site_visit_assets (
              asset_id,
              quantity,
              assets (
                item
              )
            )
          `).eq("client_Id",e).order("created_at",{ascending:!1});l(ie||[])}}catch(N){console.error("Error loading client data:",N)}}async function G(){try{const{data:N}=await se.from("assets").select("*").order("item");x(N||[])}catch(N){console.error("Error loading assets:",N)}}async function V(){try{if(T==="admin"||T==="head"){k(!0);return}if(!(P!=null&&P.id)||!e){k(!1);return}const{data:N,error:j}=await se.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",P.id).single();k(!!N)}catch(N){console.error("Error checking assignment:",N)}}async function ae(N){N.preventDefault(),S(j=>({...j,contact:!0}));try{const{error:j}=await se.from("contact_persons").insert([{...M,client_id:e}]);if(j)throw j;L({name:"",position:"",email:"",phone:""}),f(!1),await q()}catch(j){console.error("Error adding contact:",j)}finally{S(j=>({...j,contact:!1}))}}async function B(N){N.preventDefault(),S(j=>({...j,contact:!0}));try{const{error:j}=await se.from("contact_persons").update({name:g.name,position:g.position,email:g.email,phone:g.phone}).eq("id",g.id);if(j)throw j;w(null),await q()}catch(j){console.error("Error updating contact:",j)}finally{S(j=>({...j,contact:!1}))}}async function C(N){N.preventDefault(),S(j=>({...j,quotation:!0}));try{const{data:j,error:K}=await se.from("quotations").insert([{client_id:e,employee_id:P==null?void 0:P.id,amount:parseFloat(D.amount),description:D.description,start_date:D.start_date,end_date:D.end_date,status:"pending"}]).select().single();if(K)throw K;if(D.selectedAssets.length>0){const{error:ie}=await se.from("quotation_assets").insert(D.selectedAssets.map(X=>({quotation_id:j.id,asset_id:X.assetId,quantity:X.quantity})));if(ie)throw ie}Q({amount:"",description:"",start_date:"",end_date:"",selectedAssets:[]}),h(!1),await q()}catch(j){console.error("Error adding quotation:",j)}finally{S(j=>({...j,quotation:!1}))}}async function I(N,j){try{const{error:K}=await se.from("quotations").update({status:j}).eq("id",N);if(K)throw K;await q()}catch(K){console.error("Error updating quotation status:",K)}}return t?u.jsxs("div",{className:"space-y-6 p-4",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsxs("div",{className:"flex flex-wrap gap-2 w-full md:w-auto",children:[u.jsx("button",{onClick:()=>f(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:E.contact,children:E.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})}),(T==="employee"||T==="admin")&&b&&u.jsx("button",{onClick:()=>h(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:E.quotation,children:E.quotation?"Loading...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Quotation"]})})]})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(N=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:N.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:N.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Bl,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`mailto:${N.email}`,className:"hover:underline",children:N.email})]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(ff,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`tel:${N.phone}`,className:"hover:underline",children:N.phone})]})]}),T==="head"&&u.jsx("button",{onClick:()=>w(N),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},N.id))})]}),(T==="admin"||T==="head"||b)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Quotations"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No quotations found"}):u.jsx("div",{className:"space-y-4",children:s.map(N=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("p",{className:"font-semibold text-gray-800",children:["Amount: ",N.amount,"/-"]}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",N.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm",children:N.description}),u.jsx("div",{className:"mt-2",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Period: ",new Date(N.start_date).toLocaleDateString()," - ",new Date(N.end_date).toLocaleDateString()]})}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:N.quotation_assets.map(j=>u.jsxs("li",{children:[j.assets.item," (Qty: ",j.quantity,")"]},j.asset_id))})]})]}),u.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${N.status==="approved"?"bg-green-100 text-green-800":N.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:N.status.charAt(0).toUpperCase()+N.status.slice(1)}),T==="admin"&&u.jsxs("button",{onClick:()=>Y(n[0].email,N),className:"flex items-center justify-center gap-1 px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:[u.jsx(RT,{className:"w-4 h-4"}),"Send Quotation"]}),T==="admin"&&N.status==="pending"&&u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>I(N.id,"approved"),className:"px-2 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"Approve"}),u.jsx("button",{onClick:()=>I(N.id,"rejected"),className:"px-2 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Reject"})]})]})]})},N.id))})]}),(T==="admin"||T==="head"||b)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),o.length===0?u.jsx("p",{className:"text-gray-500",children:"No site visits found"}):u.jsx("div",{className:"space-y-4",children:o.map(N=>{var j,K;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsx("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:((j=N.employees)==null?void 0:j.full_name)||"Unknown Employee"}),u.jsx("span",{className:"text-sm text-gray-500",children:new Date(N.created_at).toLocaleDateString()})]}),N.latitude&&N.longitude&&u.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center text-gray-700 mb-2",children:[u.jsx(k0,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"font-medium",children:"Visit Location"})]}),u.jsxs("button",{onClick:()=>ee(parseFloat(N.latitude),parseFloat(N.longitude)),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center",children:[u.jsx(k0,{className:"w-3 h-3 mr-1"}),"View on Google Maps"]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2",children:[u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Latitude"}),u.jsx("div",{className:"font-mono text-sm",children:N.latitude})]}),u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Longitude"}),u.jsx("div",{className:"font-mono text-sm",children:N.longitude})]})]})]}),N.site_visit_form&&N.site_visit_form.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Address:"})," ",N.site_visit_form[0].address]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Contact:"})," ",N.site_visit_form[0].contact_no]}),u.jsxs("p",{className:"text-gray-500",children:[u.jsx("span",{className:"font-medium",children:"Notes:"})," ",N.site_visit_form[0].notes]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Exit Location:"})," ",N.site_visit_form[0].exit_location]})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:[(K=N.site_visit_assets)==null?void 0:K.map(ie=>{var X;return u.jsxs("li",{children:[(X=ie.assets)==null?void 0:X.item," (Qty: ",ie.quantity,")"]},ie.asset_id)}),(!N.site_visit_assets||N.site_visit_assets.length===0)&&u.jsx("li",{children:"No assets used"})]})]})]})})},N.id)})})]}),T==="head"&&u.jsx("button",{onClick:()=>v(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:E.endClient,children:E.endClient?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(S0,{className:"w-4 h-4 mr-2"}),"End Client"]})}),T==="admin"&&u.jsx("button",{onClick:()=>_(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:E.poReceived,children:E.poReceived?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(S0,{className:"w-4 h-4 mr-2"}),"PO Received"]})}),m&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as completed?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.endClient,children:"Cancel"}),u.jsx("button",{onClick:async()=>{S(N=>({...N,endClient:!0}));try{const{error:N}=await se.from("clients").update({status:"completed"}).eq("id",e);if(N)throw N;v(!1),await q()}catch(N){console.error("Error updating client status:",N)}finally{S(N=>({...N,endClient:!1}))}},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:E.endClient,children:E.endClient?"Processing...":"End Client"})]})]})}),p&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"PO Received"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Mark this client as PO Received?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.poReceived,children:"Cancel"}),u.jsx("button",{onClick:async()=>{S(N=>({...N,poReceived:!0}));try{const{error:N}=await se.from("clients").update({status:"poreceived"}).eq("id",e);if(N)throw N;_(!1),await q()}catch(N){console.error("Error updating client status:",N)}finally{S(N=>({...N,poReceived:!1}))}},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:E.poReceived,children:E.poReceived?"Processing...":"PO Received"})]})]})}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:ae,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:M.name,onChange:N=>L({...M,name:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:M.position,onChange:N=>L({...M,position:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:M.email,onChange:N=>L({...M,email:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:M.phone,onChange:N=>L({...M,phone:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:E.contact,children:E.contact?"Adding...":"Add Contact"})]})]})]})}),g&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:B,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:g.name,onChange:N=>w({...g,name:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:g.position,onChange:N=>w({...g,position:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:g.email,onChange:N=>w({...g,email:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:g.phone,onChange:N=>w({...g,phone:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>w(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:E.contact,children:E.contact?"Saving...":"Save Changes"})]})]})]})}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Quotation"}),u.jsxs("form",{onSubmit:C,children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Amount"}),u.jsx("input",{type:"number",step:"0.01",value:D.amount,onChange:N=>Q({...D,amount:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Start Date"}),u.jsx("input",{type:"date",value:D.start_date,onChange:N=>Q({...D,start_date:N.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Description"}),u.jsx("textarea",{value:D.description,onChange:N=>Q({...D,description:N.target.value}),className:"w-full p-2 border rounded h-24",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"End Date"}),u.jsx("input",{type:"date",value:D.end_date,onChange:N=>Q({...D,end_date:N.target.value}),className:"w-full p-2 border rounded",required:!0})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Assets"}),u.jsx("div",{className:"border rounded-lg p-4 max-h-64 overflow-y-auto",children:y.length===0?u.jsx("p",{className:"text-gray-500",children:"No assets available"}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map(N=>{var j;return u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("input",{type:"checkbox",id:`asset-${N.id}`,checked:D.selectedAssets.some(K=>K.assetId===N.id),onChange:K=>{K.target.checked?Q({...D,selectedAssets:[...D.selectedAssets,{assetId:N.id,quantity:1}]}):Q({...D,selectedAssets:D.selectedAssets.filter(ie=>ie.assetId!==N.id)})},className:"mt-1"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{htmlFor:`asset-${N.id}`,className:"font-medium",children:N.item}),D.selectedAssets.some(K=>K.assetId===N.id)&&u.jsxs("div",{className:"mt-1",children:[u.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Quantity"}),u.jsx("input",{type:"number",min:"1",value:((j=D.selectedAssets.find(K=>K.assetId===N.id))==null?void 0:j.quantity)||1,onChange:K=>{Q({...D,selectedAssets:D.selectedAssets.map(ie=>ie.assetId===N.id?{...ie,quantity:parseInt(K.target.value)||1}:ie)})},className:"w-full p-1 border rounded text-sm"})]})]})]},N.id)})})})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.quotation,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:E.quotation,children:E.quotation?"Creating...":"Create Quotation"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function rte(){const{id:e}=Il(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState(!1),[c,f]=O.useState(!1),[d,h]=O.useState(!1),[m,v]=O.useState([]),[p,_]=O.useState(null),[y,x]=O.useState(!1),[g,w]=O.useState({contact:!1,status:!1}),b=Je(Y=>Y.role),k=Je(Y=>Y.user),E=(Y,q)=>{window.open(`https://www.google.com/maps?q=${Y},${q}`,"_blank")},[S,T]=O.useState({name:"",position:"",email:"",phone:""});O.useEffect(()=>{e&&(P(),M(),L())},[e,y]);async function P(){try{const{data:Y}=await se.from("clients").select("*").eq("id",e).single();r(Y);const{data:q}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(a(q||[]),b==="admin"||b==="e.head"||y){const{data:G}=await se.from("site_visit").select(`
                        *,
                        employees (
                            full_name,
                            role
                        ),
                        site_visit_form (
                            address,
                            contact_no,
                            notes,
                            exit_location,
                            created_at
                        ),
                        site_visit_assets (
                            asset_id,
                            quantity,
                            assets (
                                item
                            )
                        )
                    `).eq("client_Id",e).order("created_at",{ascending:!1}),V=(G==null?void 0:G.filter(ae=>{var B;return((B=ae.employees)==null?void 0:B.role)==="e.employee"}))||[];i(V)}}catch(Y){console.error("Error loading client data:",Y)}}async function M(){try{const{data:Y}=await se.from("assets").select("*").order("item");v(Y||[])}catch(Y){console.error("Error loading assets:",Y)}}async function L(){try{if(b==="admin"||b==="e.head"){x(!0);return}if(!(k!=null&&k.id)||!e){x(!1);return}const{data:Y,error:q}=await se.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",k.id).single();x(!!Y)}catch(Y){console.error("Error checking assignment:",Y)}}async function D(Y){Y.preventDefault(),w({...g,contact:!0});try{const{error:q}=await se.from("contact_persons").insert([{...S,client_id:e}]);if(q)throw q;T({name:"",position:"",email:"",phone:""}),l(!1),await P()}catch(q){console.error("Error adding contact person:",q)}finally{w({...g,contact:!1})}}async function Q(Y){Y.preventDefault(),w({...g,contact:!0});try{const{error:q}=await se.from("contact_persons").update({name:p.name,position:p.position,email:p.email,phone:p.phone}).eq("id",p.id);if(q)throw q;_(null),await P()}catch(q){console.error("Error updating contact person:",q)}finally{w({...g,contact:!1})}}async function ee(Y){w({...g,status:!0});try{const{error:q}=await se.from("clients").update({status:Y}).eq("id",e);if(q)throw q;f(!1),h(!1),await P()}catch(q){console.error("Error updating client status:",q)}finally{w({...g,status:!1})}}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsx("div",{className:"flex gap-2",children:u.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:g.contact,children:g.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})})})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(Y=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:Y.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:Y.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Bl,{className:"w-4 h-4 mr-2"}),Y.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(ff,{className:"w-4 h-4 mr-2"}),Y.phone]})]}),b==="e.head"&&u.jsx("button",{onClick:()=>_(Y),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},Y.id))})]}),(b==="admin"||b==="head"||y)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No site visits found"}):u.jsx("div",{className:"space-y-4",children:s.map(Y=>{var q,G;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsx("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:((q=Y.employees)==null?void 0:q.full_name)||"Unknown Employee"}),u.jsx("span",{className:"text-sm text-gray-500",children:new Date(Y.created_at).toLocaleDateString()})]}),Y.latitude&&Y.longitude&&u.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center text-gray-700 mb-2",children:[u.jsx(k0,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"font-medium",children:"Visit Location"})]}),u.jsxs("button",{onClick:()=>E(parseFloat(Y.latitude),parseFloat(Y.longitude)),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center",children:[u.jsx(k0,{className:"w-3 h-3 mr-1"}),"View on Google Maps"]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2",children:[u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Latitude"}),u.jsx("div",{className:"font-mono text-sm",children:Y.latitude})]}),u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Longitude"}),u.jsx("div",{className:"font-mono text-sm",children:Y.longitude})]})]})]}),Y.site_visit_form&&Y.site_visit_form.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Address:"})," ",Y.site_visit_form[0].address]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Contact:"})," ",Y.site_visit_form[0].contact_no]}),u.jsxs("p",{className:"text-gray-500",children:[u.jsx("span",{className:"font-medium",children:"Notes:"})," ",Y.site_visit_form[0].notes]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Exit Location:"})," ",Y.site_visit_form[0].exit_location]})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:[(G=Y.site_visit_assets)==null?void 0:G.map(V=>{var ae;return u.jsxs("li",{children:[(ae=V.assets)==null?void 0:ae.item," (Qty: ",V.quantity,")"]},V.asset_id)}),(!Y.site_visit_assets||Y.site_visit_assets.length===0)&&u.jsx("li",{children:"No assets used"})]})]})]})})},Y.id)})})]}),b==="e.head"&&u.jsx("button",{onClick:()=>h(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:g.status,children:g.status?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(S0,{className:"w-4 h-4 mr-2"}),"E Complete"]})}),c&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as completed?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.status,children:"Cancel"}),u.jsx("button",{onClick:()=>ee("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:g.status,children:"Confirm"})]})]})}),d&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ecomplete"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as Ecomplete?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.status,children:"Cancel"}),u.jsx("button",{onClick:()=>ee("ecomplete"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:g.status,children:"Confirm"})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:D,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:S.name,onChange:Y=>T({...S,name:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:S.position,onChange:Y=>T({...S,position:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:S.email,onChange:Y=>T({...S,email:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:S.phone,onChange:Y=>T({...S,phone:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:g.contact,children:g.contact?"Adding...":"Add Contact"})]})]})]})}),p&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:Q,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:p.name,onChange:Y=>_({...p,name:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:p.position,onChange:Y=>_({...p,position:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:p.email,onChange:Y=>_({...p,email:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:p.phone,onChange:Y=>_({...p,phone:Y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>_(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:g.contact,children:g.contact?"Saving...":"Save Changes"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function nte(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]),[i,o]=O.useState(!1),[l,c]=O.useState({client_Id:"",latitude:"",longitude:"",accuracy:""}),[f,d]=O.useState([]),[h,m]=O.useState([]),[v,p]=O.useState(!1),[_,y]=O.useState(""),[x,g]=O.useState(!1),[w,b]=O.useState(null),[k,E]=O.useState(!1),[S,T]=O.useState(""),[P,M]=O.useState(""),[L,D]=O.useState(null),[Q,ee]=O.useState({}),Y=Pn(),q=Je(X=>X.role),G=Je(X=>X.user);O.useEffect(()=>{V(),ae(),(q==="employee"||q==="e.employee")&&(G!=null&&G.id)&&B()},[q,G==null?void 0:G.id]),O.useEffect(()=>{C()},[e,r]);async function V(){try{const{data:X,error:le}=await se.from("site_visit").select("*").eq("status","start").order("created_at",{ascending:!1});if(le)throw le;if(t(X||[]),X&&X.length>0){const oe=X.map(ke=>ke.id),{data:Ee,error:z}=await se.from("pd_kit_uploads").select("*").in("visit_id",oe);if(z)throw z;const je={};Ee==null||Ee.forEach(ke=>{ke.visit_id&&(je[ke.visit_id]||(je[ke.visit_id]=[]),je[ke.visit_id].push(ke))}),ee(je)}}catch(X){console.error("Error loading site visits:",X)}}async function ae(){try{const{data:X,error:le}=await se.from("clients").select("*").order("name");if(le)throw le;d(X||[])}catch(X){console.error("Error loading clients:",X)}}async function B(){try{if(!(G!=null&&G.id))return;const{data:X,error:le}=await se.from("client_assignments").select("client_id").eq("employee_id",G.id);if(le)throw le;if(X&&X.length>0){const{data:oe,error:Ee}=await se.from("clients").select("*").in("id",X.map(z=>z.client_id)).order("name");if(Ee)throw Ee;m(oe||[])}}catch(X){console.error("Error loading assigned clients:",X)}}const C=()=>{if(!r){s(e);return}const X=r.toLowerCase(),le=e.filter(oe=>{const Ee=(q==="e.head"||q==="admin"||q==="head"?f:h).find(ke=>ke.id===oe.client_Id),z=(Ee==null?void 0:Ee.name.toLowerCase())||"",je=(Ee==null?void 0:Ee.company.toLowerCase())||"";return z.includes(X)||je.includes(X)||oe.created_at.toLowerCase().includes(X)});s(le)},I=async()=>{if(!navigator.geolocation){y("Geolocation is not supported by your browser.");return}p(!0),y("");try{const X=await new Promise((le,oe)=>{navigator.geolocation.getCurrentPosition(le,oe,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})});c(le=>({...le,latitude:X.coords.latitude.toFixed(6),longitude:X.coords.longitude.toFixed(6),accuracy:`${X.coords.accuracy.toFixed(1)} meters`}))}catch(X){console.error("Geolocation error:",X),y(X.message||"Failed to get location")}finally{p(!1)}};async function N(X){if(X.preventDefault(),!G){alert("You must be logged in to create a site visit");return}g(!0);try{const{data:le,error:oe}=await se.from("site_visit").insert([{client_Id:l.client_Id,latitude:l.latitude,longitude:l.longitude,employee_Id:G.id,status:"start"}]).select().single();if(oe)throw oe;t([le,...e]),c({client_Id:"",latitude:"",longitude:"",accuracy:""}),o(!1)}catch(le){console.error("Error creating site visit:",le),alert("Failed to create site visit")}finally{g(!1)}}const j=async(X,le)=>{if(!w||!G||!X){T("No file selected or visit not specified");return}E(!0),T(""),M("");try{const{data:oe,error:Ee}=await se.from("site_visit").select("client_Id").eq("id",X).single();if(Ee)throw Ee;if(!oe)throw new Error("Visit not found");const z=w.name.split(".").pop(),ke=`pd-kits/${`${G.id}-${X}-${Date.now()}.${z}`}`,{data:qe,error:Ae}=await se.storage.from("pd-kits").upload(ke,w,{cacheControl:"3600",upsert:!1});if(Ae)throw Ae;const{data:me,error:tt}=await se.from("pd_kit_uploads").insert([{employee_id:G.id,file_path:ke,client_id:oe.client_Id,visit_id:X,upload_type:le}]).select();if(tt)throw tt;ee(cr=>{const gt={...cr};return gt[X]||(gt[X]=[]),gt[X].push(me[0]),gt}),M("PD Kit uploaded successfully!"),b(null),setTimeout(()=>{D(null),M("")},2e3)}catch(oe){console.error("Error in handlePdKitUpload:",oe),T(oe.message||"Failed to upload PD Kit. Please try again.")}finally{E(!1)}},K=()=>q==="admin"||q==="e.head"||q==="head"?f:h,ie=X=>{const{data:le}=se.storage.from("pd-kits").getPublicUrl(X);return le.publicUrl};return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Site Visits"}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative w-full sm:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client or date",value:r,onChange:X=>n(X.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 w-full sm:w-auto justify-center",children:[u.jsx(us,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Site Visit"})]})}),a.map(X=>u.jsx("button",{onClick:()=>Y(`/site-visits/${X.id}/pd-kits`),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View PD Kits"},X.id))]})]}),a.length===0?u.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[u.jsx("p",{className:"text-gray-500",children:"No site visits found"}),r&&u.jsx("button",{onClick:()=>n(""),className:"text-blue-600 hover:underline mt-2",children:"Clear search"})]}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(X=>{const oe=(q==="admin"||q==="head"?f:h).find(je=>je.id===X.client_Id),Ee=new Date(X.created_at).toLocaleString(),z=Q[X.id]||[];return u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow flex flex-col",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:oe?oe.name:"Unknown Client"}),(oe==null?void 0:oe.company)&&u.jsx("p",{className:"text-gray-600 text-sm mb-2",children:oe.company}),u.jsx("p",{className:"text-gray-500 text-xs mb-4",children:Ee}),z.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"PD Kits:"}),u.jsx("ul",{className:"space-y-2",children:z.map(je=>u.jsxs("li",{className:"flex items-center",children:[u.jsx(Gc,{className:"w-4 h-4 text-gray-500 mr-2"}),u.jsxs("a",{href:ie(je.file_path),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:[new Date(je.uploaded_at).toLocaleString()," (",je.upload_type,")"]})]},je.id))})]})]}),u.jsxs("div",{className:"flex justify-between items-center mt-4",children:[u.jsx("button",{onClick:()=>Y(`/site-visits/${X.id}`),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Site Visit"}),q==="e.employee"&&u.jsxs("button",{onClick:()=>D(X.id),className:"text-green-600 hover:text-green-800 text-sm font-medium flex items-center gap-1",children:[u.jsx(Ux,{className:"w-4 h-4"}),u.jsx("span",{children:"Upload PD Kit"})]})]})]},X.id)})}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Add New Site Visit"}),u.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),u.jsxs("form",{onSubmit:N,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Client"}),u.jsxs("select",{value:l.client_Id,onChange:X=>c({...l,client_Id:X.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:x||(q==="employee"||q==="e.employee")&&h.length===0,children:[u.jsx("option",{value:"",children:"Select Client"}),K().map(X=>u.jsxs("option",{value:X.id,children:[X.name," (",X.company,")"]},X.id))]}),(q==="employee"||q==="e.employee")&&h.length===0&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:"You don't have any assigned clients"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Location"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("button",{type:"button",onClick:I,disabled:v||x,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 flex items-center justify-center gap-2",children:v?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Getting Location..."]}):"Update Current Location"}),l.latitude&&l.longitude&&u.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Latitude:"})," ",l.latitude]}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Longitude:"})," ",l.longitude]}),l.accuracy&&u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Accuracy:"})," ",l.accuracy]})]}),_&&u.jsx("p",{className:"text-red-500 text-sm",children:_})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),disabled:x,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:!l.client_Id||!l.latitude||x,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:x?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Site Visit"})]})]})]})}),L&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Upload PD Kit"}),u.jsx("button",{onClick:()=>{D(null),b(null),T(""),M("")},className:"text-gray-500 hover:text-gray-700",children:""})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Select File (Image or PDF)"}),u.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:X=>{var le;return b(((le=X.target.files)==null?void 0:le[0])||null)},className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-md file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-50 file:text-blue-700
                    hover:file:bg-blue-100`,disabled:k})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Upload Type"}),u.jsx("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",disabled:k,children:u.jsx("option",{value:"start",children:"Start of Visit"})})]}),w&&u.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Selected file:"})," ",w.name]}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Size:"})," ",(w.size/1024).toFixed(2)," KB"]})]}),S&&u.jsx("p",{className:"text-red-500 text-sm",children:S}),P&&u.jsx("p",{className:"text-green-500 text-sm",children:P}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>{D(null),b(null),T(""),M("")},disabled:k,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"button",onClick:()=>{const X=document.querySelector("select"),le=X==null?void 0:X.value;j(L,le)},disabled:!w||k,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 flex items-center gap-2",children:k?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload PD Kit"})]})]})]})})]})}function ate({user:e,role:t}){const{id:r}=Il(),n=Pn(),[a,s]=O.useState(1),[i,o]=O.useState(!0),[l,c]=O.useState([]),[f,d]=O.useState(!1),[h,m]=O.useState(""),[v,p]=O.useState(""),[_,y]=O.useState(!1),[x,g]=O.useState(""),[w,b]=O.useState(null),[k,E]=O.useState({address:"",contactNo:"",notes:"",exitLocation:"",selectedAssets:[],latitude:"",longitude:"",pdKitFile:null});O.useEffect(()=>{async function G(){o(!0),p("");try{const{data:V,error:ae}=await se.from("assets").select("*").order("item");if(ae)throw ae;if(c(V||[]),r){const{data:B,error:C}=await se.from("site_visit").select("status").eq("id",r).single();if(C)throw C;if(B.status==="end"){n(`/site-visits/${r}`,{replace:!0});return}const{data:I,error:N}=await se.from("site_visit_form").select("*").eq("visit_id",r).maybeSingle();if(N)throw N;I&&E({address:I.address||"",contactNo:I.contact_no||"",notes:I.notes||"",exitLocation:I.exit_location||"",selectedAssets:[],latitude:I.latitude||"",longitude:I.longitude||"",pdKitFile:null});const{data:j,error:K}=await se.from("site_visit_assets").select("asset_id, quantity").eq("site_visit_id",r);if(K)throw K;j&&E(le=>({...le,selectedAssets:j.map(oe=>({assetId:oe.asset_id,quantity:oe.quantity}))}));const{data:ie,error:X}=await se.from("pd_kit_uploads").select("file_path").eq("visit_id",r).eq("upload_type","start").maybeSingle();if(!X&&ie){const{data:le}=se.storage.from("pd-kits").getPublicUrl(ie.file_path);b(le.publicUrl)}}}catch(V){console.error("Error loading data:",V),p(V.message||"Failed to load data")}finally{o(!1)}}G()},[r,n]);function S(G){E(V=>({...V,...G}))}const T=async()=>{if(!navigator.geolocation){m("Geolocation is not supported by your browser.");return}d(!0),m("");try{const G=await new Promise((V,ae)=>{navigator.geolocation.getCurrentPosition(V,ae,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})});S({latitude:G.coords.latitude.toString(),longitude:G.coords.longitude.toString()})}catch(G){console.error("Geolocation error:",G),m(G.message||"Failed to get location")}finally{d(!1)}},P=G=>{if(G.target.files&&G.target.files[0]){const V=G.target.files[0];S({pdKitFile:V});const ae=new FileReader;ae.onload=B=>{var C;b((C=B.target)==null?void 0:C.result)},ae.readAsDataURL(V)}},M=()=>{S({pdKitFile:null}),b(null),g("")},L=async G=>{if(!k.pdKitFile||!e||!G)return g("No file selected"),!1;y(!0),g("");try{const{data:V,error:ae}=await se.from("site_visit").select("client_Id").eq("id",G).single();if(ae)throw ae;if(!V)throw new Error("Visit not found");const B=k.pdKitFile.name.split(".").pop(),I=`pd-kits/${`${e.id}-${G}-${Date.now()}.${B}`}`,{error:N}=await se.storage.from("pd-kits").upload(I,k.pdKitFile);if(N)throw N;if(w&&w.includes("pd-kits/")){const K=w.split("pd-kits/")[1].split("?")[0];await se.storage.from("pd-kits").remove([K])}const{error:j}=await se.from("pd_kit_uploads").upsert({employee_id:e.id,client_id:V.client_Id,visit_id:G,file_path:I,upload_type:"end"});if(j)throw j;return!0}catch(V){return console.error("Error uploading PD Kit:",V),g(V.message||"Failed to upload PD Kit"),!1}finally{y(!1)}},D=G=>G===1&&!k.notes?(p("Please enter notes"),!1):G===2&&!k.address?(p("Please enter an address"),!1):G===3&&!k.exitLocation?(p("Please enter exit location"),!1):G===3&&(!k.latitude||!k.longitude)?(p("Please update your location coordinates"),!1):(p(""),!0);async function Q(G){if(G.preventDefault(),!!D(3)){o(!0),p("");try{let V=r;if(!r){const{data:C,error:I}=await se.from("site_visit").insert([{employee_id:e.id,status:"start",visit_date:new Date().toISOString()}]).select().single();if(I)throw I;V=C.id}const{error:ae}=await se.from("site_visit").update({status:"end"}).eq("id",V);if(ae)throw ae;const{error:B}=await se.from("site_visit_form").upsert({id:r||void 0,visit_id:V,address:k.address,contact_no:k.contactNo,notes:k.notes,exit_location:k.exitLocation,latitude:k.latitude,longitude:k.longitude});if(B)throw B;if(k.selectedAssets.length>0){if(r){const{error:N}=await se.from("site_visit_assets").delete().eq("site_visit_id",V);if(N)throw N}const C=k.selectedAssets.map(N=>({site_visit_id:V,asset_id:N.assetId,quantity:Math.max(1,N.quantity)})),{error:I}=await se.from("site_visit_assets").insert(C);if(I)throw I}if((k.pdKitFile||w)&&!await L(V))throw new Error("Failed to upload PD Kit");localStorage.removeItem("draftSiteVisitForm"),window.dispatchEvent(new CustomEvent("siteVisitUpdated",{detail:{visitId:V}})),alert(`Site visit ${r?"completed":"created"} successfully!`),n("/site-visits",{replace:!0})}catch(V){console.error("Error saving site visit:",V),p(V.message||"Failed to save site visit")}finally{o(!1)}}}function ee(){return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Notes *"}),u.jsx("textarea",{value:k.notes,onChange:G=>S({notes:G.target.value}),className:"w-full p-2 border rounded h-32",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Contact No"}),u.jsx("input",{type:"text",value:k.contactNo,onChange:G=>S({contactNo:G.target.value}),className:"w-full p-2 border rounded"})]})]})}function Y(){return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Address *"}),u.jsx("input",{type:"text",value:k.address,onChange:G=>S({address:G.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Assets"}),u.jsx("div",{className:"space-y-3",children:l.map(G=>{var V;return u.jsxs("div",{className:"flex items-center gap-4 p-2 border rounded",children:[u.jsx("input",{type:"checkbox",id:`asset-${G.id}`,checked:k.selectedAssets.some(ae=>ae.assetId===G.id),onChange:ae=>{const B=ae.target.checked?[...k.selectedAssets,{assetId:G.id,quantity:1}]:k.selectedAssets.filter(C=>C.assetId!==G.id);S({selectedAssets:B})},className:"h-5 w-5"}),u.jsx("label",{htmlFor:`asset-${G.id}`,className:"flex-1",children:G.item}),k.selectedAssets.some(ae=>ae.assetId===G.id)&&u.jsx("input",{type:"number",min:"1",value:((V=k.selectedAssets.find(ae=>ae.assetId===G.id))==null?void 0:V.quantity)||1,onChange:ae=>{const B=k.selectedAssets.map(C=>C.assetId===G.id?{...C,quantity:Math.max(1,parseInt(ae.target.value)||1)}:C);S({selectedAssets:B})},className:"w-20 p-1 border rounded"})]},G.id)})})]})]})}function q(){return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Exit Location *"}),u.jsx("input",{type:"text",value:k.exitLocation,onChange:G=>S({exitLocation:G.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Location Coordinates *"}),u.jsx("button",{type:"button",onClick:T,disabled:f,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-green-400 flex items-center gap-2 mb-2",children:f?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Getting Location..."]}):"Update Current Location"}),h&&u.jsx("p",{className:"text-red-500 text-sm",children:h}),u.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium",children:"Latitude"}),u.jsx("p",{className:"text-sm text-gray-700 bg-gray-100 p-2 rounded",children:k.latitude||"Not set"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium",children:"Longitude"}),u.jsx("p",{className:"text-sm text-gray-700 bg-gray-100 p-2 rounded",children:k.longitude||"Not set"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"PD Kit (End of Visit)"}),u.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[w?u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:w,alt:"PD Kit Preview",className:"max-h-48 mb-2 rounded"}),u.jsx("button",{type:"button",onClick:M,className:"absolute top-0 right-0 bg-white rounded-full p-1 shadow",children:u.jsx(Ki,{className:"w-4 h-4 text-red-500"})})]}),u.jsx("button",{type:"button",onClick:()=>{var G;return(G=document.getElementById("pd-kit-upload"))==null?void 0:G.click()},className:"text-blue-600 hover:underline text-sm",children:"Change PD Kit"})]}):u.jsx("label",{htmlFor:"pd-kit-upload",className:"cursor-pointer",children:u.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[u.jsx(Ux,{className:"w-8 h-8 text-gray-400"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload PD Kit image"}),u.jsx("p",{className:"text-xs text-gray-500",children:"(Optional for employees)"})]})}),u.jsx("input",{id:"pd-kit-upload",type:"file",accept:"image/*",onChange:P,className:"hidden"})]}),x&&u.jsx("p",{className:"text-red-500 text-sm mt-2",children:x})]})]})}return i?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white shadow-md rounded-lg mt-6",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:r?"Complete Site Visit":"Create New Site Visit"}),v&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:v}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex justify-between mb-2 text-sm font-medium",children:[u.jsx("span",{className:a===1?"text-blue-600":"text-gray-500",children:"Step 1: Details"}),u.jsx("span",{className:a===2?"text-blue-600":"text-gray-500",children:"Step 2: Assets"}),u.jsx("span",{className:a===3?"text-blue-600":"text-gray-500",children:"Step 3: Completion"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${(a-1)/2*100}%`}})})]}),u.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[a===1&&ee(),a===2&&Y(),a===3&&q(),u.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[a>1?u.jsx("button",{type:"button",onClick:()=>s(a-1),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",disabled:i,children:"Back"}):u.jsx("div",{}),a<3?u.jsx("button",{type:"button",onClick:()=>{D(a)&&s(a+1)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:i,children:"Continue"}):u.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",disabled:i||_,children:i||_?u.jsxs("span",{className:"flex items-center",children:[u.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),_?"Uploading PD Kit...":"Saving..."]}):r?"Complete Visit":"Create Visit"})]})]})]})}function ste(){const[e,t]=O.useState([]),r=Pn();O.useEffect(()=>{n()},[]);async function n(){const{data:a,error:s}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","completed");if(s){console.error("Error loading clients:",s);return}t(a||[])}return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsx("div",{className:"flex justify-between items-center mb-6",children:u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Clients History"})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(a=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:a.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:a.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:a.address}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("button",{onClick:()=>r(`/clientshistoryprofile/${a.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"})})]},a.id))})]})}function ite(){const[e,t]=O.useState([]),[r,n]=O.useState([]),[a,s]=O.useState(""),[i,o]=O.useState(!1),[l,c]=O.useState(!1),[f,d]=O.useState(null),[h,m]=O.useState([]),v=Je(D=>D.user),[p,_]=O.useState({title:"",description:"",date:"",time:"",assignTo:"self"}),[y,x]=O.useState(!1),[g,w]=O.useState("");O.useEffect(()=>{k(),b();const D=setInterval(E,6e4);return()=>clearInterval(D)},[]),O.useEffect(()=>{E()},[e]);async function b(){const{data:D,error:Q}=await se.from("employees").select("*");Q||m(D||[])}async function k(){x(!0);try{const{data:D,error:Q}=await se.from("notifications").select("*").order("scheduled_at",{ascending:!1});if(Q)throw Q;t(D||[])}catch(D){console.error("Error loading notifications:",D),w("Failed to load notifications")}finally{x(!1)}}function E(){const D=new Date,Q=e.filter(ee=>new Date(ee.scheduled_at)<=D&&!ee.is_delivered);n(Q)}async function S(D){D.preventDefault(),x(!0),w("");try{const Q=new Date(`${p.date}T${p.time}`).toISOString(),ee=p.assignTo==="all"?h.map(G=>G.id):[v==null?void 0:v.id],{data:Y,error:q}=await se.from("notifications").insert(ee.map(G=>({title:p.title,description:p.description,scheduled_at:Q,created_by:v==null?void 0:v.id,assigned_to:G,is_delivered:!1}))).select();if(q)throw q;t([...Y,...e]),_({title:"",description:"",date:"",time:"",assignTo:"self"}),o(!1)}catch(Q){console.error("Error creating notification:",Q),w("Failed to create notification")}finally{x(!1)}}async function T(D){try{await se.from("notifications").update({is_delivered:!0}).eq("id",D),t(e.map(Q=>Q.id===D?{...Q,is_delivered:!0}:Q))}catch(Q){console.error("Error marking notification:",Q)}}async function P(D,Q){x(!0);try{const ee=Q==="all"?h.map(G=>G.id):[v==null?void 0:v.id];await se.from("notifications").delete().eq("id",D);const{data:Y,error:q}=await se.from("notifications").insert(ee.map(G=>({...f,id:void 0,assigned_to:G,is_delivered:!1}))).select();if(q)throw q;t([...Y,...e.filter(G=>G.id!==D)]),c(!1)}catch(ee){console.error("Error assigning notification:",ee),w("Failed to assign notification")}finally{x(!1)}}const M=D=>new Date(D).toLocaleDateString(),L=D=>new Date(D).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Notification Center"}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative w-full sm:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Notifications",value:a,onChange:D=>s(D.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 w-full sm:w-auto justify-center",disabled:y,children:[u.jsx(us,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Notification"})]})]})]}),g&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:g}),y&&!e.length?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r.length===0?u.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:u.jsx("p",{className:"text-gray-500",children:"No active notifications"})}):u.jsx("div",{className:"space-y-4",children:r.filter(D=>D.title.toLowerCase().includes(a.toLowerCase())||D.description&&D.description.toLowerCase().includes(a.toLowerCase())).map(D=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow w-full relative",children:[u.jsx("button",{onClick:()=>T(D.id),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",title:"Dismiss notification",children:u.jsx(Ki,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex justify-between items-start pr-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:D.title}),D.description&&u.jsx("p",{className:"text-gray-600 mb-4",children:D.description}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("span",{className:"text-xs text-gray-500",children:["Scheduled: ",M(D.scheduled_at)," at ",L(D.scheduled_at)]})})]}),u.jsx("div",{className:"flex gap-2",children:((v==null?void 0:v.role)==="head"||(v==null?void 0:v.role)==="admin"||(v==null?void 0:v.role)==="employee")&&u.jsxs("button",{onClick:()=>{d(D),c(!0)},className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",title:"Reassign notification",children:[D.assigned_to===(v==null?void 0:v.id)?u.jsx(zv,{className:"w-4 h-4"}):u.jsx(Gi,{className:"w-4 h-4"}),"Reassign"]})})]})]},D.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Create Notification"}),u.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",disabled:y,children:""})]}),u.jsxs("form",{onSubmit:S,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Title *"}),u.jsx("input",{type:"text",value:p.title,onChange:D=>_({...p,title:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:y})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Description"}),u.jsx("textarea",{value:p.description,onChange:D=>_({...p,description:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",rows:3,disabled:y})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Date *"}),u.jsx("input",{type:"date",value:p.date,onChange:D=>_({...p,date:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:y})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Time *"}),u.jsx("input",{type:"time",value:p.time,onChange:D=>_({...p,time:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:y})]})]}),((v==null?void 0:v.role)==="head"||(v==null?void 0:v.role)==="admin"||(v==null?void 0:v.role)==="e.head")&&u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Assign To"}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",name:"assignTo",value:"self",checked:p.assignTo==="self",onChange:()=>_({...p,assignTo:"self"}),className:"h-4 w-4",disabled:y}),u.jsx("span",{children:"Only me"})]}),u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",name:"assignTo",value:"all",checked:p.assignTo==="all",onChange:()=>_({...p,assignTo:"all"}),className:"h-4 w-4",disabled:y}),u.jsx("span",{children:"All employees"})]})]})]}),g&&u.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 text-sm rounded",children:g}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),disabled:y,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:y||!p.title||!p.date||!p.time,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:y?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Notification"})]})]})]})}),l&&f&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Reassign Notification"}),u.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",disabled:y,children:""})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:f.title}),f.description&&u.jsx("p",{className:"text-gray-600 mb-4",children:f.description})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-gray-700 mb-4 font-medium",children:"Assign To"}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("button",{onClick:()=>P(f.id,"self"),disabled:y,className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:u.jsx(zv,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"font-medium",children:"Only me"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Assign this notification only to yourself"})]})]}),u.jsxs("button",{onClick:()=>P(f.id,"all"),disabled:y,className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[u.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:u.jsx(Gi,{className:"w-5 h-5 text-green-600"})}),u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"font-medium",children:"All employees"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Assign this notification to all employees"})]})]})]})]}),g&&u.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 text-sm rounded",children:g})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var v4=1252,ote=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Q1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Z1=function(e){ote.indexOf(e)!=-1&&(v4=Q1[0]=e)};function lte(){Z1(1252)}var qn=function(e){Z1(e)};function g4(){qn(1200),lte()}function db(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function cte(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function x4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Oc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?cte(e.slice(2)):t==254&&r==255?x4(e.slice(2)):t==65279?e.slice(1):e},md=function(t){return String.fromCharCode(t)},hb=function(t){return String.fromCharCode(t)},Fs,Us="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pb(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Us.charAt(s)+Us.charAt(i)+Us.charAt(o)+Us.charAt(l);return t}function ln(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Us.indexOf(e.charAt(c++)),i=Us.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Us.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Us.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var $e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),mo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function si(e){return $e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function mb(e){return $e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gn=function(t){return $e?mo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function vo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function ey(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ey(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Rs=$e?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:mo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function ute(e){for(var t=[],r=0,n=e.length+250,a=si(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=si(65535),n=65530)}return t.push(a.slice(0,r)),Rs(t)}var Pr=/\u0000/g,Dc=/[\u0001-\u0006]/g;function cl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xn(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}function ty(e,t){var r=""+e;return r.length>=t?r:Tt(" ",t-r.length)+r}function W0(e,t){var r=""+e;return r.length>=t?r:r+Tt(" ",t-r.length)}function fte(e,t){var r=""+Math.round(e);return r.length>=t?r:Tt("0",t-r.length)+r}function dte(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}var vb=Math.pow(2,32);function Oo(e,t){if(e>vb||e<-vb)return fte(e,t);var r=Math.round(e);return dte(r,t)}function V0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var gb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Tm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hte(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},xb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},pte={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function H0(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(a);c<t&&(d=Math.floor(a),o=d*i+s,f=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function Pi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=_te(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var y4=new Date(1899,11,31,0,0,0),mte=y4.getTime(),vte=new Date(1900,2,1,0,0,0);function _4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=vte&&(r+=24*60*60*1e3),(r-(mte+(e.getTimezoneOffset()-y4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ry(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gte(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xte(e){var t=e<0?12:11,r=ry(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function yte(e){var t=ry(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Yu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xte(e):t===10?r=e.toFixed(10).substr(0,12):r=yte(e),ry(gte(r.toUpperCase()))}function ro(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return jn(14,_4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _te(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wte(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Tm[r.m-1][1];case 5:return Tm[r.m-1][0];default:return Tm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return gb[r.q][0];default:return gb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Xn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Xn(l,c):"";return f}function Ws(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var w4=/%/g;function bte(e,t,r){var n=t.replace(w4,""),a=t.length-n.length;return rs(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function Ete(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function b4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+b4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var E4=/# (\?+)( ?)\/( ?)(\d+)/;function Ste(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Tt(" ",e[1].length+1+e[4].length):ty(i,e[1].length)+e[2]+"/"+e[3]+Xn(o,e[4].length))}function kte(e,t,r){return r+(t===0?"":""+t)+Tt(" ",e[1].length+2+e[4].length)}var S4=/^#*0*\.([0#]+)/,k4=/\).*[0#]/,T4=/\(###\) ###\\?-####/;function Ar(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function yb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function _b(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Tte(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Cte(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(k4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vn("n",n,r):"("+vn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ete(e,t,r);if(t.indexOf("%")!==-1)return bte(e,t,r);if(t.indexOf("E")!==-1)return b4(t,r);if(t.charCodeAt(0)===36)return"$"+vn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Oo(l,t.length);if(t.match(/^[#?]+$/))return a=Oo(r,0),a==="0"&&(a=""),a.length>t.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(E4))return Ste(s,l,c);if(t.match(/^#+0+$/))return c+Oo(l,t.length-t.indexOf("0"));if(s=t.match(S4))return a=yb(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])).replace(/\.(\d*)$/,function(v,p){return"."+p+Tt("0",Ar(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+yb(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ws(Oo(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vn(e,t,-r):Ws(""+(Math.floor(r)+Tte(r,s[1].length)))+"."+Xn(_b(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return vn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cl(vn(e,t.replace(/[\\-]/g,""),r)),i=0,cl(cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(T4))return a=vn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=H0(l,Math.pow(10,i)-1,!1),a=""+c,f=rs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=W0(o[2],i),f.length<s[4].length&&(f=Ar(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=H0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ty(o[1],i)+s[2]+"/"+s[3]+W0(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Oo(r,0),t.length<=a.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ar(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=_b(r,s[1].length),r<0?"-"+vn(e,t,-r):Ws(Cte(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Xn(0,3-v.length):"")+v})+"."+Xn(i,s[1].length);switch(t){case"###,##0.00":return vn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ws(Oo(l,0));return m!=="0"?c+m:"";case"###,###.00":return vn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return vn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Nte(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Ate(e,t,r){var n=t.replace(w4,""),a=t.length-n.length;return rs(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function C4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(k4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ma("n",n,r):"("+ma("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Nte(e,t,r);if(t.indexOf("%")!==-1)return Ate(e,t,r);if(t.indexOf("E")!==-1)return C4(t,r);if(t.charCodeAt(0)===36)return"$"+ma(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Xn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(E4))return kte(s,l,c);if(t.match(/^#+0+$/))return c+Xn(l,t.length-t.indexOf("0"));if(s=t.match(S4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])),a=a.replace(/\.(\d*)$/,function(v,p){return"."+p+Tt("0",Ar(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ws(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ma(e,t,-r):Ws(""+r)+"."+Tt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ma(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cl(ma(e,t.replace(/[\\-]/g,""),r)),i=0,cl(cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(T4))return a=ma(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=H0(l,Math.pow(10,i)-1,!1),a=""+c,f=rs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=W0(o[2],i),f.length<s[4].length&&(f=Ar(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=H0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ty(o[1],i)+s[2]+"/"+s[3]+W0(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ar(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ma(e,t,-r):Ws(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Xn(0,3-v.length):"")+v})+"."+Xn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Ws(""+l);return m!=="0"?c+m:"";default:if(t.match(/\.[0#?]*$/))return ma(e,t.slice(0,t.lastIndexOf(".")),r)+Ar(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rs(e,t,r){return(r|0)===r?ma(e,t,r):vn(e,t,r)}function Ote(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var N4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ec(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":V0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(N4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Dte(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!V0(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var m=e.charAt(++i),v=m==="("||m===")"?m:"t";a[a.length]={t:v,v:m},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Pi(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Pi(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(c==null&&(c=Pi(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(p.v=c.H>=12?"":""),p.t="T",i+=5,h="h"):(p.t="t",++i),c==null&&p.t==="T")return"";a[a.length]=p,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(N4)){if(c==null&&(c=Pi(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ec(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var _=0,y=0,x;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",_<1&&(_=1);break;case"s":(x=a[i].v.match(/\.0+$/))&&(y=Math.max(y,x[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[i].v.match(/[Hh]/)&&(_=1),_<2&&a[i].v.match(/[Mm]/)&&(_=2),_<3&&a[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",w;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=wte(a[i].t.charCodeAt(0),a[i].v,c,y),a[i].t="t";break;case"n":case"?":for(w=i+1;a[w]!=null&&((o=a[w].t)==="?"||o==="D"||(o===" "||o==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[i].v+=a[w].v,a[w]={v:"",t:";"},++w;g+=a[i].v,i=w-1;break;case"G":a[i].t="t",a[i].v=ro(t,r);break}var b="",k,E;if(g.length>0){g.charCodeAt(0)==40?(k=t<0&&g.charCodeAt(0)===45?-t:t,E=rs("n",g,k)):(k=t<0&&n>1?-t:t,E=rs("n",g,k),k<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),w=E.length-1;var S=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){S=i;break}var T=a.length;if(S===a.length&&E.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(w>=a[i].v.length-1?(w-=a[i].v.length,a[i].v=E.substr(w+1,a[i].v.length)):w<0?a[i].v="":(a[i].v=E.substr(0,w+1),w=-1),a[i].t="t",T=i);w>=0&&T<a.length&&(a[T].v=E.substr(0,w+1)+a[T].v)}else if(S!==a.length&&E.indexOf("E")===-1){for(w=E.indexOf(".")-1,i=S;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===S?a[i].v.indexOf(".")-1:a[i].v.length-1,b=a[i].v.substr(f+1);f>=0;--f)w>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(b=E.charAt(w--)+b);a[i].v=b,a[i].t="t",T=i}for(w>=0&&T<a.length&&(a[T].v=E.substr(0,w+1)+a[T].v),w=E.indexOf(".")+1,i=S;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==S)){for(f=a[i].v.indexOf(".")>-1&&i===S?a[i].v.indexOf(".")+1:0,b=a[i].v.substr(0,f);f<a[i].v.length;++f)w<E.length&&(b+=E.charAt(w++));a[i].v=b,a[i].t="t",T=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(k=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=rs(a[i].t,a[i].v,k),a[i].t="t");var P="";for(i=0;i!==a.length;++i)a[i]!=null&&(P+=a[i].v);return P}var wb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function jte(e,t){var r=Ote(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(wb),o=r[1].match(wb);return bb(t,i)?[n,r[0]]:bb(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function jn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:De)[e],n==null&&(n=r.table&&r.table[xb[e]]||De[xb[e]]),n==null&&(n=pte[e]||"General");break}if(V0(n,0))return ro(t,r);t instanceof Date&&(t=_4(t,r.date1904));var a=jte(n,t);if(V0(a[1]))return ro(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Dte(a[1],t,r,a[0])}function $i(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(De[r]==null){t<0&&(t=r);continue}if(De[r]==e){t=r;break}}t<0&&(t=391)}return De[t]=e,t}function A4(){De=hte()}var Pte={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},O4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Fte(e){var t=typeof e=="number"?De[e]:e;return t=t.replace(O4,"(\\d+)"),new RegExp("^"+t+"$")}function Rte(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(O4)||[]).forEach(function(d,h){var m=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":i=m;break;case"s":l=m;break;case"m":i>=0?o=m:a=m;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?f:c+"T"+f}var Mte=function(){var e={};e.version="1.2.0";function t(){for(var E=0,S=new Array(256),T=0;T!=256;++T)E=T,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,S[T]=E;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function n(E){var S=0,T=0,P=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)M[P]=E[P];for(P=0;P!=256;++P)for(T=E[P],S=256+P;S<4096;S+=256)T=M[S]=T>>>8^E[T&255];var L=[];for(P=1;P!=16;++P)L[P-1]=typeof Int32Array<"u"?M.subarray(P*256,P*256+256):M.slice(P*256,P*256+256);return L}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],f=a[5],d=a[6],h=a[7],m=a[8],v=a[9],p=a[10],_=a[11],y=a[12],x=a[13],g=a[14];function w(E,S){for(var T=S^-1,P=0,M=E.length;P<M;)T=T>>>8^r[(T^E.charCodeAt(P++))&255];return~T}function b(E,S){for(var T=S^-1,P=E.length-15,M=0;M<P;)T=g[E[M++]^T&255]^x[E[M++]^T>>8&255]^y[E[M++]^T>>16&255]^_[E[M++]^T>>>24]^p[E[M++]]^v[E[M++]]^m[E[M++]]^h[E[M++]]^d[E[M++]]^f[E[M++]]^c[E[M++]]^l[E[M++]]^o[E[M++]]^i[E[M++]]^s[E[M++]]^r[E[M++]];for(P+=15;M<P;)T=T>>>8^r[(T^E[M++])&255];return~T}function k(E,S){for(var T=S^-1,P=0,M=E.length,L=0,D=0;P<M;)L=E.charCodeAt(P++),L<128?T=T>>>8^r[(T^L)&255]:L<2048?(T=T>>>8^r[(T^(192|L>>6&31))&255],T=T>>>8^r[(T^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,D=E.charCodeAt(P++)&1023,T=T>>>8^r[(T^(240|L>>8&7))&255],T=T>>>8^r[(T^(128|L>>2&63))&255],T=T>>>8^r[(T^(128|D>>6&15|(L&3)<<4))&255],T=T>>>8^r[(T^(128|D&63))&255]):(T=T>>>8^r[(T^(224|L>>12&15))&255],T=T>>>8^r[(T^(128|L>>6&63))&255],T=T>>>8^r[(T^(128|L&63))&255]);return~T}return e.table=r,e.bstr=w,e.buf=b,e.str=k,e}(),Be=function(){var t={};t.version="1.2.1";function r(A,U){for(var F=A.split("/"),R=U.split("/"),W=0,H=0,te=Math.min(F.length,R.length);W<te;++W){if(H=F[W].length-R[W].length)return H;if(F[W]!=R[W])return F[W]<R[W]?-1:1}return F.length-R.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var U=A.lastIndexOf("/");return U===-1?A:A.slice(0,U+1)}function a(A){if(A.charAt(A.length-1)=="/")return a(A.slice(0,-1));var U=A.lastIndexOf("/");return U===-1?A:A.slice(U+1)}function s(A,U){typeof U=="string"&&(U=new Date(U));var F=U.getHours();F=F<<6|U.getMinutes(),F=F<<5|U.getSeconds()>>>1,A.write_shift(2,F);var R=U.getFullYear()-1980;R=R<<4|U.getMonth()+1,R=R<<5|U.getDate(),A.write_shift(2,R)}function i(A){var U=A.read_shift(2)&65535,F=A.read_shift(2)&65535,R=new Date,W=F&31;F>>>=5;var H=F&15;F>>>=4,R.setMilliseconds(0),R.setFullYear(F+1980),R.setMonth(H-1),R.setDate(W);var te=U&31;U>>>=5;var ce=U&63;return U>>>=6,R.setHours(U),R.setMinutes(ce),R.setSeconds(te<<1),R}function o(A){rr(A,0);for(var U={},F=0;A.l<=A.length-4;){var R=A.read_shift(2),W=A.read_shift(2),H=A.l+W,te={};switch(R){case 21589:F=A.read_shift(1),F&1&&(te.mtime=A.read_shift(4)),W>5&&(F&2&&(te.atime=A.read_shift(4)),F&4&&(te.ctime=A.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}A.l=H,U[R]=te}return U}var l;function c(){return l||(l={})}function f(A,U){if(A[0]==80&&A[1]==75)return Iy(A,U);if((A[0]|32)==109&&(A[1]|32)==105)return KO(A,U);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var F=3,R=512,W=0,H=0,te=0,ce=0,Z=0,re=[],ne=A.slice(0,512);rr(ne,0);var fe=d(ne);switch(F=fe[0],F){case 3:R=512;break;case 4:R=4096;break;case 0:if(fe[1]==0)return Iy(A,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}R!==512&&(ne=A.slice(0,R),rr(ne,28));var ve=A.slice(0,R);h(ne,F);var _e=ne.read_shift(4,"i");if(F===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);ne.l+=4,te=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ce=ne.read_shift(4,"i"),W=ne.read_shift(4,"i"),Z=ne.read_shift(4,"i"),H=ne.read_shift(4,"i");for(var pe=-1,ye=0;ye<109&&(pe=ne.read_shift(4,"i"),!(pe<0));++ye)re[ye]=pe;var Oe=m(A,R);_(Z,H,Oe,R,re);var xt=x(Oe,te,re,R);xt[te].name="!Directory",W>0&&ce!==D&&(xt[ce].name="!MiniFAT"),xt[re[0]].name="!FAT",xt.fat_addrs=re,xt.ssz=R;var yt={},ur=[],ic=[],oc=[];g(te,xt,Oe,ur,W,yt,ic,ce),v(ic,oc,ur),ur.shift();var lc={FileIndex:ic,FullPaths:oc};return U&&U.raw&&(lc.raw={header:ve,sectors:Oe}),lc}function d(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(Q,"Header Signature: "),A.l+=16;var U=A.read_shift(2,"u");return[A.read_shift(2,"u"),U]}function h(A,U){var F=9;switch(A.l+=2,F=A.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function m(A,U){for(var F=Math.ceil(A.length/U)-1,R=[],W=1;W<F;++W)R[W-1]=A.slice(W*U,(W+1)*U);return R[F-1]=A.slice(F*U),R}function v(A,U,F){for(var R=0,W=0,H=0,te=0,ce=0,Z=F.length,re=[],ne=[];R<Z;++R)re[R]=ne[R]=R,U[R]=F[R];for(;ce<ne.length;++ce)R=ne[ce],W=A[R].L,H=A[R].R,te=A[R].C,re[R]===R&&(W!==-1&&re[W]!==W&&(re[R]=re[W]),H!==-1&&re[H]!==H&&(re[R]=re[H])),te!==-1&&(re[te]=R),W!==-1&&R!=re[R]&&(re[W]=re[R],ne.lastIndexOf(W)<ce&&ne.push(W)),H!==-1&&R!=re[R]&&(re[H]=re[R],ne.lastIndexOf(H)<ce&&ne.push(H));for(R=1;R<Z;++R)re[R]===R&&(H!==-1&&re[H]!==H?re[R]=re[H]:W!==-1&&re[W]!==W&&(re[R]=re[W]));for(R=1;R<Z;++R)if(A[R].type!==0){if(ce=R,ce!=re[ce])do ce=re[ce],U[R]=U[ce]+"/"+U[R];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[R]=-1}for(U[0]+="/",R=1;R<Z;++R)A[R].type!==2&&(U[R]+="/")}function p(A,U,F){for(var R=A.start,W=A.size,H=[],te=R;F&&W>0&&te>=0;)H.push(U.slice(te*L,te*L+L)),W-=L,te=Ni(F,te*4);return H.length===0?Bt(0):Rs(H).slice(0,A.size)}function _(A,U,F,R,W){var H=D;if(A===D){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var te=F[A],ce=(R>>>2)-1;if(!te)return;for(var Z=0;Z<ce&&(H=Ni(te,Z*4))!==D;++Z)W.push(H);_(Ni(te,R-4),U-1,F,R,W)}}function y(A,U,F,R,W){var H=[],te=[];W||(W=[]);var ce=R-1,Z=0,re=0;for(Z=U;Z>=0;){W[Z]=!0,H[H.length]=Z,te.push(A[Z]);var ne=F[Math.floor(Z*4/R)];if(re=Z*4&ce,R<4+re)throw new Error("FAT boundary crossed: "+Z+" 4 "+R);if(!A[ne])break;Z=Ni(A[ne],re)}return{nodes:H,data:jb([te])}}function x(A,U,F,R){var W=A.length,H=[],te=[],ce=[],Z=[],re=R-1,ne=0,fe=0,ve=0,_e=0;for(ne=0;ne<W;++ne)if(ce=[],ve=ne+U,ve>=W&&(ve-=W),!te[ve]){Z=[];var pe=[];for(fe=ve;fe>=0;){pe[fe]=!0,te[fe]=!0,ce[ce.length]=fe,Z.push(A[fe]);var ye=F[Math.floor(fe*4/R)];if(_e=fe*4&re,R<4+_e)throw new Error("FAT boundary crossed: "+fe+" 4 "+R);if(!A[ye]||(fe=Ni(A[ye],_e),pe[fe]))break}H[ve]={nodes:ce,data:jb([Z])}}return H}function g(A,U,F,R,W,H,te,ce){for(var Z=0,re=R.length?2:0,ne=U[A].data,fe=0,ve=0,_e;fe<ne.length;fe+=128){var pe=ne.slice(fe,fe+128);rr(pe,64),ve=pe.read_shift(2),_e=oy(pe,0,ve-re),R.push(_e);var ye={name:_e,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Oe=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Oe!==0&&(ye.ct=w(pe,pe.l-8));var xt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);xt!==0&&(ye.mt=w(pe,pe.l-8)),ye.start=pe.read_shift(4,"i"),ye.size=pe.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=D,ye.name=""),ye.type===5?(Z=ye.start,W>0&&Z!==D&&(U[Z].name="!StreamData")):ye.size>=4096?(ye.storage="fat",U[ye.start]===void 0&&(U[ye.start]=y(F,ye.start,U.fat_addrs,U.ssz)),U[ye.start].name=ye.name,ye.content=U[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:Z!==D&&ye.start!==D&&U[Z]&&(ye.content=p(ye,U[Z].data,(U[ce]||{}).data))),ye.content&&rr(ye.content,0),H[_e]=ye,te.push(ye)}}function w(A,U){return new Date((Zr(A,U+4)/1e7*Math.pow(2,32)+Zr(A,U)/1e7-11644473600)*1e3)}function b(A,U){return c(),f(l.readFileSync(A),U)}function k(A,U){var F=U&&U.type;switch(F||$e&&Buffer.isBuffer(A)&&(F="buffer"),F||"base64"){case"file":return b(A,U);case"base64":return f(Gn(ln(A)),U);case"binary":return f(Gn(A),U)}return f(A,U)}function E(A,U){var F=U||{},R=F.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=R+"/",A.FileIndex[0]={name:R,type:5}),F.CLSID&&(A.FileIndex[0].clsid=F.CLSID),S(A)}function S(A){var U="Sh33tJ5";if(!Be.find(A,"/"+U)){var F=Bt(4);F[0]=55,F[1]=F[3]=50,F[2]=54,A.FileIndex.push({name:U,type:2,content:F,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+U),T(A)}}function T(A,U){E(A);for(var F=!1,R=!1,W=A.FullPaths.length-1;W>=0;--W){var H=A.FileIndex[W];switch(H.type){case 0:R?F=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(H.R*H.L*H.C)&&(F=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!U)){var te=new Date(1987,1,19),ce=0,Z=Object.create?Object.create(null):{},re=[];for(W=0;W<A.FullPaths.length;++W)Z[A.FullPaths[W]]=!0,A.FileIndex[W].type!==0&&re.push([A.FullPaths[W],A.FileIndex[W]]);for(W=0;W<re.length;++W){var ne=n(re[W][0]);R=Z[ne],R||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:Y,ct:te,mt:te,content:null}]),Z[ne]=!0)}for(re.sort(function(_e,pe){return r(_e[0],pe[0])}),A.FullPaths=[],A.FileIndex=[],W=0;W<re.length;++W)A.FullPaths[W]=re[W][0],A.FileIndex[W]=re[W][1];for(W=0;W<re.length;++W){var fe=A.FileIndex[W],ve=A.FullPaths[W];if(fe.name=a(ve).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||Y,W===0)fe.C=re.length>1?1:-1,fe.size=0,fe.type=5;else if(ve.slice(-1)=="/"){for(ce=W+1;ce<re.length&&n(A.FullPaths[ce])!=ve;++ce);for(fe.C=ce>=re.length?-1:ce,ce=W+1;ce<re.length&&n(A.FullPaths[ce])!=n(ve);++ce);fe.R=ce>=re.length?-1:ce,fe.type=1}else n(A.FullPaths[W+1]||"")==n(ve)&&(fe.R=W+1),fe.type=2}}}function P(A,U){var F=U||{};if(F.fileType=="mad")return qO(A,F);switch(T(A),F.fileType){case"zip":return WO(A,F)}var R=function(_e){for(var pe=0,ye=0,Oe=0;Oe<_e.FileIndex.length;++Oe){var xt=_e.FileIndex[Oe];if(xt.content){var yt=xt.content.length;yt>0&&(yt<4096?pe+=yt+63>>6:ye+=yt+511>>9)}}for(var ur=_e.FullPaths.length+3>>2,ic=pe+7>>3,oc=pe+127>>7,lc=ic+ye+ur+oc,yi=lc+127>>7,Ap=yi<=109?0:Math.ceil((yi-109)/127);lc+yi+Ap+127>>7>yi;)Ap=++yi<=109?0:Math.ceil((yi-109)/127);var La=[1,Ap,yi,oc,ur,ye,pe,0];return _e.FileIndex[0].size=pe<<6,La[7]=(_e.FileIndex[0].start=La[0]+La[1]+La[2]+La[3]+La[4]+La[5])+(La[6]+7>>3),La}(A),W=Bt(R[7]<<9),H=0,te=0;{for(H=0;H<8;++H)W.write_shift(1,ee[H]);for(H=0;H<8;++H)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),H=0;H<3;++H)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,R[2]),W.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:D),W.write_shift(4,R[3]),W.write_shift(-4,R[1]?R[0]-1:D),W.write_shift(4,R[1]),H=0;H<109;++H)W.write_shift(-4,H<R[2]?R[1]+H:-1)}if(R[1])for(te=0;te<R[1];++te){for(;H<236+te*127;++H)W.write_shift(-4,H<R[2]?R[1]+H:-1);W.write_shift(-4,te===R[1]-1?D:te+1)}var ce=function(_e){for(te+=_e;H<te-1;++H)W.write_shift(-4,H+1);_e&&(++H,W.write_shift(-4,D))};for(te=H=0,te+=R[1];H<te;++H)W.write_shift(-4,q.DIFSECT);for(te+=R[2];H<te;++H)W.write_shift(-4,q.FATSECT);ce(R[3]),ce(R[4]);for(var Z=0,re=0,ne=A.FileIndex[0];Z<A.FileIndex.length;++Z)ne=A.FileIndex[Z],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=te,ce(re+511>>9)));for(ce(R[6]+7>>3);W.l&511;)W.write_shift(-4,q.ENDOFCHAIN);for(te=H=0,Z=0;Z<A.FileIndex.length;++Z)ne=A.FileIndex[Z],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=te,ce(re+63>>6)));for(;W.l&511;)W.write_shift(-4,q.ENDOFCHAIN);for(H=0;H<R[4]<<2;++H){var fe=A.FullPaths[H];if(!fe||fe.length===0){for(Z=0;Z<17;++Z)W.write_shift(4,0);for(Z=0;Z<3;++Z)W.write_shift(4,-1);for(Z=0;Z<12;++Z)W.write_shift(4,0);continue}ne=A.FileIndex[H],H===0&&(ne.start=ne.size?ne.start-1:D);var ve=H===0&&F.root||ne.name;if(re=2*(ve.length+1),W.write_shift(64,ve,"utf16le"),W.write_shift(2,re),W.write_shift(1,ne.type),W.write_shift(1,ne.color),W.write_shift(-4,ne.L),W.write_shift(-4,ne.R),W.write_shift(-4,ne.C),ne.clsid)W.write_shift(16,ne.clsid,"hex");else for(Z=0;Z<4;++Z)W.write_shift(4,0);W.write_shift(4,ne.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ne.start),W.write_shift(4,ne.size),W.write_shift(4,0)}for(H=1;H<A.FileIndex.length;++H)if(ne=A.FileIndex[H],ne.size>=4096)if(W.l=ne.start+1<<9,$e&&Buffer.isBuffer(ne.content))ne.content.copy(W,W.l,0,ne.size),W.l+=ne.size+511&-512;else{for(Z=0;Z<ne.size;++Z)W.write_shift(1,ne.content[Z]);for(;Z&511;++Z)W.write_shift(1,0)}for(H=1;H<A.FileIndex.length;++H)if(ne=A.FileIndex[H],ne.size>0&&ne.size<4096)if($e&&Buffer.isBuffer(ne.content))ne.content.copy(W,W.l,0,ne.size),W.l+=ne.size+63&-64;else{for(Z=0;Z<ne.size;++Z)W.write_shift(1,ne.content[Z]);for(;Z&63;++Z)W.write_shift(1,0)}if($e)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function M(A,U){var F=A.FullPaths.map(function(Z){return Z.toUpperCase()}),R=F.map(function(Z){var re=Z.split("/");return re[re.length-(Z.slice(-1)=="/"?2:1)]}),W=!1;U.charCodeAt(0)===47?(W=!0,U=F[0].slice(0,-1)+U):W=U.indexOf("/")!==-1;var H=U.toUpperCase(),te=W===!0?F.indexOf(H):R.indexOf(H);if(te!==-1)return A.FileIndex[te];var ce=!H.match(Dc);for(H=H.replace(Pr,""),ce&&(H=H.replace(Dc,"!")),te=0;te<F.length;++te)if((ce?F[te].replace(Dc,"!"):F[te]).replace(Pr,"")==H||(ce?R[te].replace(Dc,"!"):R[te]).replace(Pr,"")==H)return A.FileIndex[te];return null}var L=64,D=-2,Q="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:Q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(A,U,F){c();var R=P(A,F);l.writeFileSync(U,R)}function V(A){for(var U=new Array(A.length),F=0;F<A.length;++F)U[F]=String.fromCharCode(A[F]);return U.join("")}function ae(A,U){var F=P(A,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,F),F;case"binary":return typeof F=="string"?F:V(F);case"base64":return pb(typeof F=="string"?F:V(F));case"buffer":if($e)return Buffer.isBuffer(F)?F:mo(F);case"array":return typeof F=="string"?Gn(F):F}return F}var B;function C(A){try{var U=A.InflateRaw,F=new U;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)B=A;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function I(A,U){if(!B)return Ry(A,U);var F=B.InflateRaw,R=new F,W=R._processChunk(A.slice(A.l),R._finishFlushFlag);return A.l+=R.bytesRead,W}function N(A){return B?B.deflateRawSync(A):Re(A)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function X(A){var U=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(U>>16|U>>8|U)&255}for(var le=typeof Uint8Array<"u",oe=le?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)oe[Ee]=X(Ee);function z(A,U){var F=oe[A&255];return U<=8?F>>>8-U:(F=F<<8|oe[A>>8&255],U<=16?F>>>16-U:(F=F<<8|oe[A>>16&255],F>>>24-U))}function je(A,U){var F=U&7,R=U>>>3;return(A[R]|(F<=6?0:A[R+1]<<8))>>>F&3}function ke(A,U){var F=U&7,R=U>>>3;return(A[R]|(F<=5?0:A[R+1]<<8))>>>F&7}function qe(A,U){var F=U&7,R=U>>>3;return(A[R]|(F<=4?0:A[R+1]<<8))>>>F&15}function Ae(A,U){var F=U&7,R=U>>>3;return(A[R]|(F<=3?0:A[R+1]<<8))>>>F&31}function me(A,U){var F=U&7,R=U>>>3;return(A[R]|(F<=1?0:A[R+1]<<8))>>>F&127}function tt(A,U,F){var R=U&7,W=U>>>3,H=(1<<F)-1,te=A[W]>>>R;return F<8-R||(te|=A[W+1]<<8-R,F<16-R)||(te|=A[W+2]<<16-R,F<24-R)||(te|=A[W+3]<<24-R),te&H}function cr(A,U,F){var R=U&7,W=U>>>3;return R<=5?A[W]|=(F&7)<<R:(A[W]|=F<<R&255,A[W+1]=(F&7)>>8-R),U+3}function gt(A,U,F){var R=U&7,W=U>>>3;return F=(F&1)<<R,A[W]|=F,U+1}function Ir(A,U,F){var R=U&7,W=U>>>3;return F<<=R,A[W]|=F&255,F>>>=8,A[W+1]=F,U+8}function ws(A,U,F){var R=U&7,W=U>>>3;return F<<=R,A[W]|=F&255,F>>>=8,A[W+1]=F&255,A[W+2]=F>>>8,U+16}function Ln(A,U){var F=A.length,R=2*F>U?2*F:U+5,W=0;if(F>=U)return A;if($e){var H=mb(R);if(A.copy)A.copy(H);else for(;W<A.length;++W)H[W]=A[W];return H}else if(le){var te=new Uint8Array(R);if(te.set)te.set(A);else for(;W<F;++W)te[W]=A[W];return te}return A.length=R,A}function er(A){for(var U=new Array(A),F=0;F<A;++F)U[F]=0;return U}function hn(A,U,F){var R=1,W=0,H=0,te=0,ce=0,Z=A.length,re=le?new Uint16Array(32):er(32);for(H=0;H<32;++H)re[H]=0;for(H=Z;H<F;++H)A[H]=0;Z=A.length;var ne=le?new Uint16Array(Z):er(Z);for(H=0;H<Z;++H)re[W=A[H]]++,R<W&&(R=W),ne[H]=0;for(re[0]=0,H=1;H<=R;++H)re[H+16]=ce=ce+re[H-1]<<1;for(H=0;H<Z;++H)ce=A[H],ce!=0&&(ne[H]=re[ce+16]++);var fe=0;for(H=0;H<Z;++H)if(fe=A[H],fe!=0)for(ce=z(ne[H],R)>>R-fe,te=(1<<R+4-fe)-1;te>=0;--te)U[ce|te<<fe]=fe&15|H<<4;return R}var $n=le?new Uint16Array(512):er(512),bs=le?new Uint16Array(32):er(32);if(!le){for(var Kt=0;Kt<512;++Kt)$n[Kt]=0;for(Kt=0;Kt<32;++Kt)bs[Kt]=0}(function(){for(var A=[],U=0;U<32;U++)A.push(5);hn(A,bs,32);var F=[];for(U=0;U<=143;U++)F.push(8);for(;U<=255;U++)F.push(9);for(;U<=279;U++)F.push(7);for(;U<=287;U++)F.push(8);hn(F,$n,288)})();var fa=function(){for(var U=le?new Uint8Array(32768):[],F=0,R=0;F<ie.length-1;++F)for(;R<ie[F+1];++R)U[R]=F;for(;R<32768;++R)U[R]=29;var W=le?new Uint8Array(259):[];for(F=0,R=0;F<K.length-1;++F)for(;R<K[F+1];++R)W[R]=F;function H(ce,Z){for(var re=0;re<ce.length;){var ne=Math.min(65535,ce.length-re),fe=re+ne==ce.length;for(Z.write_shift(1,+fe),Z.write_shift(2,ne),Z.write_shift(2,~ne&65535);ne-- >0;)Z[Z.l++]=ce[re++]}return Z.l}function te(ce,Z){for(var re=0,ne=0,fe=le?new Uint16Array(32768):[];ne<ce.length;){var ve=Math.min(65535,ce.length-ne);if(ve<10){for(re=cr(Z,re,+(ne+ve==ce.length)),re&7&&(re+=8-(re&7)),Z.l=re/8|0,Z.write_shift(2,ve),Z.write_shift(2,~ve&65535);ve-- >0;)Z[Z.l++]=ce[ne++];re=Z.l*8;continue}re=cr(Z,re,+(ne+ve==ce.length)+2);for(var _e=0;ve-- >0;){var pe=ce[ne];_e=(_e<<5^pe)&32767;var ye=-1,Oe=0;if((ye=fe[_e])&&(ye|=ne&-32768,ye>ne&&(ye-=32768),ye<ne))for(;ce[ye+Oe]==ce[ne+Oe]&&Oe<250;)++Oe;if(Oe>2){pe=W[Oe],pe<=22?re=Ir(Z,re,oe[pe+1]>>1)-1:(Ir(Z,re,3),re+=5,Ir(Z,re,oe[pe-23]>>5),re+=3);var xt=pe<8?0:pe-4>>2;xt>0&&(ws(Z,re,Oe-K[pe]),re+=xt),pe=U[ne-ye],re=Ir(Z,re,oe[pe]>>3),re-=3;var yt=pe<4?0:pe-2>>1;yt>0&&(ws(Z,re,ne-ye-ie[pe]),re+=yt);for(var ur=0;ur<Oe;++ur)fe[_e]=ne&32767,_e=(_e<<5^ce[ne])&32767,++ne;ve-=Oe-1}else pe<=143?pe=pe+48:re=gt(Z,re,1),re=Ir(Z,re,oe[pe]),fe[_e]=ne&32767,++ne}re=Ir(Z,re,0)-1}return Z.l=(re+7)/8|0,Z.l}return function(Z,re){return Z.length<8?H(Z,re):te(Z,re)}}();function Re(A){var U=Bt(50+Math.floor(A.length*1.1)),F=fa(A,U);return U.slice(0,F)}var At=le?new Uint16Array(32768):er(32768),pn=le?new Uint16Array(32768):er(32768),$t=le?new Uint16Array(128):er(128),xi=1,Fy=1;function $O(A,U){var F=Ae(A,U)+257;U+=5;var R=Ae(A,U)+1;U+=5;var W=qe(A,U)+4;U+=4;for(var H=0,te=le?new Uint8Array(19):er(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,re=le?new Uint8Array(8):er(8),ne=le?new Uint8Array(8):er(8),fe=te.length,ve=0;ve<W;++ve)te[j[ve]]=H=ke(A,U),Z<H&&(Z=H),re[H]++,U+=3;var _e=0;for(re[0]=0,ve=1;ve<=Z;++ve)ne[ve]=_e=_e+re[ve-1]<<1;for(ve=0;ve<fe;++ve)(_e=te[ve])!=0&&(ce[ve]=ne[_e]++);var pe=0;for(ve=0;ve<fe;++ve)if(pe=te[ve],pe!=0){_e=oe[ce[ve]]>>8-pe;for(var ye=(1<<7-pe)-1;ye>=0;--ye)$t[_e|ye<<pe]=pe&7|ve<<3}var Oe=[];for(Z=1;Oe.length<F+R;)switch(_e=$t[me(A,U)],U+=_e&7,_e>>>=3){case 16:for(H=3+je(A,U),U+=2,_e=Oe[Oe.length-1];H-- >0;)Oe.push(_e);break;case 17:for(H=3+ke(A,U),U+=3;H-- >0;)Oe.push(0);break;case 18:for(H=11+me(A,U),U+=7;H-- >0;)Oe.push(0);break;default:Oe.push(_e),Z<_e&&(Z=_e);break}var xt=Oe.slice(0,F),yt=Oe.slice(F);for(ve=F;ve<286;++ve)xt[ve]=0;for(ve=R;ve<30;++ve)yt[ve]=0;return xi=hn(xt,At,286),Fy=hn(yt,pn,30),U}function BO(A,U){if(A[0]==3&&!(A[1]&3))return[si(U),2];for(var F=0,R=0,W=mb(U||1<<18),H=0,te=W.length>>>0,ce=0,Z=0;!(R&1);){if(R=ke(A,F),F+=3,R>>>1)R>>1==1?(ce=9,Z=5):(F=$O(A,F),ce=xi,Z=Fy);else{F&7&&(F+=8-(F&7));var re=A[F>>>3]|A[(F>>>3)+1]<<8;if(F+=32,re>0)for(!U&&te<H+re&&(W=Ln(W,H+re),te=W.length);re-- >0;)W[H++]=A[F>>>3],F+=8;continue}for(;;){!U&&te<H+32767&&(W=Ln(W,H+32767),te=W.length);var ne=tt(A,F,ce),fe=R>>>1==1?$n[ne]:At[ne];if(F+=fe&15,fe>>>=4,!(fe>>>8&255))W[H++]=fe;else{if(fe==256)break;fe-=257;var ve=fe<8?0:fe-4>>2;ve>5&&(ve=0);var _e=H+K[fe];ve>0&&(_e+=tt(A,F,ve),F+=ve),ne=tt(A,F,Z),fe=R>>>1==1?bs[ne]:pn[ne],F+=fe&15,fe>>>=4;var pe=fe<4?0:fe-2>>1,ye=ie[fe];for(pe>0&&(ye+=tt(A,F,pe),F+=pe),!U&&te<_e&&(W=Ln(W,_e+100),te=W.length);H<_e;)W[H]=W[H-ye],++H}}}return U?[W,F+7>>>3]:[W.slice(0,H),F+7>>>3]}function Ry(A,U){var F=A.slice(A.l||0),R=BO(F,U);return A.l+=R[1],R[0]}function My(A,U){if(A)typeof console<"u"&&console.error(U);else throw new Error(U)}function Iy(A,U){var F=A;rr(F,0);var R=[],W=[],H={FileIndex:R,FullPaths:W};E(H,{root:U.root});for(var te=F.length-4;(F[te]!=80||F[te+1]!=75||F[te+2]!=5||F[te+3]!=6)&&te>=0;)--te;F.l=te+4,F.l+=4;var ce=F.read_shift(2);F.l+=6;var Z=F.read_shift(4);for(F.l=Z,te=0;te<ce;++te){F.l+=20;var re=F.read_shift(4),ne=F.read_shift(4),fe=F.read_shift(2),ve=F.read_shift(2),_e=F.read_shift(2);F.l+=8;var pe=F.read_shift(4),ye=o(F.slice(F.l+fe,F.l+fe+ve));F.l+=fe+ve+_e;var Oe=F.l;F.l=pe+4,UO(F,re,ne,H,ye),F.l=Oe}return H}function UO(A,U,F,R,W){A.l+=2;var H=A.read_shift(2),te=A.read_shift(2),ce=i(A);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var Z=A.read_shift(4),re=A.read_shift(4),ne=A.read_shift(4),fe=A.read_shift(2),ve=A.read_shift(2),_e="",pe=0;pe<fe;++pe)_e+=String.fromCharCode(A[A.l++]);if(ve){var ye=o(A.slice(A.l,A.l+ve));(ye[21589]||{}).mt&&(ce=ye[21589].mt),((W||{})[21589]||{}).mt&&(ce=W[21589].mt)}A.l+=ve;var Oe=A.slice(A.l,A.l+re);switch(te){case 8:Oe=I(A,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var xt=!1;H&8&&(Z=A.read_shift(4),Z==134695760&&(Z=A.read_shift(4),xt=!0),re=A.read_shift(4),ne=A.read_shift(4)),re!=U&&My(xt,"Bad compressed size: "+U+" != "+re),ne!=F&&My(xt,"Bad uncompressed size: "+F+" != "+ne),Np(R,_e,Oe,{unsafe:!0,mt:ce})}function WO(A,U){var F=U||{},R=[],W=[],H=Bt(1),te=F.compression?8:0,ce=0,Z=0,re=0,ne=0,fe=0,ve=A.FullPaths[0],_e=ve,pe=A.FileIndex[0],ye=[],Oe=0;for(Z=1;Z<A.FullPaths.length;++Z)if(_e=A.FullPaths[Z].slice(ve.length),pe=A.FileIndex[Z],!(!pe.size||!pe.content||_e=="Sh33tJ5")){var xt=ne,yt=Bt(_e.length);for(re=0;re<_e.length;++re)yt.write_shift(1,_e.charCodeAt(re)&127);yt=yt.slice(0,yt.l),ye[fe]=Mte.buf(pe.content,0);var ur=pe.content;te==8&&(ur=N(ur)),H=Bt(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ce),H.write_shift(2,te),pe.mt?s(H,pe.mt):H.write_shift(4,0),H.write_shift(-4,ye[fe]),H.write_shift(4,ur.length),H.write_shift(4,pe.content.length),H.write_shift(2,yt.length),H.write_shift(2,0),ne+=H.length,R.push(H),ne+=yt.length,R.push(yt),ne+=ur.length,R.push(ur),H=Bt(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ce),H.write_shift(2,te),H.write_shift(4,0),H.write_shift(-4,ye[fe]),H.write_shift(4,ur.length),H.write_shift(4,pe.content.length),H.write_shift(2,yt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,xt),Oe+=H.l,W.push(H),Oe+=yt.length,W.push(yt),++fe}return H=Bt(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,fe),H.write_shift(2,fe),H.write_shift(4,Oe),H.write_shift(4,ne),H.write_shift(2,0),Rs([Rs(R),Rs(W),H])}var $f={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function VO(A,U){if(A.ctype)return A.ctype;var F=A.name||"",R=F.match(/\.([^\.]+)$/);return R&&$f[R[1]]||U&&(R=(F=U).match(/[\.\\]([^\.\\])+$/),R&&$f[R[1]])?$f[R[1]]:"application/octet-stream"}function HO(A){for(var U=pb(A),F=[],R=0;R<U.length;R+=76)F.push(U.slice(R,R+76));return F.join(`\r
`)+`\r
`}function zO(A){var U=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],R=U.split(`\r
`),W=0;W<R.length;++W){var H=R[W];if(H.length==0){F.push("");continue}for(var te=0;te<H.length;){var ce=76,Z=H.slice(te,te+ce);Z.charAt(ce-1)=="="?ce--:Z.charAt(ce-2)=="="?ce-=2:Z.charAt(ce-3)=="="&&(ce-=3),Z=H.slice(te,te+ce),te+=ce,te<H.length&&(Z+="="),F.push(Z)}}return F.join(`\r
`)}function YO(A){for(var U=[],F=0;F<A.length;++F){for(var R=A[F];F<=A.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+A[++F];U.push(R)}for(var W=0;W<U.length;++W)U[W]=U[W].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Gn(U.join(`\r
`))}function GO(A,U,F){for(var R="",W="",H="",te,ce=0;ce<10;++ce){var Z=U[ce];if(!Z||Z.match(/^\s*$/))break;var re=Z.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":R=re[2].trim();break;case"content-type":H=re[2].trim();break;case"content-transfer-encoding":W=re[2].trim();break}}switch(++ce,W.toLowerCase()){case"base64":te=Gn(ln(U.slice(ce).join("")));break;case"quoted-printable":te=YO(U.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ne=Np(A,R.slice(F.length),te,{unsafe:!0});H&&(ne.ctype=H)}function KO(A,U){if(V(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=U&&U.root||"",R=($e&&Buffer.isBuffer(A)?A.toString("binary"):V(A)).split(`\r
`),W=0,H="";for(W=0;W<R.length;++W)if(H=R[W],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),F||(F=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),H.slice(0,F.length)!=F););var te=(R[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var ce="--"+(te[1]||""),Z=[],re=[],ne={FileIndex:Z,FullPaths:re};E(ne);var fe,ve=0;for(W=0;W<R.length;++W){var _e=R[W];_e!==ce&&_e!==ce+"--"||(ve++&&GO(ne,R.slice(fe,W),F),fe=W)}return ne}function qO(A,U){var F=U||{},R=F.boundary||"SheetJS";R="------="+R;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],H=A.FullPaths[0],te=H,ce=A.FileIndex[0],Z=1;Z<A.FullPaths.length;++Z)if(te=A.FullPaths[Z].slice(H.length),ce=A.FileIndex[Z],!(!ce.size||!ce.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,ne=$e&&Buffer.isBuffer(re)?re.toString("binary"):V(re),fe=0,ve=Math.min(1024,ne.length),_e=0,pe=0;pe<=ve;++pe)(_e=ne.charCodeAt(pe))>=32&&_e<128&&++fe;var ye=fe>=ve*4/5;W.push(R),W.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+te),W.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),W.push("Content-Type: "+VO(ce,te)),W.push(""),W.push(ye?zO(ne):HO(ne))}return W.push(R+`--\r
`),W.join(`\r
`)}function XO(A){var U={};return E(U,A),U}function Np(A,U,F,R){var W=R&&R.unsafe;W||E(A);var H=!W&&Be.find(A,U);if(!H){var te=A.FullPaths[0];U.slice(0,te.length)==te?te=U:(te.slice(-1)!="/"&&(te+="/"),te=(te+U).replace("//","/")),H={name:a(U),type:2},A.FileIndex.push(H),A.FullPaths.push(te),W||Be.utils.cfb_gc(A)}return H.content=F,H.size=F?F.length:0,R&&(R.CLSID&&(H.clsid=R.CLSID),R.mt&&(H.mt=R.mt),R.ct&&(H.ct=R.ct)),H}function JO(A,U){E(A);var F=Be.find(A,U);if(F){for(var R=0;R<A.FileIndex.length;++R)if(A.FileIndex[R]==F)return A.FileIndex.splice(R,1),A.FullPaths.splice(R,1),!0}return!1}function QO(A,U,F){E(A);var R=Be.find(A,U);if(R){for(var W=0;W<A.FileIndex.length;++W)if(A.FileIndex[W]==R)return A.FileIndex[W].name=a(F),A.FullPaths[W]=F,!0}return!1}function ZO(A){T(A,!0)}return t.find=M,t.read=k,t.parse=f,t.write=ae,t.writeFile=G,t.utils={cfb_new:XO,cfb_add:Np,cfb_del:JO,cfb_mov:QO,cfb_gc:ZO,ReadShift:Jc,CheckField:Q4,prep_blob:rr,bconcat:Rs,use_zlib:C,_deflateRaw:Re,_inflateRaw:Ry,consts:q},t}();function Ite(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Da(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ny(e){for(var t=[],r=Da(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var z0=new Date(1899,11,30,0,0,0);function Fr(e,t){var r=e.getTime(),n=z0.getTime()+(e.getTimezoneOffset()-z0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var D4=new Date,Lte=z0.getTime()+(D4.getTimezoneOffset()-z0.getTimezoneOffset())*6e4,Eb=D4.getTimezoneOffset();function hp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Lte),t.getTimezoneOffset()!==Eb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Eb)*6e4),t}function $te(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Sb=new Date("2017-02-19T19:06:09.000Z"),j4=isNaN(Sb.getFullYear())?new Date("2/19/17"):Sb,Bte=j4.getFullYear()==2017;function Zt(e,t){var r=new Date(e);if(Bte)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(j4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function no(e,t){if($e&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Pc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Pc(x4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Pc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Pc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sr(e[r]));return t}function Tt(e,t){for(var r="";r.length<t;)r+=e;return r}function Zn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Ute=["january","february","march","april","may","june","july","august","september","october","november","december"];function Nl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Ute.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Wte=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function P4(e){return e?e.content&&e.type?no(e.content,!0):e.data?Oc(e.data):e.asNodeBuffer&&$e?Oc(e.asNodeBuffer().toString("binary")):e.asBinary?Oc(e.asBinary()):e._data&&e._data.getContent?Oc(no(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function F4(e){if(!e)return null;if(e.data)return db(e.data);if(e.asNodeBuffer&&$e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?db(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Vte(e){return e&&e.name.slice(-4)===".bin"?F4(e):P4(e)}function gn(e,t){for(var r=e.FullPaths||Da(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function ay(e,t){var r=gn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mt(e,t,r){if(!r)return Vte(ay(e,t));if(!t)return null;try{return Mt(e,t)}catch{return null}}function en(e,t,r){if(!r)return P4(ay(e,t));if(!t)return null;try{return en(e,t)}catch{return null}}function Hte(e,t,r){return F4(ay(e,t))}function kb(e){for(var t=e.FullPaths||Da(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function zte(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return $e?n=mo(r):n=ute(r),Be.utils.cfb_add(e,t,n)}Be.utils.cfb_add(e,t,r)}else e.file(t,r)}function R4(e,t){switch(t.type){case"base64":return Be.read(e,{type:"base64"});case"binary":return Be.read(e,{type:"binary"});case"buffer":case"array":return Be.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var M4=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Yte=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Tb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Gte=/<[^>]*>/g,Tr=M4.match(Tb)?Tb:Gte,Kte=/<\w*:/,qte=/<(\/?)\w+:/;function Te(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(Yte),o=0,l="",c=0,f="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Ma(e){return e.replace(qte,"<$1")}var I4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Xte=ny(I4),He=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return I4[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Jte=/[&<>'"]/g,Qte=/[\u0000-\u001f]/g;function sy(e){var t=e+"";return t.replace(Jte,function(r){return Xte[r]}).replace(/\n/g,"<br/>").replace(Qte,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Cb=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Cm(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Nb(e){var t=si(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Ab(e){return mo(e,"binary").toString("utf8")}var vd="foo bar baz",st=$e&&(Ab(vd)==Cm(vd)&&Ab||Nb(vd)==Cm(vd)&&Nb)||Cm,Pc=$e?function(e){return mo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Gu=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),L4=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Zte=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ere=/<\/?(?:vt:)?variant>/g,tre=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ob(e,t){var r=Te(e),n=e.match(Zte(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(ere,"").match(tre);i&&a.push({v:st(i[2]),t:i[1]})}),a}var rre=/(^\s|\s$|\n)/;function nre(e){return Da(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function are(e,t,r){return"<"+e+(r!=null?nre(r):"")+(t!=null?(t.match(rre)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function iy(e){if($e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return st(vo(ey(e)));throw new Error("Bad input format: expected Buffer or string")}var Ku=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sre={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ire=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function ore(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function lre(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Db=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},jb=$e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:mo(t)})):Db(e)}:Db,Pb=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Qa(e,a)));return n.join("").replace(Pr,"")},oy=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Pr,""):Pb(e,t,r)}:Pb,Fb=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},$4=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Fb(e,t,r)}:Fb,Rb=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ro(e,a)));return n.join("")},Nf=$e?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Rb(t,r,n)}:Rb,B4=function(e,t){var r=Zr(e,t);return r>0?Nf(e,t+4,t+4+r-1):""},U4=B4,W4=function(e,t){var r=Zr(e,t);return r>0?Nf(e,t+4,t+4+r-1):""},V4=W4,H4=function(e,t){var r=2*Zr(e,t);return r>0?Nf(e,t+4,t+4+r-1):""},z4=H4,Y4=function(t,r){var n=Zr(t,r);return n>0?oy(t,r+4,r+4+n):""},G4=Y4,K4=function(e,t){var r=Zr(e,t);return r>0?Nf(e,t+4,t+4+r):""},q4=K4,X4=function(e,t){return ore(e,t)},Y0=X4,J4=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};$e&&(U4=function(t,r){if(!Buffer.isBuffer(t))return B4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},V4=function(t,r){if(!Buffer.isBuffer(t))return W4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},z4=function(t,r){if(!Buffer.isBuffer(t))return H4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},G4=function(t,r){if(!Buffer.isBuffer(t))return Y4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},q4=function(t,r){if(!Buffer.isBuffer(t))return K4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Y0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):X4(t,r)},J4=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ro=function(e,t){return e[t]},Qa=function(e,t){return e[t+1]*256+e[t]},cre=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ni=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ure=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Jc(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,$e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Qa(this,c)),c+=2;e*=2;break;case"utf8":r=Nf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=oy(this,this.l,this.l+e);break;case"wstr":return Jc.call(this,e,"dbcs");case"lpstr-ansi":r=U4(this,this.l),e=4+Zr(this,this.l);break;case"lpstr-cp":r=V4(this,this.l),e=4+Zr(this,this.l);break;case"lpwstr":r=z4(this,this.l),e=4+2*Zr(this,this.l);break;case"lpp4":e=4+Zr(this,this.l),r=G4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zr(this,this.l),r=q4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ro(this,this.l+e++))!==0;)s.push(md(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Qa(this,this.l+e))!==0;)s.push(md(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Ro(this,c),this.l=c+1,o=Jc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(md(Qa(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Ro(this,c),this.l=c+1,o=Jc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(md(Ro(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Ro(this,this.l),this.l++,n;case 2:return n=(t==="i"?cre:Qa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ni:ure)(this,this.l),this.l+=4,n):(a=Zr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Y0(this,this.l):a=Y0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=$4(this,this.l,e);break}}return this.l+=e,r}var fre=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},dre=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},hre=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function pre(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)hre(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,fre(this,t,this.l);break;case 8:if(n=8,r==="f"){lre(this,t,this.l);break}case 16:break;case-4:n=4,dre(this,t,this.l);break}return this.l+=n,this}function Q4(e,t){var r=$4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function rr(e,t){e.l=t,e.read_shift=Jc,e.chk=Q4,e.write_shift=pre}function br(e,t){e.l+=t}function Bt(e){var t=si(e);return rr(t,0),t}function _s(e,t,r){if(e){var n,a,s;rr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Q0[o]||Q0[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=l,t(f,c,o))return}}}function pg(){var e=[],t=$e?256:2048,r=function(c){var f=Bt(c);return rr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),Rs(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function Qc(e,t,r){var n=sr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Mb(e,t,r){var n=sr(e);return n.s=Qc(n.s,t.s,r),n.e=Qc(n.e,t.s,r),n}function Zc(e,t){if(e.cRel&&e.c<0)for(e=sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ne(e);return!e.cRel&&e.cRel!=null&&(r=gre(r)),!e.rRel&&e.rRel!=null&&(r=mre(r)),r}function Nm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ir(e.s.r)+":"+(e.e.rRel?"":"$")+ir(e.e.r):Zc(e.s,t.biff)+":"+Zc(e.e,t.biff)}function ly(e){return parseInt(vre(e),10)-1}function ir(e){return""+(e+1)}function mre(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function vre(e){return e.replace(/\$(\d+)$/,"$1")}function cy(e){for(var t=xre(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function gre(e){return e.replace(/^([A-Z])/,"$$$1")}function xre(e){return e.replace(/^\$([A-Z])/,"$1")}function yre(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ne(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function tc(e){var t=e.indexOf(":");return t==-1?{s:Dr(e),e:Dr(e)}:{s:Dr(e.slice(0,t)),e:Dr(e.slice(t+1))}}function Ue(e,t){return typeof t>"u"||typeof t=="number"?Ue(e.s,e.e):(typeof e!="string"&&(e=Ne(e)),typeof t!="string"&&(t=Ne(t)),e==t?e:e+":"+t)}function Nt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Ib(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=jn(e.z,r?Fr(t):t)}catch{}try{return e.w=jn((e.XF||{}).numFmtId||(r?14:0),r?Fr(t):t)}catch{return""+t}}function ps(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?yo[e.v]||e.v:t==null?Ib(e,e.v):Ib(e,t))}function vi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Z4(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Nt(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var m={v:t[d][h]},v=i+d,p=o+h;if(c.s.r>v&&(c.s.r=v),c.s.c>p&&(c.s.c=p),c.e.r<v&&(c.e.r=v),c.e.c<p&&(c.e.c=p),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))m=t[d][h];else if(Array.isArray(m.v)&&(m.f=t[d][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||De[14],n.cellDates?(m.t="d",m.w=jn(m.z,Fr(m.v))):(m.t="n",m.v=Fr(m.v),m.w=jn(m.z,m.v))):m.t="s";if(a)s[v]||(s[v]=[]),s[v][p]&&s[v][p].z&&(m.z=s[v][p].z),s[v][p]=m;else{var _=Ne({c:p,r:v});s[_]&&s[_].z&&(m.z=s[_].z),s[_]=m}}}return c.s.c<1e7&&(s["!ref"]=Ue(c)),s}function rc(e,t){return Z4(null,e,t)}function _re(e){return e.read_shift(4,"i")}function _r(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wre(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function uy(e,t){var r=e.l,n=e.read_shift(1),a=_r(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(wre(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var bre=uy;function In(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function go(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Ere=_r;function fy(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var Sre=_r,mg=fy;function dy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Y0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ni(t,0)>>2;return r?a/100:a}function eA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var xo=eA;function gr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function kre(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Bi[a];c&&(t.rgb=Xu(c));break;case 2:t.rgb=Xu([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Tre(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function tA(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Cre(e){return tA(e,1)}function Nre(e){return tA(e,2)}var hy=2,Br=3,gd=11,Lb=12,G0=19,xd=64,Are=65,Ore=71,Dre=4108,jre=4126,Xt=80,rA=81,Pre=[Xt,rA],Fre={1:{n:"CodePage",t:hy},2:{n:"Category",t:Xt},3:{n:"PresentationFormat",t:Xt},4:{n:"ByteCount",t:Br},5:{n:"LineCount",t:Br},6:{n:"ParagraphCount",t:Br},7:{n:"SlideCount",t:Br},8:{n:"NoteCount",t:Br},9:{n:"HiddenCount",t:Br},10:{n:"MultimediaClipCount",t:Br},11:{n:"ScaleCrop",t:gd},12:{n:"HeadingPairs",t:Dre},13:{n:"TitlesOfParts",t:jre},14:{n:"Manager",t:Xt},15:{n:"Company",t:Xt},16:{n:"LinksUpToDate",t:gd},17:{n:"CharacterCount",t:Br},19:{n:"SharedDoc",t:gd},22:{n:"HyperlinksChanged",t:gd},23:{n:"AppVersion",t:Br,p:"version"},24:{n:"DigSig",t:Are},26:{n:"ContentType",t:Xt},27:{n:"ContentStatus",t:Xt},28:{n:"Language",t:Xt},29:{n:"Version",t:Xt},255:{},2147483648:{n:"Locale",t:G0},2147483651:{n:"Behavior",t:G0},1919054434:{}},Rre={1:{n:"CodePage",t:hy},2:{n:"Title",t:Xt},3:{n:"Subject",t:Xt},4:{n:"Author",t:Xt},5:{n:"Keywords",t:Xt},6:{n:"Comments",t:Xt},7:{n:"Template",t:Xt},8:{n:"LastAuthor",t:Xt},9:{n:"RevNumber",t:Xt},10:{n:"EditTime",t:xd},11:{n:"LastPrinted",t:xd},12:{n:"CreatedDate",t:xd},13:{n:"ModifiedDate",t:xd},14:{n:"PageCount",t:Br},15:{n:"WordCount",t:Br},16:{n:"CharCount",t:Br},17:{n:"Thumbnail",t:Ore},18:{n:"Application",t:Xt},19:{n:"DocSecurity",t:Br},255:{},2147483648:{n:"Locale",t:G0},2147483651:{n:"Behavior",t:G0},1919054434:{}},$b={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Mre=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ire(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Lre=Ire([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Bi=sr(Lre),yo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Bb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function $re(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bre(e){var t=$re();if(!e||!e.match)return t;var r={};if((e.match(Tr)||[]).forEach(function(n){var a=Te(n);switch(a[0].replace(Kte,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Bb[a.ContentType]]!==void 0&&t[Bb[a.ContentType]].push(a.PartName);break}}),t.xmlns!==sre.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var qo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function eu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Tr)||[]).forEach(function(a){var s=Te(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:jc(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var Ure="application/vnd.oasis.opendocument.spreadsheet";function Wre(e,t){for(var r=iy(e),n,a;n=Ku.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Te(n[0],!1),a.path=="/"&&a.type!==Ure)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var tu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Vre=function(){for(var e=new Array(tu.length),t=0;t<tu.length;++t){var r=tu[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function aA(e){var t={};e=st(e);for(var r=0;r<tu.length;++r){var n=tu[r],a=e.match(Vre[r]);a!=null&&a.length>0&&(t[n[1]]=He(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Zt(t[n[1]]))}return t}var Hre=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function sA(e,t,r,n){var a=[];if(typeof e=="string")a=Ob(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Ob(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function zre(e,t,r){var n={};return t||(t={}),e=st(e),Hre.forEach(function(a){var s=(e.match(Gu(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=He(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&sA(n.HeadingPairs,n.TitlesOfParts,t,r),t}var Yre=/<[^>]+>[^<]*/g;function Gre(e,t){var r={},n="",a=e.match(Yre);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Te(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=He(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=He(f);break;case"bool":r[n]=mt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Zt(f);break;case"cy":case"error":r[n]=He(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var Kre={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Am;function qre(e,t,r){Am||(Am=ny(Kre)),t=Am[t]||t,e[t]=r}function py(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function iA(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function oA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function lA(e,t,r){return t===31?oA(e):iA(e,t,r)}function gg(e,t,r){return lA(e,t,r===!1?0:4)}function Xre(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return lA(e,t,0)}function Jre(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Pr,""),e.l-a&2&&(e.l+=2)}return r}function Qre(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Pr,"");return r}function Zre(e){var t=e.l,r=K0(e,rA);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=K0(e,Br);return[r,n]}function ene(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Zre(e));return r}function Ub(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Pr,"").replace(Dc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function cA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function tne(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function K0(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==Lb&&n!==t&&Pre.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Lb?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return iA(e,n,4).replace(Pr,"");case 31:return oA(e);case 64:return py(e);case 65:return cA(e);case 71:return tne(e);case 80:return gg(e,n,!s.raw).replace(Pr,"");case 81:return Xre(e,n).replace(Pr,"");case 4108:return ene(e);case 4126:case 4127:return n==4127?Jre(e):Qre(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Wb(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(x,g){return x[1]-g[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var m=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],m=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],m=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(m=!1,e.l=s[i][1]),m)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[s[i][0]];if(h[v.n]=K0(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qn(o=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(s[i][0]===1){if(o=h.CodePage=K0(e,hy),qn(o),l!==-1){var p=e.l;e.l=s[l][1],c=Ub(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Ub(e,o)}else{var _=c[s[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=cA(e);break;case 30:e.l+=4,y=gg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=gg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Ot(e,4);break;case 64:e.l+=4,y=Zt(py(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[_]=y}}return e.l=r+n,h}function Vb(e,t,r){var n=e.content;if(!n)return{};rr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Be.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=Wb(n,t),h={SystemIdentifier:c};for(var m in d)h[m]=d[m];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=Wb(n,null)}catch{}for(m in v)h[m]=v[m];return h.FMTID=[s,i],h}function ks(e,t){return e.read_shift(t),null}function rne(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ot(e,t){return e.read_shift(t)===1}function It(e){return e.read_shift(2,"u")}function uA(e,t){return rne(e,t,It)}function nne(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Af(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function ane(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ao(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Of(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ao(e,n,r)}function _o(e,t,r){if(r.biff>5)return Of(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function sne(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ine(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Pr,"");return n&&(e.l+=24),a}function one(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Pr,"");return r+i}function lne(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ine(e);case"0303000000000000c000000000000046":return one(e);default:throw new Error("Unsupported Moniker "+r)}}function yd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Pr,""):"";return r}function cne(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",f,d;a&16&&(s=yd(e,r-e.l)),a&128&&(i=yd(e,r-e.l)),(a&257)===257&&(o=yd(e,r-e.l)),(a&257)===1&&(l=lne(e,r-e.l)),a&8&&(c=yd(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=py(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return f&&(m.guid=f),d&&(m.time=d),s&&(m.Tooltip=s),m}function fA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function dA(e,t){var r=fA(e);return r[3]=0,r}function Ia(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function une(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function fne(e,t,r){return t===0?"":_o(e,t,r)}function dne(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function hA(e){var t=e.read_shift(2),r=dy(e);return[t,r]}function hne(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Af(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function pp(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function pA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var pne=pA;function mA(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function mne(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function vne(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function pr(e){e.l+=2,e.l+=e.read_shift(2)}var gne={0:pr,4:pr,5:pr,6:pr,7:vne,8:pr,9:pr,10:pr,11:pr,12:pr,13:mne,14:pr,15:pr,16:pr,17:pr,18:pr,19:pr,20:pr,21:mA};function xne(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(gne[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function _d(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function yne(e,t){return t===0||e.read_shift(2),1200}function _ne(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=_o(e,0,r);return e.read_shift(t+n-e.l),a}function wne(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function bne(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Af(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function Ene(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(ane(e));return s.Count=n,s.Unique=a,s}function Sne(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function kne(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Tne(e){var t=une(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Cne(e){return e.read_shift(2),e.read_shift(4)}function Hb(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function Nne(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function Ane(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function One(){}function Dne(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Af(e,0,r),n}function jne(e){var t=Ia(e);return t.isst=e.read_shift(4),t}function Pne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ia(e);r.biff==2&&e.l++;var s=Of(e,n-e.l,r);return a.val=s,a}function Fne(e,t,r){var n=e.read_shift(2),a=_o(e,0,r);return[n,a]}var Rne=_o;function zb(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function Mne(e){var t=e.read_shift(2),r=e.read_shift(2),n=hA(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Ine(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(hA(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function Lne(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function $ne(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Mre[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function Bne(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=$ne(e,t,n.fStyle,r),n}function Une(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Yb(e,t,r){var n=Ia(e);(r.biff==2||t==9)&&++e.l;var a=nne(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Wne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ia(e),a=gr(e);return n.val=a,n}var Gb=fne;function Vne(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ao(e,s),o=[];n>e.l;)o.push(Of(e));return[s,a,i,o]}function Kb(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=hne(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var Hne=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qb(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=ao(e,i,r);a&32&&(c=Hne[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:koe(e,f,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function vA(e,t,r){if(r.biff<8)return zne(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(dne(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function zne(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Af(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Yne(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=ao(e,n,r),i=ao(e,a,r);return[s,i]}function Gne(e,t,r){var n=pA(e);e.l++;var a=e.read_shift(1);return t-=8,[Toe(e,t,r),a,n]}function Xb(e,t,r){var n=pne(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Eoe(e,t,r)]}function Kne(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function qne(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=_o(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function Xne(e,t,r){return qne(e,t,r)}function Jne(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(pp(e));return r}function Qne(e,t,r){if(r&&r.biff<8)return eae(e,t,r);var n=mA(e),a=xne(e,t-22,n[1]);return{cmo:n,ft:a}}var Zne={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function eae(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Zne[n]||br)(e,t,r)),{cmo:[a,n,s],ft:i}}function tae(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=sne(e,6,r);var o=e.read_shift(2);e.read_shift(2),It(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=ao(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function rae(e,t){var r=pp(e);e.l+=16;var n=cne(e,t-24);return[r,n]}function nae(e,t){e.read_shift(2);var r=pp(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Pr,""),[r,n]}function aae(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=$b[r]||r,r=e.read_shift(2),t[1]=$b[r]||r,t}function sae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dA(e));return r}function iae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dA(e));return r}function oae(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function gA(e,t,r){if(!r.cellStyles)return br(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function lae(e,t){var r={};return t<32||(e.l+=16,r.header=gr(e),r.footer=gr(e),e.l+=2),r}function cae(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var uae=Ia,fae=uA,dae=Of;function hae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function pae(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ia(e);++e.l;var a=_o(e,t-7,r);return n.t="str",n.val=a,n}function mae(e){var t=Ia(e);++e.l;var r=gr(e);return t.t="n",t.val=r,t}function vae(e){var t=Ia(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function gae(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function xae(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function yae(e,t,r){var n=e.l+t,a=Ia(e),s=e.read_shift(2),i=ao(e,s,r);return e.l=n,a.t="str",a.val=i,a}var _ae=[2,3,48,49,131,139,140,245],Jb=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ny({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=si(1);switch(l.type){case"base64":f=Gn(ln(o));break;case"binary":f=Gn(o);break;case"buffer":case"array":f=o;break}rr(f,0);var d=f.read_shift(1),h=!!(d&136),m=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,_=521;d==2&&(p=f.read_shift(2)),f.l+=3,d!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(_=f.read_shift(2));var y=f.read_shift(2),x=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(x=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var g=[],w={},b=Math.min(f.length,d==2?521:_-10-(m?264:0)),k=v?32:11;f.l<b&&f[f.l]!=13;)switch(w={},w.name=Fs.utils.decode(x,f.slice(f.l,f.l+k)).replace(/[\u0000\r\n].*$/g,""),f.l+=k,w.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(w.offset=f.read_shift(4)),w.len=f.read_shift(1),d==2&&(w.offset=f.read_shift(2)),w.dec=f.read_shift(1),w.name.length&&g.push(w),d!=2&&(f.l+=v?13:14),w.type){case"B":(!m||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var E=0,S=0;for(c[0]=[],S=0;S!=g.length;++S)c[0][S]=g[S].name;for(;p-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,c[++E]=[],S=0,S=0;S!=g.length;++S){var T=f.slice(f.l,f.l+g[S].len);f.l+=g[S].len,rr(T,0);var P=Fs.utils.decode(x,T);switch(g[S].type){case"C":P.trim().length&&(c[E][S]=P.replace(/\s+$/,""));break;case"D":P.length===8?c[E][S]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):c[E][S]=P;break;case"F":c[E][S]=parseFloat(P.trim());break;case"+":case"I":c[E][S]=v?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":c[E][S]=!0;break;case"N":case"F":c[E][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[E][S]="##MEMO##"+(v?parseInt(P.trim(),10):T.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(c[E][S]=+P||0);break;case"@":c[E][S]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[E][S]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[E][S]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][S]=-T.read_shift(-8,"f");break;case"B":if(m&&g[S].len==8){c[E][S]=T.read_shift(8,"f");break}case"G":case"P":T.l+=g[S].len;break;case"0":if(g[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[S].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=rc(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function a(o,l){try{return vi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&qn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=pg(),d=Sg(o,{header:1,raw:!0,cellDates:!0}),h=d[0],m=d.slice(1),v=o["!cols"]||[],p=0,_=0,y=0,x=1;for(p=0;p<h.length;++p){if(((v[p]||{}).DBF||{}).name){h[p]=v[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(_=0;_<1024;++_)if(h.indexOf(h[p]+"_"+_)==-1){h[p]+="_"+_;break}}}}var g=Nt(o["!ref"]),w=[],b=[],k=[];for(p=0;p<=g.e.c-g.s.c;++p){var E="",S="",T=0,P=[];for(_=0;_<m.length;++_)m[_][p]!=null&&P.push(m[_][p]);if(P.length==0||h[p]==null){w[p]="?";continue}for(_=0;_<P.length;++_){switch(typeof P[_]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=P[_]instanceof Date?"D":"C";break;default:S="C"}T=Math.max(T,String(P[_]).length),E=E&&E!=S?"C":S}T>250&&(T=250),S=((v[p]||{}).DBF||{}).type,S=="C"&&v[p].DBF.len>T&&(T=v[p].DBF.len),E=="B"&&S=="N"&&(E="N",k[p]=v[p].DBF.dec,T=v[p].DBF.len),b[p]=E=="C"||S=="N"?T:s[E]||0,x+=b[p],w[p]=E}var M=f.next(32);for(M.write_shift(4,318902576),M.write_shift(4,m.length),M.write_shift(2,296+32*y),M.write_shift(2,x),p=0;p<4;++p)M.write_shift(4,0);for(M.write_shift(4,0|(+t[v4]||3)<<8),p=0,_=0;p<h.length;++p)if(h[p]!=null){var L=f.next(32),D=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,D,"sbcs"),L.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),L.write_shift(4,_),L.write_shift(1,b[p]||s[w[p]]||0),L.write_shift(1,k[p]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),_+=b[p]||s[w[p]]||0}var Q=f.next(264);for(Q.write_shift(4,13),p=0;p<65;++p)Q.write_shift(4,0);for(p=0;p<m.length;++p){var ee=f.next(x);for(ee.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(w[_]){case"L":ee.write_shift(1,m[p][_]==null?63:m[p][_]?84:70);break;case"B":ee.write_shift(8,m[p][_]||0,"f");break;case"N":var Y="0";for(typeof m[p][_]=="number"&&(Y=m[p][_].toFixed(k[_]||0)),y=0;y<b[_]-Y.length;++y)ee.write_shift(1,32);ee.write_shift(1,Y,"sbcs");break;case"D":m[p][_]?(ee.write_shift(4,("0000"+m[p][_].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(m[p][_].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+m[p][_].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var q=String(m[p][_]!=null?m[p][_]:"").slice(0,b[_]);for(ee.write_shift(1,q,"sbcs"),y=0;y<b[_]-q.length;++y)ee.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),wae=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Da(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var v=e[m];return typeof v=="number"?hb(v):v},n=function(h,m,v){var p=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?h:hb(p)};e["|"]=254;function a(h,m){switch(m.type){case"base64":return s(ln(h),m);case"binary":return s(h,m);case"buffer":return s($e&&Buffer.isBuffer(h)?h.toString("binary"):vo(h),m);case"array":return s(no(h),m)}throw new Error("Unrecognized type "+m.type)}function s(h,m){var v=h.split(/[\n\r]+/),p=-1,_=-1,y=0,x=0,g=[],w=[],b=null,k={},E=[],S=[],T=[],P=0,M;for(+m.codepage>=0&&qn(+m.codepage);y!==v.length;++y){P=0;var L=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),D=L.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),Q=D[0],ee;if(L.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&w.push(L.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,q=!1,G=!1,V=!1,ae=-1,B=-1;for(x=1;x<D.length;++x)switch(D[x].charAt(0)){case"A":break;case"X":_=parseInt(D[x].slice(1))-1,q=!0;break;case"Y":for(p=parseInt(D[x].slice(1))-1,q||(_=0),M=g.length;M<=p;++M)g[M]=[];break;case"K":ee=D[x].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(Zn(ee))?isNaN(Nl(ee).getDate())||(ee=Zt(ee)):(ee=Zn(ee),b!==null&&ec(b)&&(ee=hp(ee))),Y=!0;break;case"E":V=!0;var C=ul(D[x].slice(1),{r:p,c:_});g[p][_]=[g[p][_],C];break;case"S":G=!0,g[p][_]=[g[p][_],"S5S"];break;case"G":break;case"R":ae=parseInt(D[x].slice(1))-1;break;case"C":B=parseInt(D[x].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}if(Y&&(g[p][_]&&g[p][_].length==2?g[p][_][0]=ee:g[p][_]=ee,b=null),G){if(V)throw new Error("SYLK shared formula cannot have own formula");var I=ae>-1&&g[ae][B];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");g[p][_][1]=CA(I[1],{r:p-ae,c:_-B})}break;case"F":var N=0;for(x=1;x<D.length;++x)switch(D[x].charAt(0)){case"X":_=parseInt(D[x].slice(1))-1,++N;break;case"Y":for(p=parseInt(D[x].slice(1))-1,M=g.length;M<=p;++M)g[M]=[];break;case"M":P=parseInt(D[x].slice(1))/20;break;case"F":break;case"G":break;case"P":b=w[parseInt(D[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=D[x].slice(1).split(" "),M=parseInt(T[0],10);M<=parseInt(T[1],10);++M)P=parseInt(T[2],10),S[M-1]=P===0?{hidden:!0}:{wch:P},Al(S[M-1]);break;case"C":_=parseInt(D[x].slice(1))-1,S[_]||(S[_]={});break;case"R":p=parseInt(D[x].slice(1))-1,E[p]||(E[p]={}),P>0?(E[p].hpt=P,E[p].hpx=Ju(P)):P===0&&(E[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}N<1&&(b=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}}return E.length>0&&(k["!rows"]=E),S.length>0&&(k["!cols"]=S),m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),[g,k]}function i(h,m){var v=a(h,m),p=v[0],_=v[1],y=rc(p,m);return Da(_).forEach(function(x){y[x]=_[x]}),y}function o(h,m){return vi(i(h,m),m)}function l(h,m,v,p){var _="C;Y"+(v+1)+";X"+(p+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+oie(h.f,{r:v,c:p}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,m){m.forEach(function(v,p){var _="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=X0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=J0(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function f(h,m){m.forEach(function(v,p){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*SA(v.hpx)+";"),_.length>2&&h.push(_+"R"+(p+1))})}function d(h,m){var v=["ID;PWXL;N;E"],p=[],_=Nt(h["!ref"]),y,x=Array.isArray(h),g=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&c(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var w=_.s.r;w<=_.e.r;++w)for(var b=_.s.c;b<=_.e.c;++b){var k=Ne({r:w,c:b});y=x?(h[w]||[])[b]:h[k],!(!y||y.v==null&&(!y.f||y.F))&&p.push(l(y,h,w,b))}return v.join(g)+g+p.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),bae=function(){function e(s,i){switch(i.type){case"base64":return t(ln(s),i);case"binary":return t(s,i);case"buffer":return t($e&&Buffer.isBuffer(s)?s.toString("binary"):vo(s),i);case"array":return t(no(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[f].trim().split(","),m=h[0],v=h[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+m){case-1:if(p==="BOT"){d[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[l][c]=!0:p==="FALSE"?d[l][c]=!1:isNaN(Zn(v))?isNaN(Nl(v).getDate())?d[l][c]=v:d[l][c]=Zt(v):d[l][c]=Zn(v),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return rc(e(s,i),i)}function n(s,i){return vi(r(s,i),i)}var a=function(){var s=function(l,c,f,d,h){l.push(c),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=Nt(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){i(c,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var p=Ne({r:m,c:v});if(d=h?(l[m]||[])[v]:l[p],!d){i(c,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,_,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=jn(d.z||De[14],Fr(Zt(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var y=`\r
`,x=c.join(y);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Eae=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var m=d.split(`
`),v=-1,p=-1,_=0,y=[];_!==m.length;++_){var x=m[_].trim().split(":");if(x[0]==="cell"){var g=Dr(x[1]);if(y.length<=g.r)for(v=y.length;v<=g.r;++v)y[v]||(y[v]=[]);switch(v=g.r,p=g.c,x[2]){case"t":y[v][p]=e(x[3]);break;case"v":y[v][p]=+x[3];break;case"vtf":var w=x[x.length-1];case"vtc":switch(x[3]){case"nl":y[v][p]=!!+x[4];break;default:y[v][p]=+x[4];break}x[2]=="vtf"&&(y[v][p]=[y[v][p],w])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(d,h){return rc(r(d,h),h)}function a(d,h){return vi(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],m=[],v,p="",_=tc(d["!ref"]),y=Array.isArray(d),x=_.s.r;x<=_.e.r;++x)for(var g=_.s.c;g<=_.e.c;++g)if(p=Ne({r:x,c:g}),v=y?(d[x]||[])[g]:d[p],!(!v||v.v==null||v.t==="z")){switch(m=["cell",p,"t"],v.t){case"s":case"str":m.push(t(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=t(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var w=Fr(Zt(v.v));m[2]="vtc",m[3]="nd",m[4]=""+w,m[5]=v.w||jn(v.z||De[14],w);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,i,o,i,c(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),qu=function(){function e(f,d,h,m,v){v.raw?d[h][m]=f:f===""||(f==="TRUE"?d[h][m]=!0:f==="FALSE"?d[h][m]=!1:isNaN(Zn(f))?isNaN(Nl(f).getDate())?d[h][m]=f:d[h][m]=Zt(f):d[h][m]=Zn(f))}function t(f,d){var h=d||{},m=[];if(!f||f.length===0)return m;for(var v=f.split(/[\r\n]/),p=v.length-1;p>=0&&v[p].length===0;)--p;for(var _=10,y=0,x=0;x<=p;++x)y=v[x].indexOf(" "),y==-1?y=v[x].length:y++,_=Math.max(_,y);for(x=0;x<=p;++x){m[x]=[];var g=0;for(e(v[x].slice(0,_).trim(),m,x,g,h),g=1;g<=(v[x].length-_)/10+1;++g)e(v[x].slice(_+(g-1)*10,_+g*10).trim(),m,x,g,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,m=0,v=0;m<f.length;++m)(v=f.charCodeAt(m))==34?h=!h:!h&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&v.push([d[m],m]);if(!v.length){d=n;for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&v.push([d[m],m])}return v.sort(function(p,_){return p[0]-_[0]||n[p[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(f,d){var h=d||{},m="",v=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=a(f.slice(0,1024)):h&&h.FS?m=h.FS:m=a(f.slice(0,1024));var _=0,y=0,x=0,g=0,w=0,b=m.charCodeAt(0),k=!1,E=0,S=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var T=h.dateNF!=null?Fte(h.dateNF):null;function P(){var M=f.slice(g,w),L={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)L.t="z";else if(h.raw)L.t="s",L.v=M;else if(M.trim().length===0)L.t="s",L.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(L.t="s",L.v=M.slice(2,-1).replace(/""/g,'"')):cie(M)?(L.t="n",L.f=M.slice(1)):(L.t="s",L.v=M);else if(M=="TRUE")L.t="b",L.v=!0;else if(M=="FALSE")L.t="b",L.v=!1;else if(!isNaN(x=Zn(M)))L.t="n",h.cellText!==!1&&(L.w=M),L.v=x;else if(!isNaN(Nl(M).getDate())||T&&M.match(T)){L.z=h.dateNF||De[14];var D=0;T&&M.match(T)&&(M=Rte(M,h.dateNF,M.match(T)||[]),D=1),h.cellDates?(L.t="d",L.v=Zt(M,D)):(L.t="n",L.v=Fr(Zt(M,D))),h.cellText!==!1&&(L.w=jn(L.z,L.v instanceof Date?Fr(L.v):L.v)),h.cellNF||delete L.z}else L.t="s",L.v=M;if(L.t=="z"||(h.dense?(v[_]||(v[_]=[]),v[_][y]=L):v[Ne({c:y,r:_})]=L),g=w+1,S=f.charCodeAt(g),p.e.c<y&&(p.e.c=y),p.e.r<_&&(p.e.r=_),E==b)++y;else if(y=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;w<f.length;++w)switch(E=f.charCodeAt(w)){case 34:S===34&&(k=!k);break;case b:case 10:case 13:if(!k&&P())break e;break}return w-g>0&&P(),v["!ref"]=Ue(p),v}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):rc(t(f,d),d)}function o(f,d){var h="",m=d.type=="string"?[0,0,0,0]:by(f,d);switch(d.type){case"base64":h=ln(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Fs<"u"?h=Fs.utils.decode(d.codepage,f):h=$e&&Buffer.isBuffer(f)?f.toString("binary"):vo(f);break;case"array":h=no(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=st(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=st(h):d.type=="binary"&&typeof Fs<"u"&&d.codepage&&(h=Fs.utils.decode(d.codepage,Fs.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Eae.to_sheet(d.type=="string"?h:st(h),d):i(h,d)}function l(f,d){return vi(o(f,d),d)}function c(f){for(var d=[],h=Nt(f["!ref"]),m,v=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var _=[],y=h.s.c;y<=h.e.c;++y){var x=Ne({r:p,c:y});if(m=v?(f[p]||[])[y]:f[x],!m||m.v==null){_.push("          ");continue}for(var g=(m.w||(ps(m),m.w)||"").slice(0,10);g.length<10;)g+=" ";_.push(g+(y===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function Sae(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=wae.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return qu.to_workbook(e,t)}}var ru=function(){function e(C,I,N){if(C){rr(C,C.l||0);for(var j=N.Enum||ae;C.l<C.length;){var K=C.read_shift(2),ie=j[K]||j[65535],X=C.read_shift(2),le=C.l+X,oe=ie.f&&ie.f(C,X,N);if(C.l=le,I(oe,ie,K))return}}}function t(C,I){switch(I.type){case"base64":return r(Gn(ln(C)),I);case"binary":return r(Gn(C),I);case"buffer":case"array":return r(C,I)}throw"Unsupported type "+I.type}function r(C,I){if(!C)return C;var N=I||{},j=N.dense?[]:{},K="Sheet1",ie="",X=0,le={},oe=[],Ee=[],z={s:{r:0,c:0},e:{r:0,c:0}},je=N.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)N.Enum=ae,e(C,function(me,tt,cr){switch(cr){case 0:N.vers=me,me>=4096&&(N.qpro=!0);break;case 6:z=me;break;case 204:me&&(ie=me);break;case 222:ie=me;break;case 15:case 51:N.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:cr==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=N.dateNF||De[14],N.cellDates&&(me[1].t="d",me[1].v=hp(me[1].v))),N.qpro&&me[3]>X&&(j["!ref"]=Ue(z),le[K]=j,oe.push(K),j=N.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},X=me[3],K=ie||"Sheet"+(X+1),ie="");var gt=N.dense?(j[me[0].r]||[])[me[0].c]:j[Ne(me[0])];if(gt){gt.t=me[1].t,gt.v=me[1].v,me[1].z!=null&&(gt.z=me[1].z),me[1].f!=null&&(gt.f=me[1].f);break}N.dense?(j[me[0].r]||(j[me[0].r]=[]),j[me[0].r][me[0].c]=me[1]):j[Ne(me[0])]=me[1];break}},N);else if(C[2]==26||C[2]==14)N.Enum=B,C[2]==14&&(N.qpro=!0,C.l=0),e(C,function(me,tt,cr){switch(cr){case 204:K=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>X&&(j["!ref"]=Ue(z),le[K]=j,oe.push(K),j=N.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},X=me[3],K="Sheet"+(X+1)),je>0&&me[0].r>=je)break;N.dense?(j[me[0].r]||(j[me[0].r]=[]),j[me[0].r][me[0].c]=me[1]):j[Ne(me[0])]=me[1],z.e.c<me[0].c&&(z.e.c=me[0].c),z.e.r<me[0].r&&(z.e.r=me[0].r);break;case 27:me[14e3]&&(Ee[me[14e3][0]]=me[14e3][1]);break;case 1537:Ee[me[0]]=me[1],me[0]==X&&(K=me[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(j["!ref"]=Ue(z),le[ie||K]=j,oe.push(ie||K),!Ee.length)return{SheetNames:oe,Sheets:le};for(var ke={},qe=[],Ae=0;Ae<Ee.length;++Ae)le[oe[Ae]]?(qe.push(Ee[Ae]||oe[Ae]),ke[Ee[Ae]]=le[Ee[Ae]]||le[oe[Ae]]):(qe.push(Ee[Ae]),ke[Ee[Ae]]={"!ref":"A1"});return{SheetNames:qe,Sheets:ke}}function n(C,I){var N=I||{};if(+N.codepage>=0&&qn(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var j=pg(),K=Nt(C["!ref"]),ie=Array.isArray(C),X=[];Wn(j,0,s(1030)),Wn(j,6,l(K));for(var le=Math.min(K.e.r,8191),oe=K.s.r;oe<=le;++oe)for(var Ee=ir(oe),z=K.s.c;z<=K.e.c;++z){oe===K.s.r&&(X[z]=Ht(z));var je=X[z]+Ee,ke=ie?(C[oe]||[])[z]:C[je];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?Wn(j,13,m(oe,z,ke.v)):Wn(j,14,p(oe,z,ke.v));else{var qe=ps(ke);Wn(j,15,d(oe,z,qe.slice(0,239)))}}return Wn(j,1),j.end()}function a(C,I){var N=I||{};if(+N.codepage>=0&&qn(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var j=pg();Wn(j,0,i(C));for(var K=0,ie=0;K<C.SheetNames.length;++K)(C.Sheets[C.SheetNames[K]]||{})["!ref"]&&Wn(j,27,V(C.SheetNames[K],ie++));var X=0;for(K=0;K<C.SheetNames.length;++K){var le=C.Sheets[C.SheetNames[K]];if(!(!le||!le["!ref"])){for(var oe=Nt(le["!ref"]),Ee=Array.isArray(le),z=[],je=Math.min(oe.e.r,8191),ke=oe.s.r;ke<=je;++ke)for(var qe=ir(ke),Ae=oe.s.c;Ae<=oe.e.c;++Ae){ke===oe.s.r&&(z[Ae]=Ht(Ae));var me=z[Ae]+qe,tt=Ee?(le[ke]||[])[Ae]:le[me];if(!(!tt||tt.t=="z"))if(tt.t=="n")Wn(j,23,P(ke,Ae,X,tt.v));else{var cr=ps(tt);Wn(j,22,E(ke,Ae,X,cr.slice(0,239)))}}++X}}return Wn(j,1),j.end()}function s(C){var I=Bt(2);return I.write_shift(2,C),I}function i(C){var I=Bt(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var N=0,j=0,K=0,ie=0;ie<C.SheetNames.length;++ie){var X=C.SheetNames[ie],le=C.Sheets[X];if(!(!le||!le["!ref"])){++K;var oe=tc(le["!ref"]);N<oe.e.r&&(N=oe.e.r),j<oe.e.c&&(j=oe.e.c)}}return N>8191&&(N=8191),I.write_shift(2,N),I.write_shift(1,K),I.write_shift(1,j),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(C,I,N){var j={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&N.qpro?(j.s.c=C.read_shift(1),C.l++,j.s.r=C.read_shift(2),j.e.c=C.read_shift(1),C.l++,j.e.r=C.read_shift(2),j):(j.s.c=C.read_shift(2),j.s.r=C.read_shift(2),I==12&&N.qpro&&(C.l+=2),j.e.c=C.read_shift(2),j.e.r=C.read_shift(2),I==12&&N.qpro&&(C.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function l(C){var I=Bt(8);return I.write_shift(2,C.s.c),I.write_shift(2,C.s.r),I.write_shift(2,C.e.c),I.write_shift(2,C.e.r),I}function c(C,I,N){var j=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(j[0].c=C.read_shift(1),j[3]=C.read_shift(1),j[0].r=C.read_shift(2),C.l+=2):(j[2]=C.read_shift(1),j[0].c=C.read_shift(2),j[0].r=C.read_shift(2)),j}function f(C,I,N){var j=C.l+I,K=c(C,I,N);if(K[1].t="s",N.vers==20768){C.l++;var ie=C.read_shift(1);return K[1].v=C.read_shift(ie,"utf8"),K}return N.qpro&&C.l++,K[1].v=C.read_shift(j-C.l,"cstr"),K}function d(C,I,N){var j=Bt(7+N.length);j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,C),j.write_shift(1,39);for(var K=0;K<j.length;++K){var ie=N.charCodeAt(K);j.write_shift(1,ie>=128?95:ie)}return j.write_shift(1,0),j}function h(C,I,N){var j=c(C,I,N);return j[1].v=C.read_shift(2,"i"),j}function m(C,I,N){var j=Bt(7);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,C),j.write_shift(2,N,"i"),j}function v(C,I,N){var j=c(C,I,N);return j[1].v=C.read_shift(8,"f"),j}function p(C,I,N){var j=Bt(13);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,C),j.write_shift(8,N,"f"),j}function _(C,I,N){var j=C.l+I,K=c(C,I,N);if(K[1].v=C.read_shift(8,"f"),N.qpro)C.l=j;else{var ie=C.read_shift(2);w(C.slice(C.l,C.l+ie),K),C.l+=ie}return K}function y(C,I,N){var j=I&32768;return I&=-32769,I=(j?C:0)+(I>=8192?I-16384:I),(j?"":"$")+(N?Ht(I):ir(I))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(C,I){rr(C,0);for(var N=[],j=0,K="",ie="",X="",le="";C.l<C.length;){var oe=C[C.l++];switch(oe){case 0:N.push(C.read_shift(8,"f"));break;case 1:ie=y(I[0].c,C.read_shift(2),!0),K=y(I[0].r,C.read_shift(2),!1),N.push(ie+K);break;case 2:{var Ee=y(I[0].c,C.read_shift(2),!0),z=y(I[0].r,C.read_shift(2),!1);ie=y(I[0].c,C.read_shift(2),!0),K=y(I[0].r,C.read_shift(2),!1),N.push(Ee+z+":"+ie+K)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(C.read_shift(2));break;case 6:{for(var je="";oe=C[C.l++];)je+=String.fromCharCode(oe);N.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:le=N.pop(),X=N.pop(),N.push(["AND","OR"][oe-20]+"("+X+","+le+")");break;default:if(oe<32&&g[oe])le=N.pop(),X=N.pop(),N.push(X+g[oe]+le);else if(x[oe]){if(j=x[oe][1],j==69&&(j=C[C.l++]),j>N.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+N.join("|")+"|");return}var ke=N.slice(-j);N.length-=j,N.push(x[oe][0]+"("+ke.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}N.length==1?I[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function b(C){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=C.read_shift(2),I[3]=C[C.l++],I[0].c=C[C.l++],I}function k(C,I){var N=b(C);return N[1].t="s",N[1].v=C.read_shift(I-4,"cstr"),N}function E(C,I,N,j){var K=Bt(6+j.length);K.write_shift(2,C),K.write_shift(1,N),K.write_shift(1,I),K.write_shift(1,39);for(var ie=0;ie<j.length;++ie){var X=j.charCodeAt(ie);K.write_shift(1,X>=128?95:X)}return K.write_shift(1,0),K}function S(C,I){var N=b(C);N[1].v=C.read_shift(2);var j=N[1].v>>1;if(N[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return N[1].v=j,N}function T(C,I){var N=b(C),j=C.read_shift(4),K=C.read_shift(4),ie=C.read_shift(2);if(ie==65535)return j===0&&K===3221225472?(N[1].t="e",N[1].v=15):j===0&&K===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var X=ie&32768;return ie=(ie&32767)-16446,N[1].v=(1-X*2)*(K*Math.pow(2,ie+32)+j*Math.pow(2,ie)),N}function P(C,I,N,j){var K=Bt(14);if(K.write_shift(2,C),K.write_shift(1,N),K.write_shift(1,I),j==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ie=0,X=0,le=0,oe=0;return j<0&&(ie=1,j=-j),X=Math.log2(j)|0,j/=Math.pow(2,X-31),oe=j>>>0,oe&2147483648||(j/=2,++X,oe=j>>>0),j-=oe,oe|=2147483648,oe>>>=0,j*=Math.pow(2,32),le=j>>>0,K.write_shift(4,le),K.write_shift(4,oe),X+=16383+(ie?32768:0),K.write_shift(2,X),K}function M(C,I){var N=T(C);return C.l+=I-14,N}function L(C,I){var N=b(C),j=C.read_shift(4);return N[1].v=j>>6,N}function D(C,I){var N=b(C),j=C.read_shift(8,"f");return N[1].v=j,N}function Q(C,I){var N=D(C);return C.l+=I-10,N}function ee(C,I){return C[C.l+I-1]==0?C.read_shift(I,"cstr"):""}function Y(C,I){var N=C[C.l++];N>I-1&&(N=I-1);for(var j="";j.length<N;)j+=String.fromCharCode(C[C.l++]);return j}function q(C,I,N){if(!(!N.qpro||I<21)){var j=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var K=C.read_shift(I-21,"cstr");return[j,K]}}function G(C,I){for(var N={},j=C.l+I;C.l<j;){var K=C.read_shift(2);if(K==14e3){for(N[K]=[0,""],N[K][0]=C.read_shift(2);C[C.l];)N[K][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return N}function V(C,I){var N=Bt(5+C.length);N.write_shift(2,14e3),N.write_shift(2,I);for(var j=0;j<C.length;++j){var K=C.charCodeAt(j);N[N.l++]=K>127?95:K}return N[N.l++]=0,N}var ae={0:{n:"BOF",f:It},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},B={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:Q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function kae(e){var t={},r=e.match(Tr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Te(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Q1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var Tae=function(){var e=Gu("t"),t=Gu("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:He(i[1])},l=s.match(t);return l&&(o.s=kae(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),Cae=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Nae=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Aae=/<(?:\w+:)?r>/,Oae=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function my(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=He(st(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=st(e),r&&(n.h=sy(n.t))):e.match(Aae)&&(n.r=st(e),n.t=He(st((e.replace(Oae,"").match(Nae)||[]).join("").replace(Tr,""))),r&&(n.h=Cae(Tae(n.r)))),n):{t:""}}var Dae=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jae=/<(?:\w+:)?(?:si|sstItem)>/g,Pae=/<\/(?:\w+:)?(?:si|sstItem)>/;function Fae(e,t){var r=[],n="";if(!e)return r;var a=e.match(Dae);if(a){n=a[2].replace(jae,"").split(Pae);for(var s=0;s!=n.length;++s){var i=my(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Te(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function Rae(e){return[e.read_shift(4),e.read_shift(4)]}function Mae(e,t){var r=[],n=!1;return _s(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function xA(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ns(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Iae(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ns(e,4),t.U=ns(e,4),t.W=ns(e,4),t}function Lae(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function $ae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Lae(e));return t}function Bae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Uae(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ns(e,4),t.U=ns(e,4),t.W=ns(e,4),t}function Wae(e){var t=Uae(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function yA(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function _A(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Vae(e){var t=ns(e);switch(t.Minor){case 2:return[t.Minor,Hae(e)];case 3:return[t.Minor,zae()];case 4:return[t.Minor,Yae(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Hae(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=yA(e,r),a=_A(e,e.length-e.l);return{t:"Std",h:n,v:a}}function zae(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Yae(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Tr,function(s){var i=Te(s);switch(Ma(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Gae(e,t){var r={},n=r.EncryptionVersionInfo=ns(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=yA(e,a),t-=a,r.EncryptionVerifier=_A(e,t),r}function Kae(e){var t={},r=t.EncryptionVersionInfo=ns(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function qae(e){var t=0,r,n=xA(e),a=n.length+1,s,i,o,l,c;for(r=si(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var wA=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=xA(i),l=s(o),c=o.length,f=si(16),d=0;d!=16;++d)f[d]=0;var h,m,v;for((c&1)===1&&(h=l>>8,f[c]=a(e[0],h),--c,h=l&255,m=o[o.length-1],f[c]=a(m,h));c>0;)--c,h=l>>8,f[c]=a(o[c],h),--c,h=l&255,f[c]=a(o[c],h);for(c=15,v=15-o.length;v>0;)h=l>>8,f[c]=a(e[v],h),--c,--v,h=l&255,f[c]=a(o[c],h),--c,--v;return f}}(),Xae=function(e,t,r,n,a){a||(a=t),n||(n=wA(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},Jae=function(e){var t=0,r=wA(e);return function(n){var a=Xae("",n,t,r);return t=a[1],a[0]}};function Qae(e,t,r,n){var a={key:It(e),verificationBytes:It(e)};return r.password&&(a.verifier=qae(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Jae(r.password)),a}function Zae(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Kae(e):n.Data=Gae(e,t),n}function ese(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Zae(e,t-2,n):Qae(e,r.biff>=8?t:t-2,r,n),n}var tse=function(){function e(a,s){switch(s.type){case"base64":return t(ln(a),s);case"binary":return t(a,s);case"buffer":return t($e&&Buffer.isBuffer(a)?a.toString("binary"):vo(a),s);case"array":return t(no(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,m=0,v,p=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var _=f.slice(m,h.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++p,_.length){var y={v:_,t:"s"};Array.isArray(o)?o[d][p]=y:o[Ne({r:d,c:p})]=y}break}m=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=Ue(c),o}function r(a,s){return vi(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Nt(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Ne({r:c,c:f});o=l?(a[c]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ps(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function rse(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Xu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function nse(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function ase(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function q0(e,t){if(t===0)return e;var r=nse(rse(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Xu(ase(r))}var bA=6,sse=15,ise=1,Or=bA;function X0(e){return Math.floor((e+Math.round(128/Or)/256)*Or)}function J0(e){return Math.floor((e-5)/Or*100+.5)/100}function xg(e){return Math.round((e*Or+5)/Or*256)/256}function Om(e){return xg(J0(X0(e)))}function vy(e){var t=Math.abs(e-Om(e)),r=Or;if(t>.005)for(Or=ise;Or<sse;++Or)Math.abs(e-Om(e))<=t&&(t=Math.abs(e-Om(e)),r=Or);Or=r}function Al(e){e.width?(e.wpx=X0(e.width),e.wch=J0(e.wpx),e.MDW=Or):e.wpx?(e.wch=J0(e.wpx),e.width=xg(e.wch),e.MDW=Or):typeof e.wch=="number"&&(e.width=xg(e.wch),e.wpx=X0(e.width),e.MDW=Or),e.customWidth&&delete e.customWidth}var ose=96,EA=ose;function SA(e){return e*96/EA}function Ju(e){return e*EA/96}var lse={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function cse(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Te(i);switch(Ma(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=mt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=mt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function use(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Te(i);switch(Ma(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function fse(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Te(i);switch(Ma(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=st(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?mt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?mt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?mt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?mt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?mt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?mt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?mt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Q1[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=mt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Bi[a.color.index];a.color.index==81&&(l=Bi[1]),l||(l=Bi[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=q0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function dse(e,t,r){t.NumberFmt=[];for(var n=Da(De),a=0;a<n.length;++a)t.NumberFmt[n[a]]=De[n[a]];var s=e[0].match(Tr);if(s)for(a=0;a<s.length;++a){var i=Te(s[a]);switch(Ma(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=He(st(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}$i(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var wd=["numFmtId","fillId","fontId","borderId","xfId"],bd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hse(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Tr)||[]).forEach(function(s){var i=Te(s),o=0;switch(Ma(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<wd.length;++o)n[wd[o]]&&(n[wd[o]]=parseInt(n[wd[o]],10));for(o=0;o<bd.length;++o)n[bd[o]]&&(n[bd[o]]=mt(n[bd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=mt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var pse=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&dse(d,f,c),(d=o.match(a))&&fse(d,f,l,c),(d=o.match(n))&&use(d,f,l,c),(d=o.match(s))&&cse(d,f,l,c),(d=o.match(r))&&hse(d,f,c),f}}();function mse(e,t){var r=e.read_shift(2),n=_r(e);return[r,n]}function vse(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Tre(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=kre(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_r(e),n}var gse=br;function xse(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var yse=br;function _se(e,t,r){var n={};n.NumberFmt=[];for(var a in De)n.NumberFmt[a]=De[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return _s(e,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],$i(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=q0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var wse=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function bse(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Tr)||[]).forEach(function(a){var s=Te(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[wse.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Ese(){}function Sse(){}var kse=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Tse=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Cse=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Nse(e,t,r){t.themeElements={};var n;[["clrScheme",kse,bse],["fontScheme",Tse,Ese],["fmtScheme",Cse,Sse]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Ase=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function kA(e,t){(!e||e.length===0)&&(e=Ose());var r,n={};if(!(r=e.match(Ase)))throw new Error("themeElements not found in theme");return Nse(r[0],n,t),n.raw=e,n}function Ose(e,t){var r=[M4];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Dse(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=R4(s,{type:"array"})}catch{return}var o=en(i,"theme/theme/theme1.xml",!0);if(o)return kA(o,r)}}function jse(e){return e.read_shift(4)}function Pse(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Fse(e,4);break;case 2:t.xclrValue=fA(e);break;case 3:t.xclrValue=jse(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Fse(e,t){return br(e,t)}function Rse(e,t){return br(e,t)}function Mse(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Pse(e);break;case 6:n[1]=Rse(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Ise(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Mse(e,r-e.l));return{ixfe:n,ext:s}}function Lse(e,t){t.forEach(function(r){switch(r[0]){}})}function $se(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:_r(e)}}function Bse(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Use(e){return e.l+=4,e.read_shift(4)!=0}function Wse(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return _s(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Vse(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Tr,function(o){var l=Te(o);switch(Ma(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Hse(e){var t=[];if(!e)return t;var r=1;return(e.match(Tr)||[]).forEach(function(n){var a=Te(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function zse(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ne(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Yse(e,t,r){var n=[];return _s(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Gse(e,t,r,n){if(!e)return e;var a=n||{},s=!1;_s(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function Kse(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Qb(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Dr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=Nt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ue(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function qse(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Te(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Dr(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&my(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function Xse(e,t){var r=[],n=!1,a={},s=0;return e.replace(Tr,function(o,l){var c=Te(o);switch(Ma(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Jse(e,t){var r=[],n=!1;return e.replace(Tr,function(s){var i=Te(s);switch(Ma(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function Qse(e){var t={};t.iauthor=e.read_shift(4);var r=xo(e);return t.rfx=r.s,t.ref=Ne(r.s),e.l+=16,t}var Zse=_r;function eie(e,t){var r=[],n=[],a={},s=!1;return _s(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var tie="application/vnd.ms-office.vbaProject";function rie(e){var t=Be.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Be.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Be.write(t)}function nie(){return{"!type":"dialog"}}function aie(){return{"!type":"dialog"}}function sie(){return{"!type":"macro"}}function iie(){return{"!type":"macro"}}var ul=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,a+(o?"":"$")+Ht(f)+(l?"":"$")+ir(c)}return function(a,s){return t=s,a.replace(e,r)}}(),TA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oie=function(){return function(t,r){return t.replace(TA,function(n,a,s,i,o,l){var c=cy(i)-(s?0:r.c),f=ly(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+h})}}();function CA(e,t){return e.replace(TA,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Ht(cy(s)+t.c))+(i=="$"?i+o:ir(ly(o)+t.r))})}function lie(e,t,r){var n=tc(t),a=n.s,s=Dr(r),i={r:s.r-a.r,c:s.c-a.c};return CA(e,i)}function cie(e){return e.length!=1}function Zb(e){return e.replace(/_xlfn\./g,"")}function Rt(e){e.l+=1}function ii(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function NA(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return AA(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=ii(e),o=ii(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function AA(e){var t=ii(e),r=ii(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function uie(e,t,r){if(r.biff<8)return AA(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=ii(e),i=ii(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function OA(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fie(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ii(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function fie(e){var t=ii(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function die(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hie(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return pie(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function pie(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function mie(e,t,r){var n=(e[e.l++]&96)>>5,a=NA(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function vie(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=NA(e,s,r);return[n,a,i]}function gie(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function xie(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function yie(e,t,r){var n=(e[e.l++]&96)>>5,a=uie(e,t-1,r);return[n,a]}function _ie(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function eE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function wie(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function bie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Eie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Sie(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function DA(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Tie(e){return e.read_shift(2),DA(e)}function Cie(e){return e.read_shift(2),DA(e)}function Nie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=OA(e,0,r);return[n,a]}function Aie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=hie(e,0,r);return[n,a]}function Oie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=OA(e,0,r);return[n,a,s]}function Die(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[joe[a],FA[a],n]}function jie(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Pie(e);return[a,(s[0]===0?FA:Doe)[s[1]]]}function Pie(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Fie(e,t,r){e.l+=r&&r.biff==2?3:4}function Rie(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Mie(e){return e.l++,yo[e.read_shift(1)]}function Iie(e){return e.l++,e.read_shift(2)}function Lie(e){return e.l++,e.read_shift(1)!==0}function $ie(e){return e.l++,gr(e)}function Bie(e,t,r){return e.l++,Af(e,t-1,r)}function Uie(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ot(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=yo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=gr(e);break;case 2:r[1]=_o(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Wie(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?xo:pp)(e));return a}function Vie(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=Uie(e,r.biff);return i}function Hie(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function zie(e,t,r){if(r.biff==5)return Yie(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function Yie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Gie(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Kie(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function qie(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Xie(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Jie=br,Qie=br,Zie=br;function Df(e,t,r){return e.l+=2,[die(e)]}function gy(e){return e.l+=6,[]}var eoe=Df,toe=gy,roe=gy,noe=Df;function jA(e){return e.l+=2,[It(e),e.read_shift(2)&1]}var aoe=Df,soe=jA,ioe=gy,ooe=Df,loe=Df,coe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uoe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=coe[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function foe(e){return e.l+=2,[e.read_shift(4)]}function doe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function hoe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function poe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function moe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function voe(e){return e.l+=4,[0,0]}var tE={1:{n:"PtgExp",f:Rie},2:{n:"PtgTbl",f:Zie},3:{n:"PtgAdd",f:Rt},4:{n:"PtgSub",f:Rt},5:{n:"PtgMul",f:Rt},6:{n:"PtgDiv",f:Rt},7:{n:"PtgPower",f:Rt},8:{n:"PtgConcat",f:Rt},9:{n:"PtgLt",f:Rt},10:{n:"PtgLe",f:Rt},11:{n:"PtgEq",f:Rt},12:{n:"PtgGe",f:Rt},13:{n:"PtgGt",f:Rt},14:{n:"PtgNe",f:Rt},15:{n:"PtgIsect",f:Rt},16:{n:"PtgUnion",f:Rt},17:{n:"PtgRange",f:Rt},18:{n:"PtgUplus",f:Rt},19:{n:"PtgUminus",f:Rt},20:{n:"PtgPercent",f:Rt},21:{n:"PtgParen",f:Rt},22:{n:"PtgMissArg",f:Rt},23:{n:"PtgStr",f:Bie},26:{n:"PtgSheet",f:doe},27:{n:"PtgEndSheet",f:hoe},28:{n:"PtgErr",f:Mie},29:{n:"PtgBool",f:Lie},30:{n:"PtgInt",f:Iie},31:{n:"PtgNum",f:$ie},32:{n:"PtgArray",f:_ie},33:{n:"PtgFunc",f:Die},34:{n:"PtgFuncVar",f:jie},35:{n:"PtgName",f:Hie},36:{n:"PtgRef",f:Nie},37:{n:"PtgArea",f:mie},38:{n:"PtgMemArea",f:Gie},39:{n:"PtgMemErr",f:Jie},40:{n:"PtgMemNoMem",f:Qie},41:{n:"PtgMemFunc",f:Kie},42:{n:"PtgRefErr",f:qie},43:{n:"PtgAreaErr",f:gie},44:{n:"PtgRefN",f:Aie},45:{n:"PtgAreaN",f:yie},46:{n:"PtgMemAreaN",f:poe},47:{n:"PtgMemNoMemN",f:moe},57:{n:"PtgNameX",f:zie},58:{n:"PtgRef3d",f:Oie},59:{n:"PtgArea3d",f:vie},60:{n:"PtgRefErr3d",f:Xie},61:{n:"PtgAreaErr3d",f:xie},255:{}},goe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xoe={1:{n:"PtgElfLel",f:jA},2:{n:"PtgElfRw",f:ooe},3:{n:"PtgElfCol",f:eoe},6:{n:"PtgElfRwV",f:loe},7:{n:"PtgElfColV",f:noe},10:{n:"PtgElfRadical",f:aoe},11:{n:"PtgElfRadicalS",f:ioe},13:{n:"PtgElfColS",f:toe},15:{n:"PtgElfColSV",f:roe},16:{n:"PtgElfRadicalLel",f:soe},25:{n:"PtgList",f:uoe},29:{n:"PtgSxName",f:foe},255:{}},yoe={0:{n:"PtgAttrNoop",f:voe},1:{n:"PtgAttrSemi",f:kie},2:{n:"PtgAttrIf",f:Eie},4:{n:"PtgAttrChoose",f:wie},8:{n:"PtgAttrGoto",f:bie},16:{n:"PtgAttrSum",f:Fie},32:{n:"PtgAttrBaxcel",f:eE},33:{n:"PtgAttrBaxcel",f:eE},64:{n:"PtgAttrSpace",f:Tie},65:{n:"PtgAttrSpaceSemi",f:Cie},128:{n:"PtgAttrIfError",f:Sie},255:{}};function jf(e,t,r,n){if(n.biff<8)return br(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Vie(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Wie(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(br(e,t)),s}function Pf(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=tE[s]||tE[goe[s]],(s===24||s===25)&&(a=(s===24?xoe:yoe)[e[e.l+1]]),!a||!a.f?br(e,t):i.push([a.n,a.f(e,t,r)]);return i}function _oe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var woe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function boe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function PA(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function rE(e,t,r){var n=PA(e,t,r);return n=="#REF"?n:boe(n,r)}function mr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,f,d=0,h=0,m,v="";if(!e[0]||!e[0][0])return"";for(var p=-1,_="",y=0,x=e[0].length;y<x;++y){var g=e[0][y];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:_=Tt(" ",e[0][p][1][1]);break;case 1:_=Tt("\r",e[0][p][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+_,p=-1}o.push(c+woe[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Qc(g[1][1],i,a),o.push(Zc(f,s));break;case"PtgRefN":f=r?Qc(g[1][1],r,a):g[1][1],o.push(Zc(f,s));break;case"PtgRef3d":d=g[1][1],f=Qc(g[1][2],i,a),v=rE(n,d,a),o.push(v+"!"+Zc(f,s));break;case"PtgFunc":case"PtgFuncVar":var w=g[1][0],b=g[1][1];w||(w=0),w&=127;var k=w==0?[]:o.slice(-w);o.length-=w,b==="User"&&(b=k.shift()),o.push(b+"("+k.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":m=Mb(g[1][1],r?{s:r}:i,a),o.push(Nm(m,a));break;case"PtgArea":m=Mb(g[1][1],i,a),o.push(Nm(m,a));break;case"PtgArea3d":d=g[1][1],m=g[1][2],v=rE(n,d,a),o.push(v+"!"+Nm(m,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],S=E?E.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var T=g[1][1];h=g[1][2];var P;if(a.biff<=5)T<0&&(T=-T),n[T]&&(P=n[T][h]);else{var M="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][h]&&n[T][h].itab>0&&(M=n.SheetNames[n[T][h].itab-1]+"!"):M=n.SheetNames[h-1]+"!"),n[T]&&n[T][h])M+=n[T][h].Name;else if(n[0]&&n[0][h])M+=n[0][h].Name;else{var L=(PA(n,T,a)||"").split(";;");L[h-1]?M=L[h-1]:M+="SH33TJSERRX"}o.push(M);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var D="(",Q=")";if(p>=0){switch(_="",e[0][p][1][0]){case 2:D=Tt(" ",e[0][p][1][1])+D;break;case 3:D=Tt("\r",e[0][p][1][1])+D;break;case 4:Q=Tt(" ",e[0][p][1][1])+Q;break;case 5:Q=Tt("\r",e[0][p][1][1])+Q;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(D+o.pop()+Q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:g[1][1],r:g[1][0]};var ee={c:r.c,r:r.r};if(n.sharedf[Ne(f)]){var Y=n.sharedf[Ne(f)];o.push(mr(Y,i,ee,n,a))}else{var q=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(mr(c[1],i,ee,n,a)),q=!0;break}q||o.push(g[1])}break;case"PtgArray":o.push("{"+_oe(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&G.indexOf(e[0][y][0])==-1){g=e[0][p];var V=!0;switch(g[1][0]){case 4:V=!1;case 0:_=Tt(" ",g[1][1]);break;case 5:V=!1;case 1:_=Tt("\r",g[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((V?_:"")+o.pop()+(V?"":_)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Eoe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,t-2)];var o=Pf(e,i,r);return t!==i+a&&(s=jf(e,t-i-a,o,r)),e.l=n,[o,s]}function Soe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,t-2)];var o=Pf(e,i,r);return t!==i+a&&(s=jf(e,t-i-a,o,r)),e.l=n,[o,s]}function koe(e,t,r,n){var a=e.l+t,s=Pf(e,n,r),i;return a!==e.l&&(i=jf(e,a-e.l,s,r)),[s,i]}function Toe(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Pf(e,s,r);return s==65535?[[],br(e,t-2)]:(t!==s+2&&(a=jf(e,n-s-2,i,r)),[i,a])}function Coe(e){var t;if(Qa(e,e.l+6)!==65535)return[gr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Dm(e,t,r){var n=e.l+t,a=Ia(e);r.biff==2&&++e.l;var s=Coe(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Soe(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function mp(e,t,r){var n=e.read_shift(4),a=Pf(e,n,r),s=e.read_shift(4),i=s>0?jf(e,s,a,r):null;return[a,i]}var Noe=mp,vp=mp,Aoe=mp,Ooe=mp,Doe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},FA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},joe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function nE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function jm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var nu={},fl={};function au(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function RA(e,t,r,n,a,s){try{n.cellNF&&(e.z=De[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Zt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(De[t]==null&&$i(Pte[t]||"General",t),e.t==="e")e.w=e.w||yo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yu(e.v);else if(e.t==="d"){var i=Fr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Yu(i)}else{if(e.v===void 0)return"";e.w=ro(e.v,fl)}else e.t==="d"?e.w=jn(t,Fr(e.v),fl):e.w=jn(t,e.v,fl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=q0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=q0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function Poe(e,t){var r=Nt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ue(r))}var Foe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Roe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Moe=/<(?:\w:)?hyperlink [^>]*>/mg,Ioe=/"(\w*:\w*)"/,Loe=/<(?:\w:)?col\b[^>]*[\/]?>/g,$oe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Boe=/<(?:\w:)?pageMargins[^>]*\/>/g,MA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Uoe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Woe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Voe(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(Roe);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var h=c.match(MA);h?xy(h[0],o,a,r):(h=c.match(Uoe))&&Hoe(h[0],h[1]||"",o,a,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var v=c.slice(m,m+50).match(Ioe);v&&Poe(o,v[1])}var p=c.match(Woe);p&&p[1]&&Xoe(p[1],a);var _=[];if(t.cellStyles){var y=c.match(Loe);y&&Goe(_,y)}d&&Joe(d[1],o,t,l,s,i);var x=f.match($oe);x&&(o["!autofilter"]=Koe(x[0]));var g=[],w=f.match(Foe);if(w)for(m=0;m!=w.length;++m)g[m]=Nt(w[m].slice(w[m].indexOf('"')+1));var b=f.match(Moe);b&&zoe(o,b,n);var k=f.match(Boe);if(k&&(o["!margins"]=Yoe(Te(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ue(l)),t.sheetRows>0&&o["!ref"]){var E=Nt(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ue(E))}return _.length>0&&(o["!cols"]=_),g.length>0&&(o["!merges"]=g),o}function xy(e,t,r,n){var a=Te(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=He(st(a.codeName)))}function Hoe(e,t,r,n,a){xy(e.slice(0,e.indexOf(">")),r,n,a)}function zoe(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Te(st(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+He(s.location))):(s.Target="#"+He(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Nt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Ne({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function Yoe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Goe(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Te(t[n],!0);a.hidden&&(a.hidden=mt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,vy(a.width)),Al(a);s<=i;)e[s++]=sr(a)}}function Koe(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var qoe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Xoe(e,t){t.Views||(t.Views=[{}]),(e.match(qoe)||[]).forEach(function(r,n){var a=Te(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),mt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var Joe=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Gu("v"),i=Gu("f");return function(l,c,f,d,h,m){for(var v=0,p="",_=[],y=[],x=0,g=0,w=0,b="",k,E,S=0,T=0,P,M,L=0,D=0,Q=Array.isArray(m.CellXf),ee,Y=[],q=[],G=Array.isArray(c),V=[],ae={},B=!1,C=!!f.sheetStubs,I=l.split(t),N=0,j=I.length;N!=j;++N){p=I[N].trim();var K=p.length;if(K!==0){var ie=0;e:for(v=0;v<K;++v)switch(p[v]){case">":if(p[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(E=Te(p.slice(ie,v),!0),S=E.r!=null?parseInt(E.r,10):S+1,T=-1,f.sheetRows&&f.sheetRows<S)continue;ae={},B=!1,E.ht&&(B=!0,ae.hpt=parseFloat(E.ht),ae.hpx=Ju(ae.hpt)),E.hidden=="1"&&(B=!0,ae.hidden=!0),E.outlineLevel!=null&&(B=!0,ae.level=+E.outlineLevel),B&&(V[S-1]=ae)}break;case"<":ie=v;break}if(ie>=v)break;if(E=Te(p.slice(ie,v),!0),S=E.r!=null?parseInt(E.r,10):S+1,T=-1,!(f.sheetRows&&f.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),f&&f.cellStyles&&(ae={},B=!1,E.ht&&(B=!0,ae.hpt=parseFloat(E.ht),ae.hpx=Ju(ae.hpt)),E.hidden=="1"&&(B=!0,ae.hidden=!0),E.outlineLevel!=null&&(B=!0,ae.level=+E.outlineLevel),B&&(V[S-1]=ae)),_=p.slice(v).split(e);for(var X=0;X!=_.length&&_[X].trim().charAt(0)=="<";++X);for(_=_.slice(X),v=0;v!=_.length;++v)if(p=_[v].trim(),p.length!==0){if(y=p.match(r),x=v,g=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(x=0,b=y[1],g=0;g!=b.length&&!((w=b.charCodeAt(g)-64)<1||w>26);++g)x=26*x+w;--x,T=x}else++T;for(g=0;g!=p.length&&p.charCodeAt(g)!==62;++g);if(++g,E=Te(p.slice(0,g),!0),E.r||(E.r=Ne({r:S-1,c:T})),b=p.slice(g),k={t:""},(y=b.match(s))!=null&&y[1]!==""&&(k.v=He(y[1])),f.cellFormula){if((y=b.match(i))!=null&&y[1]!==""){if(k.f=He(st(y[1])).replace(/\r\n/g,`
`),f.xlfn||(k.f=Zb(k.f)),y[0].indexOf('t="array"')>-1)k.F=(b.match(a)||[])[1],k.F.indexOf(":")>-1&&Y.push([Nt(k.F),k.F]);else if(y[0].indexOf('t="shared"')>-1){M=Te(y[0]);var le=He(st(y[1]));f.xlfn||(le=Zb(le)),q[parseInt(M.si,10)]=[M,le,E.r]}}else(y=b.match(/<f[^>]*\/>/))&&(M=Te(y[0]),q[M.si]&&(k.f=lie(q[M.si][1],q[M.si][2],E.r)));var oe=Dr(E.r);for(g=0;g<Y.length;++g)oe.r>=Y[g][0].s.r&&oe.r<=Y[g][0].e.r&&oe.c>=Y[g][0].s.c&&oe.c<=Y[g][0].e.c&&(k.F=Y[g][1])}if(E.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(C)k.t="z";else continue;else k.t=E.t||"n";switch(d.s.c>T&&(d.s.c=T),d.e.c<T&&(d.e.c=T),k.t){case"n":if(k.v==""||k.v==null){if(!C)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!C)continue;k.t="z"}else P=nu[parseInt(k.v,10)],k.v=P.t,k.r=P.r,f.cellHTML&&(k.h=P.h);break;case"str":k.t="s",k.v=k.v!=null?st(k.v):"",f.cellHTML&&(k.h=sy(k.v));break;case"inlineStr":y=b.match(n),k.t="s",y!=null&&(P=my(y[1]))?(k.v=P.t,f.cellHTML&&(k.h=P.h)):k.v="";break;case"b":k.v=mt(k.v);break;case"d":f.cellDates?k.v=Zt(k.v,1):(k.v=Fr(Zt(k.v,1)),k.t="n");break;case"e":(!f||f.cellText!==!1)&&(k.w=k.v),k.v=nA[k.v];break}if(L=D=0,ee=null,Q&&E.s!==void 0&&(ee=m.CellXf[E.s],ee!=null&&(ee.numFmtId!=null&&(L=ee.numFmtId),f.cellStyles&&ee.fillId!=null&&(D=ee.fillId))),RA(k,L,D,f,h,m),f.cellDates&&Q&&k.t=="n"&&ec(De[L])&&(k.t="d",k.v=hp(k.v)),E.cm&&f.xlmeta){var Ee=(f.xlmeta.Cell||[])[+E.cm-1];Ee&&Ee.type=="XLDAPR"&&(k.D=!0)}if(G){var z=Dr(E.r);c[z.r]||(c[z.r]=[]),c[z.r][z.c]=k}else c[E.r]=k}}}}V.length>0&&(c["!rows"]=V)}}();function Qoe(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var Zoe=xo;function ele(){}function tle(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Ere(e),r}function rle(e){var t=In(e);return[t]}function nle(e){var t=go(e);return[t]}function ale(e){var t=In(e),r=e.read_shift(1);return[t,r,"b"]}function sle(e){var t=go(e),r=e.read_shift(1);return[t,r,"b"]}function ile(e){var t=In(e),r=e.read_shift(1);return[t,r,"e"]}function ole(e){var t=go(e),r=e.read_shift(1);return[t,r,"e"]}function lle(e){var t=In(e),r=e.read_shift(4);return[t,r,"s"]}function cle(e){var t=go(e),r=e.read_shift(4);return[t,r,"s"]}function ule(e){var t=In(e),r=gr(e);return[t,r,"n"]}function IA(e){var t=go(e),r=gr(e);return[t,r,"n"]}function fle(e){var t=In(e),r=dy(e);return[t,r,"n"]}function dle(e){var t=go(e),r=dy(e);return[t,r,"n"]}function hle(e){var t=In(e),r=uy(e);return[t,r,"is"]}function ple(e){var t=In(e),r=_r(e);return[t,r,"str"]}function mle(e){var t=go(e),r=_r(e);return[t,r,"str"]}function vle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=vp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function gle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=vp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function xle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=gr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=vp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function yle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=_r(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=vp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}var _le=xo;function wle(e,t){var r=e.l+t,n=xo(e),a=fy(e),s=_r(e),i=_r(e),o=_r(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function ble(){}function Ele(e,t,r){var n=e.l+t,a=eA(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=Noe(e,n-e.l,r);i[1]=o}else e.l=n;return i}function Sle(e,t,r){var n=e.l+t,a=xo(e),s=[a];if(r.cellFormula){var i=Ooe(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var kle=["left","right","top","bottom","header","footer"];function Tle(e){var t={};return kle.forEach(function(r){t[r]=gr(e)}),t}function Cle(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Nle(){}function Ale(){}function Ole(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,m,v,p,_,y,x,g,w,b,k=[];o.biff=12,o["!row"]=0;var E=0,S=!1,T=[],P={},M=o.supbooks||a.supbooks||[[]];if(M.sharedf=P,M.arrayf=T,M.SheetNames=a.SheetNames||a.Sheets.map(function(G){return G.name}),!o.supbooks&&(o.supbooks=M,a.Names))for(var L=0;L<a.Names.length;++L)M[0][L+1]=a.Names[L];var D=[],Q=[],ee=!1;Q0[16]={n:"BrtShortReal",f:IA};var Y;if(_s(e,function(V,ae,B){if(!h)switch(B){case 148:c=V;break;case 0:m=V,o.sheetRows&&o.sheetRows<=m.r&&(h=!0),w=ir(_=m.r),o["!row"]=m.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=Ju(V.hpt)),Q[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:V[2]},V[2]){case"n":v.v=V[1];break;case"s":g=nu[V[1]],v.v=g.t,v.r=g.r;break;case"b":v.v=!!V[1];break;case"e":v.v=V[1],o.cellText!==!1&&(v.w=yo[v.v]);break;case"str":v.t="s",v.v=V[1];break;case"is":v.t="s",v.v=V[1].t;break}if((p=i.CellXf[V[0].iStyleRef])&&RA(v,p.numFmtId,null,o,s,i),y=V[0].c==-1?y+1:V[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=v):l[Ht(y)+w]=v,o.cellFormula){for(S=!1,E=0;E<T.length;++E){var C=T[E];m.r>=C[0].s.r&&m.r<=C[0].e.r&&y>=C[0].s.c&&y<=C[0].e.c&&(v.F=Ue(C[0]),S=!0)}!S&&V.length>3&&(v.f=V[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),o.cellDates&&p&&v.t=="n"&&ec(De[p.numFmtId])){var I=Pi(v.v);I&&(v.t="d",v.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}Y&&(Y.type=="XLDAPR"&&(v.D=!0),Y=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;v={t:"z",v:void 0},y=V[0].c==-1?y+1:V[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=v):l[Ht(y)+w]=v,f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),Y&&(Y.type=="XLDAPR"&&(v.D=!0),Y=void 0);break;case 176:k.push(V);break;case 49:Y=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var N=n["!id"][V.relId];for(N?(V.Target=N.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=N):V.relId==""&&(V.Target="#"+V.loc),_=V.rfx.s.r;_<=V.rfx.e.r;++_)for(y=V.rfx.s.c;y<=V.rfx.e.c;++y)o.dense?(l[_]||(l[_]=[]),l[_][y]||(l[_][y]={t:"z",v:void 0}),l[_][y].l=V):(x=Ne({c:y,r:_}),l[x]||(l[x]={t:"z",v:void 0}),l[x].l=V);break;case 426:if(!o.cellFormula)break;T.push(V),b=o.dense?l[_][y]:l[Ht(y)+w],b.f=mr(V[1],f,{r:m.r,c:y},M,o),b.F=Ue(V[0]);break;case 427:if(!o.cellFormula)break;P[Ne(V[0].s)]=V[1],b=o.dense?l[_][y]:l[Ht(y)+w],b.f=mr(V[1],f,{r:m.r,c:y},M,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)D[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},ee||(ee=!0,vy(V.w/256)),Al(D[V.e+1]);break;case 161:l["!autofilter"]={ref:Ue(V)};break;case 476:l["!margins"]=V;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),V.name&&(a.Sheets[r].CodeName=V.name),(V.above||V.left)&&(l["!outline"]={above:V.above,left:V.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),V.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ae.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ue(c||f)),o.sheetRows&&l["!ref"]){var q=Nt(l["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>f.e.r&&(q.e.r=f.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>f.e.c&&(q.e.c=f.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ue(q))}return k.length>0&&(l["!merges"]=k),D.length>0&&(l["!cols"]=D),Q.length>0&&(l["!rows"]=Q),l}function Dle(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=He((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function jle(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=Dle(d);f.s.r=f.s.c=0,f.e.c=o,c=Ht(o),h[0].forEach(function(m,v){i[c+ir(v)]={t:"n",v:m,z:h[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=Ue(f)),i}function Ple(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(MA);return o&&xy(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Fle(e,t){e.l+=10;var r=_r(e);return{name:r}}function Rle(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return _s(e,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var LA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Mle=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ile=[],Lle=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function aE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=mt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function sE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=mt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function $A(e){sE(e.WBProps,LA),sE(e.CalcPr,Lle),aE(e.WBView,Mle),aE(e.Sheets,Ile),fl.date1904=mt(e.WBProps.date1904)}var $le="][*?/\\".split("");function Ble(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $le.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Ule=/<\w+:workbook/;function Wle(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Tr,function(l,c){var f=Te(l);switch(Ma(f[0])){case"<?xml":break;case"<workbook":l.match(Ule)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":LA.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=mt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=st(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=He(st(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=st(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),mt(f.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=He(st(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),ire.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $A(r),r}function Vle(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=mg(e),r.name=_r(e),r}function Hle(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?_r(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function zle(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Yle(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=Sre(e),i=Aoe(e,0,r),o=fy(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function Gle(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Q0[16]={n:"BrtFRTArchID$",f:zle},_s(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=mr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),$A(r),r.Names=s,r.supbooks=i,r}function Kle(e,t,r){return t.slice(-4)===".bin"?Gle(e,r):Wle(e,r)}function qle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Ole(e,n,r,a,s,i,o):Voe(e,n,r,a,s,i,o)}function Xle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Rle(e,n,r,a,s):Ple(e,n,r,a,s)}function Jle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?sie():iie()}function Qle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?nie():aie()}function Zle(e,t,r,n){return t.slice(-4)===".bin"?_se(e,r,n):pse(e,r,n)}function ece(e,t,r){return kA(e,r)}function tce(e,t,r){return t.slice(-4)===".bin"?Mae(e,r):Fae(e,r)}function rce(e,t,r){return t.slice(-4)===".bin"?eie(e,r):qse(e,r)}function nce(e,t,r){return t.slice(-4)===".bin"?Yse(e):Hse(e)}function ace(e,t,r,n){return r.slice(-4)===".bin"?Gse(e,t,r,n):void 0}function sce(e,t,r){return t.slice(-4)===".bin"?Wse(e,t,r):Vse(e,t,r)}var BA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,UA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Un(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(BA),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(UA),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function ice(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(BA),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(UA),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var su;function oce(e,t){var r=su[e]||He(e);return r==="General"?ro(t):jn(r,t)}function lce(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Zt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[He(t)]=a}function cce(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||yo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yu(e.v):e.w=ro(e.v):e.w=oce(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=su[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ec(n)){var a=Pi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function uce(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=lse[n.Pattern]||n.Pattern)}e[t.ID]=t}function fce(e,t,r,n,a,s,i,o,l,c){var f="General",d=n.StyleID,h={};c=c||{};var m=[],v=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&m.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mt(e);break;case"String":n.t="s",n.r=Cb(He(e)),n.v=e.indexOf("<")>-1?He(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Zt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=He(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=nA[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Cb(t||e));break}if(cce(n,f,c),c.cellFormula!==!1)if(n.Formula){var p=He(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=ul(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ul("RC:RC",a):n.ArrayRange&&(n.F=ul(n.ArrayRange,a),l.push([Nt(n.F),n.F]))}else for(v=0;v<l.length;++v)a.r>=l[v][0].s.r&&a.r<=l[v][0].e.r&&a.c>=l[v][0].s.c&&a.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(m.forEach(function(_){!h.patternType&&_.patternType&&(h.patternType=_.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function dce(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Pm(e,t){var r=t||{};A4();var n=Oc(iy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=st(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=sr(r);return i.type="string",qu.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){a.indexOf("<"+tt)>=0&&(s=!0)}),s)return wce(n,r);su={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},d=[],h=r.dense?[]:{},m="",v={},p={},_=Un('<Data ss:Type="String">'),y=0,x=0,g=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},k={},E="",S=0,T=[],P={},M={},L=0,D=[],Q=[],ee={},Y=[],q,G=!1,V=[],ae=[],B={},C=0,I=0,N={Sheets:[],WBProps:{date1904:!1}},j={};Ku.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=Ku.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?fce(n.slice(y,o.index),E,_,l[l.length-1][0]=="comment"?ee:v,{c:x,r:g},b,Y[x],p,V,r):(E="",_=Un(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Q.length>0&&(v.c=Q),(!r.sheetRows||r.sheetRows>g)&&v.v!==void 0&&(r.dense?(h[g]||(h[g]=[]),h[g][x]=v):h[Ht(x)+ir(g)]=v),v.HRef&&(v.l={Target:He(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(C=x+(parseInt(v.MergeAcross,10)|0),I=g+(parseInt(v.MergeDown,10)|0),T.push({s:{c:x,r:g},e:{c:C,r:I}})),!r.sheetStubs)v.MergeAcross?x=C+1:++x;else if(v.MergeAcross||v.MergeDown){for(var ie=x;ie<=C;++ie)for(var X=g;X<=I;++X)(ie>x||X>g)&&(r.dense?(h[X]||(h[X]=[]),h[X][ie]={t:"z"}):h[Ht(ie)+ir(X)]={t:"z"});x=C+1}else++x;else v=ice(o[0]),v.Index&&(x=+v.Index-1),x<w.s.c&&(w.s.c=x),x>w.e.c&&(w.e.c=x),o[0].slice(-2)==="/>"&&++x,Q=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<w.s.r&&(w.s.r=g),g>w.e.r&&(w.e.r=g),o[0].slice(-2)==="/>"&&(p=Un(o[0]),p.Index&&(g=+p.Index-1)),x=0,++g):(p=Un(o[0]),p.Index&&(g=+p.Index-1),B={},(p.AutoFitHeight=="0"||p.Height)&&(B.hpx=parseInt(p.Height,10),B.hpt=SA(B.hpx),ae[g]=B),p.Hidden=="1"&&(B.hidden=!0,ae[g]=B));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=Ue(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=Ue(w))),T.length&&(h["!merges"]=T),Y.length>0&&(h["!cols"]=Y),ae.length>0&&(h["!rows"]=ae),f[m]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=x=0,l.push([o[3],!1]),c=Un(o[0]),m=He(c.Name),h=r.dense?[]:{},T=[],V=[],ae=[],j={name:m,Hidden:0},N.Sheets.push(j);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Y=[],G=!1}break;case"style":o[1]==="/"?uce(b,k,r):k=Un(o[0]);break;case"numberformat":k.nf=He(Un(o[0]).Format||"General"),su[k.nf]&&(k.nf=su[k.nf]);for(var le=0;le!=392&&De[le]!=k.nf;++le);if(le==392){for(le=57;le!=392;++le)if(De[le]==null){$i(k.nf,le);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(q=Un(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!G&&q.wpx>10){G=!0,Or=bA;for(var oe=0;oe<Y.length;++oe)Y[oe]&&Al(Y[oe])}G&&Al(q),Y[q.Index-1||Y.length]=q;for(var Ee=0;Ee<+q.Span;++Ee)Y[Y.length]=sr(q);break;case"namedrange":if(o[1]==="/")break;N.Names||(N.Names=[]);var z=Te(o[0]),je={Name:z.Name,Ref:ul(z.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(je.Sheet=N.Sheets.length-1),N.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Un(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?qre(P,K,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));dce(ee),Q.push(ee)}else l.push([o[3],!1]),c=Un(o[0]),ee={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=Un(o[0]);h["!autofilter"]={ref:ul(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return fE(n,r);var qe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:qe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:qe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:qe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:qe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else L=o.index+o[0].length;break;case"header":h["!margins"]||au(h["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(h["!margins"].header=+Te(o[0]).Margin);break;case"footer":h["!margins"]||au(h["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(h["!margins"].footer=+Te(o[0]).Margin);break;case"pagemargins":var Ae=Te(o[0]);h["!margins"]||au(h["!margins"]={},"xlml"),isNaN(+Ae.Top)||(h["!margins"].top=+Ae.Top),isNaN(+Ae.Left)||(h["!margins"].left=+Ae.Left),isNaN(+Ae.Right)||(h["!margins"].right=+Ae.Right),isNaN(+Ae.Bottom)||(h["!margins"].bottom=+Ae.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:qe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:qe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:qe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:qe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:qe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:qe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:qe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:qe=!1}break;case"smarttags":break;default:qe=!1;break}if(qe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?lce(M,K,D,n.slice(L,o.index)):(D=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=f),me.SheetNames=d,me.Workbook=N,me.SSF=sr(De),me.Props=P,me.Custprops=M,me}function yg(e,t){switch(wy(t=t||{}),t.type||"base64"){case"base64":return Pm(ln(e),t);case"binary":case"buffer":case"file":return Pm(e,t);case"array":return Pm(vo(e),t)}}function hce(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Cre(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Nre(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var pce=[60,1084,2066,2165,2175];function mce(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Qa(r,r.l),c=_g[l],f=0;c!=null&&pce.indexOf(l)>-1;)s=Qa(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,c=_g[l=Qa(r,r.l)];var d=Rs(i);rr(d,0);var h=0;d.lens=[];for(var m=0;m<i.length;++m)d.lens.push(h),h+=i[m].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function ha(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=De[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||yo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yu(e.v):e.w=ro(e.v):e.w=jn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ec(De[n]||String(n))){var a=Pi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Ed(e,t,r){return{v:e,ixfe:t,t:r}}function vce(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",f={},d,h="",m,v,p,_,y={},x=[],g,w,b=[],k=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},T=function(Re){return Re<8?Bi[Re]:Re<64&&k[Re-8]||Bi[Re]},P=function(Re,At,pn){var $t=At.XF.data;if(!(!$t||!$t.patternType||!pn||!pn.cellStyles)){At.s={},At.s.patternType=$t.patternType;var xi;(xi=Xu(T($t.icvFore)))&&(At.s.fgColor={rgb:xi}),(xi=Xu(T($t.icvBack)))&&(At.s.bgColor={rgb:xi})}},M=function(Re,At,pn){if(!(B>1)&&!(pn.sheetRows&&Re.r>=pn.sheetRows)){if(pn.cellStyles&&At.XF&&At.XF.data&&P(Re,At,pn),delete At.ixfe,delete At.XF,d=Re,h=Ne(Re),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<i.s.r&&(i.s.r=Re.r),Re.c<i.s.c&&(i.s.c=Re.c),Re.r+1>i.e.r&&(i.e.r=Re.r+1),Re.c+1>i.e.c&&(i.e.c=Re.c+1),pn.cellFormula&&At.f){for(var $t=0;$t<x.length;++$t)if(!(x[$t][0].s.c>Re.c||x[$t][0].s.r>Re.r)&&!(x[$t][0].e.c<Re.c||x[$t][0].e.r<Re.r)){At.F=Ue(x[$t][0]),(x[$t][0].s.c!=Re.c||x[$t][0].s.r!=Re.r)&&delete At.f,At.f&&(At.f=""+mr(x[$t][1],i,Re,V,L));break}}pn.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=At):a[h]=At}},L={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var D,Q=[],ee=[],Y=[],q=[],G=!1,V=[];V.SheetNames=L.snames,V.sharedf=L.sharedf,V.arrayf=L.arrayf,V.names=[],V.XTI=[];var ae=0,B=0,C=0,I=[],N=[],j;L.codepage=1200,qn(1200);for(var K=!1;e.l<e.length-1;){var ie=e.l,X=e.read_shift(2);if(X===0&&ae===10)break;var le=e.l===e.length?0:e.read_shift(2),oe=_g[X];if(oe&&oe.f){if(t.bookSheets&&ae===133&&X!==133)break;if(ae=X,oe.r===2||oe.r==12){var Ee=e.read_shift(2);if(le-=2,!L.enc&&Ee!==X&&((Ee&255)<<8|Ee>>8)!==X)throw new Error("rt mismatch: "+Ee+"!="+X);oe.r==12&&(e.l+=10,le-=10)}var z={};if(X===10?z=oe.f(e,le,L):z=mce(X,oe,e,le,L),B==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(X){case 34:r.opts.Date1904=E.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=z;break;case 66:var je=Number(z);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}qn(L.codepage=je),K=!0;break;case 317:L.rrtabid=z;break;case 25:L.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:L.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(a["!type"]="dialog"),z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:b.push(z);break;case 430:V.push([z]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(z);break;case 24:case 536:j={Name:z.Name,Ref:mr(z.rgce,i,null,V,L)},z.itab>0&&(j.Sheet=z.itab-1),V.names.push(j),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(N[z.itab-1]={ref:Ue(z.rgce[0][0][1][2])});break;case 22:L.ExternCount=z;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(z),V.XTI=V.XTI.concat(z);break;case 2196:if(L.biff<8)break;j!=null&&(j.Comment=z[1]);break;case 18:a["!protect"]=z;break;case 19:z!==0&&L.WTF&&console.error("Password verifier: "+z);break;case 133:s[z.pos]=z,L.snames.push(z.name);break;case 10:{if(--B)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ue(i),t.sheetRows&&t.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ue(i),i.e.r=ke}i.e.r++,i.e.c++}Q.length>0&&(a["!merges"]=Q),ee.length>0&&(a["!objects"]=ee),Y.length>0&&(a["!cols"]=Y),q.length>0&&(a["!rows"]=q),E.Sheets.push(S)}c===""?f=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),L.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(L.biff=5,K=!0,qn(L.codepage=28591)),L.biff==8&&z.BIFFVer==0&&z.dt==16&&(L.biff=2),B++)break;if(a=t.dense?[]:{},L.biff<8&&!K&&(K=!0,qn(L.codepage=t.codepage||1252)),L.biff<5||z.BIFFVer==0&&z.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var qe={pos:e.l-le,name:c};s[qe.pos]=qe,L.snames.push(c)}else c=(s[ie]||{name:""}).name;z.dt==32&&(a["!type"]="chart"),z.dt==64&&(a["!type"]="macro"),Q=[],ee=[],L.arrayf=x=[],Y=[],q=[],G=!1,S={Hidden:(s[ie]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[z.r]||[])[z.c]:a[Ne({c:z.c,r:z.r})])&&++z.c,g={ixfe:z.ixfe,XF:b[z.ixfe]||{},v:z.val,t:"n"},C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:z.c,r:z.r},g,t);break;case 5:case 517:g={ixfe:z.ixfe,XF:b[z.ixfe],v:z.val,t:z.t},C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:z.c,r:z.r},g,t);break;case 638:g={ixfe:z.ixfe,XF:b[z.ixfe],v:z.rknum,t:"n"},C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:z.c,r:z.r},g,t);break;case 189:for(var Ae=z.c;Ae<=z.C;++Ae){var me=z.rkrec[Ae-z.c][0];g={ixfe:me,XF:b[me],v:z.rkrec[Ae-z.c][1],t:"n"},C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:Ae,r:z.r},g,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(g=Ed(z.val,z.cell.ixfe,z.tt),g.XF=b[g.ixfe],t.cellFormula){var tt=z.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var cr=tt[0][0][1][0],gt=tt[0][0][1][1],Ir=Ne({r:cr,c:gt});y[Ir]?g.f=""+mr(z.formula,i,z.cell,V,L):g.F=((t.dense?(a[cr]||[])[gt]:a[Ir])||{}).F}else g.f=""+mr(z.formula,i,z.cell,V,L)}C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M(z.cell,g,t),o=z}break;case 7:case 519:if(o)o.val=z,g=Ed(z,o.cell.ixfe,"s"),g.XF=b[g.ixfe],t.cellFormula&&(g.f=""+mr(o.formula,i,o.cell,V,L)),C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M(o.cell,g,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(z);var ws=Ne(z[0].s);if(m=t.dense?(a[z[0].s.r]||[])[z[0].s.c]:a[ws],t.cellFormula&&m){if(!o||!ws||!m)break;m.f=""+mr(z[1],i,z[0],V,L),m.F=Ue(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[Ne(o.cell)]=z[0],m=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Ne(o.cell)],(m||{}).f=""+mr(z[0],i,d,V,L)}}break;case 253:g=Ed(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(g.h=l[z.isst].h),g.XF=b[g.ixfe],C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:z.c,r:z.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:z.ixfe,XF:b[z.ixfe],t:"z"},C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:z.c,r:z.r},g,t));break;case 190:if(t.sheetStubs)for(var Ln=z.c;Ln<=z.C;++Ln){var er=z.ixfe[Ln-z.c];g={ixfe:er,XF:b[er],t:"z"},C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:Ln,r:z.r},g,t)}break;case 214:case 516:case 4:g=Ed(z.val,z.ixfe,"s"),g.XF=b[g.ixfe],C>0&&(g.z=I[g.ixfe>>8&63]),ha(g,t,r.opts.Date1904),M({c:z.c,r:z.r},g,t);break;case 0:case 512:B===1&&(i=z);break;case 252:l=z;break;case 1054:if(L.biff==4){I[C++]=z[1];for(var hn=0;hn<C+163&&De[hn]!=z[1];++hn);hn>=163&&$i(z[1],C+163)}else $i(z[1],z[0]);break;case 30:{I[C++]=z;for(var $n=0;$n<C+163&&De[$n]!=z;++$n);$n>=163&&$i(z,C+163)}break;case 229:Q=Q.concat(z);break;case 93:ee[z.cmo[0]]=L.lastobj=z;break;case 438:L.lastobj.TxO=z;break;case 127:L.lastobj.ImData=z;break;case 440:for(_=z[0].s.r;_<=z[0].e.r;++_)for(p=z[0].s.c;p<=z[0].e.c;++p)m=t.dense?(a[_]||[])[p]:a[Ne({c:p,r:_})],m&&(m.l=z[1]);break;case 2048:for(_=z[0].s.r;_<=z[0].e.r;++_)for(p=z[0].s.c;p<=z[0].e.c;++p)m=t.dense?(a[_]||[])[p]:a[Ne({c:p,r:_})],m&&m.l&&(m.l.Tooltip=z[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;m=t.dense?(a[z[0].r]||[])[z[0].c]:a[Ne(z[0])];var bs=ee[z[2]];m||(t.dense?(a[z[0].r]||(a[z[0].r]=[]),m=a[z[0].r][z[0].c]={t:"z"}):m=a[Ne(z[0])]={t:"z"},i.e.r=Math.max(i.e.r,z[0].r),i.s.r=Math.min(i.s.r,z[0].r),i.e.c=Math.max(i.e.c,z[0].c),i.s.c=Math.min(i.s.c,z[0].c)),m.c||(m.c=[]),v={a:z[1],t:bs.TxO.t},m.c.push(v)}break;case 2173:Lse(b[z.ixfe],z.ext);break;case 125:{if(!L.cellStyles)break;for(;z.e>=z.s;)Y[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},G||(G=!0,vy(z.w/256)),Al(Y[z.e+1])}break;case 520:{var Kt={};z.level!=null&&(q[z.r]=Kt,Kt.level=z.level),z.hidden&&(q[z.r]=Kt,Kt.hidden=!0),z.hpt&&(q[z.r]=Kt,Kt.hpt=z.hpt,Kt.hpx=Ju(z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||au(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=z;break;case 161:a["!margins"]||au(a["!margins"]={}),a["!margins"].header=z.header,a["!margins"].footer=z.footer;break;case 574:z.RTL&&(E.Views[0].RTL=!0);break;case 146:k=z;break;case 2198:D=z;break;case 140:w=z;break;case 442:c?S.CodeName=z||S.name:E.WBProps.CodeName=z||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+X.toString(16)),e.l+=le}return r.SheetNames=Da(s).sort(function(fa,Re){return Number(fa)-Number(Re)}).map(function(fa){return s[fa].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&N.forEach(function(fa,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=fa}),r.Strings=l,r.SSF=sr(De),L.enc&&(r.Encryption=L.enc),D&&(r.Themes=D),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),V.names.length>0&&(E.Names=V.names),r.Workbook=E,r}var iE={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gce(e,t,r){var n=Be.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Vb(n,Fre,iE.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Be.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Vb(i,Rre,iE.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(sA(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function WA(e,t){t||(t={}),wy(t),g4(),t.codepage&&Z1(t.codepage);var r,n;if(e.FullPaths){if(Be.find(e,"/encryption"))throw new Error("File is password-protected");r=Be.find(e,"!CompObj"),n=Be.find(e,"/Workbook")||Be.find(e,"/Book")}else{switch(t.type){case"base64":e=Gn(ln(e));break;case"binary":e=Gn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}rr(e,0),n={content:e}}var a,s;if(r&&hce(r),t.bookProps&&!t.bookSheets)a={};else{var i=$e?"buffer":"array";if(n&&n.content)a=vce(n.content,t);else if((s=Be.find(e,"PerfectOffice_MAIN"))&&s.content)a=ru.to_workbook(s.content,(t.type=i,t));else if((s=Be.find(e,"NativeContent_MAIN"))&&s.content)a=ru.to_workbook(s.content,(t.type=i,t));else throw(s=Be.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Be.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=rie(e))}var o={};return e.FullPaths&&gce(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var Q0={0:{f:Qoe},1:{f:rle},2:{f:fle},3:{f:ile},4:{f:ale},5:{f:ule},6:{f:ple},7:{f:lle},8:{f:yle},9:{f:xle},10:{f:vle},11:{f:gle},12:{f:nle},13:{f:dle},14:{f:ole},15:{f:sle},16:{f:IA},17:{f:mle},18:{f:cle},19:{f:uy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Yle},40:{},42:{},43:{f:vse},44:{f:mse},45:{f:gse},46:{f:yse},47:{f:xse},48:{},49:{f:_re},50:{},51:{f:Bse},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gA},62:{f:hle},63:{f:zse},64:{f:Nle},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Cle},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tle},148:{f:Zoe,p:16},151:{f:ble},152:{},153:{f:Hle},154:{},155:{},156:{f:Vle},157:{},158:{},159:{T:1,f:Rae},160:{T:-1},161:{T:1,f:xo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_le},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$se},336:{T:-1},337:{f:Use,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:mg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ele},427:{f:Sle},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Tle},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ele},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wle},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:mg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Zse},633:{T:1},634:{T:-1},635:{T:1,f:Qse},636:{T:-1},637:{f:bre},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Fle},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ale},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_g={6:{f:Dm},10:{f:ks},12:{f:It},13:{f:It},14:{f:Ot},15:{f:Ot},16:{f:gr},17:{f:Ot},18:{f:Ot},19:{f:It},20:{f:Gb},21:{f:Gb},23:{f:vA},24:{f:qb},25:{f:Ot},26:{},27:{},28:{f:Xne},29:{},34:{f:Ot},35:{f:Kb},38:{f:gr},39:{f:gr},40:{f:gr},41:{f:gr},42:{f:Ot},43:{f:Ot},47:{f:ese},49:{f:Dne},51:{f:It},60:{},61:{f:Nne},64:{f:Ot},65:{f:One},66:{f:It},77:{},80:{},81:{},82:{},85:{f:It},89:{},90:{},91:{},92:{f:_ne},93:{f:Qne},94:{},95:{f:Ot},96:{},97:{},99:{f:Ot},125:{f:gA},128:{f:Une},129:{f:wne},130:{f:It},131:{f:Ot},132:{f:Ot},133:{f:bne},134:{},140:{f:aae},141:{f:It},144:{},146:{f:iae},151:{},152:{},153:{},154:{},155:{},156:{f:It},157:{},158:{},160:{f:fae},161:{f:lae},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Ine},190:{f:Lne},193:{f:ks},197:{},198:{},199:{},200:{},201:{},202:{f:Ot},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:It},220:{},221:{f:Ot},222:{},224:{f:Bne},225:{f:yne},226:{f:ks},227:{},229:{f:Jne},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Ene},253:{f:jne},255:{f:Sne},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:uA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ot},353:{f:ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Vne},431:{f:Ot},432:{},433:{},434:{},437:{},438:{f:tae},439:{f:Ot},440:{f:rae},441:{},442:{f:Of},443:{},444:{f:It},445:{},446:{},448:{f:ks},449:{f:Cne,r:2},450:{f:ks},512:{f:zb},513:{f:uae},515:{f:Wne},516:{f:Pne},517:{f:Yb},519:{f:dae},520:{f:kne},523:{},545:{f:Xb},549:{f:Hb},566:{},574:{f:Ane},638:{f:Mne},659:{},1048:{},1054:{f:Fne},1084:{},1212:{f:Gne},2048:{f:nae},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_d},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:oae,r:12},2173:{f:Ise,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ot,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Yne,r:12},2197:{},2198:{f:Dse,r:12},2199:{},2200:{},2201:{},2202:{f:Kne,r:12},2203:{f:ks},2204:{},2205:{},2206:{},2207:{},2211:{f:Tne},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:It},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:cae},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:sae},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:zb},1:{},2:{f:vae},3:{f:mae},4:{f:pae},5:{f:Yb},7:{f:gae},8:{},9:{f:_d},11:{},22:{f:It},30:{f:Rne},31:{},32:{},33:{f:Xb},36:{},37:{f:Hb},50:{f:xae},62:{},52:{},67:{},68:{f:It},69:{},86:{},126:{},127:{f:hae},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yae},223:{},234:{},354:{},421:{},518:{f:Dm},521:{f:_d},536:{f:qb},547:{f:Kb},561:{},579:{},1030:{f:Dm},1033:{f:_d},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wn(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&J4(r)&&e.push(r)}}function oE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Wte(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<l.length;++i){var p=l[i].trim(),_=p.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(_!="<td"&&_!="<th")){var y=p.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var x=y[o].trim();if(x.match(/<t[dh]/i)){for(var g=x,w=0;g.charAt(0)=="<"&&(w=g.indexOf(">"))>-1;)g=g.slice(w+1);for(var b=0;b<v.length;++b){var k=v[b];k.s.c==f&&k.s.r<c&&c<=k.e.r&&(f=k.e.c+1,b=-1)}var E=Te(x.slice(0,x.indexOf(">")));h=E.colspan?+E.colspan:1,((d=+E.rowspan)>1||h>1)&&v.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+h-1}});var S=E.t||E["data-t"]||"";if(!g.length){f+=h;continue}if(g=L4(g),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!g.length){f+=h;continue}var T={t:"s",v:g};r.raw||!g.trim().length||S=="s"||(g==="TRUE"?T={t:"b",v:!0}:g==="FALSE"?T={t:"b",v:!1}:isNaN(Zn(g))?isNaN(Nl(g).getDate())||(T={t:"d",v:Zt(g)},r.cellDates||(T={t:"n",v:Fr(T.v)}),T.z=r.dateNF||De[14]):T={t:"n",v:Zn(g)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=T):n[Ne({r:c,c:f})]=T,f+=h}}}}return n["!ref"]=Ue(m),v.length&&(n["!merges"]=v),n}function xce(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var f=Ne({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||sy(d.w||(ps(d),d.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(m["data-t"]=d&&d.t||"z",d.v!=null&&(m["data-v"]=d.v),d.z!=null&&(m["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(are("td",h,m))}}var v="<tr>";return v+s.join("")+"</tr>"}var yce='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_ce="</body></html>";function wce(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return vi(oE(r[0],t),t);var n=Ey();return r.forEach(function(a,s){Sy(n,oE(a,t),"Sheet"+(s+1))}),n}function bce(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ece(e,t){var r=t||{},n=r.header!=null?r.header:yce,a=r.footer!=null?r.footer:_ce,s=[n],i=tc(e["!ref"]);r.dense=Array.isArray(e),s.push(bce(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(xce(e,i,o,r));return s.push("</table>"+a),s.join("")}function VA(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Dr(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=tc(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),a==-1&&(c.e.r=a=f.e.r+1)}var d=[],h=0,m=e["!rows"]||(e["!rows"]=[]),v=0,p=0,_=0,y=0,x=0,g=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&p<l;++v){var w=o[v];if(lE(w)){if(n.display)continue;m[p]={hidden:!0}}var b=w.children;for(_=y=0;_<b.length;++_){var k=b[_];if(!(n.display&&lE(k))){var E=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):L4(k.innerHTML),S=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<d.length;++h){var T=d[h];T.s.c==y+s&&T.s.r<p+a&&p+a<=T.e.r&&(y=T.e.c+1-s,h=-1)}g=+k.getAttribute("colspan")||1,((x=+k.getAttribute("rowspan")||1)>1||g>1)&&d.push({s:{r:p+a,c:y+s},e:{r:p+a+(x||1)-1,c:y+s+(g||1)-1}});var P={t:"s",v:E},M=k.getAttribute("data-t")||k.getAttribute("t")||"";E!=null&&(E.length==0?P.t=M||"z":n.raw||E.trim().length==0||M=="s"||(E==="TRUE"?P={t:"b",v:!0}:E==="FALSE"?P={t:"b",v:!1}:isNaN(Zn(E))?isNaN(Nl(E).getDate())||(P={t:"d",v:Zt(E)},n.cellDates||(P={t:"n",v:Fr(P.v)}),P.z=n.dateNF||De[14]):P={t:"n",v:Zn(E)})),P.z===void 0&&S!=null&&(P.z=S);var L="",D=k.getElementsByTagName("A");if(D&&D.length)for(var Q=0;Q<D.length&&!(D[Q].hasAttribute("href")&&(L=D[Q].getAttribute("href"),L.charAt(0)!="#"));++Q);L&&L.charAt(0)!="#"&&(P.l={Target:L}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][y+s]=P):e[Ne({c:y+s,r:p+a})]=P,c.e.c<y+s&&(c.e.c=y+s),y+=g}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=Ue(c),p>=l&&(e["!fullref"]=Ue((c.e.r=o.length-v+p-1+a,c))),e}function HA(e,t){var r=t||{},n=r.dense?[]:{};return VA(n,e,t)}function Sce(e,t){return vi(HA(e,t),t)}function lE(e){var t="",r=kce(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function kce(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Tce(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=He(t.replace(/<[^>]*>/g,""));return[r]}var cE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function zA(e,t){var r=t||{},n=iy(e),a=[],s,i,o={name:""},l="",c=0,f,d,h={},m=[],v=r.dense?[]:{},p,_,y={value:""},x="",g=0,w=[],b=-1,k=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,T={},P=[],M={},L=0,D=0,Q=[],ee=1,Y=1,q=[],G={Names:[]},V={},ae=["",""],B=[],C={},I="",N=0,j=!1,K=!1,ie=0;for(Ku.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Ku.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?v["!ref"]=Ue(E):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(v["!fullref"]=v["!ref"],E.e.r=r.sheetRows-1,v["!ref"]=Ue(E)),P.length&&(v["!merges"]=P),Q.length&&(v["!rows"]=Q),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),h[f.name]=v,K=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=Te(p[0],!1),b=k=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,v=r.dense?[]:{},P=[],Q=[],K=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){b+=ee,ee=1;break}if(d=Te(p[0],!1),d.?b=d.-1:b==-1&&(b=0),ee=+d["number-rows-repeated"]||1,ee<10)for(ie=0;ie<ee;++ie)S>0&&(Q[b+ie]={level:S});k=-1;break;case"covered-table-cell":p[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(v[b]||(v[b]=[]),v[b][k]={t:"z"}):v[Ne({r:b,c:k})]={t:"z"}),x="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++k,y=Te(p[0],!1),Y=parseInt(y["number-columns-repeated"]||"1",10),_={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(_.f=nE(He(y.formula))),(y.||y["value-type"])=="string"&&(_.t="s",_.v=He(y["string-value"]||""),r.dense?(v[b]||(v[b]=[]),v[b][k]=_):v[Ne({r:b,c:k})]=_),k+=Y-1;else if(p[1]!=="/"){++k,x="",g=0,w=[],Y=1;var X=ee?b+ee-1:b;if(k>E.e.c&&(E.e.c=k),k<E.s.c&&(E.s.c=k),b<E.s.r&&(E.s.r=b),X>E.e.r&&(E.e.r=X),y=Te(p[0],!1),B=[],C={},_={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=He(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(L=parseInt(y["number-matrix-rows-spanned"],10)||0,D=parseInt(y["number-matrix-columns-spanned"],10)||0,M={s:{r:b,c:k},e:{r:b+L-1,c:k+D-1}},_.F=Ue(M),q.push([M,_.F])),y.formula)_.f=nE(y.formula);else for(ie=0;ie<q.length;++ie)b>=q[ie][0].s.r&&b<=q[ie][0].e.r&&k>=q[ie][0].s.c&&k<=q[ie][0].e.c&&(_.F=q[ie][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(L=parseInt(y["number-rows-spanned"],10)||0,D=parseInt(y["number-columns-spanned"],10)||0,M={s:{r:b,c:k},e:{r:b+L-1,c:k+D-1}},P.push(M)),y["number-columns-repeated"]&&(Y=parseInt(y["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=mt(y["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(y.value);break;case"percentage":_.t="n",_.v=parseFloat(y.value);break;case"currency":_.t="n",_.v=parseFloat(y.value);break;case"date":_.t="d",_.v=Zt(y["date-value"]),r.cellDates||(_.t="n",_.v=Fr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=$te(y["time-value"])/86400,r.cellDates&&(_.t="d",_.v=hp(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(y.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",y["string-value"]!=null&&(x=He(y["string-value"]),w=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(j=!1,_.t==="s"&&(_.v=x||"",w.length&&(_.R=w),j=g==0),V.Target&&(_.l=V),B.length>0&&(_.c=B,B=[]),x&&r.cellText!==!1&&(_.w=x),j&&(_.t="z",delete _.v),(!j||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var le=0;le<ee;++le){if(Y=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(v[b+le]||(v[b+le]=[]),v[b+le][k]=le==0?_:sr(_);--Y>0;)v[b+le][k+Y]=sr(_);else for(v[Ne({r:b+le,c:k})]=_;--Y>0;)v[Ne({r:b+le,c:k+Y})]=sr(_);E.e.c<=k&&(E.e.c=k)}Y=parseInt(y["number-columns-repeated"]||"1",10),k+=Y-1,Y=0,_={},x="",w=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;C.t=x,w.length&&(C.R=w),C.a=I,B.push(C)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);I="",N=0,x="",g=0,w=[];break;case"creator":p[1]==="/"?I=n.slice(N,p.index):N=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);x="",g=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(T[o.name]=l,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=Te(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Te(p[0],!1),l+=cE[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Te(p[0],!1),l+=cE[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,p.index);break}else c=p.index+p[0].length;break;case"named-range":i=Te(p[0],!1),ae=jm(i["cell-range-address"]);var oe={Name:i.name,Ref:ae[0]+"!"+ae[1]};K&&(oe.Sheet=m.length),G.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var Ee=Tce(n.slice(g,p.index));x=(x.length>0?x+`
`:"")+Ee[0]}else Te(p[0],!1),g=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ae=jm(Te(p[0])["target-range-address"]),h[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(V=Te(p[0],!1),!V.href)break;V.Target=He(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(ae=jm(V.Target.slice(1)),V.Target="#"+ae[0]+"!"+ae[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var z={Sheets:h,SheetNames:m,Workbook:G};return r.bookSheets&&delete z.Sheets,z}function uE(e,t){t=t||{},gn(e,"META-INF/manifest.xml")&&Wre(Mt(e,"META-INF/manifest.xml"),t);var r=en(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=zA(st(r),t);return gn(e,"meta.xml")&&(n.Props=aA(Mt(e,"meta.xml"))),n}function fE(e,t){return zA(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function yy(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function wg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):st(vo(e))}function bg(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function dE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Cce(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Qu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function zt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Qu(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Qu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function _y(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Nce(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Qu(e,n),s=xr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:zt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=xr(o.data),c=zt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=zt(s[3][0].data)>>>0>0),r.push(i)}return r}function Ace(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Qu(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[bg(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var f=bg(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Oce(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ace(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return bg(t)}function Dce(e,t,r,n){var a=yy(e),s=a.getUint32(4,!0),i=(n>1?12:8)+dE(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=dE(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function jce(e,t,r){var n=yy(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);a&1&&(l=Cce(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Pce(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Dce(e,t,r,e[0]);case 5:return jce(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ei(e){var t=xr(e);return Qu(t[1][0].data)}function hE(e,t){var r=xr(t.data),n=zt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=xr(i.data),l=zt(o[1][0].data)>>>0;switch(n){case 1:s[l]=wg(o[3][0].data);break;case 8:{var c=e[ei(o[9][0].data)][0],f=xr(c.data),d=e[ei(f[1][0].data)][0],h=zt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=xr(d.data);s[l]=m[3].map(function(v){return wg(v.data)}).join("")}break}}),s}function Fce(e,t){var r,n,a,s,i,o,l,c,f,d,h,m,v,p,_=xr(e),y=zt(_[1][0].data)>>>0,x=zt(_[2][0].data)>>>0,g=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&zt(_[8][0].data)>0||!1,w,b;if((s=(a=_[7])==null?void 0:a[0])!=null&&s.data&&t!=0)w=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,b=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=_[4])==null?void 0:f[0])!=null&&d.data&&t!=1)w=(m=(h=_[4])==null?void 0:h[0])==null?void 0:m.data,b=(p=(v=_[3])==null?void 0:v[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=g?4:1,E=yy(w),S=[],T=0;T<w.length/2;++T){var P=E.getUint16(T*2,!0);P<65535&&S.push([T,P])}if(S.length!=x)throw"Expected ".concat(x," cells, found ").concat(S.length);var M=[];for(T=0;T<S.length-1;++T)M[S[T][0]]=b.subarray(S[T][1]*k,S[T+1][1]*k);return S.length>=1&&(M[S[S.length-1][0]]=b.subarray(S[S.length-1][1]*k)),{R:y,cells:M}}function Rce(e,t){var r,n=xr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?zt(n[7][0].data)>>>0>0?1:0:-1,s=_y(n[5],function(i){return Fce(i,a)});return{nrows:zt(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function Mce(e,t,r){var n,a=xr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(zt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(zt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ue(s);var i=xr(a[4][0].data),o=hE(e,e[ei(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?hE(e,e[ei(i[17][0].data)][0]):[],c=xr(i[3][0].data),f=0;c[1].forEach(function(d){var h=xr(d.data),m=e[ei(h[2][0].data)][0],v=zt(m.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var p=Rce(e,m);p.data.forEach(function(_,y){_.forEach(function(x,g){var w=Ne({r:f+y,c:g}),b=Pce(x,o,l);b&&(r[w]=b)})}),f+=p.nrows})}function Ice(e,t){var r=xr(t.data),n={"!ref":"A1"},a=e[ei(r[2][0].data)],s=zt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Mce(e,a[0],n),n}function Lce(e,t){var r,n=xr(t.data),a={name:(r=n[1])!=null&&r[0]?wg(n[1][0].data):"",sheets:[]},s=_y(n[2],ei);return s.forEach(function(i){e[i].forEach(function(o){var l=zt(o.meta[1][0].data);l==6e3&&a.sheets.push(Ice(e,o))})}),a}function $ce(e,t){var r=Ey(),n=xr(t.data),a=_y(n[1],ei);if(a.forEach(function(s){e[s].forEach(function(i){var o=zt(i.meta[1][0].data);if(o==2){var l=Lce(e,i);l.sheets.forEach(function(c,f){Sy(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Fm(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Oce(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=Nce(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&zt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var f=zt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return $ce(s,o)}function Bce(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function wy(e){Bce([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Uce(e){return qo.WS.indexOf(e)>-1?"sheet":e==qo.CS?"chart":e==qo.DS?"dialog":e==qo.MS?"macro":e&&e.length?e:"sheet"}function Wce(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Uce(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Vce(e,t,r,n,a,s,i,o,l,c,f,d){try{s[n]=eu(en(e,r,!0),t);var h=Mt(e,t),m;switch(o){case"sheet":m=qle(h,t,a,l,s[n],c,f,d);break;case"chart":if(m=Xle(h,t,a,l,s[n],c,f,d),!m||!m["!drawel"])break;var v=jc(m["!drawel"].Target,t),p=vg(v),_=Kse(en(e,v,!0),eu(en(e,p,!0),v)),y=jc(_,v),x=vg(y);m=jle(en(e,y,!0),y,l,eu(en(e,x,!0),y),c,m);break;case"macro":m=Jle(h,t,a,l,s[n],c,f,d);break;case"dialog":m=Qle(h,t,a,l,s[n],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=m;var g=[];s&&s[n]&&Da(s[n]).forEach(function(w){var b="";if(s[n][w].Type==qo.CMNT){b=jc(s[n][w].Target,t);var k=rce(Mt(e,b,!0),b,l);if(!k||!k.length)return;Qb(m,k,!1)}s[n][w].Type==qo.TCMNT&&(b=jc(s[n][w].Target,t),g=g.concat(Xse(Mt(e,b,!0),l)))}),g&&g.length&&Qb(m,g,!0,l.people||[])}catch(w){if(l.WTF)throw w}}function mn(e){return e.charAt(0)=="/"?e.slice(1):e}function Hce(e,t){if(A4(),t=t||{},wy(t),gn(e,"META-INF/manifest.xml")||gn(e,"objectdata.xml"))return uE(e,t);if(gn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Fm<"u"){if(e.FileIndex)return Fm(e);var r=Be.utils.cfb_new();return kb(e).forEach(function(Q){zte(r,Q,Hte(e,Q))}),Fm(r)}throw new Error("Unsupported NUMBERS file")}if(!gn(e,"[Content_Types].xml"))throw gn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):gn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=kb(e),a=Bre(en(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Mt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Mt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(nu=[],a.sst)try{nu=tce(Mt(e,mn(a.sst)),a.sst,t)}catch(Q){if(t.WTF)throw Q}t.cellStyles&&a.themes.length&&(l=ece(en(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=Zle(Mt(e,mn(a.style)),a.style,l,t))}a.links.map(function(Q){try{var ee=eu(en(e,vg(mn(Q))),Q);return ace(Mt(e,mn(Q)),ee,Q,t)}catch{}});var f=Kle(Mt(e,mn(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=Mt(e,mn(a.coreprops[0]),!0),h&&(d=aA(h)),a.extprops.length!==0&&(h=Mt(e,mn(a.extprops[0]),!0),h&&zre(h,d,t)));var m={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=en(e,mn(a.custprops[0]),!0),h&&(m=Gre(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(ee){return ee.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(v.Props=d,v.Custprops=m),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var p={};t.bookDeps&&a.calcchain&&(p=nce(Mt(e,mn(a.calcchain)),a.calcchain));var _=0,y={},x,g;{var w=f.Sheets;d.Worksheets=w.length,d.SheetNames=[];for(var b=0;b!=w.length;++b)d.SheetNames[b]=w[b].name}var k=s?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");gn(e,S)||(S="xl/_rels/workbook."+k+".rels");var T=eu(en(e,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=sce(Mt(e,mn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Jse(Mt(e,mn(a.people[0])),t)),T&&(T=Wce(T,f.Sheets));var P=Mt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var M="sheet";if(T&&T[_]?(x="xl/"+T[_][1].replace(/[\/]?xl\//,""),gn(e,x)||(x=T[_][1]),gn(e,x)||(x=S.replace(/_rels\/.*$/,"")+T[_][1]),M=T[_][2]):(x="xl/worksheets/sheet"+(_+1-P)+"."+k,x=x.replace(/sheet0\./,"sheet.")),g=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,D=0;D!=t.sheets.length;++D)typeof t.sheets[D]=="number"&&t.sheets[D]==_&&(L=1),typeof t.sheets[D]=="string"&&t.sheets[D].toLowerCase()==d.SheetNames[_].toLowerCase()&&(L=1);if(!L)continue e}}Vce(e,x,g,d.SheetNames[_],_,y,i,M,t,f,l,c)}return v={Directory:a,Workbook:f,Props:d,Custprops:m,Deps:p,Sheets:i,SheetNames:d.SheetNames,Strings:nu,Styles:c,Themes:l,SSF:sr(De)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(Q,ee){Q=Q.replace(/^Root Entry[\/]/,""),v.keys.push(Q),v.files[Q]=e.FileIndex[ee]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=Mt(e,mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===tie&&(v.vbaraw=Mt(e,"xl/vbaProject.bin",!0))),v}function zce(e,t){var r=t||{},n="Workbook",a=Be.find(e,n);try{if(n="/!DataSpaces/Version",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Iae(a.content),n="/!DataSpaces/DataSpaceMap",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=$ae(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Bae(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Wae(a.content)}catch{}if(n="/EncryptionInfo",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Vae(a.content);if(n="/EncryptedPackage",a=Be.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function by(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ln(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Yce(e,t){return Be.find(e,"EncryptedPackage")?zce(e,t):WA(e,t)}function Gce(e,t){var r,n=e,a=t||{};return a.type||(a.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r=R4(n,a),Hce(r,a)}function YA(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return yg(e.slice(r),t);default:break e}return qu.to_workbook(e,t)}function Kce(e,t){var r="",n=by(e,t);switch(t.type){case"base64":r=ln(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=no(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=st(r)),t.type="binary",YA(r,t)}function qce(e,t){var r=e;return t.type=="base64"&&(r=ln(r)),r=Fs.utils.decode(1200,r.slice(2),"str"),t.type="binary",YA(r,t)}function Xce(e){return e.match(/[^\x00-\x7F]/)?Pc(e):e}function Rm(e,t,r,n){return n?(r.type="string",qu.to_workbook(e,r)):qu.to_workbook(t,r)}function Eg(e,t){g4();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Eg(new Uint8Array(e),(r=sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),fl={},r.dateNF&&(fl.dateNF=r.dateNF),r.type||(r.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=$e?"buffer":"binary",n=Ite(e),typeof Uint8Array<"u"&&!$e&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Xce(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=sr(r),r.type="array",Eg(ey(n),r)}switch((a=by(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Yce(Be.read(n,r),r);break;case 9:if(a[1]<=8)return WA(n,r);break;case 60:return yg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Sae(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return bae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Gce(n,r):Rm(e,n,r,s);case 239:return a[3]===60?yg(n,r):Rm(e,n,r,s);case 255:if(a[1]===254)return qce(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return ru.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ru.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Jb.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return tse.to_workbook(n,r);break;case 10:case 13:case 32:return Kce(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _ae.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Jb.to_workbook(n,r):Rm(e,n,r,s)}function Jce(e,t,r,n,a,s,i,o){var l=ir(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var v=i?e[r][m]:e[n[m]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[m]!=null&&(h[s[m]]=c);continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[m]!=null){if(p==null)if(v.t=="e"&&p===null)h[s[m]]=null;else if(c!==void 0)h[s[m]]=c;else if(f&&p===null)h[s[m]]=null;else continue;else h[s[m]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?p:ps(v,p,o);p!=null&&(d=!1)}}return{row:h,isempty:d}}function Sg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Nt(f);break;case"number":l=Nt(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=ir(l.s.r),h=[],m=[],v=0,p=0,_=Array.isArray(e),y=l.s.r,x=0,g={};_&&!e[y]&&(e[y]=[]);var w=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(w[x]||{}).hidden)switch(h[x]=Ht(x),r=_?e[y][x]:e[h[x]+d],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=h[x];break;case 3:s[x]=c.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ps(r,null,c),p=g[i]||0,!p)g[i]=1;else{do o=i+"_"+p++;while(g[o]);g[i]=p,g[o]=1}s[x]=o}for(y=l.s.r+a;y<=l.e.r;++y)if(!(b[y]||{}).hidden){var k=Jce(e,l,y,h,n,s,_,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[v++]=k.row)}return m.length=v,m}var pE=/"/g;function Qce(e,t,r,n,a,s,i,o){for(var l=!0,c=[],f="",d=ir(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=o.dense?(e[r]||[])[h]:e[n[h]+d];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:ps(m,null,o));for(var v=0,p=0;v!==f.length;++v)if((p=f.charCodeAt(v))===a||p===s||p===34||o.forceQuotes){f='"'+f.replace(pE,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(pE,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function GA(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Nt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(d[v]=Ht(v));for(var p=0,_=a.s.r;_<=a.e.r;++_)(m[_]||{}).hidden||(f=Qce(e,a,_,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((p++?o:"")+f)));return delete n.dense,r.join("")}function Zce(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=GA(e,t);return r}function eue(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Nt(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Ht(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=ir(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function KA(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=Nt(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var h=n.header||[],m=0;t.forEach(function(p,_){Da(p).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var x=p[y],g="z",w="",b=Ne({c:o+m,r:i+_+a});c=Zu(s,b),x&&typeof x=="object"&&!(x instanceof Date)?s[b]=x:(typeof x=="number"?g="n":typeof x=="boolean"?g="b":typeof x=="string"?g="s":x instanceof Date?(g="d",n.cellDates||(g="n",x=Fr(x)),w=n.dateNF||De[14]):x===null&&n.nullError&&(g="e",x=0),c?(c.t=g,c.v=x,delete c.w,delete c.R,w&&(c.z=w)):s[b]=c={t:g,v:x},w&&(c.z=w))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var v=ir(i);if(a)for(m=0;m<h.length;++m)s[Ht(m+o)+v]={t:"s",v:h[m]};return s["!ref"]=Ue(f),s}function tue(e,t){return KA(null,e,t)}function Zu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Dr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zu(e,Ne(t)):Zu(e,Ne({r:t,c:r||0}))}function rue(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ey(){return{SheetNames:[],Sheets:{}}}function Sy(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(Ble(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function nue(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=rue(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function aue(e,t){return e.z=t,e}function qA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function sue(e,t,r){return qA(e,"#"+t,r)}function iue(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function oue(e,t,r,n){for(var a=typeof t!="string"?t:Nt(t),s=typeof t=="string"?t:Ue(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Zu(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var lue={encode_col:Ht,encode_row:ir,encode_cell:Ne,encode_range:Ue,decode_col:cy,decode_row:ly,split_cell:yre,decode_cell:Dr,decode_range:tc,format_cell:ps,sheet_add_aoa:Z4,sheet_add_json:KA,sheet_add_dom:VA,aoa_to_sheet:rc,json_to_sheet:tue,table_to_sheet:HA,table_to_book:Sce,sheet_to_csv:GA,sheet_to_txt:Zce,sheet_to_json:Sg,sheet_to_html:Ece,sheet_to_formulae:eue,sheet_to_row_object_array:Sg,sheet_get_cell:Zu,book_new:Ey,book_append_sheet:Sy,book_set_sheet_visibility:nue,cell_set_number_format:aue,cell_set_hyperlink:qA,cell_set_internal_link:sue,cell_add_comment:iue,sheet_set_array_formula:oue,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function cue(){const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,s]=O.useState(null),[i,o]=O.useState(!1);O.useEffect(()=>{(async()=>{try{n(!0);const{data:h,error:m}=await se.from("contacts").select("*").eq("status","open");if(m)throw m;t(h||[])}catch(h){console.error("Error fetching contacts:",h)}finally{n(!1)}})()},[]);const l=d=>{d.target.files&&d.target.files.length>0&&s(d.target.files[0])},c=async()=>{if(a){o(!0);try{const d=await a.arrayBuffer(),h=Eg(d),m=h.Sheets[h.SheetNames[0]],p=lue.sheet_to_json(m).map(x=>({client:x.Client||x.client||"",name:x.Name||x.name||"",contact_name:x["Contact Name"]||x.contact_name||x.Contact||"",email:x.Email||x.email||"",phone_number:x["Phone Number"]||x.phone_number||x.Phone||"",status:"open"})),{data:_,error:y}=await se.from("contacts").insert(p).select();if(y)throw y;t([...e,..._]),alert(`${_.length} contacts imported successfully!`),s(null)}catch(d){console.error("Error processing file:",d),alert("Error importing contacts. Please check the file format.")}finally{o(!1)}}},f=async d=>{try{const{error:h}=await se.from("contacts").update({status:"close"}).eq("id",d);if(h)throw h;t(e.filter(m=>m.id!==d)),alert("Call Done")}catch(h){console.error("Error updating contact:",h),alert("Failed to update contact")}};return r?u.jsx("div",{className:"text-center py-8",children:"Loading contacts..."}):u.jsxs("div",{className:"container mx-auto p-4",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Excel Data Import"}),u.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Upload Excel File"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[u.jsxs("div",{className:"flex-1 w-full",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Excel File"}),u.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",onChange:l,className:`block w-full text-sm text-gray-500\r
                file:mr-4 file:py-2 file:px-4\r
                file:rounded-md file:border-0\r
                file:text-sm file:font-semibold\r
                file:bg-blue-50 file:text-blue-700\r
                hover:file:bg-blue-100`,disabled:i})]}),u.jsx("button",{onClick:c,disabled:!a||i,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded disabled:opacity-50 disabled:cursor-not-allowed mt-6 sm:mt-0",children:i?"Uploading...":"Import Data"})]}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Supported formats: .xlsx, .xls, .csv. File should contain columns for Client, Name, Contact Name, Email, and Phone Number."})]}),e.length>0?u.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(d=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.client}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.contact_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.email}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.phone_number}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:u.jsx("button",{onClick:()=>d.id&&f(d.id),className:"text-blue-600 hover:text-blue-900",children:"Mark Done"})})]},d.id))})]})})}):u.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:u.jsx("p",{className:"text-gray-500",children:"No contacts found. Upload an Excel file to get started."})})]})}function uue(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]);O.useState(!1);const[i,o]=O.useState(!1),[l,c]=O.useState(null),[f,d]=O.useState([]),[h,m]=O.useState(""),[v,p]=O.useState([]),_=Pn(),y=Je(S=>S.role),x=Je(S=>S.user);O.useEffect(()=>{g(),(y==="e.head"||y==="e.employee")&&b()},[y,x==null?void 0:x.id]),O.useEffect(()=>{w()},[e,r]);async function g(){try{if(y==="e.employee"&&(x!=null&&x.id)){const{data:S,error:T}=await se.from("client_assignments").select("client:clients(*, client_assignments(employee_id))").eq("employee_id",x.id).eq("client.status","poreceived");if(T)throw T;const P=(S==null?void 0:S.map(M=>M.client).filter(M=>M!==null))||[];t(P)}else if(y==="e.head"||y==="admin"){const{data:S,error:T}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","poreceived");if(T)throw T;t(S||[])}}catch(S){console.error("Error loading clients:",S)}}const w=()=>{if(!r){s(e);return}const S=e.filter(T=>{var P,M,L;return((P=T==null?void 0:T.name)==null?void 0:P.toLowerCase().includes(r.toLowerCase()))||((M=T==null?void 0:T.company)==null?void 0:M.toLowerCase().includes(r.toLowerCase()))||((L=T==null?void 0:T.address)==null?void 0:L.toLowerCase().includes(r.toLowerCase()))});s(S)};async function b(){const{data:S,error:T}=await se.from("employees").select("*").eq("role","e.employee");if(T){console.error("Error loading employees:",T);return}d(S||[])}async function k(){if(l)try{const S=v.map(P=>({client_id:l.id,employee_id:P}));await se.from("client_assignments").delete().eq("client_id",l.id);const{error:T}=await se.from("client_assignments").insert(S);if(T)throw T;o(!1),g()}catch(S){console.error("Error assigning employees:",S)}}const E=f.filter(S=>{var T;return(T=S==null?void 0:S.full_name)==null?void 0:T.toLowerCase().includes(h.toLowerCase())});return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"PO Received Clients"}),u.jsx("div",{className:"flex items-center space-x-4",children:u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:S=>n(S.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]})})]}),a.length===0?u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No PO received clients found"})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(S=>S&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:S.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:S.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:S.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>_(`/eclients/${S.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),(y==="e.head"||y==="admin")&&u.jsxs("button",{onClick:()=>{var T;c(S),p(((T=S.client_assignments)==null?void 0:T.map(P=>P.employee_id))||[]),o(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Gi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},S.id))}),i&&l&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Assign Employees to ",l.name]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:h,onChange:S=>m(S.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:v,onChange:S=>{const T=Array.from(S.target.selectedOptions,P=>P.value);p(T)},className:"w-full p-2 border rounded h-40",size:5,children:E.map(S=>u.jsx("option",{value:S.id,children:S.full_name},S.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}function fue(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]);O.useState(!1);const[i,o]=O.useState(!1),[l,c]=O.useState(null),[f,d]=O.useState([]),[h,m]=O.useState(""),[v,p]=O.useState([]),_=Pn(),y=Je(E=>E.role);Je(E=>E.user),O.useEffect(()=>{x(),y==="finance.employee"&&w()},[y]),O.useEffect(()=>{g()},[e,r]);async function x(){const{data:E,error:S}=await se.from("clients").select("*, client_assignments(employee_id)").eq("status","ecomplete");if(S){console.error("Error loading clients:",S);return}t(E||[])}const g=()=>{if(!r){s(e);return}const E=e.filter(S=>S.name.toLowerCase().includes(r.toLowerCase())||S.company.toLowerCase().includes(r.toLowerCase())||S.address.toLowerCase().includes(r.toLowerCase()));s(E)};async function w(){const{data:E,error:S}=await se.from("employees").select("*").eq("role","finance.employee");if(S){console.error("Error loading employees:",S);return}d(E||[])}async function b(){if(!l)return;const E=v.map(T=>({client_id:l.id,employee_id:T})),{error:S}=await se.from("client_assignments").insert(E);if(S){console.error("Error assigning employees:",S);return}o(!1),x()}const k=f.filter(E=>E.full_name.toLowerCase().includes(h.toLowerCase()));return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-white-800",children:"FClients"}),u.jsx("div",{className:"flex items-center",children:u.jsxs("div",{className:"relative mr-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search FClients",value:r,onChange:E=>n(E.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]})})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(E=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:E.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:E.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:E.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>_(`/fclients/${E.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),y==="head"&&u.jsxs("button",{onClick:()=>{c(E),o(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Gi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},E.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Assign Employees"}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:h,onChange:E=>m(E.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:v,onChange:E=>{const S=Array.from(E.target.selectedOptions,T=>T.value);p(S)},className:"w-full p-2 border rounded",children:k.map(E=>u.jsx("option",{value:E.id,children:E.full_name},E.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}const due=()=>{const[e,t]=O.useState({client_id:"",employee_id:"",document_type:"",description:"",file:null}),[r,n]=O.useState(!1),[a,s]=O.useState(0),[i,o]=O.useState(null),[l,c]=O.useState(!1),[f,d]=O.useState([]),[h,m]=O.useState(!0),v=Je(g=>g.user);O.useEffect(()=>{(async()=>{try{const{data:w,error:b}=await se.from("clients").select("id, name").eq("status","ecomplete").order("name",{ascending:!0});if(b)throw b;d(w||[])}catch(w){console.error("Error fetching clients:",w),o("Failed to load client list")}finally{m(!1)}})()},[]);const p=g=>{const{name:w,value:b}=g.target;t({...e,[w]:b})},_=g=>{g.target.files&&g.target.files[0]&&t({...e,file:g.target.files[0]})},y=()=>{t({...e,file:null})},x=async g=>{if(g.preventDefault(),!e.file){o("Please select a file to upload");return}n(!0),o(null),c(!1);try{const w=e.file.name.split(".").pop(),k=`documents/${`${e.client_id}_${Date.now()}.${w}`}`,{error:E}=await se.storage.from("documents").upload(k,e.file,{cacheControl:"3600",upsert:!1,contentType:e.file.type});if(E)throw E;const{data:S}=se.storage.from("documents").getPublicUrl(k),{error:T}=await se.from("documents").insert([{client_id:e.client_id,employee_id:(v==null?void 0:v.id)||e.employee_id,document_type:e.document_type,description:e.description,file_name:e.file.name,file_url:S.publicUrl,file_path:k,file_type:e.file.type,file_size:e.file.size}]);if(T)throw T;c(!0),t({client_id:"",employee_id:"",document_type:"",description:"",file:null})}catch(w){console.error("Error uploading document:",w),o(w instanceof Error?w.message:"Failed to upload document")}finally{n(!1)}};return u.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Documents Upload"}),u.jsxs("form",{onSubmit:x,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"client_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),h?u.jsx("select",{disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100",children:u.jsx("option",{children:"Loading clients..."})}):u.jsxs("select",{id:"client_id",name:"client_id",value:e.client_id,onChange:p,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"",children:"Select a client"}),f.map(g=>u.jsx("option",{value:g.id,children:g.name},g.id))]})]}),!(v!=null&&v.id)&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"employee_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),u.jsx("input",{type:"text",id:"employee_id",name:"employee_id",value:e.employee_id,onChange:p,required:!(v!=null&&v.id),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"document_type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Document Type"}),u.jsxs("select",{id:"document_type",name:"document_type",value:e.document_type,onChange:p,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"",children:"Select document type"}),u.jsx("option",{value:"invoice",children:"Invoice"}),u.jsx("option",{value:"contract",children:"Contract"}),u.jsx("option",{value:"proposal",children:"Proposal"}),u.jsx("option",{value:"report",children:"Report"}),u.jsx("option",{value:"other",children:"Other"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),u.jsx("textarea",{id:"description",name:"description",value:e.description,onChange:p,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Document File"}),e.file?u.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-300 rounded-md bg-gray-50",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Gc,{className:"h-5 w-5 text-gray-400 mr-2"}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.file.name})]}),u.jsx("button",{type:"button",onClick:y,className:"text-gray-500 hover:text-gray-700",children:u.jsx(Ki,{className:"h-5 w-5"})})]}):u.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:u.jsxs("div",{className:"space-y-1 text-center",children:[u.jsx("div",{className:"flex justify-center",children:u.jsx(Ux,{className:"mx-auto h-12 w-12 text-gray-400"})}),u.jsxs("div",{className:"flex text-sm text-gray-600",children:[u.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[u.jsx("span",{children:"Upload a file"}),u.jsx("input",{id:"file-upload",name:"file-upload",type:"file",onChange:_,className:"sr-only",required:!0})]}),u.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"PDF, DOCX, XLSX, JPG, PNG up to 10MB"})]})})]}),r&&u.jsxs("div",{className:"pt-1",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[u.jsx("span",{children:"Uploading..."}),u.jsxs("span",{children:[a,"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${a}%`}})})]}),i&&u.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-100 rounded-md",children:i}),l&&u.jsx("div",{className:"p-3 text-sm text-green-700 bg-green-100 rounded-md",children:"Document uploaded successfully!"}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:r,className:`px-4 py-2 rounded-md text-white ${r?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,children:r?"Uploading...":"Upload Document"})})]})]})};function hue(){const{id:e}=Il(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState([]),[c,f]=O.useState([]);Je(m=>m.user),O.useEffect(()=>{e&&(d(),h())},[e]);async function d(){const{data:m}=await se.from("clients").select("*").eq("id",e).single();r(m);const{data:v}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(v||[]);const{data:p}=await se.from("quotations").select(`
                *,
                employees (
                    full_name
                ),
                quotation_assets (
                    asset_id,
                    quantity,
                    assets (
                        item
                    )
                )
            `).eq("client_id",e).order("created_at",{ascending:!1});i(p||[]);const{data:_}=await se.from("site_visits").select(`
                *,
                employees (
                    full_name
                ),
                site_visit_assets (
                    asset_id,
                    quantity,
                    assets (
                        item
                    )
                )
            `).eq("client_id",e).order("created_at",{ascending:!1});l(_||[])}async function h(){const{data:m}=await se.from("assets").select("*").order("item");f(m||[])}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsx("div",{className:"flex justify-between items-start",children:u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]})})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(m=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:m.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:m.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Bl,{className:"w-4 h-4 mr-2"}),m.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(ff,{className:"w-4 h-4 mr-2"}),m.phone]})]})]},m.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Quotations"}),u.jsx("div",{className:"space-y-4",children:s.map(m=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-semibold text-gray-800",children:["Amount: $",m.amount]}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",m.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm",children:m.description}),u.jsx("div",{className:"mt-2",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Period: ",new Date(m.start_date).toLocaleDateString()," - ",new Date(m.end_date).toLocaleDateString()]})}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:m.quotation_assets.map(v=>u.jsxs("li",{children:[v.assets.item," (Qty: ",v.quantity,")"]},v.asset_id))})]})]}),u.jsx("div",{className:"flex flex-col gap-2",children:u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${m.status==="approved"?"bg-green-100 text-green-800":m.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:m.status.charAt(0).toUpperCase()+m.status.slice(1)})})]})},m.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),u.jsx("div",{className:"space-y-4",children:o.map(m=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold text-gray-800",children:m.address}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",m.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm mt-2",children:m.notes}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:m.site_visit_assets.map(v=>u.jsxs("li",{children:[v.assets.item," (Qty: ",v.quantity,")"]},v.asset_id))})]}),u.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:["Exit Location: ",m.exit_location]})]}),u.jsx("div",{className:"text-sm text-gray-500",children:new Date(m.created_at).toLocaleDateString()})]})},m.id))})]})]}):null}const mE="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSIwIDAgMzAwIDIwMCIgZmlsbD0iI2VlZWVlZSI+PHJlY3Qgd2lkdGg9IjMwMCIgaGVpZ2h0PSIyMDAiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBhbGlnbm1lbnQtYmFzZWxpbmU9Im1pZGRsZSIgZmlsbD0iIzY2NiI+Tm8gUHJldmlldyBBdmFpbGFibGU8L3RleHQ+PC9zdmc+";function pue(){const e=Pn(),[t,r]=O.useState([]),[n,a]=O.useState(!0),[s,i]=O.useState(""),[o,l]=O.useState(""),[c,f]=O.useState(""),[d,h]=O.useState("all"),[m,v]=O.useState(!1),[p,_]=O.useState(null);O.useEffect(()=>{(async()=>{try{a(!0);const{data:k,error:E}=await se.from("pd_kit_uploads").select(`
            id,
            file_path,
            uploaded_at,
            upload_type,
            visit_id
          `).order("uploaded_at",{ascending:!1});if(E)throw E;if(!k)return;const S=[...new Set(k.map(L=>L.visit_id))],{data:T,error:P}=await se.from("site_visit").select(`
            id,
            created_at,
            client_Id,
            employee_Id,
            clients (id, name, company),
            employees (id, full_name)
          `).in("id",S);if(P)throw P;const M=k.map(L=>{var Q,ee,Y,q,G;const D=T==null?void 0:T.find(V=>V.id===L.visit_id);return{id:L.id,file_path:L.file_path,uploaded_at:L.uploaded_at,upload_type:L.upload_type,visit:{id:(D==null?void 0:D.id)||"",created_at:(D==null?void 0:D.created_at)||"",client:{id:((Q=D==null?void 0:D.clients)==null?void 0:Q.id)||"",name:((ee=D==null?void 0:D.clients)==null?void 0:ee.name)||"Unknown Client",company:((Y=D==null?void 0:D.clients)==null?void 0:Y.company)||""},employee:{id:((q=D==null?void 0:D.employees)==null?void 0:q.id)||"",name:((G=D==null?void 0:D.employees)==null?void 0:G.full_name)||"Unknown Employee"}}}});r(M)}catch(k){console.error("Error fetching PD kits:",k),i(k.message||"Failed to load PD kits")}finally{a(!1)}})()},[]);const y=b=>{const{data:k}=se.storage.from("pd-kits").getPublicUrl(b);return k.publicUrl},x=t.filter(b=>{const k=b.visit.client.name.toLowerCase().includes(o.toLowerCase())||b.visit.client.company.toLowerCase().includes(o.toLowerCase())||b.visit.employee.name.toLowerCase().includes(o.toLowerCase()),E=c?new Date(b.uploaded_at).toISOString().split("T")[0]===c:!0,S=d==="all"||b.upload_type===d;return k&&E&&S}),g=()=>{l(""),f(""),h("all")},w=b=>{_(y(b))};return n?u.jsx("div",{className:"flex items-center justify-center h-screen",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):s?u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:s}),u.jsxs("button",{onClick:()=>e(-1),className:"mt-4 px-4 py-2 bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(w6,{className:"w-4 h-4"}),"Go Back"]})]}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:()=>_(null),children:u.jsxs("div",{className:"relative max-w-full max-h-full",children:[u.jsx("img",{src:p,alt:"PD Kit Preview",className:"max-w-full max-h-[90vh] object-contain",onClick:b=>b.stopPropagation(),onError:b=>{const k=b.target;k.onerror=null,k.src=mE}}),u.jsx("button",{className:"absolute top-4 right-4 bg-white p-2 rounded-full shadow-lg",onClick:()=>_(null),children:u.jsx(Ki,{className:"w-6 h-6 text-gray-800"})})]})}),u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"All PD Kits"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client, company or employee...",value:o,onChange:b=>l(b.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>v(!m),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(PT,{className:"w-4 h-4"}),u.jsx("span",{children:"Filters"})]})]})]}),m&&u.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"font-medium",children:"Filters"}),u.jsxs("button",{onClick:g,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Ki,{className:"w-4 h-4"}),"Clear all"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Date"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Ph,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"date",value:c,onChange:b=>f(b.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Type"}),u.jsxs("select",{value:d,onChange:b=>h(b.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2",children:[u.jsx("option",{value:"all",children:"All Types"}),u.jsx("option",{value:"start",children:"Start of Visit"}),u.jsx("option",{value:"end",children:"End of Visit"})]})]})]})]}),x.length===0?u.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[u.jsx("p",{className:"text-gray-500",children:"No PD Kits found"}),(o||c||d!=="all")&&u.jsx("button",{onClick:g,className:"text-blue-600 hover:underline mt-2",children:"Clear filters"})]}):u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(b=>u.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition-shadow",children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-medium text-gray-800 line-clamp-1",children:b.visit.client.name}),u.jsx("p",{className:"text-sm text-gray-500",children:b.visit.client.company})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${b.upload_type==="start"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:b.upload_type==="start"?"Start":"End"})]})}),u.jsxs("div",{className:"relative group",children:[u.jsx("img",{src:y(b.file_path),alt:`PD Kit ${b.upload_type}`,className:"w-full h-48 object-cover cursor-pointer",onClick:()=>w(b.file_path),onError:k=>{const E=k.target;E.onerror=null,E.src=mE}}),u.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100",children:u.jsx(Ew,{className:"text-white w-8 h-8"})})]}),u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[u.jsx(zv,{className:"w-4 h-4"}),b.visit.employee.name]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(b.uploaded_at).toLocaleString()})]}),u.jsxs("button",{onClick:()=>w(b.file_path),className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Ew,{className:"w-4 h-4"}),"Expand"]})]})})]},b.id))})]})}function mue(){const{role:e}=Je(),[t,r]=O.useState(!0),n=()=>{r(!t)};return u.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[u.jsx("button",{onClick:n,className:"p-2 bg-gray-200 rounded-md shadow-md m-2 focus:outline-none z-50 fixed top-22 left-0",children:u.jsx(FT,{className:"w-4 h-4"})}),u.jsx("div",{className:`w-64 bg-white shadow-lg ${t?"block":"hidden"}`,children:u.jsxs("nav",{className:"mt-8",children:[u.jsxs(Xr,{to:"/dashboard",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(E6,{className:"w-5 h-5 mr-3"}),"Dashboard"]}),(e==="head"||e==="e.head")&&u.jsxs(Xr,{to:"/employees",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Gi,{className:"w-5 h-5 mr-3"}),"Employees"]}),(e==="head"||e==="admin"||e==="employee")&&u.jsxs(Xr,{to:"/clients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Yc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),(e==="e.employee"||e==="e.head")&&u.jsxs(Xr,{to:"/eclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Yc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),e==="finance.employee"&&u.jsxs(Xr,{to:"/fclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Yc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),e==="e.head"&&u.jsxs(Xr,{to:"/pd-kits",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(ww,{className:"w-5 h-5 mr-3"}),"PD Kits"]}),(e==="employee"||e==="e.employee")&&u.jsxs(Xr,{to:"/site-visit",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(ww,{className:"w-5 h-5 mr-3"}),"Site Visit"]}),e==="finance.employee"&&u.jsx(u.Fragment,{children:u.jsxs(Xr,{to:"/documents-upload",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(od,{className:"w-5 h-5 mr-3"}),"Documents Upload"]})}),u.jsxs(Xr,{to:"/allclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(od,{className:"w-5 h-5 mr-3"}),"All Clients"]}),(e==="head"||e==="e.head"||e==="admin")&&u.jsxs(Xr,{to:"/time-insights",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(od,{className:"w-5 h-5 mr-3"}),"Site Visit Time"]}),u.jsxs(Xr,{to:"/xldata",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(od,{className:"w-5 h-5 mr-3"}),"XL Data"]}),u.jsxs(Xr,{to:"/Notifications",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Hv,{className:"w-5 h-5 mr-3"}),"Notifications"]}),u.jsxs(Xr,{to:"/clients-history",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(b6,{className:"w-5 h-5 mr-3"}),"Clients History"]})]})}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsx("div",{className:"p-8",children:u.jsx(gP,{})})})]})}function ze(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw new Error(typeof e=="number"?"[MobX] minified error nr: "+e+(r.length?" "+r.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var vue={};function gp(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:vue}var XA=Object.assign,Z0=Object.getOwnPropertyDescriptor,Ta=Object.defineProperty,xp=Object.prototype,kg=[];Object.freeze(kg);var JA={};Object.freeze(JA);var gue=typeof Proxy<"u",xue=Object.toString();function QA(){gue||ze("Proxy not available")}function ZA(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var Xo=function(){};function oa(e){return typeof e=="function"}function so(e){var t=typeof e;switch(t){case"string":case"symbol":case"number":return!0}return!1}function yp(e){return e!==null&&typeof e=="object"}function oi(e){if(!yp(e))return!1;var t=Object.getPrototypeOf(e);if(t==null)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r.toString()===xue}function eO(e){var t=e==null?void 0:e.constructor;return t?t.name==="GeneratorFunction"||t.displayName==="GeneratorFunction":!1}function _p(e,t,r){Ta(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function tO(e,t,r){Ta(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function wo(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(n){return yp(n)&&n[r]===!0}}function nc(e){return e!=null&&Object.prototype.toString.call(e)==="[object Map]"}function yue(e){var t=Object.getPrototypeOf(e),r=Object.getPrototypeOf(t),n=Object.getPrototypeOf(r);return n===null}function Ya(e){return e!=null&&Object.prototype.toString.call(e)==="[object Set]"}var rO=typeof Object.getOwnPropertySymbols<"u";function _ue(e){var t=Object.keys(e);if(!rO)return t;var r=Object.getOwnPropertySymbols(e);return r.length?[].concat(t,r.filter(function(n){return xp.propertyIsEnumerable.call(e,n)})):t}var wp=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:rO?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function nO(e){return e===null?null:typeof e=="object"?""+e:e}function as(e,t){return xp.hasOwnProperty.call(e,t)}var wue=Object.getOwnPropertyDescriptors||function(t){var r={};return wp(t).forEach(function(n){r[n]=Z0(t,n)}),r};function tn(e,t){return!!(e&t)}function rn(e,t,r){return r?e|=t:e&=~t,e}function vE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function bue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sue(n.key),n)}}function ac(e,t,r){return t&&bue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jo(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=kue(e))||t){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},io.apply(null,arguments)}function aO(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Tg(e,t)}function Tg(e,t){return Tg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Tg(e,t)}function Eue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Sue(e){var t=Eue(e,"string");return typeof t=="symbol"?t:t+""}function kue(e,t){if(e){if(typeof e=="string")return vE(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vE(e,t):void 0}}var wa=Symbol("mobx-stored-annotations");function Ca(e){function t(r,n){if(Rf(n))return e.decorate_20223_(r,n);Ff(r,n,e)}return Object.assign(t,e)}function Ff(e,t,r){as(e,wa)||_p(e,wa,io({},e[wa])),Fue(r)||(e[wa][t]=r)}function Tue(e){return as(e,wa)||_p(e,wa,io({},e[wa])),e[wa]}function Rf(e){return typeof e=="object"&&typeof e.kind=="string"}var Ce=Symbol("mobx administration"),gi=function(){function e(r){r===void 0&&(r="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=Ye.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=r}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},t.reportObserved=function(){return _O(this)},t.reportChanged=function(){kn(),wO(this),Tn()},t.toString=function(){return this.name_},ac(e,[{key:"isBeingObserved",get:function(){return tn(this.flags_,e.isBeingObservedMask_)},set:function(n){this.flags_=rn(this.flags_,e.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return tn(this.flags_,e.isPendingUnobservationMask_)},set:function(n){this.flags_=rn(this.flags_,e.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return tn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=rn(this.flags_,e.diffValueMask_,n===1)}}])}();gi.isBeingObservedMask_=1;gi.isPendingUnobservationMask_=2;gi.diffValueMask_=4;var ky=wo("Atom",gi);function sO(e,t,r){t===void 0&&(t=Xo),r===void 0&&(r=Xo);var n=new gi(e);return t!==Xo&&Lfe(n,t),r!==Xo&&TO(n,r),n}function Cue(e,t){return e===t}function Nue(e,t){return jy(e,t)}function Aue(e,t){return jy(e,t,1)}function Oue(e,t){return Object.is?Object.is(e,t):e===t?e!==0||1/e===1/t:e!==e&&t!==t}var eh={identity:Cue,structural:Nue,default:Oue,shallow:Aue};function oo(e,t,r){return OO(e)?e:Array.isArray(e)?nr.array(e,{name:r}):oi(e)?nr.object(e,void 0,{name:r}):nc(e)?nr.map(e,{name:r}):Ya(e)?nr.set(e,{name:r}):typeof e=="function"&&!tf(e)&&!rf(e)?eO(e)?Ol(e):ef(r,e):e}function Due(e,t,r){if(e==null||Cp(e)||Tp(e)||Eo(e)||_a(e))return e;if(Array.isArray(e))return nr.array(e,{name:r,deep:!1});if(oi(e))return nr.object(e,void 0,{name:r,deep:!1});if(nc(e))return nr.map(e,{name:r,deep:!1});if(Ya(e))return nr.set(e,{name:r,deep:!1})}function bp(e){return e}function jue(e,t){return jy(e,t)?t:e}var Pue="override";function Fue(e){return e.annotationType_===Pue}function Mf(e,t){return{annotationType_:e,options_:t,make_:Rue,extend_:Mue,decorate_20223_:Iue}}function Rue(e,t,r,n){var a;if((a=this.options_)!=null&&a.bound)return this.extend_(e,t,r,!1)===null?0:1;if(n===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if(tf(r.value))return 1;var s=iO(e,this,t,r,!1);return Ta(n,t,s),2}function Mue(e,t,r,n){var a=iO(e,this,t,r);return e.defineProperty_(t,a,n)}function Iue(e,t){var r=t.kind,n=t.name,a=t.addInitializer,s=this,i=function(c){var f,d,h,m;return lo((f=(d=s.options_)==null?void 0:d.name)!=null?f:n.toString(),c,(h=(m=s.options_)==null?void 0:m.autoAction)!=null?h:!1)};if(r=="field")return function(l){var c,f=l;return tf(f)||(f=i(f)),(c=s.options_)!=null&&c.bound&&(f=f.bind(this),f.isMobxAction=!0),f};if(r=="method"){var o;return tf(e)||(e=i(e)),(o=this.options_)!=null&&o.bound&&a(function(){var l=this,c=l[n].bind(l);c.isMobxAction=!0,l[n]=c}),e}ze("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+r+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function Lue(e,t,r,n){t.annotationType_,n.value}function iO(e,t,r,n,a){var s,i,o,l,c,f,d;a===void 0&&(a=ge.safeDescriptors),Lue(e,t,r,n);var h=n.value;if((s=t.options_)!=null&&s.bound){var m;h=h.bind((m=e.proxy_)!=null?m:e.target_)}return{value:lo((i=(o=t.options_)==null?void 0:o.name)!=null?i:r.toString(),h,(l=(c=t.options_)==null?void 0:c.autoAction)!=null?l:!1,(f=t.options_)!=null&&f.bound?(d=e.proxy_)!=null?d:e.target_:void 0),configurable:a?e.isPlainObject_:!0,enumerable:!1,writable:!a}}function oO(e,t){return{annotationType_:e,options_:t,make_:$ue,extend_:Bue,decorate_20223_:Uue}}function $ue(e,t,r,n){var a;if(n===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if((a=this.options_)!=null&&a.bound&&(!as(e.target_,t)||!rf(e.target_[t]))&&this.extend_(e,t,r,!1)===null)return 0;if(rf(r.value))return 1;var s=lO(e,this,t,r,!1,!1);return Ta(n,t,s),2}function Bue(e,t,r,n){var a,s=lO(e,this,t,r,(a=this.options_)==null?void 0:a.bound);return e.defineProperty_(t,s,n)}function Uue(e,t){var r,n=t.name,a=t.addInitializer;return rf(e)||(e=Ol(e)),(r=this.options_)!=null&&r.bound&&a(function(){var s=this,i=s[n].bind(s);i.isMobXFlow=!0,s[n]=i}),e}function Wue(e,t,r,n){t.annotationType_,n.value}function lO(e,t,r,n,a,s){s===void 0&&(s=ge.safeDescriptors),Wue(e,t,r,n);var i=n.value;if(rf(i)||(i=Ol(i)),a){var o;i=i.bind((o=e.proxy_)!=null?o:e.target_),i.isMobXFlow=!0}return{value:i,configurable:s?e.isPlainObject_:!0,enumerable:!1,writable:!s}}function Ty(e,t){return{annotationType_:e,options_:t,make_:Vue,extend_:Hue,decorate_20223_:zue}}function Vue(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function Hue(e,t,r,n){return Yue(e,this,t,r),e.defineComputedProperty_(t,io({},this.options_,{get:r.get,set:r.set}),n)}function zue(e,t){var r=this,n=t.name,a=t.addInitializer;return a(function(){var s=sc(this)[Ce],i=io({},r.options_,{get:e,context:this});i.name||(i.name="ObservableObject."+n.toString()),s.values_.set(n,new la(i))}),function(){return this[Ce].getObservablePropValue_(n)}}function Yue(e,t,r,n){t.annotationType_,n.get}function Ep(e,t){return{annotationType_:e,options_:t,make_:Gue,extend_:Kue,decorate_20223_:que}}function Gue(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function Kue(e,t,r,n){var a,s;return Xue(e,this),e.defineObservableProperty_(t,r.value,(a=(s=this.options_)==null?void 0:s.enhancer)!=null?a:oo,n)}function que(e,t){var r=this,n=t.kind,a=t.name,s=new WeakSet;function i(o,l){var c,f,d=sc(o)[Ce],h=new Ui(l,(c=(f=r.options_)==null?void 0:f.enhancer)!=null?c:oo,"ObservableObject."+a.toString(),!1);d.values_.set(a,h),s.add(o)}if(n=="accessor")return{get:function(){return s.has(this)||i(this,e.get.call(this)),this[Ce].getObservablePropValue_(a)},set:function(l){return s.has(this)||i(this,l),this[Ce].setObservablePropValue_(a,l)},init:function(l){return s.has(this)||i(this,l),l}}}function Xue(e,t,r,n){t.annotationType_}var Jue="true",Que=cO();function cO(e){return{annotationType_:Jue,options_:e,make_:Zue,extend_:efe,decorate_20223_:tfe}}function Zue(e,t,r,n){var a,s;if(r.get)return Sp.make_(e,t,r,n);if(r.set){var i=lo(t.toString(),r.set);return n===e.target_?e.defineProperty_(t,{configurable:ge.safeDescriptors?e.isPlainObject_:!0,set:i})===null?0:2:(Ta(n,t,{configurable:!0,set:i}),2)}if(n!==e.target_&&typeof r.value=="function"){var o;if(eO(r.value)){var l,c=(l=this.options_)!=null&&l.autoBind?Ol.bound:Ol;return c.make_(e,t,r,n)}var f=(o=this.options_)!=null&&o.autoBind?ef.bound:ef;return f.make_(e,t,r,n)}var d=((a=this.options_)==null?void 0:a.deep)===!1?nr.ref:nr;if(typeof r.value=="function"&&(s=this.options_)!=null&&s.autoBind){var h;r.value=r.value.bind((h=e.proxy_)!=null?h:e.target_)}return d.make_(e,t,r,n)}function efe(e,t,r,n){var a,s;if(r.get)return Sp.extend_(e,t,r,n);if(r.set)return e.defineProperty_(t,{configurable:ge.safeDescriptors?e.isPlainObject_:!0,set:lo(t.toString(),r.set)},n);if(typeof r.value=="function"&&(a=this.options_)!=null&&a.autoBind){var i;r.value=r.value.bind((i=e.proxy_)!=null?i:e.target_)}var o=((s=this.options_)==null?void 0:s.deep)===!1?nr.ref:nr;return o.extend_(e,t,r,n)}function tfe(e,t){ze("'"+this.annotationType_+"' cannot be used as a decorator")}var rfe="observable",nfe="observable.ref",afe="observable.shallow",sfe="observable.struct",uO={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(uO);function Sd(e){return e||uO}var Cg=Ep(rfe),ife=Ep(nfe,{enhancer:bp}),ofe=Ep(afe,{enhancer:Due}),lfe=Ep(sfe,{enhancer:jue}),fO=Ca(Cg);function kd(e){return e.deep===!0?oo:e.deep===!1?bp:ufe(e.defaultDecorator)}function cfe(e){var t;return e?(t=e.defaultDecorator)!=null?t:cO(e):void 0}function ufe(e){var t,r;return e&&(t=(r=e.options_)==null?void 0:r.enhancer)!=null?t:oo}function dO(e,t,r){if(Rf(t))return Cg.decorate_20223_(e,t);if(so(t)){Ff(e,t,Cg);return}return OO(e)?e:oi(e)?nr.object(e,t,r):Array.isArray(e)?nr.array(e,t):nc(e)?nr.map(e,t):Ya(e)?nr.set(e,t):typeof e=="object"&&e!==null?e:nr.box(e,t)}XA(dO,fO);var ffe={box:function(t,r){var n=Sd(r);return new Ui(t,kd(n),n.name,!0,n.equals)},array:function(t,r){var n=Sd(r);return(ge.useProxies===!1||n.proxy===!1?cde:Zfe)(t,kd(n),n.name)},map:function(t,r){var n=Sd(r);return new jO(t,kd(n),n.name)},set:function(t,r){var n=Sd(r);return new PO(t,kd(n),n.name)},object:function(t,r,n){return So(function(){return Wfe(ge.useProxies===!1||(n==null?void 0:n.proxy)===!1?sc({},n):qfe({},n),t,r)})},ref:Ca(ife),shallow:Ca(ofe),deep:fO,struct:Ca(lfe)},nr=XA(dO,ffe),hO="computed",dfe="computed.struct",Ng=Ty(hO),hfe=Ty(dfe,{equals:eh.structural}),Sp=function(t,r){if(Rf(r))return Ng.decorate_20223_(t,r);if(so(r))return Ff(t,r,Ng);if(oi(t))return Ca(Ty(hO,t));var n=oi(r)?r:{};return n.get=t,n.name||(n.name=t.name||""),new la(n)};Object.assign(Sp,Ng);Sp.struct=Ca(hfe);var gE,xE,th=0,pfe=1,mfe=(gE=(xE=Z0(function(){},"name"))==null?void 0:xE.configurable)!=null?gE:!1,yE={value:"action",configurable:!0,writable:!1,enumerable:!1};function lo(e,t,r,n){r===void 0&&(r=!1);function a(){return vfe(e,r,t,n||this,arguments)}return a.isMobxAction=!0,a.toString=function(){return t.toString()},mfe&&(yE.value=e,Ta(a,"name",yE)),a}function vfe(e,t,r,n,a){var s=gfe(e,t);try{return r.apply(n,a)}catch(i){throw s.error_=i,i}finally{xfe(s)}}function gfe(e,t,r,n){var a=!1,s=0,i=ge.trackingDerivation,o=!t||!i;kn();var l=ge.allowStateChanges;o&&(bo(),l=Cy(!0));var c=Ay(!0),f={runAsAction_:o,prevDerivation_:i,prevAllowStateChanges_:l,prevAllowStateReads_:c,notifySpy_:a,startTime_:s,actionId_:pfe++,parentActionId_:th};return th=f.actionId_,f}function xfe(e){th!==e.actionId_&&ze(30),th=e.parentActionId_,e.error_!==void 0&&(ge.suppressReactionErrors=!0),Ny(e.prevAllowStateChanges_),iu(e.prevAllowStateReads_),Tn(),e.runAsAction_&&ss(e.prevDerivation_),ge.suppressReactionErrors=!1}function Cy(e){var t=ge.allowStateChanges;return ge.allowStateChanges=e,t}function Ny(e){ge.allowStateChanges=e}var Ui=function(e){function t(n,a,s,i,o){var l;return s===void 0&&(s="ObservableValue"),o===void 0&&(o=eh.default),l=e.call(this,s)||this,l.enhancer=void 0,l.name_=void 0,l.equals=void 0,l.hasUnreportedChange_=!1,l.interceptors_=void 0,l.changeListeners_=void 0,l.value_=void 0,l.dehancer=void 0,l.enhancer=a,l.name_=s,l.equals=o,l.value_=a(n,void 0,s),l}aO(t,e);var r=t.prototype;return r.dehanceValue=function(a){return this.dehancer!==void 0?this.dehancer(a):a},r.set=function(a){this.value_,a=this.prepareNewValue_(a),a!==ge.UNCHANGED&&this.setNewValue_(a)},r.prepareNewValue_=function(a){if(bn(this)){var s=En(this,{object:this,type:Na,newValue:a});if(!s)return ge.UNCHANGED;a=s.newValue}return a=this.enhancer(a,this.value_,this.name_),this.equals(this.value_,a)?ge.UNCHANGED:a},r.setNewValue_=function(a){var s=this.value_;this.value_=a,this.reportChanged(),ea(this)&&ta(this,{type:Na,object:this,newValue:a,oldValue:s})},r.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},r.intercept_=function(a){return If(this,a)},r.observe_=function(a,s){return s&&a({observableKind:"value",debugObjectName:this.name_,object:this,type:Na,newValue:this.value_,oldValue:void 0}),Lf(this,a)},r.raw=function(){return this.value_},r.toJSON=function(){return this.get()},r.toString=function(){return this.name_+"["+this.value_+"]"},r.valueOf=function(){return nO(this.get())},r[Symbol.toPrimitive]=function(){return this.valueOf()},t}(gi),la=function(){function e(r){this.dependenciesState_=Ye.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ye.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new nh(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=rh.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,r.get||ze(31),this.derivation=r.get,this.name_=r.name||"ComputedValue",r.set&&(this.setter_=lo("ComputedValue-setter",r.set)),this.equals_=r.equals||(r.compareStructural||r.struct?eh.structural:eh.default),this.scope_=r.context,this.requiresReaction_=r.requiresReaction,this.keepAlive_=!!r.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){Efe(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},t.get=function(){if(this.isComputing&&ze(32,this.name_,this.derivation),ge.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)Ag(this)&&(this.warnAboutUntrackedRead_(),kn(),this.value_=this.computeValue_(!1),Tn());else if(_O(this),Ag(this)){var n=ge.trackingContext;this.keepAlive_&&!n&&(ge.trackingContext=this),this.trackAndCompute()&&bfe(this),ge.trackingContext=n}var a=this.value_;if(Gd(a))throw a.cause;return a},t.set=function(n){if(this.setter_){this.isRunningSetter&&ze(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter=!1}}else ze(34,this.name_)},t.trackAndCompute=function(){var n=this.value_,a=this.dependenciesState_===Ye.NOT_TRACKING_,s=this.computeValue_(!0),i=a||Gd(n)||Gd(s)||!this.equals_(n,s);return i&&(this.value_=s),i},t.computeValue_=function(n){this.isComputing=!0;var a=Cy(!1),s;if(n)s=pO(this,this.derivation,this.scope_);else if(ge.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(i){s=new nh(i)}return Ny(a),this.isComputing=!1,s},t.suspend_=function(){this.keepAlive_||(Og(this),this.value_=void 0)},t.observe_=function(n,a){var s=this,i=!0,o=void 0;return Pfe(function(){var l=s.get();if(!i||a){var c=bo();n({observableKind:"computed",debugObjectName:s.name_,type:Na,object:s,newValue:l,oldValue:o}),ss(c)}i=!1,o=l})},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return nO(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},ac(e,[{key:"isComputing",get:function(){return tn(this.flags_,e.isComputingMask_)},set:function(n){this.flags_=rn(this.flags_,e.isComputingMask_,n)}},{key:"isRunningSetter",get:function(){return tn(this.flags_,e.isRunningSetterMask_)},set:function(n){this.flags_=rn(this.flags_,e.isRunningSetterMask_,n)}},{key:"isBeingObserved",get:function(){return tn(this.flags_,e.isBeingObservedMask_)},set:function(n){this.flags_=rn(this.flags_,e.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return tn(this.flags_,e.isPendingUnobservationMask_)},set:function(n){this.flags_=rn(this.flags_,e.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return tn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=rn(this.flags_,e.diffValueMask_,n===1)}}])}();la.isComputingMask_=1;la.isRunningSetterMask_=2;la.isBeingObservedMask_=4;la.isPendingUnobservationMask_=8;la.diffValueMask_=16;var kp=wo("ComputedValue",la),Ye;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(Ye||(Ye={}));var rh;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(rh||(rh={}));var nh=function(t){this.cause=void 0,this.cause=t};function Gd(e){return e instanceof nh}function Ag(e){switch(e.dependenciesState_){case Ye.UP_TO_DATE_:return!1;case Ye.NOT_TRACKING_:case Ye.STALE_:return!0;case Ye.POSSIBLY_STALE_:{for(var t=Ay(!0),r=bo(),n=e.observing_,a=n.length,s=0;s<a;s++){var i=n[s];if(kp(i)){if(ge.disableErrorBoundaries)i.get();else try{i.get()}catch{return ss(r),iu(t),!0}if(e.dependenciesState_===Ye.STALE_)return ss(r),iu(t),!0}}return vO(e),ss(r),iu(t),!1}}}function pO(e,t,r){var n=Ay(!0);vO(e),e.newObserving_=new Array(e.runId_===0?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++ge.runId;var a=ge.trackingDerivation;ge.trackingDerivation=e,ge.inBatch++;var s;if(ge.disableErrorBoundaries===!0)s=t.call(r);else try{s=t.call(r)}catch(i){s=new nh(i)}return ge.inBatch--,ge.trackingDerivation=a,yfe(e),iu(n),s}function yfe(e){for(var t=e.observing_,r=e.observing_=e.newObserving_,n=Ye.UP_TO_DATE_,a=0,s=e.unboundDepsCount_,i=0;i<s;i++){var o=r[i];o.diffValue===0&&(o.diffValue=1,a!==i&&(r[a]=o),a++),o.dependenciesState_>n&&(n=o.dependenciesState_)}for(r.length=a,e.newObserving_=null,s=t.length;s--;){var l=t[s];l.diffValue===0&&xO(l,e),l.diffValue=0}for(;a--;){var c=r[a];c.diffValue===1&&(c.diffValue=0,wfe(c,e))}n!==Ye.UP_TO_DATE_&&(e.dependenciesState_=n,e.onBecomeStale_())}function Og(e){var t=e.observing_;e.observing_=[];for(var r=t.length;r--;)xO(t[r],e);e.dependenciesState_=Ye.NOT_TRACKING_}function mO(e){var t=bo();try{return e()}finally{ss(t)}}function bo(){var e=ge.trackingDerivation;return ge.trackingDerivation=null,e}function ss(e){ge.trackingDerivation=e}function Ay(e){var t=ge.allowStateReads;return ge.allowStateReads=e,t}function iu(e){ge.allowStateReads=e}function vO(e){if(e.dependenciesState_!==Ye.UP_TO_DATE_){e.dependenciesState_=Ye.UP_TO_DATE_;for(var t=e.observing_,r=t.length;r--;)t[r].lowestObserverState_=Ye.UP_TO_DATE_}}var Kd=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},qd=!0,gO=!1,ge=function(){var e=gp();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(qd=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new Kd().version&&(qd=!1),qd?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new Kd):(setTimeout(function(){gO||ze(35)},1),new Kd)}();function _fe(){if((ge.pendingReactions.length||ge.inBatch||ge.isRunningReactions)&&ze(36),gO=!0,qd){var e=gp();--e.__mobxInstanceCount===0&&(e.__mobxGlobals=void 0),ge=new Kd}}function wfe(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function xO(e,t){e.observers_.delete(t),e.observers_.size===0&&yO(e)}function yO(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,ge.pendingUnobservations.push(e))}function kn(){ge.inBatch++}function Tn(){if(--ge.inBatch===0){bO();for(var e=ge.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=!1,r.observers_.size===0&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBUO()),r instanceof la&&r.suspend_())}ge.pendingUnobservations=[]}}function _O(e){var t=ge.trackingDerivation;return t!==null?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&ge.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(e.observers_.size===0&&ge.inBatch>0&&yO(e),!1)}function wO(e){e.lowestObserverState_!==Ye.STALE_&&(e.lowestObserverState_=Ye.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ye.UP_TO_DATE_&&t.onBecomeStale_(),t.dependenciesState_=Ye.STALE_}))}function bfe(e){e.lowestObserverState_!==Ye.STALE_&&(e.lowestObserverState_=Ye.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ye.POSSIBLY_STALE_?t.dependenciesState_=Ye.STALE_:t.dependenciesState_===Ye.UP_TO_DATE_&&(e.lowestObserverState_=Ye.UP_TO_DATE_)}))}function Efe(e){e.lowestObserverState_===Ye.UP_TO_DATE_&&(e.lowestObserverState_=Ye.POSSIBLY_STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ye.UP_TO_DATE_&&(t.dependenciesState_=Ye.POSSIBLY_STALE_,t.onBecomeStale_())}))}var ms=function(){function e(r,n,a,s){r===void 0&&(r="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Ye.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=rh.NONE,this.name_=r,this.onInvalidate_=n,this.errorHandler_=a,this.requiresObservable_=s}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,ge.pendingReactions.push(this),bO())},t.runReaction_=function(){if(!this.isDisposed){kn(),this.isScheduled=!1;var n=ge.trackingContext;if(ge.trackingContext=this,Ag(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(a){this.reportExceptionInDerivation_(a)}}ge.trackingContext=n,Tn()}},t.track=function(n){if(!this.isDisposed){kn(),this.isRunning=!0;var a=ge.trackingContext;ge.trackingContext=this;var s=pO(this,n,void 0);ge.trackingContext=a,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&Og(this),Gd(s)&&this.reportExceptionInDerivation_(s.cause),Tn()}},t.reportExceptionInDerivation_=function(n){var a=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(ge.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";ge.suppressReactionErrors||console.error(s,n),ge.globalReactionErrorHandlers.forEach(function(i){return i(n,a)})},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(kn(),Og(this),Tn()))},t.getDisposer_=function(n){var a=this,s=function i(){a.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",i)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[Ce]=this,s},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(n){},ac(e,[{key:"isDisposed",get:function(){return tn(this.flags_,e.isDisposedMask_)},set:function(n){this.flags_=rn(this.flags_,e.isDisposedMask_,n)}},{key:"isScheduled",get:function(){return tn(this.flags_,e.isScheduledMask_)},set:function(n){this.flags_=rn(this.flags_,e.isScheduledMask_,n)}},{key:"isTrackPending",get:function(){return tn(this.flags_,e.isTrackPendingMask_)},set:function(n){this.flags_=rn(this.flags_,e.isTrackPendingMask_,n)}},{key:"isRunning",get:function(){return tn(this.flags_,e.isRunningMask_)},set:function(n){this.flags_=rn(this.flags_,e.isRunningMask_,n)}},{key:"diffValue",get:function(){return tn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=rn(this.flags_,e.diffValueMask_,n===1)}}])}();ms.isDisposedMask_=1;ms.isScheduledMask_=2;ms.isTrackPendingMask_=4;ms.isRunningMask_=8;ms.diffValueMask_=16;var Sfe=100,Dg=function(t){return t()};function bO(){ge.inBatch>0||ge.isRunningReactions||Dg(kfe)}function kfe(){ge.isRunningReactions=!0;for(var e=ge.pendingReactions,t=0;e.length>0;){++t===Sfe&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var r=e.splice(0),n=0,a=r.length;n<a;n++)r[n].runReaction_()}ge.isRunningReactions=!1}var ah=wo("Reaction",ms);function Tfe(e){var t=Dg;Dg=function(n){return e(function(){return t(n)})}}function ou(){return!1}function Cfe(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var EO="action",Nfe="action.bound",SO="autoAction",Afe="autoAction.bound",Ofe="<unnamed action>",jg=Mf(EO),Dfe=Mf(Nfe,{bound:!0}),Pg=Mf(SO,{autoAction:!0}),jfe=Mf(Afe,{autoAction:!0,bound:!0});function kO(e){var t=function(n,a){if(oa(n))return lo(n.name||Ofe,n,e);if(oa(a))return lo(n,a,e);if(Rf(a))return(e?Pg:jg).decorate_20223_(n,a);if(so(a))return Ff(n,a,e?Pg:jg);if(so(n))return Ca(Mf(e?SO:EO,{name:n,autoAction:e}))};return t}var Qo=kO(!1);Object.assign(Qo,jg);var ef=kO(!0);Object.assign(ef,Pg);Qo.bound=Ca(Dfe);ef.bound=Ca(jfe);function tf(e){return oa(e)&&e.isMobxAction===!0}function Pfe(e,t){var r,n,a,s;t===void 0&&(t=JA);var i=(r=(n=t)==null?void 0:n.name)!=null?r:"Autorun",o=!t.scheduler&&!t.delay,l;if(o)l=new ms(i,function(){this.track(d)},t.onError,t.requiresObservable);else{var c=Rfe(t),f=!1;l=new ms(i,function(){f||(f=!0,c(function(){f=!1,l.isDisposed||l.track(d)}))},t.onError,t.requiresObservable)}function d(){e(l)}return(a=t)!=null&&(a=a.signal)!=null&&a.aborted||l.schedule_(),l.getDisposer_((s=t)==null?void 0:s.signal)}var Ffe=function(t){return t()};function Rfe(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Ffe}var Mfe="onBO",Ife="onBUO";function Lfe(e,t,r){return CO(Mfe,e,t,r)}function TO(e,t,r){return CO(Ife,e,t,r)}function CO(e,t,r,n){var a=oh(t),s=oa(n)?n:r,i=e+"L";return a[i]?a[i].add(s):a[i]=new Set([s]),function(){var o=a[i];o&&(o.delete(s),o.size===0&&delete a[i])}}var $fe="never",Td="always",Bfe="observed";function Ufe(e){e.isolateGlobalState===!0&&_fe();var t=e.useProxies,r=e.enforceActions;if(t!==void 0&&(ge.useProxies=t===Td?!0:t===$fe?!1:typeof Proxy<"u"),t==="ifavailable"&&(ge.verifyProxies=!0),r!==void 0){var n=r===Td?Td:r===Bfe;ge.enforceActions=n,ge.allowStateChanges=!(n===!0||n===Td)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(a){a in e&&(ge[a]=!!e[a])}),ge.allowStateReads=!ge.observableRequiresReaction,e.reactionScheduler&&Tfe(e.reactionScheduler)}function Wfe(e,t,r,n){var a=wue(t);return So(function(){var s=sc(e,n)[Ce];wp(a).forEach(function(i){s.extend_(i,a[i],r&&i in r?r[i]:!0)})}),e}function Vfe(e,t){return NO(oh(e,t))}function NO(e){var t={name:e.name_};return e.observing_&&e.observing_.length>0&&(t.dependencies=Hfe(e.observing_).map(NO)),t}function Hfe(e){return Array.from(new Set(e))}var zfe=0;function AO(){this.message="FLOW_CANCELLED"}AO.prototype=Object.create(Error.prototype);var Mm=oO("flow"),Yfe=oO("flow.bound",{bound:!0}),Ol=Object.assign(function(t,r){if(Rf(r))return Mm.decorate_20223_(t,r);if(so(r))return Ff(t,r,Mm);var n=t,a=n.name||"<unnamed flow>",s=function(){var o=this,l=arguments,c=++zfe,f=Qo(a+" - runid: "+c+" - init",n).apply(o,l),d,h=void 0,m=new Promise(function(v,p){var _=0;d=p;function y(w){h=void 0;var b;try{b=Qo(a+" - runid: "+c+" - yield "+_++,f.next).call(f,w)}catch(k){return p(k)}g(b)}function x(w){h=void 0;var b;try{b=Qo(a+" - runid: "+c+" - yield "+_++,f.throw).call(f,w)}catch(k){return p(k)}g(b)}function g(w){if(oa(w==null?void 0:w.then)){w.then(g,p);return}return w.done?v(w.value):(h=Promise.resolve(w.value),h.then(y,x))}y(void 0)});return m.cancel=Qo(a+" - runid: "+c+" - cancel",function(){try{h&&_E(h);var v=f.return(void 0),p=Promise.resolve(v.value);p.then(Xo,Xo),_E(p),d(new AO)}catch(_){d(_)}}),m};return s.isMobXFlow=!0,s},Mm);Ol.bound=Ca(Yfe);function _E(e){oa(e.cancel)&&e.cancel()}function rf(e){return(e==null?void 0:e.isMobXFlow)===!0}function Gfe(e,t){return e?Cp(e)||!!e[Ce]||ky(e)||ah(e)||kp(e):!1}function OO(e){return Gfe(e)}function Ga(e,t){t===void 0&&(t=void 0),kn();try{return e.apply(t)}finally{Tn()}}function Do(e){return e[Ce]}var Kfe={has:function(t,r){return Do(t).has_(r)},get:function(t,r){return Do(t).get_(r)},set:function(t,r,n){var a;return so(r)?(a=Do(t).set_(r,n,!0))!=null?a:!0:!1},deleteProperty:function(t,r){var n;return so(r)?(n=Do(t).delete_(r,!0))!=null?n:!0:!1},defineProperty:function(t,r,n){var a;return(a=Do(t).defineProperty_(r,n))!=null?a:!0},ownKeys:function(t){return Do(t).ownKeys_()},preventExtensions:function(t){ze(13)}};function qfe(e,t){var r,n;return QA(),e=sc(e,t),(n=(r=e[Ce]).proxy_)!=null?n:r.proxy_=new Proxy(e,Kfe)}function bn(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function If(e,t){var r=e.interceptors_||(e.interceptors_=[]);return r.push(t),ZA(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function En(e,t){var r=bo();try{for(var n=[].concat(e.interceptors_||[]),a=0,s=n.length;a<s&&(t=n[a](t),t&&!t.type&&ze(14),!!t);a++);return t}finally{ss(r)}}function ea(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function Lf(e,t){var r=e.changeListeners_||(e.changeListeners_=[]);return r.push(t),ZA(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function ta(e,t){var r=bo(),n=e.changeListeners_;if(n){n=n.slice();for(var a=0,s=n.length;a<s;a++)n[a](t);ss(r)}}function Xfe(e,t,r){return So(function(){var n,a=sc(e,r)[Ce];(n=t)!=null||(t=Tue(e)),wp(t).forEach(function(s){return a.make_(s,t[s])})}),e}var wE="splice",Na="update",Jfe=1e4,Qfe={get:function(t,r){var n=t[Ce];return r===Ce?n:r==="length"?n.getArrayLength_():typeof r=="string"&&!isNaN(r)?n.get_(parseInt(r)):as(sh,r)?sh[r]:t[r]},set:function(t,r,n){var a=t[Ce];return r==="length"&&a.setArrayLength_(n),typeof r=="symbol"||isNaN(r)?t[r]=n:a.set_(parseInt(r),n),!0},preventExtensions:function(){ze(15)}},Oy=function(){function e(r,n,a,s){r===void 0&&(r="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=a,this.legacyMode_=s,this.atom_=new gi(r),this.enhancer_=function(i,o){return n(i,o,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},t.intercept_=function(n){return If(this,n)},t.observe_=function(n,a){return a===void 0&&(a=!1),a&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Lf(this,n)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&ze("Out of range: "+n);var a=this.values_.length;if(n!==a)if(n>a){for(var s=new Array(n-a),i=0;i<n-a;i++)s[i]=void 0;this.spliceWithArray_(a,0,s)}else this.spliceWithArray_(n,a-n)},t.updateArrayLength_=function(n,a){n!==this.lastKnownLength_&&ze(16),this.lastKnownLength_+=a,this.legacyMode_&&a>0&&IO(n+a+1)},t.spliceWithArray_=function(n,a,s){var i=this;this.atom_;var o=this.values_.length;if(n===void 0?n=0:n>o?n=o:n<0&&(n=Math.max(0,o+n)),arguments.length===1?a=o-n:a==null?a=0:a=Math.max(0,Math.min(a,o-n)),s===void 0&&(s=kg),bn(this)){var l=En(this,{object:this.proxy_,type:wE,index:n,removedCount:a,added:s});if(!l)return kg;a=l.removedCount,s=l.added}if(s=s.length===0?s:s.map(function(d){return i.enhancer_(d,void 0)}),this.legacyMode_){var c=s.length-a;this.updateArrayLength_(o,c)}var f=this.spliceItemsIntoValues_(n,a,s);return(a!==0||s.length!==0)&&this.notifyArraySplice_(n,s,f),this.dehanceValues_(f)},t.spliceItemsIntoValues_=function(n,a,s){if(s.length<Jfe){var i;return(i=this.values_).splice.apply(i,[n,a].concat(s))}else{var o=this.values_.slice(n,n+a),l=this.values_.slice(n+a);this.values_.length+=s.length-a;for(var c=0;c<s.length;c++)this.values_[n+c]=s[c];for(var f=0;f<l.length;f++)this.values_[n+s.length+f]=l[f];return o}},t.notifyArrayChildUpdate_=function(n,a,s){var i=!this.owned_&&ou(),o=ea(this),l=o||i?{observableKind:"array",object:this.proxy_,type:Na,debugObjectName:this.atom_.name_,index:n,newValue:a,oldValue:s}:null;this.atom_.reportChanged(),o&&ta(this,l)},t.notifyArraySplice_=function(n,a,s){var i=!this.owned_&&ou(),o=ea(this),l=o||i?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:wE,index:n,removed:s,added:a,removedCount:s.length,addedCount:a.length}:null;this.atom_.reportChanged(),o&&ta(this,l)},t.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},t.set_=function(n,a){var s=this.values_;if(this.legacyMode_&&n>s.length&&ze(17,n,s.length),n<s.length){this.atom_;var i=s[n];if(bn(this)){var o=En(this,{type:Na,object:this.proxy_,index:n,newValue:a});if(!o)return;a=o.newValue}a=this.enhancer_(a,i);var l=a!==i;l&&(s[n]=a,this.notifyArrayChildUpdate_(n,a,i))}else{for(var c=new Array(n+1-s.length),f=0;f<c.length-1;f++)c[f]=void 0;c[c.length-1]=a,this.spliceWithArray_(s.length,0,c)}},e}();function Zfe(e,t,r,n){return r===void 0&&(r="ObservableArray"),n===void 0&&(n=!1),QA(),So(function(){var a=new Oy(r,t,n,!1);tO(a.values_,Ce,a);var s=new Proxy(a.values_,Qfe);return a.proxy_=s,e&&e.length&&a.spliceWithArray_(0,0,e),s})}var sh={clear:function(){return this.splice(0)},replace:function(t){var r=this[Ce];return r.spliceWithArray_(0,r.values_.length,t)},toJSON:function(){return this.slice()},splice:function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];var i=this[Ce];switch(arguments.length){case 0:return[];case 1:return i.spliceWithArray_(t);case 2:return i.spliceWithArray_(t,r)}return i.spliceWithArray_(t,r,a)},spliceWithArray:function(t,r,n){return this[Ce].spliceWithArray_(t,r,n)},push:function(){for(var t=this[Ce],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.spliceWithArray_(t.values_.length,0,n),t.values_.length},pop:function(){return this.splice(Math.max(this[Ce].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=this[Ce],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.spliceWithArray_(0,0,n),t.values_.length},reverse:function(){return ge.trackingDerivation&&ze(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){ge.trackingDerivation&&ze(37,"sort");var t=this.slice();return t.sort.apply(t,arguments),this.replace(t),this},remove:function(t){var r=this[Ce],n=r.dehanceValues_(r.values_).indexOf(t);return n>-1?(this.splice(n,1),!0):!1}};it("at",dn);it("concat",dn);it("flat",dn);it("includes",dn);it("indexOf",dn);it("join",dn);it("lastIndexOf",dn);it("slice",dn);it("toString",dn);it("toLocaleString",dn);it("toSorted",dn);it("toSpliced",dn);it("with",dn);it("every",ua);it("filter",ua);it("find",ua);it("findIndex",ua);it("findLast",ua);it("findLastIndex",ua);it("flatMap",ua);it("forEach",ua);it("map",ua);it("some",ua);it("toReversed",ua);it("reduce",DO);it("reduceRight",DO);function it(e,t){typeof Array.prototype[e]=="function"&&(sh[e]=t(e))}function dn(e){return function(){var t=this[Ce];t.atom_.reportObserved();var r=t.dehanceValues_(t.values_);return r[e].apply(r,arguments)}}function ua(e){return function(t,r){var n=this,a=this[Ce];a.atom_.reportObserved();var s=a.dehanceValues_(a.values_);return s[e](function(i,o){return t.call(r,i,o,n)})}}function DO(e){return function(){var t=this,r=this[Ce];r.atom_.reportObserved();var n=r.dehanceValues_(r.values_),a=arguments[0];return arguments[0]=function(s,i,o){return a(s,i,o,t)},n[e].apply(n,arguments)}}var ede=wo("ObservableArrayAdministration",Oy);function Tp(e){return yp(e)&&ede(e[Ce])}var tde={},Vs="add",ih="delete",jO=function(){function e(r,n,a){var s=this;n===void 0&&(n=oo),a===void 0&&(a="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[Ce]=tde,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=a,oa(Map)||ze(18),So(function(){s.keysAtom_=sO("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,r&&s.merge(r)})}var t=e.prototype;return t.has_=function(n){return this.data_.has(n)},t.has=function(n){var a=this;if(!ge.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var i=s=new Ui(this.has_(n),bp,"ObservableMap.key?",!1);this.hasMap_.set(n,i),TO(i,function(){return a.hasMap_.delete(n)})}return s.get()},t.set=function(n,a){var s=this.has_(n);if(bn(this)){var i=En(this,{type:s?Na:Vs,object:this,newValue:a,name:n});if(!i)return this;a=i.newValue}return s?this.updateValue_(n,a):this.addValue_(n,a),this},t.delete=function(n){var a=this;if(this.keysAtom_,bn(this)){var s=En(this,{type:ih,object:this,name:n});if(!s)return!1}if(this.has_(n)){var i=ou(),o=ea(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:ih,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return Ga(function(){var c;a.keysAtom_.reportChanged(),(c=a.hasMap_.get(n))==null||c.setNewValue_(!1);var f=a.data_.get(n);f.setNewValue_(void 0),a.data_.delete(n)}),o&&ta(this,l),!0}return!1},t.updateValue_=function(n,a){var s=this.data_.get(n);if(a=s.prepareNewValue_(a),a!==ge.UNCHANGED){var i=ou(),o=ea(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:Na,object:this,oldValue:s.value_,name:n,newValue:a}:null;s.setNewValue_(a),o&&ta(this,l)}},t.addValue_=function(n,a){var s=this;this.keysAtom_,Ga(function(){var c,f=new Ui(a,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,f),a=f.value_,(c=s.hasMap_.get(n))==null||c.setNewValue_(!0),s.keysAtom_.reportChanged()});var i=ou(),o=ea(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:Vs,object:this,name:n,newValue:a}:null;o&&ta(this,l)},t.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var n=this,a=this.keys();return bE({next:function(){var i=a.next(),o=i.done,l=i.value;return{done:o,value:o?void 0:n.get(l)}}})},t.entries=function(){var n=this,a=this.keys();return bE({next:function(){var i=a.next(),o=i.done,l=i.value;return{done:o,value:o?void 0:[l,n.get(l)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(n,a){for(var s=Jo(this),i;!(i=s()).done;){var o=i.value,l=o[0],c=o[1];n.call(a,c,l,this)}},t.merge=function(n){var a=this;return Eo(n)&&(n=new Map(n)),Ga(function(){oi(n)?_ue(n).forEach(function(s){return a.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var i=s[0],o=s[1];return a.set(i,o)}):nc(n)?(yue(n)||ze(19,n),n.forEach(function(s,i){return a.set(i,s)})):n!=null&&ze(20,n)}),this},t.clear=function(){var n=this;Ga(function(){mO(function(){for(var a=Jo(n.keys()),s;!(s=a()).done;){var i=s.value;n.delete(i)}})})},t.replace=function(n){var a=this;return Ga(function(){for(var s=rde(n),i=new Map,o=!1,l=Jo(a.data_.keys()),c;!(c=l()).done;){var f=c.value;if(!s.has(f)){var d=a.delete(f);if(d)o=!0;else{var h=a.data_.get(f);i.set(f,h)}}}for(var m=Jo(s.entries()),v;!(v=m()).done;){var p=v.value,_=p[0],y=p[1],x=a.data_.has(_);if(a.set(_,y),a.data_.has(_)){var g=a.data_.get(_);i.set(_,g),x||(o=!0)}}if(!o)if(a.data_.size!==i.size)a.keysAtom_.reportChanged();else for(var w=a.data_.keys(),b=i.keys(),k=w.next(),E=b.next();!k.done;){if(k.value!==E.value){a.keysAtom_.reportChanged();break}k=w.next(),E=b.next()}a.data_=i}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(n,a){return Lf(this,n)},t.intercept_=function(n){return If(this,n)},ac(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),Eo=wo("ObservableMap",jO);function bE(e){return e[Symbol.toStringTag]="MapIterator",Py(e)}function rde(e){if(nc(e)||Eo(e))return e;if(Array.isArray(e))return new Map(e);if(oi(e)){var t=new Map;for(var r in e)t.set(r,e[r]);return t}else return ze(21,e)}var nde={},PO=function(){function e(r,n,a){var s=this;n===void 0&&(n=oo),a===void 0&&(a="ObservableSet"),this.name_=void 0,this[Ce]=nde,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=a,oa(Set)||ze(22),this.enhancer_=function(i,o){return n(i,o,a)},So(function(){s.atom_=sO(s.name_),r&&s.replace(r)})}var t=e.prototype;return t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.clear=function(){var n=this;Ga(function(){mO(function(){for(var a=Jo(n.data_.values()),s;!(s=a()).done;){var i=s.value;n.delete(i)}})})},t.forEach=function(n,a){for(var s=Jo(this),i;!(i=s()).done;){var o=i.value;n.call(a,o,o,this)}},t.add=function(n){var a=this;if(this.atom_,bn(this)){var s=En(this,{type:Vs,object:this,newValue:n});if(!s)return this}if(!this.has(n)){Ga(function(){a.data_.add(a.enhancer_(n,void 0)),a.atom_.reportChanged()});var i=!1,o=ea(this),l=o||i?{observableKind:"set",debugObjectName:this.name_,type:Vs,object:this,newValue:n}:null;o&&ta(this,l)}return this},t.delete=function(n){var a=this;if(bn(this)){var s=En(this,{type:ih,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var i=!1,o=ea(this),l=o||i?{observableKind:"set",debugObjectName:this.name_,type:ih,object:this,oldValue:n}:null;return Ga(function(){a.atom_.reportChanged(),a.data_.delete(n)}),o&&ta(this,l),!0}return!1},t.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},t.entries=function(){var n=this.values();return EE({next:function(){var s=n.next(),i=s.value,o=s.done;return o?{value:void 0,done:o}:{value:[i,i],done:o}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var n=this,a=this.data_.values();return EE({next:function(){var i=a.next(),o=i.value,l=i.done;return l?{value:void 0,done:l}:{value:n.dehanceValue_(o),done:l}}})},t.intersection=function(n){if(Ya(n)&&!_a(n))return n.intersection(this);var a=new Set(this);return a.intersection(n)},t.union=function(n){if(Ya(n)&&!_a(n))return n.union(this);var a=new Set(this);return a.union(n)},t.difference=function(n){return new Set(this).difference(n)},t.symmetricDifference=function(n){if(Ya(n)&&!_a(n))return n.symmetricDifference(this);var a=new Set(this);return a.symmetricDifference(n)},t.isSubsetOf=function(n){return new Set(this).isSubsetOf(n)},t.isSupersetOf=function(n){return new Set(this).isSupersetOf(n)},t.isDisjointFrom=function(n){if(Ya(n)&&!_a(n))return n.isDisjointFrom(this);var a=new Set(this);return a.isDisjointFrom(n)},t.replace=function(n){var a=this;return _a(n)&&(n=new Set(n)),Ga(function(){Array.isArray(n)?(a.clear(),n.forEach(function(s){return a.add(s)})):Ya(n)?(a.clear(),n.forEach(function(s){return a.add(s)})):n!=null&&ze("Cannot initialize set from "+n)}),this},t.observe_=function(n,a){return Lf(this,n)},t.intercept_=function(n){return If(this,n)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},ac(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),_a=wo("ObservableSet",PO);function EE(e){return e[Symbol.toStringTag]="SetIterator",Py(e)}var SE=Object.create(null),kE="remove",FO=function(){function e(r,n,a,s){n===void 0&&(n=new Map),s===void 0&&(s=Que),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=r,this.values_=n,this.name_=a,this.defaultAnnotation_=s,this.keysAtom_=new gi("ObservableObject.keys"),this.isPlainObject_=oi(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(n){return this.values_.get(n).get()},t.setObservablePropValue_=function(n,a){var s=this.values_.get(n);if(s instanceof la)return s.set(a),!0;if(bn(this)){var i=En(this,{type:Na,object:this.proxy_||this.target_,name:n,newValue:a});if(!i)return null;a=i.newValue}if(a=s.prepareNewValue_(a),a!==ge.UNCHANGED){var o=ea(this),l=!1,c=o||l?{type:Na,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:a}:null;s.setNewValue_(a),o&&ta(this,c)}return!0},t.get_=function(n){return ge.trackingDerivation&&!as(this.target_,n)&&this.has_(n),this.target_[n]},t.set_=function(n,a,s){return s===void 0&&(s=!1),as(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,a):s?Reflect.set(this.target_,n,a):(this.target_[n]=a,!0):this.extend_(n,{value:a,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},t.has_=function(n){if(!ge.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var a=this.pendingKeys_.get(n);return a||(a=new Ui(n in this.target_,bp,"ObservableObject.key?",!1),this.pendingKeys_.set(n,a)),a.get()},t.make_=function(n,a){if(a===!0&&(a=this.defaultAnnotation_),a!==!1){if(!(n in this.target_)){var s;if((s=this.target_[wa])!=null&&s[n])return;ze(1,a.annotationType_,this.name_+"."+n.toString())}for(var i=this.target_;i&&i!==xp;){var o=Z0(i,n);if(o){var l=a.make_(this,n,o,i);if(l===0)return;if(l===1)break}i=Object.getPrototypeOf(i)}CE(this,a,n)}},t.extend_=function(n,a,s,i){if(i===void 0&&(i=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,a,i);var o=s.extend_(this,n,a,i);return o&&CE(this,s,n),o},t.defineProperty_=function(n,a,s){s===void 0&&(s=!1),this.keysAtom_;try{kn();var i=this.delete_(n);if(!i)return i;if(bn(this)){var o=En(this,{object:this.proxy_||this.target_,name:n,type:Vs,newValue:a.value});if(!o)return null;var l=o.newValue;a.value!==l&&(a=io({},a,{value:l}))}if(s){if(!Reflect.defineProperty(this.target_,n,a))return!1}else Ta(this.target_,n,a);this.notifyPropertyAddition_(n,a.value)}finally{Tn()}return!0},t.defineObservableProperty_=function(n,a,s,i){i===void 0&&(i=!1),this.keysAtom_;try{kn();var o=this.delete_(n);if(!o)return o;if(bn(this)){var l=En(this,{object:this.proxy_||this.target_,name:n,type:Vs,newValue:a});if(!l)return null;a=l.newValue}var c=TE(n),f={configurable:ge.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:c.get,set:c.set};if(i){if(!Reflect.defineProperty(this.target_,n,f))return!1}else Ta(this.target_,n,f);var d=new Ui(a,s,"ObservableObject.key",!1);this.values_.set(n,d),this.notifyPropertyAddition_(n,d.value_)}finally{Tn()}return!0},t.defineComputedProperty_=function(n,a,s){s===void 0&&(s=!1),this.keysAtom_;try{kn();var i=this.delete_(n);if(!i)return i;if(bn(this)){var o=En(this,{object:this.proxy_||this.target_,name:n,type:Vs,newValue:void 0});if(!o)return null}a.name||(a.name="ObservableObject.key"),a.context=this.proxy_||this.target_;var l=TE(n),c={configurable:ge.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:l.get,set:l.set};if(s){if(!Reflect.defineProperty(this.target_,n,c))return!1}else Ta(this.target_,n,c);this.values_.set(n,new la(a)),this.notifyPropertyAddition_(n,void 0)}finally{Tn()}return!0},t.delete_=function(n,a){if(a===void 0&&(a=!1),this.keysAtom_,!as(this.target_,n))return!0;if(bn(this)){var s=En(this,{object:this.proxy_||this.target_,name:n,type:kE});if(!s)return null}try{var i;kn();var o=ea(this),l=!1,c=this.values_.get(n),f=void 0;if(!c&&(o||l)){var d;f=(d=Z0(this.target_,n))==null?void 0:d.value}if(a){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(c&&(this.values_.delete(n),c instanceof Ui&&(f=c.value_),wO(c)),this.keysAtom_.reportChanged(),(i=this.pendingKeys_)==null||(i=i.get(n))==null||i.set(n in this.target_),o||l){var h={type:kE,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:f,name:n};o&&ta(this,h)}}finally{Tn()}return!0},t.observe_=function(n,a){return Lf(this,n)},t.intercept_=function(n){return If(this,n)},t.notifyPropertyAddition_=function(n,a){var s,i=ea(this),o=!1;if(i||o){var l=i||o?{type:Vs,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:a}:null;i&&ta(this,l)}(s=this.pendingKeys_)==null||(s=s.get(n))==null||s.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),wp(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function sc(e,t){var r;if(as(e,Ce))return e;var n=(r=t==null?void 0:t.name)!=null?r:"ObservableObject",a=new FO(e,new Map,String(n),cfe(t));return _p(e,Ce,a),e}var ade=wo("ObservableObjectAdministration",FO);function TE(e){return SE[e]||(SE[e]={get:function(){return this[Ce].getObservablePropValue_(e)},set:function(r){return this[Ce].setObservablePropValue_(e,r)}})}function Cp(e){return yp(e)?ade(e[Ce]):!1}function CE(e,t,r){var n;(n=e.target_[wa])==null||delete n[r]}var sde=MO(0),ide=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,e===!1}(),Im=0,RO=function(){};function ode(e,t){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):e.prototype.__proto__!==void 0?e.prototype.__proto__=t:e.prototype=t}ode(RO,Array.prototype);var Dy=function(e){function t(n,a,s,i){var o;return s===void 0&&(s="ObservableArray"),i===void 0&&(i=!1),o=e.call(this)||this,So(function(){var l=new Oy(s,a,i,!0);l.proxy_=o,tO(o,Ce,l),n&&n.length&&o.spliceWithArray(0,0,n),ide&&Object.defineProperty(o,"0",sde)}),o}aO(t,e);var r=t.prototype;return r.concat=function(){this[Ce].atom_.reportObserved();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return Array.prototype.concat.apply(this.slice(),s.map(function(o){return Tp(o)?o.slice():o}))},r[Symbol.iterator]=function(){var n=this,a=0;return Py({next:function(){return a<n.length?{value:n[a++],done:!1}:{done:!0,value:void 0}}})},ac(t,[{key:"length",get:function(){return this[Ce].getArrayLength_()},set:function(a){this[Ce].setArrayLength_(a)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(RO);Object.entries(sh).forEach(function(e){var t=e[0],r=e[1];t!=="concat"&&_p(Dy.prototype,t,r)});function MO(e){return{enumerable:!1,configurable:!0,get:function(){return this[Ce].get_(e)},set:function(r){this[Ce].set_(e,r)}}}function lde(e){Ta(Dy.prototype,""+e,MO(e))}function IO(e){if(e>Im){for(var t=Im;t<e+100;t++)lde(t);Im=e}}IO(1e3);function cde(e,t,r){return new Dy(e,t,r)}function oh(e,t){if(typeof e=="object"&&e!==null){if(Tp(e))return t!==void 0&&ze(23),e[Ce].atom_;if(_a(e))return e.atom_;if(Eo(e)){if(t===void 0)return e.keysAtom_;var r=e.data_.get(t)||e.hasMap_.get(t);return r||ze(25,t,Fg(e)),r}if(Cp(e)){if(!t)return ze(26);var n=e[Ce].values_.get(t);return n||ze(27,t,Fg(e)),n}if(ky(e)||kp(e)||ah(e))return e}else if(oa(e)&&ah(e[Ce]))return e[Ce];ze(28)}function ude(e,t){if(e||ze(29),ky(e)||kp(e)||ah(e)||Eo(e)||_a(e))return e;if(e[Ce])return e[Ce];ze(24,e)}function Fg(e,t){var r;if(t!==void 0)r=oh(e,t);else{if(tf(e))return e.name;Cp(e)||Eo(e)||_a(e)?r=ude(e):r=oh(e)}return r.name_}function So(e){var t=bo(),r=Cy(!0);kn();try{return e()}finally{Tn(),Ny(r),ss(t)}}var NE=xp.toString;function jy(e,t,r){return r===void 0&&(r=-1),Rg(e,t,r)}function Rg(e,t,r,n,a){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var s=typeof e;if(s!=="function"&&s!=="object"&&typeof t!="object")return!1;var i=NE.call(e);if(i!==NE.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":r>=0&&r++;break}e=AE(e),t=AE(t);var o=i==="[object Array]";if(!o){if(typeof e!="object"||typeof t!="object")return!1;var l=e.constructor,c=t.constructor;if(l!==c&&!(oa(l)&&l instanceof l&&oa(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}if(r===0)return!1;r<0&&(r=-1),n=n||[],a=a||[];for(var f=n.length;f--;)if(n[f]===e)return a[f]===t;if(n.push(e),a.push(t),o){if(f=e.length,f!==t.length)return!1;for(;f--;)if(!Rg(e[f],t[f],r-1,n,a))return!1}else{var d=Object.keys(e),h;if(f=d.length,Object.keys(t).length!==f)return!1;for(;f--;)if(h=d[f],!(as(t,h)&&Rg(e[h],t[h],r-1,n,a)))return!1}return n.pop(),a.pop(),!0}function AE(e){return Tp(e)?e.slice():nc(e)||Eo(e)||Ya(e)||_a(e)?Array.from(e.entries()):e}var OE,fde=((OE=gp().Iterator)==null?void 0:OE.prototype)||{};function Py(e){return e[Symbol.iterator]=dde,Object.assign(Object.create(fde),e)}function dde(){return this}["Symbol","Map","Set"].forEach(function(e){var t=gp();typeof t[e]>"u"&&ze("MobX requires global '"+e+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Cfe,extras:{getDebugName:Fg},$mobx:Ce});if(!O.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!Xfe)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function hde(e){e()}function pde(e){e||(e=hde),Ufe({reactionScheduler:e})}function mde(e){return Vfe(e)}var vde=1e4,gde=1e4,xde=function(){function e(t){var r=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(n){n===void 0&&(n=vde),clearTimeout(r.sweepTimeout),r.sweepTimeout=void 0;var a=Date.now();r.registrations.forEach(function(s,i){a-s.registeredAt>=n&&(r.finalize(s.value),r.registrations.delete(i))}),r.registrations.size>0&&r.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){r.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(t,r,n){this.registrations.set(n,{value:r,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(t){this.registrations.delete(t)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,gde))}}),e}(),yde=typeof FinalizationRegistry<"u"?FinalizationRegistry:xde,Mg=new yde(function(e){var t;(t=e.reaction)===null||t===void 0||t.dispose(),e.reaction=null});function DE(e){e.reaction=new ms("observer".concat(e.name),function(){var t;e.stateVersion=Symbol(),(t=e.onStoreChange)===null||t===void 0||t.call(e)})}function _de(e,t){t===void 0&&(t="observed");var r=J.useRef(null);if(!r.current){var n={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:t,subscribe:function(o){return Mg.unregister(n),n.onStoreChange=o,n.reaction||(DE(n),n.stateVersion=Symbol()),function(){var l;n.onStoreChange=null,(l=n.reaction)===null||l===void 0||l.dispose(),n.reaction=null}},getSnapshot:function(){return n.stateVersion}};r.current=n}var a=r.current;a.reaction||(DE(a),Mg.register(r,a,a)),J.useDebugValue(a.reaction,mde),oT.useSyncExternalStore(a.subscribe,a.getSnapshot,a.getSnapshot);var s,i;if(a.reaction.track(function(){try{s=e()}catch(o){i=o}}),i)throw i;return s}var Lm,$m,LO=typeof Symbol=="function"&&Symbol.for,wde=($m=(Lm=Object.getOwnPropertyDescriptor(function(){},"name"))===null||Lm===void 0?void 0:Lm.configurable)!==null&&$m!==void 0?$m:!1,jE=LO?Symbol.for("react.forward_ref"):typeof O.forwardRef=="function"&&O.forwardRef(function(e){return null}).$$typeof,PE=LO?Symbol.for("react.memo"):typeof O.memo=="function"&&O.memo(function(e){return null}).$$typeof;function bde(e,t){var r;if(PE&&e.$$typeof===PE)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var n=(r=void 0)!==null&&r!==void 0?r:!1,a=e,s=e.displayName||e.name;if(jE&&e.$$typeof===jE&&(n=!0,a=e.render,typeof a!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var i=function(o,l){return _de(function(){return a(o,l)},s)};return i.displayName=e.displayName,wde&&Object.defineProperty(i,"name",{value:e.name,writable:!0,configurable:!0}),e.contextTypes&&(i.contextTypes=e.contextTypes),n&&(i=O.forwardRef(i)),i=O.memo(i),Sde(e,i),i}var Ede={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function Sde(e,t){Object.keys(e).forEach(function(r){Ede[r]||Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}var Bm;pde(Dx.unstable_batchedUpdates);Bm=Mg.finalizeAllImmediately;const kde=bde(()=>{const e=Je(),t=Pn(),[r,n]=O.useState(new Date);O.useEffect(()=>{const s=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(s)},[]);const a=()=>{e.logout(),localStorage.clear(),sessionStorage.clear(),t("/login")};return u.jsxs("nav",{className:"bg-White-800 text-Black shadow-lg py-4 px-6 flex items-center justify-between",children:[u.jsxs("div",{className:"text-left",children:[u.jsxs("p",{className:"text-sm",children:["Date: ",r.toLocaleDateString()]}),u.jsxs("p",{className:"text-sm",children:["Time: ",r.toLocaleTimeString()]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsxs("span",{className:"mr-4",children:["Role: ",e.role]}),u.jsx("button",{onClick:a,className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Logout"})]})]})});function Tde(){const{id:e}=Il(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState(!1),[c,f]=O.useState(!1);O.useState(null);const[d,h]=O.useState(!1),[m,v]=O.useState(!1),[p,_]=O.useState(null),[y,x]=O.useState(!1),[g,w]=O.useState({contact:!1,status:!1,quotation:!1,document:!1}),[b,k]=O.useState({document_type:"quotation",description:"",file:null}),E=Je(B=>B.role),S=Je(B=>B.user),[T,P]=O.useState({name:"",position:"",email:"",phone:""});O.useEffect(()=>{e&&(M(),D(),L(),Q())},[e,y]);async function M(){try{const{data:B}=await se.from("clients").select("*").eq("id",e).single();r(B);const{data:C}=await se.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(C||[]);const I=se.from("quotations").select(`
                    *,
                    employees (
                        full_name,
                        role
                    ),
                    quotation_assets (
                        asset_id,
                        quantity,
                        assets (
                            item
                        )
                    )
                `).eq("client_id",e);E!=="admin"&&E!=="head"&&I.eq("status","approved")}catch(B){console.error("Error loading client data:",B)}}async function L(){try{w(I=>({...I,document:!0}));const{data:B,error:C}=await se.from("documents").select(`
                    *,
                    employees (
                        full_name
                    )
                `).eq("client_id",e).order("created_at",{ascending:!1});if(C)throw C;console.log("Documents loaded:",B),i(B||[])}catch(B){console.error("Error loading documents:",B)}finally{w(B=>({...B,document:!1}))}}async function D(){try{const{data:B}=await se.from("assets").select("*").order("item")}catch(B){console.error("Error loading assets:",B)}}async function Q(){try{if(E==="admin"||E==="finance.employee"){x(!0);return}if(!(S!=null&&S.id)||!e){x(!1);return}const{data:B,error:C}=await se.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",S.id).single();x(!!B)}catch(B){console.error("Error checking assignment:",B)}}async function ee(B){B.preventDefault(),w({...g,contact:!0});try{const{error:C}=await se.from("contact_persons").insert([{...T,client_id:e}]);if(C)throw C;P({name:"",position:"",email:"",phone:""}),l(!1),await M()}catch(C){console.error("Error adding contact person:",C)}finally{w({...g,contact:!1})}}async function Y(B){B.preventDefault(),w({...g,contact:!0});try{const{error:C}=await se.from("contact_persons").update({name:p.name,position:p.position,email:p.email,phone:p.phone}).eq("id",p.id);if(C)throw C;_(null),await M()}catch(C){console.error("Error updating contact person:",C)}finally{w({...g,contact:!1})}}async function q(B){w({...g,status:!0});try{const{error:C}=await se.from("clients").update({status:B}).eq("id",e);if(C)throw C;h(!1),v(!1),await M()}catch(C){console.error("Error updating client status:",C)}finally{w({...g,status:!1})}}async function G(B){if(B.preventDefault(),!(!b.file||!(S!=null&&S.id))){w({...g,document:!0});try{const{data:C}=await se.storage.listBuckets();C!=null&&C.find(X=>X.name==="documents")||await se.storage.createBucket("documents",{public:!1});const I=b.file.name.split(".").pop(),N=`${S.id}/${Date.now()}.${I}`,{error:j}=await se.storage.from("documents").upload(N,b.file,{cacheControl:"3600",upsert:!1});if(j)throw j;const{data:{publicUrl:K}}=se.storage.from("documents").getPublicUrl(N),{error:ie}=await se.from("documents").insert([{client_id:e,employee_id:S.id,document_type:b.document_type,description:b.description,file_name:b.file.name,file_url:K,file_path:N,file_type:b.file.type,file_size:b.file.size}]);if(ie)throw ie;k({document_type:"quotation",description:"",file:null}),f(!1),await L()}catch(C){console.error("Error uploading document:",C),alert(`Upload failed: ${C.message}`)}finally{w({...g,document:!1})}}}async function V(B,C){if(confirm("Are you sure you want to delete this document?")){w({...g,document:!0});try{const{error:I}=await se.storage.from("documents").remove([C]);if(I)throw I;const{error:N}=await se.from("documents").delete().eq("id",B);if(N)throw N;await L()}catch(I){console.error("Error deleting document:",I)}finally{w({...g,document:!1})}}}function ae(B,C){const I=encodeURIComponent(`Document: ${B.file_name}`),N=encodeURIComponent(`Dear Client,

Please find attached the document you requested.

Document Type: ${B.document_type}
Description: ${B.description||"N/A"}

Best regards,
${(S==null?void 0:S.full_name)||"Your Representative"}
${(S==null?void 0:S.email)||""}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${C}&su=${I}&body=${N}`)}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:g.contact,children:g.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})}),u.jsx("button",{onClick:()=>f(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:g.document,children:g.document?"Loading...":u.jsxs(u.Fragment,{children:[u.jsx(kw,{className:"w-4 h-4 mr-2"}),"Upload Document"]})})]})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(B=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:B.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:B.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(Bl,{className:"w-4 h-4 mr-2"}),B.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(ff,{className:"w-4 h-4 mr-2"}),B.phone]})]}),E==="finance.employee"&&u.jsx("button",{onClick:()=>_(B),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},B.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Documents"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No documents found"}):u.jsx("div",{className:"space-y-4",children:s.map(B=>{var C;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(kw,{className:"w-4 h-4 text-gray-500"}),u.jsx("a",{href:B.file_url,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-blue-600 hover:underline",children:B.file_name})]}),u.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Type: ",B.document_type]}),B.description&&u.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Description: ",B.description]}),u.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Uploaded by ",(C=B.employees)==null?void 0:C.full_name," on ",new Date(B.created_at).toLocaleDateString()]})]}),u.jsxs("div",{className:"flex gap-2",children:[n.length>0&&u.jsx("button",{onClick:()=>ae(B,n[0].email),className:"p-2 text-blue-600 hover:text-blue-800",title:"Send to client",children:u.jsx(RT,{className:"w-4 h-4"})}),(E==="admin"||E==="finance.employee")&&u.jsx("button",{onClick:()=>V(B.id,B.file_path),className:"p-2 text-red-600 hover:text-red-800",title:"Delete document",disabled:g.document,children:u.jsx(S6,{className:"w-4 h-4"})})]})]})},B.id)})})]}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Upload Document"}),u.jsxs("form",{onSubmit:G,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Document Type"}),u.jsxs("select",{value:b.document_type,onChange:B=>k({...b,document_type:B.target.value}),className:"w-full p-2 border rounded",required:!0,children:[u.jsx("option",{value:"quotation",children:"Quotation"}),u.jsx("option",{value:"contract",children:"Contract"}),u.jsx("option",{value:"invoice",children:"Invoice"}),u.jsx("option",{value:"proposal",children:"Proposal"}),u.jsx("option",{value:"other",children:"Other"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Description (Optional)"}),u.jsx("textarea",{value:b.description,onChange:B=>k({...b,description:B.target.value}),className:"w-full p-2 border rounded",rows:3})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"File"}),u.jsx("input",{type:"file",onChange:B=>{B.target.files&&B.target.files[0]&&k({...b,file:B.target.files[0]})},className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.document,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:g.document||!b.file,children:g.document?"Uploading...":"Upload Document"})]})]})]})}),E==="finance.employee"&&u.jsx("button",{onClick:()=>v(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:g.status,children:g.status?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(S0,{className:"w-4 h-4 mr-2"}),"Completed"]})}),d&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.status,children:"Cancel"}),u.jsx("button",{onClick:()=>q("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:g.status,children:"Confirm"})]})]})}),m&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Completed"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.status,children:"Cancel"}),u.jsx("button",{onClick:()=>q("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:g.status,children:"Confirm"})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:ee,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:T.name,onChange:B=>P({...T,name:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:T.position,onChange:B=>P({...T,position:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:T.email,onChange:B=>P({...T,email:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:T.phone,onChange:B=>P({...T,phone:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:g.contact,children:g.contact?"Adding...":"Add Contact"})]})]})]})}),p&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:Y,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:p.name,onChange:B=>_({...p,name:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:p.position,onChange:B=>_({...p,position:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:p.email,onChange:B=>_({...p,email:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:p.phone,onChange:B=>_({...p,phone:B.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>_(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:g.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:g.contact,children:g.contact?"Saving...":"Save Changes"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function Cde(){const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,s]=O.useState(""),[i,o]=O.useState(""),[l,c]=O.useState(""),[f,d]=O.useState(!1);O.useEffect(()=>{h()},[]);async function h(){n(!0);try{const{data:y,error:x}=await se.from("site_visit").select(`
          id,
          created_at,
          status,
          employee:employee_Id (full_name),
          client:client_Id (name, address),
          form:site_visit_form (
            address,
            created_at
          )
        `).order("created_at",{ascending:!1});if(x)throw x;const g=m(y||[]);t(g)}catch(y){console.error("Error fetching time insights:",y)}finally{n(!1)}}function m(y){return y.filter(x=>{var g,w;return x.status==="end"&&((w=(g=x.form)==null?void 0:g[0])==null?void 0:w.created_at)}).map(x=>{var T,P,M,L,D;const g=new Date(x.created_at),b=(new Date(x.form[0].created_at).getTime()-g.getTime())/(1e3*60),k=Math.floor(b/(60*24)),E=Math.floor(b%(60*24)/60),S=Math.floor(b%60);return{id:x.id,client_name:((T=x.client)==null?void 0:T.name)||"Unknown",employee_name:((P=x.employee)==null?void 0:P.full_name)||"Unknown",date:g.toLocaleDateString(),raw_date:g,address:((L=(M=x.form)==null?void 0:M[0])==null?void 0:L.address)||((D=x.client)==null?void 0:D.address)||"N/A",duration:{days:k,hours:E,minutes:S}}})}const v=e.filter(y=>{const x=y.client_name.toLowerCase().includes(a.toLowerCase())||y.employee_name.toLowerCase().includes(a.toLowerCase())||y.address.toLowerCase().includes(a.toLowerCase()),g=i?y.raw_date.toISOString().split("T")[0]===i:!0,w=l?y.employee_name.toLowerCase().includes(l.toLowerCase()):!0;return x&&g&&w}),p=()=>{s(""),o(""),c("")},_=[...new Set(e.map(y=>y.employee_name))];return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Time Insights"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client, employee or address...",value:a,onChange:y=>s(y.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>d(!f),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(PT,{className:"w-4 h-4"}),u.jsx("span",{children:"Filters"})]})]})]}),f&&u.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"font-medium",children:"Filters"}),u.jsxs("button",{onClick:p,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Ki,{className:"w-4 h-4"}),"Clear all"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Visit Date"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Ph,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"date",value:i,onChange:y=>o(y.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),u.jsxs("select",{value:l,onChange:y=>c(y.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2",children:[u.jsx("option",{value:"",children:"All Employees"}),_.map(y=>u.jsx("option",{value:y,children:y},y))]})]})]})]}),r?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length>0?v.map(y=>{const x=y.duration.days*1440+y.duration.hours*60+y.duration.minutes;return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.client_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.employee_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.date}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.address}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsxs("span",{className:`px-2 py-1 rounded-full text-xs ${x>120?"bg-red-100 text-red-800":x>60?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[`${y.duration.days>0?`${y.duration.days}d `:""}${y.duration.hours}h ${y.duration.minutes}m`,x>0&&` (${x.toFixed(0)} mins)`]})})]},y.id)}):u.jsx("tr",{children:u.jsxs("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:["No matching time tracking data found",(a||i||l)&&u.jsx("button",{onClick:p,className:"text-blue-600 hover:underline ml-2",children:"Clear filters"})]})})})]})})})]})}function Ec({children:e,requiredRoles:t}){const r=Je(n=>n.role);return t.includes(r||"")?e:u.jsx(b0,{to:"/dashboard"})}function Nde({children:e}){return Je(r=>r.user)?e:u.jsx(b0,{to:"/login"})}function Ade(){return u.jsx(TP,{children:u.jsx(Ode,{})})}function Ode(){const t=Ml().pathname!=="/login";return Je(r=>r.role),u.jsxs(u.Fragment,{children:[t&&u.jsx(kde,{}),u.jsxs(yP,{children:[u.jsx(ht,{path:"/login",element:u.jsx(k6,{})}),u.jsxs(ht,{path:"/",element:u.jsx(Nde,{children:u.jsx(mue,{})}),children:[u.jsx(ht,{path:"/",element:u.jsx(b0,{to:"/dashboard"})}),u.jsx(ht,{path:"/dashboard",element:u.jsx(Xee,{})}),u.jsx(ht,{path:"/clients",element:u.jsx(Qee,{})}),u.jsx(ht,{path:"/clients-history",element:u.jsx(ste,{})}),u.jsx(ht,{path:"/notifications",element:u.jsx(ite,{})}),u.jsx(ht,{path:"/AllClients",element:u.jsx(Zee,{})}),u.jsx(ht,{path:"/xldata",element:u.jsx(cue,{})}),u.jsx(ht,{path:"/time-insights",element:u.jsx(Cde,{})}),u.jsx(ht,{path:"/clientshistoryprofile/:id",element:u.jsx(hue,{})}),u.jsx(ht,{path:"/clients/:id",element:u.jsx(tte,{})}),u.jsx(ht,{path:"/eclients/:id",element:u.jsx(rte,{})}),u.jsx(ht,{path:"/allclients/:id",element:u.jsx(ete,{})}),u.jsx(ht,{path:"/site-visits/:id",element:u.jsx(ate,{})}),u.jsx(ht,{path:"/fclients/:id",element:u.jsx(Tde,{})}),u.jsx(ht,{path:"/pd-kits",element:u.jsx(pue,{})}),u.jsx(ht,{path:"/employees",element:u.jsx(Ec,{requiredRoles:["head","e.head"],children:u.jsx(Jee,{})})}),u.jsx(ht,{path:"/site-visit",element:u.jsx(Ec,{requiredRoles:["employee","e.employee"],children:u.jsx(nte,{})})}),u.jsx(ht,{path:"/eclients",element:u.jsx(Ec,{requiredRoles:["e.head","e.employee"],children:u.jsx(uue,{})})}),u.jsx(ht,{path:"/fclients",element:u.jsx(Ec,{requiredRoles:["finance.employee"],children:u.jsx(fue,{})})}),u.jsx(ht,{path:"/documents-upload",element:u.jsx(Ec,{requiredRoles:["finance.employee"],children:u.jsx(due,{})})})]}),u.jsx(ht,{path:"*",element:u.jsx(b0,{to:"/dashboard"})})]})]})}Gk(document.getElementById("root")).render(u.jsx(O.StrictMode,{children:u.jsx(Ade,{})}));export{Er as g};
